function Vk(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(e,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var zl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function om(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Wk(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}),n}var kx={exports:{}},Sf={},Rx={exports:{}},je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lu=Symbol.for("react.element"),Uk=Symbol.for("react.portal"),zk=Symbol.for("react.fragment"),Hk=Symbol.for("react.strict_mode"),Gk=Symbol.for("react.profiler"),qk=Symbol.for("react.provider"),Kk=Symbol.for("react.context"),Xk=Symbol.for("react.forward_ref"),Yk=Symbol.for("react.suspense"),Qk=Symbol.for("react.memo"),Jk=Symbol.for("react.lazy"),Uy=Symbol.iterator;function Zk(e){return e===null||typeof e!="object"?null:(e=Uy&&e[Uy]||e["@@iterator"],typeof e=="function"?e:null)}var Px={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ix=Object.assign,Ox={};function ss(e,t,n){this.props=e,this.context=t,this.refs=Ox,this.updater=n||Px}ss.prototype.isReactComponent={};ss.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ss.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Tx(){}Tx.prototype=ss.prototype;function im(e,t,n){this.props=e,this.context=t,this.refs=Ox,this.updater=n||Px}var am=im.prototype=new Tx;am.constructor=im;Ix(am,ss.prototype);am.isPureReactComponent=!0;var zy=Array.isArray,Dx=Object.prototype.hasOwnProperty,sm={current:null},Nx={key:!0,ref:!0,__self:!0,__source:!0};function Ax(e,t,n){var r,o={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)Dx.call(t,r)&&!Nx.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];o.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:Lu,type:e,key:i,ref:a,props:o,_owner:sm.current}}function eR(e,t){return{$$typeof:Lu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function um(e){return typeof e=="object"&&e!==null&&e.$$typeof===Lu}function tR(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Hy=/\/+/g;function Wd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?tR(""+e.key):t.toString(36)}function Hl(e,t,n,r,o){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Lu:case Uk:a=!0}}if(a)return a=e,o=o(a),e=r===""?"."+Wd(a,0):r,zy(o)?(n="",e!=null&&(n=e.replace(Hy,"$&/")+"/"),Hl(o,t,n,"",function(l){return l})):o!=null&&(um(o)&&(o=eR(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(Hy,"$&/")+"/")+e)),t.push(o)),1;if(a=0,r=r===""?".":r+":",zy(e))for(var s=0;s<e.length;s++){i=e[s];var u=r+Wd(i,s);a+=Hl(i,t,n,u,o)}else if(u=Zk(e),typeof u=="function")for(e=u.call(e),s=0;!(i=e.next()).done;)i=i.value,u=r+Wd(i,s++),a+=Hl(i,t,n,u,o);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function al(e,t,n){if(e==null)return e;var r=[],o=0;return Hl(e,r,"","",function(i){return t.call(n,i,o++)}),r}function nR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var xn={current:null},Gl={transition:null},rR={ReactCurrentDispatcher:xn,ReactCurrentBatchConfig:Gl,ReactCurrentOwner:sm};function Mx(){throw Error("act(...) is not supported in production builds of React.")}je.Children={map:al,forEach:function(e,t,n){al(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return al(e,function(){t++}),t},toArray:function(e){return al(e,function(t){return t})||[]},only:function(e){if(!um(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};je.Component=ss;je.Fragment=zk;je.Profiler=Gk;je.PureComponent=im;je.StrictMode=Hk;je.Suspense=Yk;je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rR;je.act=Mx;je.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Ix({},e.props),o=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=sm.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(u in t)Dx.call(t,u)&&!Nx.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&s!==void 0?s[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:Lu,type:e.type,key:o,ref:i,props:r,_owner:a}};je.createContext=function(e){return e={$$typeof:Kk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:qk,_context:e},e.Consumer=e};je.createElement=Ax;je.createFactory=function(e){var t=Ax.bind(null,e);return t.type=e,t};je.createRef=function(){return{current:null}};je.forwardRef=function(e){return{$$typeof:Xk,render:e}};je.isValidElement=um;je.lazy=function(e){return{$$typeof:Jk,_payload:{_status:-1,_result:e},_init:nR}};je.memo=function(e,t){return{$$typeof:Qk,type:e,compare:t===void 0?null:t}};je.startTransition=function(e){var t=Gl.transition;Gl.transition={};try{e()}finally{Gl.transition=t}};je.unstable_act=Mx;je.useCallback=function(e,t){return xn.current.useCallback(e,t)};je.useContext=function(e){return xn.current.useContext(e)};je.useDebugValue=function(){};je.useDeferredValue=function(e){return xn.current.useDeferredValue(e)};je.useEffect=function(e,t){return xn.current.useEffect(e,t)};je.useId=function(){return xn.current.useId()};je.useImperativeHandle=function(e,t,n){return xn.current.useImperativeHandle(e,t,n)};je.useInsertionEffect=function(e,t){return xn.current.useInsertionEffect(e,t)};je.useLayoutEffect=function(e,t){return xn.current.useLayoutEffect(e,t)};je.useMemo=function(e,t){return xn.current.useMemo(e,t)};je.useReducer=function(e,t,n){return xn.current.useReducer(e,t,n)};je.useRef=function(e){return xn.current.useRef(e)};je.useState=function(e){return xn.current.useState(e)};je.useSyncExternalStore=function(e,t,n){return xn.current.useSyncExternalStore(e,t,n)};je.useTransition=function(){return xn.current.useTransition()};je.version="18.3.1";Rx.exports=je;var N=Rx.exports;const _n=om(N),dh=Vk({__proto__:null,default:_n},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oR=N,iR=Symbol.for("react.element"),aR=Symbol.for("react.fragment"),sR=Object.prototype.hasOwnProperty,uR=oR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lR={key:!0,ref:!0,__self:!0,__source:!0};function Fx(e,t,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)sR.call(t,r)&&!lR.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:iR,type:e,key:i,ref:a,props:o,_owner:uR.current}}Sf.Fragment=aR;Sf.jsx=Fx;Sf.jsxs=Fx;kx.exports=Sf;var P=kx.exports,ph={},Lx={exports:{}},Jn={},Bx={exports:{}},jx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,L){var B=O.length;O.push(L);e:for(;0<B;){var G=B-1>>>1,q=O[G];if(0<o(q,L))O[G]=L,O[B]=q,B=G;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var L=O[0],B=O.pop();if(B!==L){O[0]=B;e:for(var G=0,q=O.length,J=q>>>1;G<J;){var ne=2*(G+1)-1,ie=O[ne],se=ne+1,me=O[se];if(0>o(ie,B))se<q&&0>o(me,ie)?(O[G]=me,O[se]=B,G=se):(O[G]=ie,O[ne]=B,G=ne);else if(se<q&&0>o(me,B))O[G]=me,O[se]=B,G=se;else break e}}return L}function o(O,L){var B=O.sortIndex-L.sortIndex;return B!==0?B:O.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,f=null,d=3,p=!1,h=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var L=n(l);L!==null;){if(L.callback===null)r(l);else if(L.startTime<=O)r(l),L.sortIndex=L.expirationTime,t(u,L);else break;L=n(l)}}function x(O){if(m=!1,b(O),!h)if(n(u)!==null)h=!0,M(w);else{var L=n(l);L!==null&&$(x,L.startTime-O)}}function w(O,L){h=!1,m&&(m=!1,v(C),C=-1),p=!0;var B=d;try{for(b(L),f=n(u);f!==null&&(!(f.expirationTime>L)||O&&!T());){var G=f.callback;if(typeof G=="function"){f.callback=null,d=f.priorityLevel;var q=G(f.expirationTime<=L);L=e.unstable_now(),typeof q=="function"?f.callback=q:f===n(u)&&r(u),b(L)}else r(u);f=n(u)}if(f!==null)var J=!0;else{var ne=n(l);ne!==null&&$(x,ne.startTime-L),J=!1}return J}finally{f=null,d=B,p=!1}}var S=!1,E=null,C=-1,k=5,_=-1;function T(){return!(e.unstable_now()-_<k)}function D(){if(E!==null){var O=e.unstable_now();_=O;var L=!0;try{L=E(!0,O)}finally{L?U():(S=!1,E=null)}}else S=!1}var U;if(typeof y=="function")U=function(){y(D)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,A=j.port2;j.port1.onmessage=D,U=function(){A.postMessage(null)}}else U=function(){g(D,0)};function M(O){E=O,S||(S=!0,U())}function $(O,L){C=g(function(){O(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){h||p||(h=!0,M(w))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(O){switch(d){case 1:case 2:case 3:var L=3;break;default:L=d}var B=d;d=L;try{return O()}finally{d=B}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,L){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var B=d;d=O;try{return L()}finally{d=B}},e.unstable_scheduleCallback=function(O,L,B){var G=e.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?G+B:G):B=G,O){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=B+q,O={id:c++,callback:L,priorityLevel:O,startTime:B,expirationTime:q,sortIndex:-1},B>G?(O.sortIndex=B,t(l,O),n(u)===null&&O===n(l)&&(m?(v(C),C=-1):m=!0,$(x,B-G))):(O.sortIndex=q,t(u,O),h||p||(h=!0,M(w))),O},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(O){var L=d;return function(){var B=d;d=L;try{return O.apply(this,arguments)}finally{d=B}}}})(jx);Bx.exports=jx;var cR=Bx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fR=N,Yn=cR;function re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $x=new Set,nu={};function Gi(e,t){Ga(e,t),Ga(e+"Capture",t)}function Ga(e,t){for(nu[e]=t,e=0;e<t.length;e++)$x.add(t[e])}var fo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hh=Object.prototype.hasOwnProperty,dR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gy={},qy={};function pR(e){return hh.call(qy,e)?!0:hh.call(Gy,e)?!1:dR.test(e)?qy[e]=!0:(Gy[e]=!0,!1)}function hR(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vR(e,t,n,r){if(t===null||typeof t>"u"||hR(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function wn(e,t,n,r,o,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Zt[e]=new wn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Zt[t]=new wn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Zt[e]=new wn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Zt[e]=new wn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Zt[e]=new wn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Zt[e]=new wn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Zt[e]=new wn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Zt[e]=new wn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Zt[e]=new wn(e,5,!1,e.toLowerCase(),null,!1,!1)});var lm=/[\-:]([a-z])/g;function cm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(lm,cm);Zt[t]=new wn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(lm,cm);Zt[t]=new wn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(lm,cm);Zt[t]=new wn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Zt[e]=new wn(e,1,!1,e.toLowerCase(),null,!1,!1)});Zt.xlinkHref=new wn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Zt[e]=new wn(e,1,!1,e.toLowerCase(),null,!0,!0)});function fm(e,t,n,r){var o=Zt.hasOwnProperty(t)?Zt[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(vR(t,n,o,r)&&(n=null),r||o===null?pR(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var yo=fR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sl=Symbol.for("react.element"),ga=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),dm=Symbol.for("react.strict_mode"),vh=Symbol.for("react.profiler"),Vx=Symbol.for("react.provider"),Wx=Symbol.for("react.context"),pm=Symbol.for("react.forward_ref"),mh=Symbol.for("react.suspense"),gh=Symbol.for("react.suspense_list"),hm=Symbol.for("react.memo"),Do=Symbol.for("react.lazy"),Ux=Symbol.for("react.offscreen"),Ky=Symbol.iterator;function bs(e){return e===null||typeof e!="object"?null:(e=Ky&&e[Ky]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Object.assign,Ud;function Fs(e){if(Ud===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ud=t&&t[1]||""}return`
`+Ud+e}var zd=!1;function Hd(e,t){if(!e||zd)return"";zd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var o=l.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var u=`
`+o[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=s);break}}}finally{zd=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Fs(e):""}function mR(e){switch(e.tag){case 5:return Fs(e.type);case 16:return Fs("Lazy");case 13:return Fs("Suspense");case 19:return Fs("SuspenseList");case 0:case 2:case 15:return e=Hd(e.type,!1),e;case 11:return e=Hd(e.type.render,!1),e;case 1:return e=Hd(e.type,!0),e;default:return""}}function yh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case ga:return"Portal";case vh:return"Profiler";case dm:return"StrictMode";case mh:return"Suspense";case gh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Wx:return(e.displayName||"Context")+".Consumer";case Vx:return(e._context.displayName||"Context")+".Provider";case pm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case hm:return t=e.displayName||null,t!==null?t:yh(e.type)||"Memo";case Do:t=e._payload,e=e._init;try{return yh(e(t))}catch{}}return null}function gR(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yh(t);case 8:return t===dm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function oi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function yR(e){var t=zx(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ul(e){e._valueTracker||(e._valueTracker=yR(e))}function Hx(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=zx(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function fc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function bh(e,t){var n=t.checked;return pt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Xy(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=oi(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Gx(e,t){t=t.checked,t!=null&&fm(e,"checked",t,!1)}function xh(e,t){Gx(e,t);var n=oi(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wh(e,t.type,n):t.hasOwnProperty("defaultValue")&&wh(e,t.type,oi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Yy(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function wh(e,t,n){(t!=="number"||fc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ls=Array.isArray;function Ia(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+oi(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Sh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(re(91));return pt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Qy(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(re(92));if(Ls(n)){if(1<n.length)throw Error(re(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:oi(n)}}function qx(e,t){var n=oi(t.value),r=oi(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Jy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Kx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ch(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Kx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ll,Xx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ll=ll||document.createElement("div"),ll.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ll.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ru(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Us={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bR=["Webkit","ms","Moz","O"];Object.keys(Us).forEach(function(e){bR.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Us[t]=Us[e]})});function Yx(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Us.hasOwnProperty(e)&&Us[e]?(""+t).trim():t+"px"}function Qx(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=Yx(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var xR=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Eh(e,t){if(t){if(xR[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(re(62))}}function _h(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kh=null;function vm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Rh=null,Oa=null,Ta=null;function Zy(e){if(e=$u(e)){if(typeof Rh!="function")throw Error(re(280));var t=e.stateNode;t&&(t=Rf(t),Rh(e.stateNode,e.type,t))}}function Jx(e){Oa?Ta?Ta.push(e):Ta=[e]:Oa=e}function Zx(){if(Oa){var e=Oa,t=Ta;if(Ta=Oa=null,Zy(e),t)for(e=0;e<t.length;e++)Zy(t[e])}}function ew(e,t){return e(t)}function tw(){}var Gd=!1;function nw(e,t,n){if(Gd)return e(t,n);Gd=!0;try{return ew(e,t,n)}finally{Gd=!1,(Oa!==null||Ta!==null)&&(tw(),Zx())}}function ou(e,t){var n=e.stateNode;if(n===null)return null;var r=Rf(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(re(231,t,typeof n));return n}var Ph=!1;if(fo)try{var xs={};Object.defineProperty(xs,"passive",{get:function(){Ph=!0}}),window.addEventListener("test",xs,xs),window.removeEventListener("test",xs,xs)}catch{Ph=!1}function wR(e,t,n,r,o,i,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var zs=!1,dc=null,pc=!1,Ih=null,SR={onError:function(e){zs=!0,dc=e}};function CR(e,t,n,r,o,i,a,s,u){zs=!1,dc=null,wR.apply(SR,arguments)}function ER(e,t,n,r,o,i,a,s,u){if(CR.apply(this,arguments),zs){if(zs){var l=dc;zs=!1,dc=null}else throw Error(re(198));pc||(pc=!0,Ih=l)}}function qi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function rw(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function e0(e){if(qi(e)!==e)throw Error(re(188))}function _R(e){var t=e.alternate;if(!t){if(t=qi(e),t===null)throw Error(re(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return e0(o),e;if(i===r)return e0(o),t;i=i.sibling}throw Error(re(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(re(189))}}if(n.alternate!==r)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?e:t}function ow(e){return e=_R(e),e!==null?iw(e):null}function iw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=iw(e);if(t!==null)return t;e=e.sibling}return null}var aw=Yn.unstable_scheduleCallback,t0=Yn.unstable_cancelCallback,kR=Yn.unstable_shouldYield,RR=Yn.unstable_requestPaint,xt=Yn.unstable_now,PR=Yn.unstable_getCurrentPriorityLevel,mm=Yn.unstable_ImmediatePriority,sw=Yn.unstable_UserBlockingPriority,hc=Yn.unstable_NormalPriority,IR=Yn.unstable_LowPriority,uw=Yn.unstable_IdlePriority,Cf=null,Hr=null;function OR(e){if(Hr&&typeof Hr.onCommitFiberRoot=="function")try{Hr.onCommitFiberRoot(Cf,e,void 0,(e.current.flags&128)===128)}catch{}}var Er=Math.clz32?Math.clz32:NR,TR=Math.log,DR=Math.LN2;function NR(e){return e>>>=0,e===0?32:31-(TR(e)/DR|0)|0}var cl=64,fl=4194304;function Bs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=Bs(s):(i&=a,i!==0&&(r=Bs(i)))}else a=n&~o,a!==0?r=Bs(a):i!==0&&(r=Bs(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,i=t&-t,o>=i||o===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Er(t),o=1<<n,r|=e[n],t&=~o;return r}function AR(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function MR(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Er(i),s=1<<a,u=o[a];u===-1?(!(s&n)||s&r)&&(o[a]=AR(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}function Oh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function lw(){var e=cl;return cl<<=1,!(cl&4194240)&&(cl=64),e}function qd(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Bu(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Er(t),e[t]=n}function FR(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-Er(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}function gm(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Er(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var Ke=0;function cw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var fw,ym,dw,pw,hw,Th=!1,dl=[],Uo=null,zo=null,Ho=null,iu=new Map,au=new Map,Mo=[],LR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function n0(e,t){switch(e){case"focusin":case"focusout":Uo=null;break;case"dragenter":case"dragleave":zo=null;break;case"mouseover":case"mouseout":Ho=null;break;case"pointerover":case"pointerout":iu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":au.delete(t.pointerId)}}function ws(e,t,n,r,o,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},t!==null&&(t=$u(t),t!==null&&ym(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function BR(e,t,n,r,o){switch(t){case"focusin":return Uo=ws(Uo,e,t,n,r,o),!0;case"dragenter":return zo=ws(zo,e,t,n,r,o),!0;case"mouseover":return Ho=ws(Ho,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return iu.set(i,ws(iu.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,au.set(i,ws(au.get(i)||null,e,t,n,r,o)),!0}return!1}function vw(e){var t=Ei(e.target);if(t!==null){var n=qi(t);if(n!==null){if(t=n.tag,t===13){if(t=rw(n),t!==null){e.blockedOn=t,hw(e.priority,function(){dw(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ql(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Dh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);kh=r,n.target.dispatchEvent(r),kh=null}else return t=$u(n),t!==null&&ym(t),e.blockedOn=n,!1;t.shift()}return!0}function r0(e,t,n){ql(e)&&n.delete(t)}function jR(){Th=!1,Uo!==null&&ql(Uo)&&(Uo=null),zo!==null&&ql(zo)&&(zo=null),Ho!==null&&ql(Ho)&&(Ho=null),iu.forEach(r0),au.forEach(r0)}function Ss(e,t){e.blockedOn===t&&(e.blockedOn=null,Th||(Th=!0,Yn.unstable_scheduleCallback(Yn.unstable_NormalPriority,jR)))}function su(e){function t(o){return Ss(o,e)}if(0<dl.length){Ss(dl[0],e);for(var n=1;n<dl.length;n++){var r=dl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Uo!==null&&Ss(Uo,e),zo!==null&&Ss(zo,e),Ho!==null&&Ss(Ho,e),iu.forEach(t),au.forEach(t),n=0;n<Mo.length;n++)r=Mo[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Mo.length&&(n=Mo[0],n.blockedOn===null);)vw(n),n.blockedOn===null&&Mo.shift()}var Da=yo.ReactCurrentBatchConfig,mc=!0;function $R(e,t,n,r){var o=Ke,i=Da.transition;Da.transition=null;try{Ke=1,bm(e,t,n,r)}finally{Ke=o,Da.transition=i}}function VR(e,t,n,r){var o=Ke,i=Da.transition;Da.transition=null;try{Ke=4,bm(e,t,n,r)}finally{Ke=o,Da.transition=i}}function bm(e,t,n,r){if(mc){var o=Dh(e,t,n,r);if(o===null)rp(e,t,r,gc,n),n0(e,r);else if(BR(o,e,t,n,r))r.stopPropagation();else if(n0(e,r),t&4&&-1<LR.indexOf(e)){for(;o!==null;){var i=$u(o);if(i!==null&&fw(i),i=Dh(e,t,n,r),i===null&&rp(e,t,r,gc,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else rp(e,t,r,null,n)}}var gc=null;function Dh(e,t,n,r){if(gc=null,e=vm(r),e=Ei(e),e!==null)if(t=qi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=rw(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return gc=e,null}function mw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(PR()){case mm:return 1;case sw:return 4;case hc:case IR:return 16;case uw:return 536870912;default:return 16}default:return 16}}var Bo=null,xm=null,Kl=null;function gw(){if(Kl)return Kl;var e,t=xm,n=t.length,r,o="value"in Bo?Bo.value:Bo.textContent,i=o.length;for(e=0;e<n&&t[e]===o[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===o[i-r];r++);return Kl=o.slice(e,1<r?1-r:void 0)}function Xl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function pl(){return!0}function o0(){return!1}function Zn(e){function t(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?pl:o0,this.isPropagationStopped=o0,this}return pt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=pl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=pl)},persist:function(){},isPersistent:pl}),t}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wm=Zn(us),ju=pt({},us,{view:0,detail:0}),WR=Zn(ju),Kd,Xd,Cs,Ef=pt({},ju,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Cs&&(Cs&&e.type==="mousemove"?(Kd=e.screenX-Cs.screenX,Xd=e.screenY-Cs.screenY):Xd=Kd=0,Cs=e),Kd)},movementY:function(e){return"movementY"in e?e.movementY:Xd}}),i0=Zn(Ef),UR=pt({},Ef,{dataTransfer:0}),zR=Zn(UR),HR=pt({},ju,{relatedTarget:0}),Yd=Zn(HR),GR=pt({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),qR=Zn(GR),KR=pt({},us,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),XR=Zn(KR),YR=pt({},us,{data:0}),a0=Zn(YR),QR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eP(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ZR[e])?!!t[e]:!1}function Sm(){return eP}var tP=pt({},ju,{key:function(e){if(e.key){var t=QR[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Xl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?JR[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sm,charCode:function(e){return e.type==="keypress"?Xl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Xl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),nP=Zn(tP),rP=pt({},Ef,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s0=Zn(rP),oP=pt({},ju,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sm}),iP=Zn(oP),aP=pt({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),sP=Zn(aP),uP=pt({},Ef,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),lP=Zn(uP),cP=[9,13,27,32],Cm=fo&&"CompositionEvent"in window,Hs=null;fo&&"documentMode"in document&&(Hs=document.documentMode);var fP=fo&&"TextEvent"in window&&!Hs,yw=fo&&(!Cm||Hs&&8<Hs&&11>=Hs),u0=" ",l0=!1;function bw(e,t){switch(e){case"keyup":return cP.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ba=!1;function dP(e,t){switch(e){case"compositionend":return xw(t);case"keypress":return t.which!==32?null:(l0=!0,u0);case"textInput":return e=t.data,e===u0&&l0?null:e;default:return null}}function pP(e,t){if(ba)return e==="compositionend"||!Cm&&bw(e,t)?(e=gw(),Kl=xm=Bo=null,ba=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return yw&&t.locale!=="ko"?null:t.data;default:return null}}var hP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!hP[e.type]:t==="textarea"}function ww(e,t,n,r){Jx(r),t=yc(t,"onChange"),0<t.length&&(n=new wm("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gs=null,uu=null;function vP(e){Dw(e,0)}function _f(e){var t=Sa(e);if(Hx(t))return e}function mP(e,t){if(e==="change")return t}var Sw=!1;if(fo){var Qd;if(fo){var Jd="oninput"in document;if(!Jd){var f0=document.createElement("div");f0.setAttribute("oninput","return;"),Jd=typeof f0.oninput=="function"}Qd=Jd}else Qd=!1;Sw=Qd&&(!document.documentMode||9<document.documentMode)}function d0(){Gs&&(Gs.detachEvent("onpropertychange",Cw),uu=Gs=null)}function Cw(e){if(e.propertyName==="value"&&_f(uu)){var t=[];ww(t,uu,e,vm(e)),nw(vP,t)}}function gP(e,t,n){e==="focusin"?(d0(),Gs=t,uu=n,Gs.attachEvent("onpropertychange",Cw)):e==="focusout"&&d0()}function yP(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _f(uu)}function bP(e,t){if(e==="click")return _f(t)}function xP(e,t){if(e==="input"||e==="change")return _f(t)}function wP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Pr=typeof Object.is=="function"?Object.is:wP;function lu(e,t){if(Pr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!hh.call(t,o)||!Pr(e[o],t[o]))return!1}return!0}function p0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function h0(e,t){var n=p0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=p0(n)}}function Ew(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ew(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function _w(){for(var e=window,t=fc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=fc(e.document)}return t}function Em(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function SP(e){var t=_w(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ew(n.ownerDocument.documentElement,n)){if(r!==null&&Em(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=h0(n,i);var a=h0(n,r);o&&a&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var CP=fo&&"documentMode"in document&&11>=document.documentMode,xa=null,Nh=null,qs=null,Ah=!1;function v0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ah||xa==null||xa!==fc(r)||(r=xa,"selectionStart"in r&&Em(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),qs&&lu(qs,r)||(qs=r,r=yc(Nh,"onSelect"),0<r.length&&(t=new wm("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=xa)))}function hl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wa={animationend:hl("Animation","AnimationEnd"),animationiteration:hl("Animation","AnimationIteration"),animationstart:hl("Animation","AnimationStart"),transitionend:hl("Transition","TransitionEnd")},Zd={},kw={};fo&&(kw=document.createElement("div").style,"AnimationEvent"in window||(delete wa.animationend.animation,delete wa.animationiteration.animation,delete wa.animationstart.animation),"TransitionEvent"in window||delete wa.transitionend.transition);function kf(e){if(Zd[e])return Zd[e];if(!wa[e])return e;var t=wa[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in kw)return Zd[e]=t[n];return e}var Rw=kf("animationend"),Pw=kf("animationiteration"),Iw=kf("animationstart"),Ow=kf("transitionend"),Tw=new Map,m0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ci(e,t){Tw.set(e,t),Gi(t,[e])}for(var ep=0;ep<m0.length;ep++){var tp=m0[ep],EP=tp.toLowerCase(),_P=tp[0].toUpperCase()+tp.slice(1);ci(EP,"on"+_P)}ci(Rw,"onAnimationEnd");ci(Pw,"onAnimationIteration");ci(Iw,"onAnimationStart");ci("dblclick","onDoubleClick");ci("focusin","onFocus");ci("focusout","onBlur");ci(Ow,"onTransitionEnd");Ga("onMouseEnter",["mouseout","mouseover"]);Ga("onMouseLeave",["mouseout","mouseover"]);Ga("onPointerEnter",["pointerout","pointerover"]);Ga("onPointerLeave",["pointerout","pointerover"]);Gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var js="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kP=new Set("cancel close invalid load scroll toggle".split(" ").concat(js));function g0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,ER(r,t,void 0,e),e.currentTarget=null}function Dw(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;g0(o,s,l),i=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;g0(o,s,l),i=u}}}if(pc)throw e=Ih,pc=!1,Ih=null,e}function nt(e,t){var n=t[jh];n===void 0&&(n=t[jh]=new Set);var r=e+"__bubble";n.has(r)||(Nw(t,e,2,!1),n.add(r))}function np(e,t,n){var r=0;t&&(r|=4),Nw(n,e,r,t)}var vl="_reactListening"+Math.random().toString(36).slice(2);function cu(e){if(!e[vl]){e[vl]=!0,$x.forEach(function(n){n!=="selectionchange"&&(kP.has(n)||np(n,!1,e),np(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[vl]||(t[vl]=!0,np("selectionchange",!1,t))}}function Nw(e,t,n,r){switch(mw(t)){case 1:var o=$R;break;case 4:o=VR;break;default:o=bm}n=o.bind(null,t,n,e),o=void 0,!Ph||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function rp(e,t,n,r,o){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;s!==null;){if(a=Ei(s),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}s=s.parentNode}}r=r.return}nw(function(){var l=i,c=vm(n),f=[];e:{var d=Tw.get(e);if(d!==void 0){var p=wm,h=e;switch(e){case"keypress":if(Xl(n)===0)break e;case"keydown":case"keyup":p=nP;break;case"focusin":h="focus",p=Yd;break;case"focusout":h="blur",p=Yd;break;case"beforeblur":case"afterblur":p=Yd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=i0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=zR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=iP;break;case Rw:case Pw:case Iw:p=qR;break;case Ow:p=sP;break;case"scroll":p=WR;break;case"wheel":p=lP;break;case"copy":case"cut":case"paste":p=XR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=s0}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?d!==null?d+"Capture":null:d;m=[];for(var y=l,b;y!==null;){b=y;var x=b.stateNode;if(b.tag===5&&x!==null&&(b=x,v!==null&&(x=ou(y,v),x!=null&&m.push(fu(y,x,b)))),g)break;y=y.return}0<m.length&&(d=new p(d,h,null,n,c),f.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&n!==kh&&(h=n.relatedTarget||n.fromElement)&&(Ei(h)||h[po]))break e;if((p||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,p?(h=n.relatedTarget||n.toElement,p=l,h=h?Ei(h):null,h!==null&&(g=qi(h),h!==g||h.tag!==5&&h.tag!==6)&&(h=null)):(p=null,h=l),p!==h)){if(m=i0,x="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=s0,x="onPointerLeave",v="onPointerEnter",y="pointer"),g=p==null?d:Sa(p),b=h==null?d:Sa(h),d=new m(x,y+"leave",p,n,c),d.target=g,d.relatedTarget=b,x=null,Ei(c)===l&&(m=new m(v,y+"enter",h,n,c),m.target=b,m.relatedTarget=g,x=m),g=x,p&&h)t:{for(m=p,v=h,y=0,b=m;b;b=na(b))y++;for(b=0,x=v;x;x=na(x))b++;for(;0<y-b;)m=na(m),y--;for(;0<b-y;)v=na(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=na(m),v=na(v)}m=null}else m=null;p!==null&&y0(f,d,p,m,!1),h!==null&&g!==null&&y0(f,g,h,m,!0)}}e:{if(d=l?Sa(l):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var w=mP;else if(c0(d))if(Sw)w=xP;else{w=yP;var S=gP}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=bP);if(w&&(w=w(e,l))){ww(f,w,n,c);break e}S&&S(e,d,l),e==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&wh(d,"number",d.value)}switch(S=l?Sa(l):window,e){case"focusin":(c0(S)||S.contentEditable==="true")&&(xa=S,Nh=l,qs=null);break;case"focusout":qs=Nh=xa=null;break;case"mousedown":Ah=!0;break;case"contextmenu":case"mouseup":case"dragend":Ah=!1,v0(f,n,c);break;case"selectionchange":if(CP)break;case"keydown":case"keyup":v0(f,n,c)}var E;if(Cm)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else ba?bw(e,n)&&(C="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(yw&&n.locale!=="ko"&&(ba||C!=="onCompositionStart"?C==="onCompositionEnd"&&ba&&(E=gw()):(Bo=c,xm="value"in Bo?Bo.value:Bo.textContent,ba=!0)),S=yc(l,C),0<S.length&&(C=new a0(C,e,null,n,c),f.push({event:C,listeners:S}),E?C.data=E:(E=xw(n),E!==null&&(C.data=E)))),(E=fP?dP(e,n):pP(e,n))&&(l=yc(l,"onBeforeInput"),0<l.length&&(c=new a0("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:l}),c.data=E))}Dw(f,t)})}function fu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function yc(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=ou(e,n),i!=null&&r.unshift(fu(e,i,o)),i=ou(e,t),i!=null&&r.push(fu(e,i,o))),e=e.return}return r}function na(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function y0(e,t,n,r,o){for(var i=t._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,o?(u=ou(n,i),u!=null&&a.unshift(fu(n,u,s))):o||(u=ou(n,i),u!=null&&a.push(fu(n,u,s)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var RP=/\r\n?/g,PP=/\u0000|\uFFFD/g;function b0(e){return(typeof e=="string"?e:""+e).replace(RP,`
`).replace(PP,"")}function ml(e,t,n){if(t=b0(t),b0(e)!==t&&n)throw Error(re(425))}function bc(){}var Mh=null,Fh=null;function Lh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bh=typeof setTimeout=="function"?setTimeout:void 0,IP=typeof clearTimeout=="function"?clearTimeout:void 0,x0=typeof Promise=="function"?Promise:void 0,OP=typeof queueMicrotask=="function"?queueMicrotask:typeof x0<"u"?function(e){return x0.resolve(null).then(e).catch(TP)}:Bh;function TP(e){setTimeout(function(){throw e})}function op(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),su(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);su(t)}function Go(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function w0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ls=Math.random().toString(36).slice(2),Vr="__reactFiber$"+ls,du="__reactProps$"+ls,po="__reactContainer$"+ls,jh="__reactEvents$"+ls,DP="__reactListeners$"+ls,NP="__reactHandles$"+ls;function Ei(e){var t=e[Vr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[po]||n[Vr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=w0(e);e!==null;){if(n=e[Vr])return n;e=w0(e)}return t}e=n,n=e.parentNode}return null}function $u(e){return e=e[Vr]||e[po],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Sa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(re(33))}function Rf(e){return e[du]||null}var $h=[],Ca=-1;function fi(e){return{current:e}}function ot(e){0>Ca||(e.current=$h[Ca],$h[Ca]=null,Ca--)}function Je(e,t){Ca++,$h[Ca]=e.current,e.current=t}var ii={},pn=fi(ii),Rn=fi(!1),Mi=ii;function qa(e,t){var n=e.type.contextTypes;if(!n)return ii;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Pn(e){return e=e.childContextTypes,e!=null}function xc(){ot(Rn),ot(pn)}function S0(e,t,n){if(pn.current!==ii)throw Error(re(168));Je(pn,t),Je(Rn,n)}function Aw(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(re(108,gR(e)||"Unknown",o));return pt({},n,r)}function wc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ii,Mi=pn.current,Je(pn,e),Je(Rn,Rn.current),!0}function C0(e,t,n){var r=e.stateNode;if(!r)throw Error(re(169));n?(e=Aw(e,t,Mi),r.__reactInternalMemoizedMergedChildContext=e,ot(Rn),ot(pn),Je(pn,e)):ot(Rn),Je(Rn,n)}var io=null,Pf=!1,ip=!1;function Mw(e){io===null?io=[e]:io.push(e)}function AP(e){Pf=!0,Mw(e)}function di(){if(!ip&&io!==null){ip=!0;var e=0,t=Ke;try{var n=io;for(Ke=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}io=null,Pf=!1}catch(o){throw io!==null&&(io=io.slice(e+1)),aw(mm,di),o}finally{Ke=t,ip=!1}}return null}var Ea=[],_a=0,Sc=null,Cc=0,tr=[],nr=0,Fi=null,so=1,uo="";function yi(e,t){Ea[_a++]=Cc,Ea[_a++]=Sc,Sc=e,Cc=t}function Fw(e,t,n){tr[nr++]=so,tr[nr++]=uo,tr[nr++]=Fi,Fi=e;var r=so;e=uo;var o=32-Er(r)-1;r&=~(1<<o),n+=1;var i=32-Er(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,so=1<<32-Er(t)+o|n<<o|r,uo=i+e}else so=1<<i|n<<o|r,uo=e}function _m(e){e.return!==null&&(yi(e,1),Fw(e,1,0))}function km(e){for(;e===Sc;)Sc=Ea[--_a],Ea[_a]=null,Cc=Ea[--_a],Ea[_a]=null;for(;e===Fi;)Fi=tr[--nr],tr[nr]=null,uo=tr[--nr],tr[nr]=null,so=tr[--nr],tr[nr]=null}var qn=null,Un=null,at=!1,xr=null;function Lw(e,t){var n=ir(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function E0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,qn=e,Un=Go(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,qn=e,Un=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Fi!==null?{id:so,overflow:uo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=ir(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,qn=e,Un=null,!0):!1;default:return!1}}function Vh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Wh(e){if(at){var t=Un;if(t){var n=t;if(!E0(e,t)){if(Vh(e))throw Error(re(418));t=Go(n.nextSibling);var r=qn;t&&E0(e,t)?Lw(r,n):(e.flags=e.flags&-4097|2,at=!1,qn=e)}}else{if(Vh(e))throw Error(re(418));e.flags=e.flags&-4097|2,at=!1,qn=e}}}function _0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qn=e}function gl(e){if(e!==qn)return!1;if(!at)return _0(e),at=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Lh(e.type,e.memoizedProps)),t&&(t=Un)){if(Vh(e))throw Bw(),Error(re(418));for(;t;)Lw(e,t),t=Go(t.nextSibling)}if(_0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Un=Go(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Un=null}}else Un=qn?Go(e.stateNode.nextSibling):null;return!0}function Bw(){for(var e=Un;e;)e=Go(e.nextSibling)}function Ka(){Un=qn=null,at=!1}function Rm(e){xr===null?xr=[e]:xr.push(e)}var MP=yo.ReactCurrentBatchConfig;function Es(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var r=n.stateNode}if(!r)throw Error(re(147,e));var o=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,e))}return e}function yl(e,t){throw e=Object.prototype.toString.call(t),Error(re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function k0(e){var t=e._init;return t(e._payload)}function jw(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function n(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function o(v,y){return v=Yo(v,y),v.index=0,v.sibling=null,v}function i(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function s(v,y,b,x){return y===null||y.tag!==6?(y=dp(b,v.mode,x),y.return=v,y):(y=o(y,b),y.return=v,y)}function u(v,y,b,x){var w=b.type;return w===ya?c(v,y,b.props.children,x,b.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Do&&k0(w)===y.type)?(x=o(y,b.props),x.ref=Es(v,y,b),x.return=v,x):(x=nc(b.type,b.key,b.props,null,v.mode,x),x.ref=Es(v,y,b),x.return=v,x)}function l(v,y,b,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=pp(b,v.mode,x),y.return=v,y):(y=o(y,b.children||[]),y.return=v,y)}function c(v,y,b,x,w){return y===null||y.tag!==7?(y=Oi(b,v.mode,x,w),y.return=v,y):(y=o(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=dp(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case sl:return b=nc(y.type,y.key,y.props,null,v.mode,b),b.ref=Es(v,null,y),b.return=v,b;case ga:return y=pp(y,v.mode,b),y.return=v,y;case Do:var x=y._init;return f(v,x(y._payload),b)}if(Ls(y)||bs(y))return y=Oi(y,v.mode,b,null),y.return=v,y;yl(v,y)}return null}function d(v,y,b,x){var w=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return w!==null?null:s(v,y,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case sl:return b.key===w?u(v,y,b,x):null;case ga:return b.key===w?l(v,y,b,x):null;case Do:return w=b._init,d(v,y,w(b._payload),x)}if(Ls(b)||bs(b))return w!==null?null:c(v,y,b,x,null);yl(v,b)}return null}function p(v,y,b,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return v=v.get(b)||null,s(y,v,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case sl:return v=v.get(x.key===null?b:x.key)||null,u(y,v,x,w);case ga:return v=v.get(x.key===null?b:x.key)||null,l(y,v,x,w);case Do:var S=x._init;return p(v,y,b,S(x._payload),w)}if(Ls(x)||bs(x))return v=v.get(b)||null,c(y,v,x,w,null);yl(y,x)}return null}function h(v,y,b,x){for(var w=null,S=null,E=y,C=y=0,k=null;E!==null&&C<b.length;C++){E.index>C?(k=E,E=null):k=E.sibling;var _=d(v,E,b[C],x);if(_===null){E===null&&(E=k);break}e&&E&&_.alternate===null&&t(v,E),y=i(_,y,C),S===null?w=_:S.sibling=_,S=_,E=k}if(C===b.length)return n(v,E),at&&yi(v,C),w;if(E===null){for(;C<b.length;C++)E=f(v,b[C],x),E!==null&&(y=i(E,y,C),S===null?w=E:S.sibling=E,S=E);return at&&yi(v,C),w}for(E=r(v,E);C<b.length;C++)k=p(E,v,C,b[C],x),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?C:k.key),y=i(k,y,C),S===null?w=k:S.sibling=k,S=k);return e&&E.forEach(function(T){return t(v,T)}),at&&yi(v,C),w}function m(v,y,b,x){var w=bs(b);if(typeof w!="function")throw Error(re(150));if(b=w.call(b),b==null)throw Error(re(151));for(var S=w=null,E=y,C=y=0,k=null,_=b.next();E!==null&&!_.done;C++,_=b.next()){E.index>C?(k=E,E=null):k=E.sibling;var T=d(v,E,_.value,x);if(T===null){E===null&&(E=k);break}e&&E&&T.alternate===null&&t(v,E),y=i(T,y,C),S===null?w=T:S.sibling=T,S=T,E=k}if(_.done)return n(v,E),at&&yi(v,C),w;if(E===null){for(;!_.done;C++,_=b.next())_=f(v,_.value,x),_!==null&&(y=i(_,y,C),S===null?w=_:S.sibling=_,S=_);return at&&yi(v,C),w}for(E=r(v,E);!_.done;C++,_=b.next())_=p(E,v,C,_.value,x),_!==null&&(e&&_.alternate!==null&&E.delete(_.key===null?C:_.key),y=i(_,y,C),S===null?w=_:S.sibling=_,S=_);return e&&E.forEach(function(D){return t(v,D)}),at&&yi(v,C),w}function g(v,y,b,x){if(typeof b=="object"&&b!==null&&b.type===ya&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case sl:e:{for(var w=b.key,S=y;S!==null;){if(S.key===w){if(w=b.type,w===ya){if(S.tag===7){n(v,S.sibling),y=o(S,b.props.children),y.return=v,v=y;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Do&&k0(w)===S.type){n(v,S.sibling),y=o(S,b.props),y.ref=Es(v,S,b),y.return=v,v=y;break e}n(v,S);break}else t(v,S);S=S.sibling}b.type===ya?(y=Oi(b.props.children,v.mode,x,b.key),y.return=v,v=y):(x=nc(b.type,b.key,b.props,null,v.mode,x),x.ref=Es(v,y,b),x.return=v,v=x)}return a(v);case ga:e:{for(S=b.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(v,y.sibling),y=o(y,b.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else t(v,y);y=y.sibling}y=pp(b,v.mode,x),y.return=v,v=y}return a(v);case Do:return S=b._init,g(v,y,S(b._payload),x)}if(Ls(b))return h(v,y,b,x);if(bs(b))return m(v,y,b,x);yl(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(v,y.sibling),y=o(y,b),y.return=v,v=y):(n(v,y),y=dp(b,v.mode,x),y.return=v,v=y),a(v)):n(v,y)}return g}var Xa=jw(!0),$w=jw(!1),Ec=fi(null),_c=null,ka=null,Pm=null;function Im(){Pm=ka=_c=null}function Om(e){var t=Ec.current;ot(Ec),e._currentValue=t}function Uh(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Na(e,t){_c=e,Pm=ka=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(kn=!0),e.firstContext=null)}function lr(e){var t=e._currentValue;if(Pm!==e)if(e={context:e,memoizedValue:t,next:null},ka===null){if(_c===null)throw Error(re(308));ka=e,_c.dependencies={lanes:0,firstContext:e}}else ka=ka.next=e;return t}var _i=null;function Tm(e){_i===null?_i=[e]:_i.push(e)}function Vw(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,Tm(t)):(n.next=o.next,o.next=n),t.interleaved=n,ho(e,r)}function ho(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var No=!1;function Dm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ww(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function lo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qo(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,We&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,ho(e,n)}return o=r.interleaved,o===null?(t.next=t,Tm(r)):(t.next=o.next,o.next=t),r.interleaved=t,ho(e,n)}function Yl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,gm(e,n)}}function R0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=t:i=i.next=t}else o=i=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function kc(e,t,n,r){var o=e.updateQueue;No=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?i=l:a.next=l,a=u;var c=e.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(i!==null){var f=o.baseState;a=0,c=l=u=null,s=i;do{var d=s.lane,p=s.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,m=s;switch(d=t,p=n,m.tag){case 1:if(h=m.payload,typeof h=="function"){f=h.call(p,f,d);break e}f=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=m.payload,d=typeof h=="function"?h.call(p,f,d):h,d==null)break e;f=pt({},f,d);break e;case 2:No=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,d=o.effects,d===null?o.effects=[s]:d.push(s))}else p={eventTime:p,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=p,u=f):c=c.next=p,a|=d;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;d=s,s=d.next,d.next=null,o.lastBaseUpdate=d,o.shared.pending=null}}while(!0);if(c===null&&(u=f),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=c,t=o.shared.interleaved,t!==null){o=t;do a|=o.lane,o=o.next;while(o!==t)}else i===null&&(o.shared.lanes=0);Bi|=a,e.lanes=a,e.memoizedState=f}}function P0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(re(191,o));o.call(r)}}}var Vu={},Gr=fi(Vu),pu=fi(Vu),hu=fi(Vu);function ki(e){if(e===Vu)throw Error(re(174));return e}function Nm(e,t){switch(Je(hu,t),Je(pu,e),Je(Gr,Vu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ch(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ch(t,e)}ot(Gr),Je(Gr,t)}function Ya(){ot(Gr),ot(pu),ot(hu)}function Uw(e){ki(hu.current);var t=ki(Gr.current),n=Ch(t,e.type);t!==n&&(Je(pu,e),Je(Gr,n))}function Am(e){pu.current===e&&(ot(Gr),ot(pu))}var lt=fi(0);function Rc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ap=[];function Mm(){for(var e=0;e<ap.length;e++)ap[e]._workInProgressVersionPrimary=null;ap.length=0}var Ql=yo.ReactCurrentDispatcher,sp=yo.ReactCurrentBatchConfig,Li=0,dt=null,It=null,Bt=null,Pc=!1,Ks=!1,vu=0,FP=0;function tn(){throw Error(re(321))}function Fm(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Pr(e[n],t[n]))return!1;return!0}function Lm(e,t,n,r,o,i){if(Li=i,dt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ql.current=e===null||e.memoizedState===null?$P:VP,e=n(r,o),Ks){i=0;do{if(Ks=!1,vu=0,25<=i)throw Error(re(301));i+=1,Bt=It=null,t.updateQueue=null,Ql.current=WP,e=n(r,o)}while(Ks)}if(Ql.current=Ic,t=It!==null&&It.next!==null,Li=0,Bt=It=dt=null,Pc=!1,t)throw Error(re(300));return e}function Bm(){var e=vu!==0;return vu=0,e}function Fr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?dt.memoizedState=Bt=e:Bt=Bt.next=e,Bt}function cr(){if(It===null){var e=dt.alternate;e=e!==null?e.memoizedState:null}else e=It.next;var t=Bt===null?dt.memoizedState:Bt.next;if(t!==null)Bt=t,It=e;else{if(e===null)throw Error(re(310));It=e,e={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},Bt===null?dt.memoizedState=Bt=e:Bt=Bt.next=e}return Bt}function mu(e,t){return typeof t=="function"?t(e):t}function up(e){var t=cr(),n=t.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=e;var r=It,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,u=null,l=i;do{var c=l.lane;if((Li&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=f,a=r):u=u.next=f,dt.lanes|=c,Bi|=c}l=l.next}while(l!==null&&l!==i);u===null?a=r:u.next=s,Pr(r,t.memoizedState)||(kn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do i=o.lane,dt.lanes|=i,Bi|=i,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function lp(e){var t=cr(),n=t.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=e(i,a.action),a=a.next;while(a!==o);Pr(i,t.memoizedState)||(kn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function zw(){}function Hw(e,t){var n=dt,r=cr(),o=t(),i=!Pr(r.memoizedState,o);if(i&&(r.memoizedState=o,kn=!0),r=r.queue,jm(Kw.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Bt!==null&&Bt.memoizedState.tag&1){if(n.flags|=2048,gu(9,qw.bind(null,n,r,o,t),void 0,null),jt===null)throw Error(re(349));Li&30||Gw(n,t,o)}return o}function Gw(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function qw(e,t,n,r){t.value=n,t.getSnapshot=r,Xw(t)&&Yw(e)}function Kw(e,t,n){return n(function(){Xw(t)&&Yw(e)})}function Xw(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Pr(e,n)}catch{return!0}}function Yw(e){var t=ho(e,1);t!==null&&_r(t,e,1,-1)}function I0(e){var t=Fr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mu,lastRenderedState:e},t.queue=e,e=e.dispatch=jP.bind(null,dt,e),[t.memoizedState,e]}function gu(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Qw(){return cr().memoizedState}function Jl(e,t,n,r){var o=Fr();dt.flags|=e,o.memoizedState=gu(1|t,n,void 0,r===void 0?null:r)}function If(e,t,n,r){var o=cr();r=r===void 0?null:r;var i=void 0;if(It!==null){var a=It.memoizedState;if(i=a.destroy,r!==null&&Fm(r,a.deps)){o.memoizedState=gu(t,n,i,r);return}}dt.flags|=e,o.memoizedState=gu(1|t,n,i,r)}function O0(e,t){return Jl(8390656,8,e,t)}function jm(e,t){return If(2048,8,e,t)}function Jw(e,t){return If(4,2,e,t)}function Zw(e,t){return If(4,4,e,t)}function e2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function t2(e,t,n){return n=n!=null?n.concat([e]):null,If(4,4,e2.bind(null,t,e),n)}function $m(){}function n2(e,t){var n=cr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fm(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function r2(e,t){var n=cr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fm(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function o2(e,t,n){return Li&21?(Pr(n,t)||(n=lw(),dt.lanes|=n,Bi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,kn=!0),e.memoizedState=n)}function LP(e,t){var n=Ke;Ke=n!==0&&4>n?n:4,e(!0);var r=sp.transition;sp.transition={};try{e(!1),t()}finally{Ke=n,sp.transition=r}}function i2(){return cr().memoizedState}function BP(e,t,n){var r=Xo(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},a2(e))s2(t,n);else if(n=Vw(e,t,n,r),n!==null){var o=bn();_r(n,e,r,o),u2(n,t,r)}}function jP(e,t,n){var r=Xo(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(a2(e))s2(t,o);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,Pr(s,a)){var u=t.interleaved;u===null?(o.next=o,Tm(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=Vw(e,t,o,r),n!==null&&(o=bn(),_r(n,e,r,o),u2(n,t,r))}}function a2(e){var t=e.alternate;return e===dt||t!==null&&t===dt}function s2(e,t){Ks=Pc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function u2(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,gm(e,n)}}var Ic={readContext:lr,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},$P={readContext:lr,useCallback:function(e,t){return Fr().memoizedState=[e,t===void 0?null:t],e},useContext:lr,useEffect:O0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Jl(4194308,4,e2.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Jl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Jl(4,2,e,t)},useMemo:function(e,t){var n=Fr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Fr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=BP.bind(null,dt,e),[r.memoizedState,e]},useRef:function(e){var t=Fr();return e={current:e},t.memoizedState=e},useState:I0,useDebugValue:$m,useDeferredValue:function(e){return Fr().memoizedState=e},useTransition:function(){var e=I0(!1),t=e[0];return e=LP.bind(null,e[1]),Fr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=dt,o=Fr();if(at){if(n===void 0)throw Error(re(407));n=n()}else{if(n=t(),jt===null)throw Error(re(349));Li&30||Gw(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,O0(Kw.bind(null,r,i,e),[e]),r.flags|=2048,gu(9,qw.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Fr(),t=jt.identifierPrefix;if(at){var n=uo,r=so;n=(r&~(1<<32-Er(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=vu++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=FP++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},VP={readContext:lr,useCallback:n2,useContext:lr,useEffect:jm,useImperativeHandle:t2,useInsertionEffect:Jw,useLayoutEffect:Zw,useMemo:r2,useReducer:up,useRef:Qw,useState:function(){return up(mu)},useDebugValue:$m,useDeferredValue:function(e){var t=cr();return o2(t,It.memoizedState,e)},useTransition:function(){var e=up(mu)[0],t=cr().memoizedState;return[e,t]},useMutableSource:zw,useSyncExternalStore:Hw,useId:i2,unstable_isNewReconciler:!1},WP={readContext:lr,useCallback:n2,useContext:lr,useEffect:jm,useImperativeHandle:t2,useInsertionEffect:Jw,useLayoutEffect:Zw,useMemo:r2,useReducer:lp,useRef:Qw,useState:function(){return lp(mu)},useDebugValue:$m,useDeferredValue:function(e){var t=cr();return It===null?t.memoizedState=e:o2(t,It.memoizedState,e)},useTransition:function(){var e=lp(mu)[0],t=cr().memoizedState;return[e,t]},useMutableSource:zw,useSyncExternalStore:Hw,useId:i2,unstable_isNewReconciler:!1};function yr(e,t){if(e&&e.defaultProps){t=pt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function zh(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:pt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Of={isMounted:function(e){return(e=e._reactInternals)?qi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=bn(),o=Xo(e),i=lo(r,o);i.payload=t,n!=null&&(i.callback=n),t=qo(e,i,o),t!==null&&(_r(t,e,o,r),Yl(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=bn(),o=Xo(e),i=lo(r,o);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=qo(e,i,o),t!==null&&(_r(t,e,o,r),Yl(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=bn(),r=Xo(e),o=lo(n,r);o.tag=2,t!=null&&(o.callback=t),t=qo(e,o,r),t!==null&&(_r(t,e,r,n),Yl(t,e,r))}};function T0(e,t,n,r,o,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!lu(n,r)||!lu(o,i):!0}function l2(e,t,n){var r=!1,o=ii,i=t.contextType;return typeof i=="object"&&i!==null?i=lr(i):(o=Pn(t)?Mi:pn.current,r=t.contextTypes,i=(r=r!=null)?qa(e,o):ii),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Of,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function D0(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Of.enqueueReplaceState(t,t.state,null)}function Hh(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Dm(e);var i=t.contextType;typeof i=="object"&&i!==null?o.context=lr(i):(i=Pn(t)?Mi:pn.current,o.context=qa(e,i)),o.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(zh(e,t,i,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Of.enqueueReplaceState(o,o.state,null),kc(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Qa(e,t){try{var n="",r=t;do n+=mR(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:o,digest:null}}function cp(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Gh(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var UP=typeof WeakMap=="function"?WeakMap:Map;function c2(e,t,n){n=lo(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Tc||(Tc=!0,nv=r),Gh(e,t)},n}function f2(e,t,n){n=lo(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){Gh(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Gh(e,t),typeof r!="function"&&(Ko===null?Ko=new Set([this]):Ko.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function N0(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new UP;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=rI.bind(null,e,t,n),t.then(e,e))}function A0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function M0(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=lo(-1,1),t.tag=2,qo(n,t,1))),n.lanes|=1),e)}var zP=yo.ReactCurrentOwner,kn=!1;function yn(e,t,n,r){t.child=e===null?$w(t,null,n,r):Xa(t,e.child,n,r)}function F0(e,t,n,r,o){n=n.render;var i=t.ref;return Na(t,o),r=Lm(e,t,n,r,i,o),n=Bm(),e!==null&&!kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,vo(e,t,o)):(at&&n&&_m(t),t.flags|=1,yn(e,t,r,o),t.child)}function L0(e,t,n,r,o){if(e===null){var i=n.type;return typeof i=="function"&&!Km(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,d2(e,t,i,r,o)):(e=nc(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:lu,n(a,r)&&e.ref===t.ref)return vo(e,t,o)}return t.flags|=1,e=Yo(i,r),e.ref=t.ref,e.return=t,t.child=e}function d2(e,t,n,r,o){if(e!==null){var i=e.memoizedProps;if(lu(i,r)&&e.ref===t.ref)if(kn=!1,t.pendingProps=r=i,(e.lanes&o)!==0)e.flags&131072&&(kn=!0);else return t.lanes=e.lanes,vo(e,t,o)}return qh(e,t,n,r,o)}function p2(e,t,n){var r=t.pendingProps,o=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(Pa,$n),$n|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Je(Pa,$n),$n|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Je(Pa,$n),$n|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Je(Pa,$n),$n|=r;return yn(e,t,o,n),t.child}function h2(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function qh(e,t,n,r,o){var i=Pn(n)?Mi:pn.current;return i=qa(t,i),Na(t,o),n=Lm(e,t,n,r,i,o),r=Bm(),e!==null&&!kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,vo(e,t,o)):(at&&r&&_m(t),t.flags|=1,yn(e,t,n,o),t.child)}function B0(e,t,n,r,o){if(Pn(n)){var i=!0;wc(t)}else i=!1;if(Na(t,o),t.stateNode===null)Zl(e,t),l2(t,n,r),Hh(t,n,r,o),r=!0;else if(e===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;typeof l=="object"&&l!==null?l=lr(l):(l=Pn(n)?Mi:pn.current,l=qa(t,l));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&D0(t,a,r,l),No=!1;var d=t.memoizedState;a.state=d,kc(t,r,a,o),u=t.memoizedState,s!==r||d!==u||Rn.current||No?(typeof c=="function"&&(zh(t,n,c,r),u=t.memoizedState),(s=No||T0(t,n,s,r,d,u,l))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ww(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:yr(t.type,s),a.props=l,f=t.pendingProps,d=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=lr(u):(u=Pn(n)?Mi:pn.current,u=qa(t,u));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==f||d!==u)&&D0(t,a,r,u),No=!1,d=t.memoizedState,a.state=d,kc(t,r,a,o);var h=t.memoizedState;s!==f||d!==h||Rn.current||No?(typeof p=="function"&&(zh(t,n,p,r),h=t.memoizedState),(l=No||T0(t,n,l,r,d,h,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,h,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,h,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),a.props=r,a.state=h,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Kh(e,t,n,r,i,o)}function Kh(e,t,n,r,o,i){h2(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return o&&C0(t,n,!1),vo(e,t,i);r=t.stateNode,zP.current=t;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Xa(t,e.child,null,i),t.child=Xa(t,null,s,i)):yn(e,t,s,i),t.memoizedState=r.state,o&&C0(t,n,!0),t.child}function v2(e){var t=e.stateNode;t.pendingContext?S0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&S0(e,t.context,!1),Nm(e,t.containerInfo)}function j0(e,t,n,r,o){return Ka(),Rm(o),t.flags|=256,yn(e,t,n,r),t.child}var Xh={dehydrated:null,treeContext:null,retryLane:0};function Yh(e){return{baseLanes:e,cachePool:null,transitions:null}}function m2(e,t,n){var r=t.pendingProps,o=lt.current,i=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(o&2)!==0),s?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Je(lt,o&1),e===null)return Wh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Nf(a,r,0,null),e=Oi(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Yh(n),t.memoizedState=Xh,e):Vm(t,a));if(o=e.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return HP(e,t,a,r,s,o,n);if(i){i=r.fallback,a=t.mode,o=e.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Yo(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=Yo(s,i):(i=Oi(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?Yh(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Xh,r}return i=e.child,e=i.sibling,r=Yo(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Vm(e,t){return t=Nf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function bl(e,t,n,r){return r!==null&&Rm(r),Xa(t,e.child,null,n),e=Vm(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function HP(e,t,n,r,o,i,a){if(n)return t.flags&256?(t.flags&=-257,r=cp(Error(re(422))),bl(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=Nf({mode:"visible",children:r.children},o,0,null),i=Oi(i,o,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Xa(t,e.child,null,a),t.child.memoizedState=Yh(a),t.memoizedState=Xh,i);if(!(t.mode&1))return bl(e,t,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(re(419)),r=cp(i,r,void 0),bl(e,t,a,r)}if(s=(a&e.childLanes)!==0,kn||s){if(r=jt,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,ho(e,o),_r(r,e,o,-1))}return qm(),r=cp(Error(re(421))),bl(e,t,a,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=oI.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,Un=Go(o.nextSibling),qn=t,at=!0,xr=null,e!==null&&(tr[nr++]=so,tr[nr++]=uo,tr[nr++]=Fi,so=e.id,uo=e.overflow,Fi=t),t=Vm(t,r.children),t.flags|=4096,t)}function $0(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Uh(e.return,t,n)}function fp(e,t,n,r,o){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function g2(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(yn(e,t,r.children,n),r=lt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$0(e,n,t);else if(e.tag===19)$0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Je(lt,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&Rc(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),fp(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&Rc(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}fp(t,!0,n,null,i);break;case"together":fp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Zl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function vo(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Bi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(re(153));if(t.child!==null){for(e=t.child,n=Yo(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Yo(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function GP(e,t,n){switch(t.tag){case 3:v2(t),Ka();break;case 5:Uw(t);break;case 1:Pn(t.type)&&wc(t);break;case 4:Nm(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Je(Ec,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Je(lt,lt.current&1),t.flags|=128,null):n&t.child.childLanes?m2(e,t,n):(Je(lt,lt.current&1),e=vo(e,t,n),e!==null?e.sibling:null);Je(lt,lt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return g2(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Je(lt,lt.current),r)break;return null;case 22:case 23:return t.lanes=0,p2(e,t,n)}return vo(e,t,n)}var y2,Qh,b2,x2;y2=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Qh=function(){};b2=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,ki(Gr.current);var i=null;switch(n){case"input":o=bh(e,o),r=bh(e,r),i=[];break;case"select":o=pt({},o,{value:void 0}),r=pt({},r,{value:void 0}),i=[];break;case"textarea":o=Sh(e,o),r=Sh(e,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=bc)}Eh(n,r);var a;n=null;for(l in o)if(!r.hasOwnProperty(l)&&o.hasOwnProperty(l)&&o[l]!=null)if(l==="style"){var s=o[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(nu.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var u=r[l];if(s=o!=null?o[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(i=i||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(nu.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&nt("scroll",e),i||s===u||(i=[])):(i=i||[]).push(l,u))}n&&(i=i||[]).push("style",n);var l=i;(t.updateQueue=l)&&(t.flags|=4)}};x2=function(e,t,n,r){n!==r&&(t.flags|=4)};function _s(e,t){if(!at)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function qP(e,t,n){var r=t.pendingProps;switch(km(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(t),null;case 1:return Pn(t.type)&&xc(),nn(t),null;case 3:return r=t.stateNode,Ya(),ot(Rn),ot(pn),Mm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(gl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,xr!==null&&(iv(xr),xr=null))),Qh(e,t),nn(t),null;case 5:Am(t);var o=ki(hu.current);if(n=t.type,e!==null&&t.stateNode!=null)b2(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(re(166));return nn(t),null}if(e=ki(Gr.current),gl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Vr]=t,r[du]=i,e=(t.mode&1)!==0,n){case"dialog":nt("cancel",r),nt("close",r);break;case"iframe":case"object":case"embed":nt("load",r);break;case"video":case"audio":for(o=0;o<js.length;o++)nt(js[o],r);break;case"source":nt("error",r);break;case"img":case"image":case"link":nt("error",r),nt("load",r);break;case"details":nt("toggle",r);break;case"input":Xy(r,i),nt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},nt("invalid",r);break;case"textarea":Qy(r,i),nt("invalid",r)}Eh(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&ml(r.textContent,s,e),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&ml(r.textContent,s,e),o=["children",""+s]):nu.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&nt("scroll",r)}switch(n){case"input":ul(r),Yy(r,i,!0);break;case"textarea":ul(r),Jy(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=bc)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Kx(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Vr]=t,e[du]=r,y2(e,t,!1,!1),t.stateNode=e;e:{switch(a=_h(n,r),n){case"dialog":nt("cancel",e),nt("close",e),o=r;break;case"iframe":case"object":case"embed":nt("load",e),o=r;break;case"video":case"audio":for(o=0;o<js.length;o++)nt(js[o],e);o=r;break;case"source":nt("error",e),o=r;break;case"img":case"image":case"link":nt("error",e),nt("load",e),o=r;break;case"details":nt("toggle",e),o=r;break;case"input":Xy(e,r),o=bh(e,r),nt("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=pt({},r,{value:void 0}),nt("invalid",e);break;case"textarea":Qy(e,r),o=Sh(e,r),nt("invalid",e);break;default:o=r}Eh(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];i==="style"?Qx(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Xx(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ru(e,u):typeof u=="number"&&ru(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(nu.hasOwnProperty(i)?u!=null&&i==="onScroll"&&nt("scroll",e):u!=null&&fm(e,i,u,a))}switch(n){case"input":ul(e),Yy(e,r,!1);break;case"textarea":ul(e),Jy(e);break;case"option":r.value!=null&&e.setAttribute("value",""+oi(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ia(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ia(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=bc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return nn(t),null;case 6:if(e&&t.stateNode!=null)x2(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(re(166));if(n=ki(hu.current),ki(Gr.current),gl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Vr]=t,(i=r.nodeValue!==n)&&(e=qn,e!==null))switch(e.tag){case 3:ml(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ml(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vr]=t,t.stateNode=r}return nn(t),null;case 13:if(ot(lt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(at&&Un!==null&&t.mode&1&&!(t.flags&128))Bw(),Ka(),t.flags|=98560,i=!1;else if(i=gl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(re(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(re(317));i[Vr]=t}else Ka(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;nn(t),i=!1}else xr!==null&&(iv(xr),xr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||lt.current&1?Ot===0&&(Ot=3):qm())),t.updateQueue!==null&&(t.flags|=4),nn(t),null);case 4:return Ya(),Qh(e,t),e===null&&cu(t.stateNode.containerInfo),nn(t),null;case 10:return Om(t.type._context),nn(t),null;case 17:return Pn(t.type)&&xc(),nn(t),null;case 19:if(ot(lt),i=t.memoizedState,i===null)return nn(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)_s(i,!1);else{if(Ot!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Rc(e),a!==null){for(t.flags|=128,_s(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Je(lt,lt.current&1|2),t.child}e=e.sibling}i.tail!==null&&xt()>Ja&&(t.flags|=128,r=!0,_s(i,!1),t.lanes=4194304)}else{if(!r)if(e=Rc(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),_s(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!at)return nn(t),null}else 2*xt()-i.renderingStartTime>Ja&&n!==1073741824&&(t.flags|=128,r=!0,_s(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=xt(),t.sibling=null,n=lt.current,Je(lt,r?n&1|2:n&1),t):(nn(t),null);case 22:case 23:return Gm(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?$n&1073741824&&(nn(t),t.subtreeFlags&6&&(t.flags|=8192)):nn(t),null;case 24:return null;case 25:return null}throw Error(re(156,t.tag))}function KP(e,t){switch(km(t),t.tag){case 1:return Pn(t.type)&&xc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ya(),ot(Rn),ot(pn),Mm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Am(t),null;case 13:if(ot(lt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(re(340));Ka()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ot(lt),null;case 4:return Ya(),null;case 10:return Om(t.type._context),null;case 22:case 23:return Gm(),null;case 24:return null;default:return null}}var xl=!1,un=!1,XP=typeof WeakSet=="function"?WeakSet:Set,le=null;function Ra(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){mt(e,t,r)}else n.current=null}function Jh(e,t,n){try{n()}catch(r){mt(e,t,r)}}var V0=!1;function YP(e,t){if(Mh=mc,e=_w(),Em(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,l=0,c=0,f=e,d=null;t:for(;;){for(var p;f!==n||o!==0&&f.nodeType!==3||(s=a+o),f!==i||r!==0&&f.nodeType!==3||(u=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(p=f.firstChild)!==null;)d=f,f=p;for(;;){if(f===e)break t;if(d===n&&++l===o&&(s=a),d===i&&++c===r&&(u=a),(p=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=p}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fh={focusedElem:e,selectionRange:n},mc=!1,le=t;le!==null;)if(t=le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,le=e;else for(;le!==null;){t=le;try{var h=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var m=h.memoizedProps,g=h.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:yr(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(x){mt(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,le=e;break}le=t.return}return h=V0,V0=!1,h}function Xs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,i!==void 0&&Jh(t,n,i)}o=o.next}while(o!==r)}}function Tf(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Zh(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function w2(e){var t=e.alternate;t!==null&&(e.alternate=null,w2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vr],delete t[du],delete t[jh],delete t[DP],delete t[NP])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function S2(e){return e.tag===5||e.tag===3||e.tag===4}function W0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||S2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ev(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=bc));else if(r!==4&&(e=e.child,e!==null))for(ev(e,t,n),e=e.sibling;e!==null;)ev(e,t,n),e=e.sibling}function tv(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(tv(e,t,n),e=e.sibling;e!==null;)tv(e,t,n),e=e.sibling}var Gt=null,br=!1;function Ro(e,t,n){for(n=n.child;n!==null;)C2(e,t,n),n=n.sibling}function C2(e,t,n){if(Hr&&typeof Hr.onCommitFiberUnmount=="function")try{Hr.onCommitFiberUnmount(Cf,n)}catch{}switch(n.tag){case 5:un||Ra(n,t);case 6:var r=Gt,o=br;Gt=null,Ro(e,t,n),Gt=r,br=o,Gt!==null&&(br?(e=Gt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Gt.removeChild(n.stateNode));break;case 18:Gt!==null&&(br?(e=Gt,n=n.stateNode,e.nodeType===8?op(e.parentNode,n):e.nodeType===1&&op(e,n),su(e)):op(Gt,n.stateNode));break;case 4:r=Gt,o=br,Gt=n.stateNode.containerInfo,br=!0,Ro(e,t,n),Gt=r,br=o;break;case 0:case 11:case 14:case 15:if(!un&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Jh(n,t,a),o=o.next}while(o!==r)}Ro(e,t,n);break;case 1:if(!un&&(Ra(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){mt(n,t,s)}Ro(e,t,n);break;case 21:Ro(e,t,n);break;case 22:n.mode&1?(un=(r=un)||n.memoizedState!==null,Ro(e,t,n),un=r):Ro(e,t,n);break;default:Ro(e,t,n)}}function U0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new XP),t.forEach(function(r){var o=iI.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function gr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:Gt=s.stateNode,br=!1;break e;case 3:Gt=s.stateNode.containerInfo,br=!0;break e;case 4:Gt=s.stateNode.containerInfo,br=!0;break e}s=s.return}if(Gt===null)throw Error(re(160));C2(i,a,o),Gt=null,br=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(l){mt(o,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)E2(t,e),t=t.sibling}function E2(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gr(t,e),Ar(e),r&4){try{Xs(3,e,e.return),Tf(3,e)}catch(m){mt(e,e.return,m)}try{Xs(5,e,e.return)}catch(m){mt(e,e.return,m)}}break;case 1:gr(t,e),Ar(e),r&512&&n!==null&&Ra(n,n.return);break;case 5:if(gr(t,e),Ar(e),r&512&&n!==null&&Ra(n,n.return),e.flags&32){var o=e.stateNode;try{ru(o,"")}catch(m){mt(e,e.return,m)}}if(r&4&&(o=e.stateNode,o!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,s=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&Gx(o,i),_h(s,a);var l=_h(s,i);for(a=0;a<u.length;a+=2){var c=u[a],f=u[a+1];c==="style"?Qx(o,f):c==="dangerouslySetInnerHTML"?Xx(o,f):c==="children"?ru(o,f):fm(o,c,f,l)}switch(s){case"input":xh(o,i);break;case"textarea":qx(o,i);break;case"select":var d=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Ia(o,!!i.multiple,p,!1):d!==!!i.multiple&&(i.defaultValue!=null?Ia(o,!!i.multiple,i.defaultValue,!0):Ia(o,!!i.multiple,i.multiple?[]:"",!1))}o[du]=i}catch(m){mt(e,e.return,m)}}break;case 6:if(gr(t,e),Ar(e),r&4){if(e.stateNode===null)throw Error(re(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(m){mt(e,e.return,m)}}break;case 3:if(gr(t,e),Ar(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{su(t.containerInfo)}catch(m){mt(e,e.return,m)}break;case 4:gr(t,e),Ar(e);break;case 13:gr(t,e),Ar(e),o=e.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(zm=xt())),r&4&&U0(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(un=(l=un)||c,gr(t,e),un=l):gr(t,e),Ar(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(le=e,c=e.child;c!==null;){for(f=le=c;le!==null;){switch(d=le,p=d.child,d.tag){case 0:case 11:case 14:case 15:Xs(4,d,d.return);break;case 1:Ra(d,d.return);var h=d.stateNode;if(typeof h.componentWillUnmount=="function"){r=d,n=d.return;try{t=r,h.props=t.memoizedProps,h.state=t.memoizedState,h.componentWillUnmount()}catch(m){mt(r,n,m)}}break;case 5:Ra(d,d.return);break;case 22:if(d.memoizedState!==null){H0(f);continue}}p!==null?(p.return=d,le=p):H0(f)}c=c.sibling}e:for(c=null,f=e;;){if(f.tag===5){if(c===null){c=f;try{o=f.stateNode,l?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=f.stateNode,u=f.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=Yx("display",a))}catch(m){mt(e,e.return,m)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(m){mt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gr(t,e),Ar(e),r&4&&U0(e);break;case 21:break;default:gr(t,e),Ar(e)}}function Ar(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(S2(n)){var r=n;break e}n=n.return}throw Error(re(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(ru(o,""),r.flags&=-33);var i=W0(e);tv(e,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=W0(e);ev(e,s,a);break;default:throw Error(re(161))}}catch(u){mt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function QP(e,t,n){le=e,_2(e)}function _2(e,t,n){for(var r=(e.mode&1)!==0;le!==null;){var o=le,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||xl;if(!a){var s=o.alternate,u=s!==null&&s.memoizedState!==null||un;s=xl;var l=un;if(xl=a,(un=u)&&!l)for(le=o;le!==null;)a=le,u=a.child,a.tag===22&&a.memoizedState!==null?G0(o):u!==null?(u.return=a,le=u):G0(o);for(;i!==null;)le=i,_2(i),i=i.sibling;le=o,xl=s,un=l}z0(e)}else o.subtreeFlags&8772&&i!==null?(i.return=o,le=i):z0(e)}}function z0(e){for(;le!==null;){var t=le;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:un||Tf(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!un)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:yr(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&P0(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}P0(t,a,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&su(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}un||t.flags&512&&Zh(t)}catch(d){mt(t,t.return,d)}}if(t===e){le=null;break}if(n=t.sibling,n!==null){n.return=t.return,le=n;break}le=t.return}}function H0(e){for(;le!==null;){var t=le;if(t===e){le=null;break}var n=t.sibling;if(n!==null){n.return=t.return,le=n;break}le=t.return}}function G0(e){for(;le!==null;){var t=le;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Tf(4,t)}catch(u){mt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(u){mt(t,o,u)}}var i=t.return;try{Zh(t)}catch(u){mt(t,i,u)}break;case 5:var a=t.return;try{Zh(t)}catch(u){mt(t,a,u)}}}catch(u){mt(t,t.return,u)}if(t===e){le=null;break}var s=t.sibling;if(s!==null){s.return=t.return,le=s;break}le=t.return}}var JP=Math.ceil,Oc=yo.ReactCurrentDispatcher,Wm=yo.ReactCurrentOwner,sr=yo.ReactCurrentBatchConfig,We=0,jt=null,Et=null,Jt=0,$n=0,Pa=fi(0),Ot=0,yu=null,Bi=0,Df=0,Um=0,Ys=null,Sn=null,zm=0,Ja=1/0,oo=null,Tc=!1,nv=null,Ko=null,wl=!1,jo=null,Dc=0,Qs=0,rv=null,ec=-1,tc=0;function bn(){return We&6?xt():ec!==-1?ec:ec=xt()}function Xo(e){return e.mode&1?We&2&&Jt!==0?Jt&-Jt:MP.transition!==null?(tc===0&&(tc=lw()),tc):(e=Ke,e!==0||(e=window.event,e=e===void 0?16:mw(e.type)),e):1}function _r(e,t,n,r){if(50<Qs)throw Qs=0,rv=null,Error(re(185));Bu(e,n,r),(!(We&2)||e!==jt)&&(e===jt&&(!(We&2)&&(Df|=n),Ot===4&&Fo(e,Jt)),In(e,r),n===1&&We===0&&!(t.mode&1)&&(Ja=xt()+500,Pf&&di()))}function In(e,t){var n=e.callbackNode;MR(e,t);var r=vc(e,e===jt?Jt:0);if(r===0)n!==null&&t0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&t0(n),t===1)e.tag===0?AP(q0.bind(null,e)):Mw(q0.bind(null,e)),OP(function(){!(We&6)&&di()}),n=null;else{switch(cw(r)){case 1:n=mm;break;case 4:n=sw;break;case 16:n=hc;break;case 536870912:n=uw;break;default:n=hc}n=N2(n,k2.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function k2(e,t){if(ec=-1,tc=0,We&6)throw Error(re(327));var n=e.callbackNode;if(Aa()&&e.callbackNode!==n)return null;var r=vc(e,e===jt?Jt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Nc(e,r);else{t=r;var o=We;We|=2;var i=P2();(jt!==e||Jt!==t)&&(oo=null,Ja=xt()+500,Ii(e,t));do try{tI();break}catch(s){R2(e,s)}while(!0);Im(),Oc.current=i,We=o,Et!==null?t=0:(jt=null,Jt=0,t=Ot)}if(t!==0){if(t===2&&(o=Oh(e),o!==0&&(r=o,t=ov(e,o))),t===1)throw n=yu,Ii(e,0),Fo(e,r),In(e,xt()),n;if(t===6)Fo(e,r);else{if(o=e.current.alternate,!(r&30)&&!ZP(o)&&(t=Nc(e,r),t===2&&(i=Oh(e),i!==0&&(r=i,t=ov(e,i))),t===1))throw n=yu,Ii(e,0),Fo(e,r),In(e,xt()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(re(345));case 2:bi(e,Sn,oo);break;case 3:if(Fo(e,r),(r&130023424)===r&&(t=zm+500-xt(),10<t)){if(vc(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){bn(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Bh(bi.bind(null,e,Sn,oo),t);break}bi(e,Sn,oo);break;case 4:if(Fo(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-Er(r);i=1<<a,a=t[a],a>o&&(o=a),r&=~i}if(r=o,r=xt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*JP(r/1960))-r,10<r){e.timeoutHandle=Bh(bi.bind(null,e,Sn,oo),r);break}bi(e,Sn,oo);break;case 5:bi(e,Sn,oo);break;default:throw Error(re(329))}}}return In(e,xt()),e.callbackNode===n?k2.bind(null,e):null}function ov(e,t){var n=Ys;return e.current.memoizedState.isDehydrated&&(Ii(e,t).flags|=256),e=Nc(e,t),e!==2&&(t=Sn,Sn=n,t!==null&&iv(t)),e}function iv(e){Sn===null?Sn=e:Sn.push.apply(Sn,e)}function ZP(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!Pr(i(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fo(e,t){for(t&=~Um,t&=~Df,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Er(t),r=1<<n;e[n]=-1,t&=~r}}function q0(e){if(We&6)throw Error(re(327));Aa();var t=vc(e,0);if(!(t&1))return In(e,xt()),null;var n=Nc(e,t);if(e.tag!==0&&n===2){var r=Oh(e);r!==0&&(t=r,n=ov(e,r))}if(n===1)throw n=yu,Ii(e,0),Fo(e,t),In(e,xt()),n;if(n===6)throw Error(re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bi(e,Sn,oo),In(e,xt()),null}function Hm(e,t){var n=We;We|=1;try{return e(t)}finally{We=n,We===0&&(Ja=xt()+500,Pf&&di())}}function ji(e){jo!==null&&jo.tag===0&&!(We&6)&&Aa();var t=We;We|=1;var n=sr.transition,r=Ke;try{if(sr.transition=null,Ke=1,e)return e()}finally{Ke=r,sr.transition=n,We=t,!(We&6)&&di()}}function Gm(){$n=Pa.current,ot(Pa)}function Ii(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,IP(n)),Et!==null)for(n=Et.return;n!==null;){var r=n;switch(km(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&xc();break;case 3:Ya(),ot(Rn),ot(pn),Mm();break;case 5:Am(r);break;case 4:Ya();break;case 13:ot(lt);break;case 19:ot(lt);break;case 10:Om(r.type._context);break;case 22:case 23:Gm()}n=n.return}if(jt=e,Et=e=Yo(e.current,null),Jt=$n=t,Ot=0,yu=null,Um=Df=Bi=0,Sn=Ys=null,_i!==null){for(t=0;t<_i.length;t++)if(n=_i[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}_i=null}return e}function R2(e,t){do{var n=Et;try{if(Im(),Ql.current=Ic,Pc){for(var r=dt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Pc=!1}if(Li=0,Bt=It=dt=null,Ks=!1,vu=0,Wm.current=null,n===null||n.return===null){Ot=1,yu=t,Et=null;break}e:{var i=e,a=n.return,s=n,u=t;if(t=Jt,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=A0(a);if(p!==null){p.flags&=-257,M0(p,a,s,i,t),p.mode&1&&N0(i,l,t),t=p,u=l;var h=t.updateQueue;if(h===null){var m=new Set;m.add(u),t.updateQueue=m}else h.add(u);break e}else{if(!(t&1)){N0(i,l,t),qm();break e}u=Error(re(426))}}else if(at&&s.mode&1){var g=A0(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),M0(g,a,s,i,t),Rm(Qa(u,s));break e}}i=u=Qa(u,s),Ot!==4&&(Ot=2),Ys===null?Ys=[i]:Ys.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=c2(i,u,t);R0(i,v);break e;case 1:s=u;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ko===null||!Ko.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var x=f2(i,s,t);R0(i,x);break e}}i=i.return}while(i!==null)}O2(n)}catch(w){t=w,Et===n&&n!==null&&(Et=n=n.return);continue}break}while(!0)}function P2(){var e=Oc.current;return Oc.current=Ic,e===null?Ic:e}function qm(){(Ot===0||Ot===3||Ot===2)&&(Ot=4),jt===null||!(Bi&268435455)&&!(Df&268435455)||Fo(jt,Jt)}function Nc(e,t){var n=We;We|=2;var r=P2();(jt!==e||Jt!==t)&&(oo=null,Ii(e,t));do try{eI();break}catch(o){R2(e,o)}while(!0);if(Im(),We=n,Oc.current=r,Et!==null)throw Error(re(261));return jt=null,Jt=0,Ot}function eI(){for(;Et!==null;)I2(Et)}function tI(){for(;Et!==null&&!kR();)I2(Et)}function I2(e){var t=D2(e.alternate,e,$n);e.memoizedProps=e.pendingProps,t===null?O2(e):Et=t,Wm.current=null}function O2(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=KP(n,t),n!==null){n.flags&=32767,Et=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ot=6,Et=null;return}}else if(n=qP(n,t,$n),n!==null){Et=n;return}if(t=t.sibling,t!==null){Et=t;return}Et=t=e}while(t!==null);Ot===0&&(Ot=5)}function bi(e,t,n){var r=Ke,o=sr.transition;try{sr.transition=null,Ke=1,nI(e,t,n,r)}finally{sr.transition=o,Ke=r}return null}function nI(e,t,n,r){do Aa();while(jo!==null);if(We&6)throw Error(re(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(re(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(FR(e,i),e===jt&&(Et=jt=null,Jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||wl||(wl=!0,N2(hc,function(){return Aa(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=sr.transition,sr.transition=null;var a=Ke;Ke=1;var s=We;We|=4,Wm.current=null,YP(e,n),E2(n,e),SP(Fh),mc=!!Mh,Fh=Mh=null,e.current=n,QP(n),RR(),We=s,Ke=a,sr.transition=i}else e.current=n;if(wl&&(wl=!1,jo=e,Dc=o),i=e.pendingLanes,i===0&&(Ko=null),OR(n.stateNode),In(e,xt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Tc)throw Tc=!1,e=nv,nv=null,e;return Dc&1&&e.tag!==0&&Aa(),i=e.pendingLanes,i&1?e===rv?Qs++:(Qs=0,rv=e):Qs=0,di(),null}function Aa(){if(jo!==null){var e=cw(Dc),t=sr.transition,n=Ke;try{if(sr.transition=null,Ke=16>e?16:e,jo===null)var r=!1;else{if(e=jo,jo=null,Dc=0,We&6)throw Error(re(331));var o=We;for(We|=4,le=e.current;le!==null;){var i=le,a=i.child;if(le.flags&16){var s=i.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(le=l;le!==null;){var c=le;switch(c.tag){case 0:case 11:case 15:Xs(8,c,i)}var f=c.child;if(f!==null)f.return=c,le=f;else for(;le!==null;){c=le;var d=c.sibling,p=c.return;if(w2(c),c===l){le=null;break}if(d!==null){d.return=p,le=d;break}le=p}}}var h=i.alternate;if(h!==null){var m=h.child;if(m!==null){h.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}le=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,le=a;else e:for(;le!==null;){if(i=le,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Xs(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,le=v;break e}le=i.return}}var y=e.current;for(le=y;le!==null;){a=le;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,le=b;else e:for(a=y;le!==null;){if(s=le,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Tf(9,s)}}catch(w){mt(s,s.return,w)}if(s===a){le=null;break e}var x=s.sibling;if(x!==null){x.return=s.return,le=x;break e}le=s.return}}if(We=o,di(),Hr&&typeof Hr.onPostCommitFiberRoot=="function")try{Hr.onPostCommitFiberRoot(Cf,e)}catch{}r=!0}return r}finally{Ke=n,sr.transition=t}}return!1}function K0(e,t,n){t=Qa(n,t),t=c2(e,t,1),e=qo(e,t,1),t=bn(),e!==null&&(Bu(e,1,t),In(e,t))}function mt(e,t,n){if(e.tag===3)K0(e,e,n);else for(;t!==null;){if(t.tag===3){K0(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ko===null||!Ko.has(r))){e=Qa(n,e),e=f2(t,e,1),t=qo(t,e,1),e=bn(),t!==null&&(Bu(t,1,e),In(t,e));break}}t=t.return}}function rI(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=bn(),e.pingedLanes|=e.suspendedLanes&n,jt===e&&(Jt&n)===n&&(Ot===4||Ot===3&&(Jt&130023424)===Jt&&500>xt()-zm?Ii(e,0):Um|=n),In(e,t)}function T2(e,t){t===0&&(e.mode&1?(t=fl,fl<<=1,!(fl&130023424)&&(fl=4194304)):t=1);var n=bn();e=ho(e,t),e!==null&&(Bu(e,t,n),In(e,n))}function oI(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),T2(e,n)}function iI(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(re(314))}r!==null&&r.delete(t),T2(e,n)}var D2;D2=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Rn.current)kn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return kn=!1,GP(e,t,n);kn=!!(e.flags&131072)}else kn=!1,at&&t.flags&1048576&&Fw(t,Cc,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Zl(e,t),e=t.pendingProps;var o=qa(t,pn.current);Na(t,n),o=Lm(null,t,r,e,o,n);var i=Bm();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pn(r)?(i=!0,wc(t)):i=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Dm(t),o.updater=Of,t.stateNode=o,o._reactInternals=t,Hh(t,r,e,n),t=Kh(null,t,r,!0,i,n)):(t.tag=0,at&&i&&_m(t),yn(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Zl(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=sI(r),e=yr(r,e),o){case 0:t=qh(null,t,r,e,n);break e;case 1:t=B0(null,t,r,e,n);break e;case 11:t=F0(null,t,r,e,n);break e;case 14:t=L0(null,t,r,yr(r.type,e),n);break e}throw Error(re(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:yr(r,o),qh(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:yr(r,o),B0(e,t,r,o,n);case 3:e:{if(v2(t),e===null)throw Error(re(387));r=t.pendingProps,i=t.memoizedState,o=i.element,Ww(e,t),kc(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){o=Qa(Error(re(423)),t),t=j0(e,t,r,n,o);break e}else if(r!==o){o=Qa(Error(re(424)),t),t=j0(e,t,r,n,o);break e}else for(Un=Go(t.stateNode.containerInfo.firstChild),qn=t,at=!0,xr=null,n=$w(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ka(),r===o){t=vo(e,t,n);break e}yn(e,t,r,n)}t=t.child}return t;case 5:return Uw(t),e===null&&Wh(t),r=t.type,o=t.pendingProps,i=e!==null?e.memoizedProps:null,a=o.children,Lh(r,o)?a=null:i!==null&&Lh(r,i)&&(t.flags|=32),h2(e,t),yn(e,t,a,n),t.child;case 6:return e===null&&Wh(t),null;case 13:return m2(e,t,n);case 4:return Nm(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Xa(t,null,r,n):yn(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:yr(r,o),F0(e,t,r,o,n);case 7:return yn(e,t,t.pendingProps,n),t.child;case 8:return yn(e,t,t.pendingProps.children,n),t.child;case 12:return yn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,a=o.value,Je(Ec,r._currentValue),r._currentValue=a,i!==null)if(Pr(i.value,a)){if(i.children===o.children&&!Rn.current){t=vo(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=lo(-1,n&-n),u.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Uh(i.return,n,t),s.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(re(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),Uh(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}yn(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Na(t,n),o=lr(o),r=r(o),t.flags|=1,yn(e,t,r,n),t.child;case 14:return r=t.type,o=yr(r,t.pendingProps),o=yr(r.type,o),L0(e,t,r,o,n);case 15:return d2(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:yr(r,o),Zl(e,t),t.tag=1,Pn(r)?(e=!0,wc(t)):e=!1,Na(t,n),l2(t,r,o),Hh(t,r,o,n),Kh(null,t,r,!0,e,n);case 19:return g2(e,t,n);case 22:return p2(e,t,n)}throw Error(re(156,t.tag))};function N2(e,t){return aw(e,t)}function aI(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ir(e,t,n,r){return new aI(e,t,n,r)}function Km(e){return e=e.prototype,!(!e||!e.isReactComponent)}function sI(e){if(typeof e=="function")return Km(e)?1:0;if(e!=null){if(e=e.$$typeof,e===pm)return 11;if(e===hm)return 14}return 2}function Yo(e,t){var n=e.alternate;return n===null?(n=ir(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function nc(e,t,n,r,o,i){var a=2;if(r=e,typeof e=="function")Km(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case ya:return Oi(n.children,o,i,t);case dm:a=8,o|=8;break;case vh:return e=ir(12,n,t,o|2),e.elementType=vh,e.lanes=i,e;case mh:return e=ir(13,n,t,o),e.elementType=mh,e.lanes=i,e;case gh:return e=ir(19,n,t,o),e.elementType=gh,e.lanes=i,e;case Ux:return Nf(n,o,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Vx:a=10;break e;case Wx:a=9;break e;case pm:a=11;break e;case hm:a=14;break e;case Do:a=16,r=null;break e}throw Error(re(130,e==null?e:typeof e,""))}return t=ir(a,n,t,o),t.elementType=e,t.type=r,t.lanes=i,t}function Oi(e,t,n,r){return e=ir(7,e,r,t),e.lanes=n,e}function Nf(e,t,n,r){return e=ir(22,e,r,t),e.elementType=Ux,e.lanes=n,e.stateNode={isHidden:!1},e}function dp(e,t,n){return e=ir(6,e,null,t),e.lanes=n,e}function pp(e,t,n){return t=ir(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function uI(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qd(0),this.expirationTimes=qd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qd(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Xm(e,t,n,r,o,i,a,s,u){return e=new uI(e,t,n,s,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=ir(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dm(i),e}function lI(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ga,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function A2(e){if(!e)return ii;e=e._reactInternals;e:{if(qi(e)!==e||e.tag!==1)throw Error(re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(re(171))}if(e.tag===1){var n=e.type;if(Pn(n))return Aw(e,n,t)}return t}function M2(e,t,n,r,o,i,a,s,u){return e=Xm(n,r,!0,e,o,i,a,s,u),e.context=A2(null),n=e.current,r=bn(),o=Xo(n),i=lo(r,o),i.callback=t??null,qo(n,i,o),e.current.lanes=o,Bu(e,o,r),In(e,r),e}function Af(e,t,n,r){var o=t.current,i=bn(),a=Xo(o);return n=A2(n),t.context===null?t.context=n:t.pendingContext=n,t=lo(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=qo(o,t,a),e!==null&&(_r(e,o,a,i),Yl(e,o,a)),a}function Ac(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function X0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Ym(e,t){X0(e,t),(e=e.alternate)&&X0(e,t)}function cI(){return null}var F2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Qm(e){this._internalRoot=e}Mf.prototype.render=Qm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(re(409));Af(e,t,null,null)};Mf.prototype.unmount=Qm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ji(function(){Af(null,e,null,null)}),t[po]=null}};function Mf(e){this._internalRoot=e}Mf.prototype.unstable_scheduleHydration=function(e){if(e){var t=pw();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mo.length&&t!==0&&t<Mo[n].priority;n++);Mo.splice(n,0,e),n===0&&vw(e)}};function Jm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ff(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Y0(){}function fI(e,t,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var l=Ac(a);i.call(l)}}var a=M2(t,r,e,0,null,!1,!1,"",Y0);return e._reactRootContainer=a,e[po]=a.current,cu(e.nodeType===8?e.parentNode:e),ji(),a}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var l=Ac(u);s.call(l)}}var u=Xm(e,0,!1,null,null,!1,!1,"",Y0);return e._reactRootContainer=u,e[po]=u.current,cu(e.nodeType===8?e.parentNode:e),ji(function(){Af(t,u,n,r)}),u}function Lf(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var u=Ac(a);s.call(u)}}Af(t,a,e,o)}else a=fI(n,t,e,o,r);return Ac(a)}fw=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Bs(t.pendingLanes);n!==0&&(gm(t,n|1),In(t,xt()),!(We&6)&&(Ja=xt()+500,di()))}break;case 13:ji(function(){var r=ho(e,1);if(r!==null){var o=bn();_r(r,e,1,o)}}),Ym(e,1)}};ym=function(e){if(e.tag===13){var t=ho(e,134217728);if(t!==null){var n=bn();_r(t,e,134217728,n)}Ym(e,134217728)}};dw=function(e){if(e.tag===13){var t=Xo(e),n=ho(e,t);if(n!==null){var r=bn();_r(n,e,t,r)}Ym(e,t)}};pw=function(){return Ke};hw=function(e,t){var n=Ke;try{return Ke=e,t()}finally{Ke=n}};Rh=function(e,t,n){switch(t){case"input":if(xh(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Rf(r);if(!o)throw Error(re(90));Hx(r),xh(r,o)}}}break;case"textarea":qx(e,n);break;case"select":t=n.value,t!=null&&Ia(e,!!n.multiple,t,!1)}};ew=Hm;tw=ji;var dI={usingClientEntryPoint:!1,Events:[$u,Sa,Rf,Jx,Zx,Hm]},ks={findFiberByHostInstance:Ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pI={bundleType:ks.bundleType,version:ks.version,rendererPackageName:ks.rendererPackageName,rendererConfig:ks.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ow(e),e===null?null:e.stateNode},findFiberByHostInstance:ks.findFiberByHostInstance||cI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sl.isDisabled&&Sl.supportsFiber)try{Cf=Sl.inject(pI),Hr=Sl}catch{}}Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dI;Jn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jm(t))throw Error(re(200));return lI(e,t,null,n)};Jn.createRoot=function(e,t){if(!Jm(e))throw Error(re(299));var n=!1,r="",o=F2;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Xm(e,1,!1,null,null,n,!1,r,o),e[po]=t.current,cu(e.nodeType===8?e.parentNode:e),new Qm(t)};Jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(re(188)):(e=Object.keys(e).join(","),Error(re(268,e)));return e=ow(t),e=e===null?null:e.stateNode,e};Jn.flushSync=function(e){return ji(e)};Jn.hydrate=function(e,t,n){if(!Ff(t))throw Error(re(200));return Lf(null,e,t,!0,n)};Jn.hydrateRoot=function(e,t,n){if(!Jm(e))throw Error(re(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=F2;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=M2(t,null,e,1,n??null,o,!1,i,a),e[po]=t.current,cu(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Mf(t)};Jn.render=function(e,t,n){if(!Ff(t))throw Error(re(200));return Lf(null,e,t,!1,n)};Jn.unmountComponentAtNode=function(e){if(!Ff(e))throw Error(re(40));return e._reactRootContainer?(ji(function(){Lf(null,null,e,!1,function(){e._reactRootContainer=null,e[po]=null})}),!0):!1};Jn.unstable_batchedUpdates=Hm;Jn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ff(n))throw Error(re(200));if(e==null||e._reactInternals===void 0)throw Error(re(38));return Lf(e,t,n,!1,r)};Jn.version="18.3.1-next-f1338f8080-20240426";function L2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(L2)}catch(e){console.error(e)}}L2(),Lx.exports=Jn;var Bf=Lx.exports,Q0=Bf;ph.createRoot=Q0.createRoot,ph.hydrateRoot=Q0.hydrateRoot;/**
 * @remix-run/router v1.16.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bu(){return bu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bu.apply(this,arguments)}var $o;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})($o||($o={}));const J0="popstate";function hI(e){e===void 0&&(e={});function t(r,o){let{pathname:i,search:a,hash:s}=r.location;return av("",{pathname:i,search:a,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:j2(o)}return mI(t,n,null,e)}function Tt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function B2(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function vI(){return Math.random().toString(36).substr(2,8)}function Z0(e,t){return{usr:e.state,key:e.key,idx:t}}function av(e,t,n,r){return n===void 0&&(n=null),bu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?cs(t):t,{state:n,key:t&&t.key||r||vI()})}function j2(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function cs(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function mI(e,t,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,a=o.history,s=$o.Pop,u=null,l=c();l==null&&(l=0,a.replaceState(bu({},a.state,{idx:l}),""));function c(){return(a.state||{idx:null}).idx}function f(){s=$o.Pop;let g=c(),v=g==null?null:g-l;l=g,u&&u({action:s,location:m.location,delta:v})}function d(g,v){s=$o.Push;let y=av(m.location,g,v);l=c()+1;let b=Z0(y,l),x=m.createHref(y);try{a.pushState(b,"",x)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;o.location.assign(x)}i&&u&&u({action:s,location:m.location,delta:1})}function p(g,v){s=$o.Replace;let y=av(m.location,g,v);l=c();let b=Z0(y,l),x=m.createHref(y);a.replaceState(b,"",x),i&&u&&u({action:s,location:m.location,delta:0})}function h(g){let v=o.location.origin!=="null"?o.location.origin:o.location.href,y=typeof g=="string"?g:j2(g);return y=y.replace(/ $/,"%20"),Tt(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return s},get location(){return e(o,a)},listen(g){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(J0,f),u=g,()=>{o.removeEventListener(J0,f),u=null}},createHref(g){return t(o,g)},createURL:h,encodeLocation(g){let v=h(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:p,go(g){return a.go(g)}};return m}var e1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(e1||(e1={}));function gI(e,t,n){n===void 0&&(n="/");let r=typeof t=="string"?cs(t):t,o=W2(r.pathname||"/",n);if(o==null)return null;let i=$2(e);yI(i);let a=null;for(let s=0;a==null&&s<i.length;++s){let u=OI(o);a=RI(i[s],u)}return a}function $2(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(i,a,s)=>{let u={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(Tt(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let l=Ti([r,u.relativePath]),c=n.concat(u);i.children&&i.children.length>0&&(Tt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),$2(i.children,t,c,l)),!(i.path==null&&!i.index)&&t.push({path:l,score:_I(l,i.index),routesMeta:c})};return e.forEach((i,a)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))o(i,a);else for(let u of V2(i.path))o(i,a,u)}),t}function V2(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let a=V2(r.join("/")),s=[];return s.push(...a.map(u=>u===""?i:[i,u].join("/"))),o&&s.push(...a),s.map(u=>e.startsWith("/")&&u===""?"/":u)}function yI(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:kI(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const bI=/^:[\w-]+$/,xI=3,wI=2,SI=1,CI=10,EI=-2,t1=e=>e==="*";function _I(e,t){let n=e.split("/"),r=n.length;return n.some(t1)&&(r+=EI),t&&(r+=wI),n.filter(o=>!t1(o)).reduce((o,i)=>o+(bI.test(i)?xI:i===""?SI:CI),r)}function kI(e,t){return e.length===t.length&&e.slice(0,-1).every((r,o)=>r===t[o])?e[e.length-1]-t[t.length-1]:0}function RI(e,t){let{routesMeta:n}=e,r={},o="/",i=[];for(let a=0;a<n.length;++a){let s=n[a],u=a===n.length-1,l=o==="/"?t:t.slice(o.length)||"/",c=PI({path:s.relativePath,caseSensitive:s.caseSensitive,end:u},l);if(!c)return null;Object.assign(r,c.params);let f=s.route;i.push({params:r,pathname:Ti([o,c.pathname]),pathnameBase:FI(Ti([o,c.pathnameBase])),route:f}),c.pathnameBase!=="/"&&(o=Ti([o,c.pathnameBase]))}return i}function PI(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=II(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((l,c,f)=>{let{paramName:d,isOptional:p}=c;if(d==="*"){let m=s[f]||"";a=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const h=s[f];return p&&!h?l[d]=void 0:l[d]=(h||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:a,pattern:e}}function II(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),B2(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}function OI(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return B2(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function W2(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function TI(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:o=""}=typeof e=="string"?cs(e):e;return{pathname:n?n.startsWith("/")?n:DI(n,t):t,search:LI(r),hash:BI(o)}}function DI(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function hp(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function NI(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function AI(e,t){let n=NI(e);return t?n.map((r,o)=>o===e.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function MI(e,t,n,r){r===void 0&&(r=!1);let o;typeof e=="string"?o=cs(e):(o=bu({},e),Tt(!o.pathname||!o.pathname.includes("?"),hp("?","pathname","search",o)),Tt(!o.pathname||!o.pathname.includes("#"),hp("#","pathname","hash",o)),Tt(!o.search||!o.search.includes("#"),hp("#","search","hash",o)));let i=e===""||o.pathname==="",a=i?"/":o.pathname,s;if(a==null)s=n;else{let f=t.length-1;if(!r&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),f-=1;o.pathname=d.join("/")}s=f>=0?t[f]:"/"}let u=TI(o,s),l=a&&a!=="/"&&a.endsWith("/"),c=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}const Ti=e=>e.join("/").replace(/\/\/+/g,"/"),FI=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),LI=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,BI=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function jI(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const U2=["post","put","patch","delete"];new Set(U2);const $I=["get",...U2];new Set($I);/**
 * React Router v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xu(){return xu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xu.apply(this,arguments)}const Zm=N.createContext(null),VI=N.createContext(null),jf=N.createContext(null),$f=N.createContext(null),Ki=N.createContext({outlet:null,matches:[],isDataRoute:!1}),z2=N.createContext(null);function Vf(){return N.useContext($f)!=null}function eg(){return Vf()||Tt(!1),N.useContext($f).location}function H2(e){N.useContext(jf).static||N.useLayoutEffect(e)}function Wf(){let{isDataRoute:e}=N.useContext(Ki);return e?eO():WI()}function WI(){Vf()||Tt(!1);let e=N.useContext(Zm),{basename:t,future:n,navigator:r}=N.useContext(jf),{matches:o}=N.useContext(Ki),{pathname:i}=eg(),a=JSON.stringify(AI(o,n.v7_relativeSplatPath)),s=N.useRef(!1);return H2(()=>{s.current=!0}),N.useCallback(function(l,c){if(c===void 0&&(c={}),!s.current)return;if(typeof l=="number"){r.go(l);return}let f=MI(l,JSON.parse(a),i,c.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Ti([t,f.pathname])),(c.replace?r.replace:r.push)(f,c.state,c)},[t,r,a,i,e])}function Uf(){let{matches:e}=N.useContext(Ki),t=e[e.length-1];return t?t.params:{}}function UI(e,t){return zI(e,t)}function zI(e,t,n,r){Vf()||Tt(!1);let{navigator:o}=N.useContext(jf),{matches:i}=N.useContext(Ki),a=i[i.length-1],s=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let l=eg(),c;if(t){var f;let g=typeof t=="string"?cs(t):t;u==="/"||(f=g.pathname)!=null&&f.startsWith(u)||Tt(!1),c=g}else c=l;let d=c.pathname||"/",p=d;if(u!=="/"){let g=u.replace(/^\//,"").split("/");p="/"+d.replace(/^\//,"").split("/").slice(g.length).join("/")}let h=gI(e,{pathname:p}),m=XI(h&&h.map(g=>Object.assign({},g,{params:Object.assign({},s,g.params),pathname:Ti([u,o.encodeLocation?o.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?u:Ti([u,o.encodeLocation?o.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,r);return t&&m?N.createElement($f.Provider,{value:{location:xu({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:$o.Pop}},m):m}function HI(){let e=ZI(),t=jI(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},t),n?N.createElement("pre",{style:o},n):null,null)}const GI=N.createElement(HI,null);class qI extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?N.createElement(Ki.Provider,{value:this.props.routeContext},N.createElement(z2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function KI(e){let{routeContext:t,match:n,children:r}=e,o=N.useContext(Zm);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(Ki.Provider,{value:t},r)}function XI(e,t,n,r){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if((i=n)!=null&&i.errors)e=n.matches;else return null}let a=e,s=(o=n)==null?void 0:o.errors;if(s!=null){let c=a.findIndex(f=>f.route.id&&(s==null?void 0:s[f.route.id])!==void 0);c>=0||Tt(!1),a=a.slice(0,Math.min(a.length,c+1))}let u=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let f=a[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=c),f.route.id){let{loaderData:d,errors:p}=n,h=f.route.loader&&d[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||h){u=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,f,d)=>{let p,h=!1,m=null,g=null;n&&(p=s&&f.route.id?s[f.route.id]:void 0,m=f.route.errorElement||GI,u&&(l<0&&d===0?(h=!0,g=null):l===d&&(h=!0,g=f.route.hydrateFallbackElement||null)));let v=t.concat(a.slice(0,d+1)),y=()=>{let b;return p?b=m:h?b=g:f.route.Component?b=N.createElement(f.route.Component,null):f.route.element?b=f.route.element:b=c,N.createElement(KI,{match:f,routeContext:{outlet:c,matches:v,isDataRoute:n!=null},children:b})};return n&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?N.createElement(qI,{location:n.location,revalidation:n.revalidation,component:m,error:p,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var G2=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(G2||{}),Mc=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Mc||{});function YI(e){let t=N.useContext(Zm);return t||Tt(!1),t}function QI(e){let t=N.useContext(VI);return t||Tt(!1),t}function JI(e){let t=N.useContext(Ki);return t||Tt(!1),t}function q2(e){let t=JI(),n=t.matches[t.matches.length-1];return n.route.id||Tt(!1),n.route.id}function ZI(){var e;let t=N.useContext(z2),n=QI(Mc.UseRouteError),r=q2(Mc.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function eO(){let{router:e}=YI(G2.UseNavigateStable),t=q2(Mc.UseNavigateStable),n=N.useRef(!1);return H2(()=>{n.current=!0}),N.useCallback(function(o,i){i===void 0&&(i={}),n.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,xu({fromRouteId:t},i)))},[e,t])}function fa(e){Tt(!1)}function tO(e){let{basename:t="/",children:n=null,location:r,navigationType:o=$o.Pop,navigator:i,static:a=!1,future:s}=e;Vf()&&Tt(!1);let u=t.replace(/^\/*/,"/"),l=N.useMemo(()=>({basename:u,navigator:i,static:a,future:xu({v7_relativeSplatPath:!1},s)}),[u,s,i,a]);typeof r=="string"&&(r=cs(r));let{pathname:c="/",search:f="",hash:d="",state:p=null,key:h="default"}=r,m=N.useMemo(()=>{let g=W2(c,u);return g==null?null:{location:{pathname:g,search:f,hash:d,state:p,key:h},navigationType:o}},[u,c,f,d,p,h,o]);return m==null?null:N.createElement(jf.Provider,{value:l},N.createElement($f.Provider,{children:n,value:m}))}function nO(e){let{children:t,location:n}=e;return UI(sv(t),n)}new Promise(()=>{});function sv(e,t){t===void 0&&(t=[]);let n=[];return N.Children.forEach(e,(r,o)=>{if(!N.isValidElement(r))return;let i=[...t,o];if(r.type===N.Fragment){n.push.apply(n,sv(r.props.children,i));return}r.type!==fa&&Tt(!1),!r.props.index||!r.props.children||Tt(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=sv(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const rO="6";try{window.__reactRouterVersion=rO}catch{}const oO="startTransition",n1=dh[oO];function iO(e){let{basename:t,children:n,future:r,window:o}=e,i=N.useRef();i.current==null&&(i.current=hI({window:o,v5Compat:!0}));let a=i.current,[s,u]=N.useState({action:a.action,location:a.location}),{v7_startTransition:l}=r||{},c=N.useCallback(f=>{l&&n1?n1(()=>u(f)):u(f)},[u,l]);return N.useLayoutEffect(()=>a.listen(c),[a,c]),N.createElement(tO,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:a,future:r})}var r1;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(r1||(r1={}));var o1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(o1||(o1={}));function K2(e,t){return function(){return e.apply(t,arguments)}}const{toString:aO}=Object.prototype,{getPrototypeOf:tg}=Object,zf=(e=>t=>{const n=aO.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Or=e=>(e=e.toLowerCase(),t=>zf(t)===e),Hf=e=>t=>typeof t===e,{isArray:fs}=Array,wu=Hf("undefined");function sO(e){return e!==null&&!wu(e)&&e.constructor!==null&&!wu(e.constructor)&&ur(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const X2=Or("ArrayBuffer");function uO(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&X2(e.buffer),t}const lO=Hf("string"),ur=Hf("function"),Y2=Hf("number"),Gf=e=>e!==null&&typeof e=="object",cO=e=>e===!0||e===!1,rc=e=>{if(zf(e)!=="object")return!1;const t=tg(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},fO=Or("Date"),dO=Or("File"),pO=Or("Blob"),hO=Or("FileList"),vO=e=>Gf(e)&&ur(e.pipe),mO=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ur(e.append)&&((t=zf(e))==="formdata"||t==="object"&&ur(e.toString)&&e.toString()==="[object FormData]"))},gO=Or("URLSearchParams"),[yO,bO,xO,wO]=["ReadableStream","Request","Response","Headers"].map(Or),SO=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wu(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,o;if(typeof e!="object"&&(e=[e]),fs(e))for(r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else{const i=n?Object.getOwnPropertyNames(e):Object.keys(e),a=i.length;let s;for(r=0;r<a;r++)s=i[r],t.call(null,e[s],s,e)}}function Q2(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,o;for(;r-- >0;)if(o=n[r],t===o.toLowerCase())return o;return null}const J2=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Z2=e=>!wu(e)&&e!==J2;function uv(){const{caseless:e}=Z2(this)&&this||{},t={},n=(r,o)=>{const i=e&&Q2(t,o)||o;rc(t[i])&&rc(r)?t[i]=uv(t[i],r):rc(r)?t[i]=uv({},r):fs(r)?t[i]=r.slice():t[i]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Wu(arguments[r],n);return t}const CO=(e,t,n,{allOwnKeys:r}={})=>(Wu(t,(o,i)=>{n&&ur(o)?e[i]=K2(o,n):e[i]=o},{allOwnKeys:r}),e),EO=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),_O=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},kO=(e,t,n,r)=>{let o,i,a;const s={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)a=o[i],(!r||r(a,e,t))&&!s[a]&&(t[a]=e[a],s[a]=!0);e=n!==!1&&tg(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},RO=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},PO=e=>{if(!e)return null;if(fs(e))return e;let t=e.length;if(!Y2(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},IO=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&tg(Uint8Array)),OO=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=r.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},TO=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},DO=Or("HTMLFormElement"),NO=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,o){return r.toUpperCase()+o}),i1=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),AO=Or("RegExp"),eS=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Wu(n,(o,i)=>{let a;(a=t(o,i,e))!==!1&&(r[i]=a||o)}),Object.defineProperties(e,r)},MO=e=>{eS(e,(t,n)=>{if(ur(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(ur(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},FO=(e,t)=>{const n={},r=o=>{o.forEach(i=>{n[i]=!0})};return fs(e)?r(e):r(String(e).split(t)),n},LO=()=>{},BO=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,vp="abcdefghijklmnopqrstuvwxyz",a1="0123456789",tS={DIGIT:a1,ALPHA:vp,ALPHA_DIGIT:vp+vp.toUpperCase()+a1},jO=(e=16,t=tS.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n};function $O(e){return!!(e&&ur(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const VO=e=>{const t=new Array(10),n=(r,o)=>{if(Gf(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[o]=r;const i=fs(r)?[]:{};return Wu(r,(a,s)=>{const u=n(a,o+1);!wu(u)&&(i[s]=u)}),t[o]=void 0,i}}return r};return n(e,0)},WO=Or("AsyncFunction"),UO=e=>e&&(Gf(e)||ur(e))&&ur(e.then)&&ur(e.catch),X={isArray:fs,isArrayBuffer:X2,isBuffer:sO,isFormData:mO,isArrayBufferView:uO,isString:lO,isNumber:Y2,isBoolean:cO,isObject:Gf,isPlainObject:rc,isReadableStream:yO,isRequest:bO,isResponse:xO,isHeaders:wO,isUndefined:wu,isDate:fO,isFile:dO,isBlob:pO,isRegExp:AO,isFunction:ur,isStream:vO,isURLSearchParams:gO,isTypedArray:IO,isFileList:hO,forEach:Wu,merge:uv,extend:CO,trim:SO,stripBOM:EO,inherits:_O,toFlatObject:kO,kindOf:zf,kindOfTest:Or,endsWith:RO,toArray:PO,forEachEntry:OO,matchAll:TO,isHTMLForm:DO,hasOwnProperty:i1,hasOwnProp:i1,reduceDescriptors:eS,freezeMethods:MO,toObjectSet:FO,toCamelCase:NO,noop:LO,toFiniteNumber:BO,findKey:Q2,global:J2,isContextDefined:Z2,ALPHABET:tS,generateString:jO,isSpecCompliantForm:$O,toJSONObject:VO,isAsyncFn:WO,isThenable:UO};function De(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o)}X.inherits(De,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:X.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const nS=De.prototype,rS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{rS[e]={value:e}});Object.defineProperties(De,rS);Object.defineProperty(nS,"isAxiosError",{value:!0});De.from=(e,t,n,r,o,i)=>{const a=Object.create(nS);return X.toFlatObject(e,a,function(u){return u!==Error.prototype},s=>s!=="isAxiosError"),De.call(a,e.message,t,n,r,o),a.cause=e,a.name=e.name,i&&Object.assign(a,i),a};const zO=null;function lv(e){return X.isPlainObject(e)||X.isArray(e)}function oS(e){return X.endsWith(e,"[]")?e.slice(0,-2):e}function s1(e,t,n){return e?e.concat(t).map(function(o,i){return o=oS(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}function HO(e){return X.isArray(e)&&!e.some(lv)}const GO=X.toFlatObject(X,{},null,function(t){return/^is[A-Z]/.test(t)});function qf(e,t,n){if(!X.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=X.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!X.isUndefined(g[m])});const r=n.metaTokens,o=n.visitor||c,i=n.dots,a=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&X.isSpecCompliantForm(t);if(!X.isFunction(o))throw new TypeError("visitor must be a function");function l(h){if(h===null)return"";if(X.isDate(h))return h.toISOString();if(!u&&X.isBlob(h))throw new De("Blob is not supported. Use a Buffer instead.");return X.isArrayBuffer(h)||X.isTypedArray(h)?u&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function c(h,m,g){let v=h;if(h&&!g&&typeof h=="object"){if(X.endsWith(m,"{}"))m=r?m:m.slice(0,-2),h=JSON.stringify(h);else if(X.isArray(h)&&HO(h)||(X.isFileList(h)||X.endsWith(m,"[]"))&&(v=X.toArray(h)))return m=oS(m),v.forEach(function(b,x){!(X.isUndefined(b)||b===null)&&t.append(a===!0?s1([m],x,i):a===null?m:m+"[]",l(b))}),!1}return lv(h)?!0:(t.append(s1(g,m,i),l(h)),!1)}const f=[],d=Object.assign(GO,{defaultVisitor:c,convertValue:l,isVisitable:lv});function p(h,m){if(!X.isUndefined(h)){if(f.indexOf(h)!==-1)throw Error("Circular reference detected in "+m.join("."));f.push(h),X.forEach(h,function(v,y){(!(X.isUndefined(v)||v===null)&&o.call(t,v,X.isString(y)?y.trim():y,m,d))===!0&&p(v,m?m.concat(y):[y])}),f.pop()}}if(!X.isObject(e))throw new TypeError("data must be an object");return p(e),t}function u1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function ng(e,t){this._pairs=[],e&&qf(e,this,t)}const iS=ng.prototype;iS.append=function(t,n){this._pairs.push([t,n])};iS.toString=function(t){const n=t?function(r){return t.call(this,r,u1)}:u1;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function qO(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function aS(e,t,n){if(!t)return e;const r=n&&n.encode||qO,o=n&&n.serialize;let i;if(o?i=o(t,n):i=X.isURLSearchParams(t)?t.toString():new ng(t,n).toString(r),i){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class l1{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){X.forEach(this.handlers,function(r){r!==null&&t(r)})}}const sS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},KO=typeof URLSearchParams<"u"?URLSearchParams:ng,XO=typeof FormData<"u"?FormData:null,YO=typeof Blob<"u"?Blob:null,QO={isBrowser:!0,classes:{URLSearchParams:KO,FormData:XO,Blob:YO},protocols:["http","https","file","blob","url","data"]},rg=typeof window<"u"&&typeof document<"u",JO=(e=>rg&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),ZO=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",eT=rg&&window.location.href||"http://localhost",tT=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:rg,hasStandardBrowserEnv:JO,hasStandardBrowserWebWorkerEnv:ZO,origin:eT},Symbol.toStringTag,{value:"Module"})),kr={...tT,...QO};function nT(e,t){return qf(e,new kr.classes.URLSearchParams,Object.assign({visitor:function(n,r,o,i){return kr.isNode&&X.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function rT(e){return X.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function oT(e){const t={},n=Object.keys(e);let r;const o=n.length;let i;for(r=0;r<o;r++)i=n[r],t[i]=e[i];return t}function uS(e){function t(n,r,o,i){let a=n[i++];if(a==="__proto__")return!0;const s=Number.isFinite(+a),u=i>=n.length;return a=!a&&X.isArray(o)?o.length:a,u?(X.hasOwnProp(o,a)?o[a]=[o[a],r]:o[a]=r,!s):((!o[a]||!X.isObject(o[a]))&&(o[a]=[]),t(n,r,o[a],i)&&X.isArray(o[a])&&(o[a]=oT(o[a])),!s)}if(X.isFormData(e)&&X.isFunction(e.entries)){const n={};return X.forEachEntry(e,(r,o)=>{t(rT(r),o,n,0)}),n}return null}function iT(e,t,n){if(X.isString(e))try{return(t||JSON.parse)(e),X.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Uu={transitional:sS,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",o=r.indexOf("application/json")>-1,i=X.isObject(t);if(i&&X.isHTMLForm(t)&&(t=new FormData(t)),X.isFormData(t))return o?JSON.stringify(uS(t)):t;if(X.isArrayBuffer(t)||X.isBuffer(t)||X.isStream(t)||X.isFile(t)||X.isBlob(t)||X.isReadableStream(t))return t;if(X.isArrayBufferView(t))return t.buffer;if(X.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return nT(t,this.formSerializer).toString();if((s=X.isFileList(t))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return qf(s?{"files[]":t}:t,u&&new u,this.formSerializer)}}return i||o?(n.setContentType("application/json",!1),iT(t)):t}],transformResponse:[function(t){const n=this.transitional||Uu.transitional,r=n&&n.forcedJSONParsing,o=this.responseType==="json";if(X.isResponse(t)||X.isReadableStream(t))return t;if(t&&X.isString(t)&&(r&&!this.responseType||o)){const a=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(s){if(a)throw s.name==="SyntaxError"?De.from(s,De.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:kr.classes.FormData,Blob:kr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};X.forEach(["delete","get","head","post","put","patch"],e=>{Uu.headers[e]={}});const aT=X.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),sT=e=>{const t={};let n,r,o;return e&&e.split(`
`).forEach(function(a){o=a.indexOf(":"),n=a.substring(0,o).trim().toLowerCase(),r=a.substring(o+1).trim(),!(!n||t[n]&&aT[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},c1=Symbol("internals");function Rs(e){return e&&String(e).trim().toLowerCase()}function oc(e){return e===!1||e==null?e:X.isArray(e)?e.map(oc):String(e)}function uT(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const lT=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function mp(e,t,n,r,o){if(X.isFunction(r))return r.call(this,t,n);if(o&&(t=n),!!X.isString(t)){if(X.isString(r))return t.indexOf(r)!==-1;if(X.isRegExp(r))return r.test(t)}}function cT(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function fT(e,t){const n=X.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(o,i,a){return this[r].call(this,t,o,i,a)},configurable:!0})})}class On{constructor(t){t&&this.set(t)}set(t,n,r){const o=this;function i(s,u,l){const c=Rs(u);if(!c)throw new Error("header name must be a non-empty string");const f=X.findKey(o,c);(!f||o[f]===void 0||l===!0||l===void 0&&o[f]!==!1)&&(o[f||u]=oc(s))}const a=(s,u)=>X.forEach(s,(l,c)=>i(l,c,u));if(X.isPlainObject(t)||t instanceof this.constructor)a(t,n);else if(X.isString(t)&&(t=t.trim())&&!lT(t))a(sT(t),n);else if(X.isHeaders(t))for(const[s,u]of t.entries())i(u,s,r);else t!=null&&i(n,t,r);return this}get(t,n){if(t=Rs(t),t){const r=X.findKey(this,t);if(r){const o=this[r];if(!n)return o;if(n===!0)return uT(o);if(X.isFunction(n))return n.call(this,o,r);if(X.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Rs(t),t){const r=X.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||mp(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let o=!1;function i(a){if(a=Rs(a),a){const s=X.findKey(r,a);s&&(!n||mp(r,r[s],s,n))&&(delete r[s],o=!0)}}return X.isArray(t)?t.forEach(i):i(t),o}clear(t){const n=Object.keys(this);let r=n.length,o=!1;for(;r--;){const i=n[r];(!t||mp(this,this[i],i,t,!0))&&(delete this[i],o=!0)}return o}normalize(t){const n=this,r={};return X.forEach(this,(o,i)=>{const a=X.findKey(r,i);if(a){n[a]=oc(o),delete n[i];return}const s=t?cT(i):String(i).trim();s!==i&&delete n[i],n[s]=oc(o),r[s]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return X.forEach(this,(r,o)=>{r!=null&&r!==!1&&(n[o]=t&&X.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(o=>r.set(o)),r}static accessor(t){const r=(this[c1]=this[c1]={accessors:{}}).accessors,o=this.prototype;function i(a){const s=Rs(a);r[s]||(fT(o,a),r[s]=!0)}return X.isArray(t)?t.forEach(i):i(t),this}}On.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);X.reduceDescriptors(On.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});X.freezeMethods(On);function gp(e,t){const n=this||Uu,r=t||n,o=On.from(r.headers);let i=r.data;return X.forEach(e,function(s){i=s.call(n,i,o.normalize(),t?t.status:void 0)}),o.normalize(),i}function lS(e){return!!(e&&e.__CANCEL__)}function ds(e,t,n){De.call(this,e??"canceled",De.ERR_CANCELED,t,n),this.name="CanceledError"}X.inherits(ds,De,{__CANCEL__:!0});function cS(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new De("Request failed with status code "+n.status,[De.ERR_BAD_REQUEST,De.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function dT(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function pT(e,t){e=e||10;const n=new Array(e),r=new Array(e);let o=0,i=0,a;return t=t!==void 0?t:1e3,function(u){const l=Date.now(),c=r[i];a||(a=l),n[o]=u,r[o]=l;let f=i,d=0;for(;f!==o;)d+=n[f++],f=f%e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),l-a<t)return;const p=c&&l-c;return p?Math.round(d*1e3/p):void 0}}function hT(e,t){let n=0;const r=1e3/t;let o=null;return function(){const a=this===!0,s=Date.now();if(a||s-n>r)return o&&(clearTimeout(o),o=null),n=s,e.apply(null,arguments);o||(o=setTimeout(()=>(o=null,n=Date.now(),e.apply(null,arguments)),r-(s-n)))}}const Fc=(e,t,n=3)=>{let r=0;const o=pT(50,250);return hT(i=>{const a=i.loaded,s=i.lengthComputable?i.total:void 0,u=a-r,l=o(u),c=a<=s;r=a;const f={loaded:a,total:s,progress:s?a/s:void 0,bytes:u,rate:l||void 0,estimated:l&&s&&c?(s-a)/l:void 0,event:i,lengthComputable:s!=null};f[t?"download":"upload"]=!0,e(f)},n)},vT=kr.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function o(i){let a=i;return t&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=o(window.location.href),function(a){const s=X.isString(a)?o(a):a;return s.protocol===r.protocol&&s.host===r.host}}():function(){return function(){return!0}}(),mT=kr.hasStandardBrowserEnv?{write(e,t,n,r,o,i){const a=[e+"="+encodeURIComponent(t)];X.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),X.isString(r)&&a.push("path="+r),X.isString(o)&&a.push("domain="+o),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function gT(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function yT(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function fS(e,t){return e&&!gT(t)?yT(e,t):t}const f1=e=>e instanceof On?{...e}:e;function $i(e,t){t=t||{};const n={};function r(l,c,f){return X.isPlainObject(l)&&X.isPlainObject(c)?X.merge.call({caseless:f},l,c):X.isPlainObject(c)?X.merge({},c):X.isArray(c)?c.slice():c}function o(l,c,f){if(X.isUndefined(c)){if(!X.isUndefined(l))return r(void 0,l,f)}else return r(l,c,f)}function i(l,c){if(!X.isUndefined(c))return r(void 0,c)}function a(l,c){if(X.isUndefined(c)){if(!X.isUndefined(l))return r(void 0,l)}else return r(void 0,c)}function s(l,c,f){if(f in t)return r(l,c);if(f in e)return r(void 0,l)}const u={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(l,c)=>o(f1(l),f1(c),!0)};return X.forEach(Object.keys(Object.assign({},e,t)),function(c){const f=u[c]||o,d=f(e[c],t[c],c);X.isUndefined(d)&&f!==s||(n[c]=d)}),n}const dS=e=>{const t=$i({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:i,headers:a,auth:s}=t;t.headers=a=On.from(a),t.url=aS(fS(t.baseURL,t.url),e.params,e.paramsSerializer),s&&a.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let u;if(X.isFormData(n)){if(kr.hasStandardBrowserEnv||kr.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((u=a.getContentType())!==!1){const[l,...c]=u?u.split(";").map(f=>f.trim()).filter(Boolean):[];a.setContentType([l||"multipart/form-data",...c].join("; "))}}if(kr.hasStandardBrowserEnv&&(r&&X.isFunction(r)&&(r=r(t)),r||r!==!1&&vT(t.url))){const l=o&&i&&mT.read(i);l&&a.set(o,l)}return t},bT=typeof XMLHttpRequest<"u",xT=bT&&function(e){return new Promise(function(n,r){const o=dS(e);let i=o.data;const a=On.from(o.headers).normalize();let{responseType:s}=o,u;function l(){o.cancelToken&&o.cancelToken.unsubscribe(u),o.signal&&o.signal.removeEventListener("abort",u)}let c=new XMLHttpRequest;c.open(o.method.toUpperCase(),o.url,!0),c.timeout=o.timeout;function f(){if(!c)return;const p=On.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),m={data:!s||s==="text"||s==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:p,config:e,request:c};cS(function(v){n(v),l()},function(v){r(v),l()},m),c=null}"onloadend"in c?c.onloadend=f:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(f)},c.onabort=function(){c&&(r(new De("Request aborted",De.ECONNABORTED,o,c)),c=null)},c.onerror=function(){r(new De("Network Error",De.ERR_NETWORK,o,c)),c=null},c.ontimeout=function(){let h=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const m=o.transitional||sS;o.timeoutErrorMessage&&(h=o.timeoutErrorMessage),r(new De(h,m.clarifyTimeoutError?De.ETIMEDOUT:De.ECONNABORTED,o,c)),c=null},i===void 0&&a.setContentType(null),"setRequestHeader"in c&&X.forEach(a.toJSON(),function(h,m){c.setRequestHeader(m,h)}),X.isUndefined(o.withCredentials)||(c.withCredentials=!!o.withCredentials),s&&s!=="json"&&(c.responseType=o.responseType),typeof o.onDownloadProgress=="function"&&c.addEventListener("progress",Fc(o.onDownloadProgress,!0)),typeof o.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",Fc(o.onUploadProgress)),(o.cancelToken||o.signal)&&(u=p=>{c&&(r(!p||p.type?new ds(null,e,c):p),c.abort(),c=null)},o.cancelToken&&o.cancelToken.subscribe(u),o.signal&&(o.signal.aborted?u():o.signal.addEventListener("abort",u)));const d=dT(o.url);if(d&&kr.protocols.indexOf(d)===-1){r(new De("Unsupported protocol "+d+":",De.ERR_BAD_REQUEST,e));return}c.send(i||null)})},wT=(e,t)=>{let n=new AbortController,r;const o=function(u){if(!r){r=!0,a();const l=u instanceof Error?u:this.reason;n.abort(l instanceof De?l:new ds(l instanceof Error?l.message:l))}};let i=t&&setTimeout(()=>{o(new De(`timeout ${t} of ms exceeded`,De.ETIMEDOUT))},t);const a=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u&&(u.removeEventListener?u.removeEventListener("abort",o):u.unsubscribe(o))}),e=null)};e.forEach(u=>u&&u.addEventListener&&u.addEventListener("abort",o));const{signal:s}=n;return s.unsubscribe=a,[s,()=>{i&&clearTimeout(i),i=null}]},ST=function*(e,t){let n=e.byteLength;if(!t||n<t){yield e;return}let r=0,o;for(;r<n;)o=r+t,yield e.slice(r,o),r=o},CT=async function*(e,t,n){for await(const r of e)yield*ST(ArrayBuffer.isView(r)?r:await n(String(r)),t)},d1=(e,t,n,r,o)=>{const i=CT(e,t,o);let a=0;return new ReadableStream({type:"bytes",async pull(s){const{done:u,value:l}=await i.next();if(u){s.close(),r();return}let c=l.byteLength;n&&n(a+=c),s.enqueue(new Uint8Array(l))},cancel(s){return r(s),i.return()}},{highWaterMark:2})},p1=(e,t)=>{const n=e!=null;return r=>setTimeout(()=>t({lengthComputable:n,total:e,loaded:r}))},Kf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",pS=Kf&&typeof ReadableStream=="function",cv=Kf&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),ET=pS&&(()=>{let e=!1;const t=new Request(kr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})(),h1=64*1024,fv=pS&&!!(()=>{try{return X.isReadableStream(new Response("").body)}catch{}})(),Lc={stream:fv&&(e=>e.body)};Kf&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Lc[t]&&(Lc[t]=X.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new De(`Response type '${t}' is not supported`,De.ERR_NOT_SUPPORT,r)})})})(new Response);const _T=async e=>{if(e==null)return 0;if(X.isBlob(e))return e.size;if(X.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(X.isArrayBufferView(e))return e.byteLength;if(X.isURLSearchParams(e)&&(e=e+""),X.isString(e))return(await cv(e)).byteLength},kT=async(e,t)=>{const n=X.toFiniteNumber(e.getContentLength());return n??_T(t)},RT=Kf&&(async e=>{let{url:t,method:n,data:r,signal:o,cancelToken:i,timeout:a,onDownloadProgress:s,onUploadProgress:u,responseType:l,headers:c,withCredentials:f="same-origin",fetchOptions:d}=dS(e);l=l?(l+"").toLowerCase():"text";let[p,h]=o||i||a?wT([o,i],a):[],m,g;const v=()=>{!m&&setTimeout(()=>{p&&p.unsubscribe()}),m=!0};let y;try{if(u&&ET&&n!=="get"&&n!=="head"&&(y=await kT(c,r))!==0){let S=new Request(t,{method:"POST",body:r,duplex:"half"}),E;X.isFormData(r)&&(E=S.headers.get("content-type"))&&c.setContentType(E),S.body&&(r=d1(S.body,h1,p1(y,Fc(u)),null,cv))}X.isString(f)||(f=f?"cors":"omit"),g=new Request(t,{...d,signal:p,method:n.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",withCredentials:f});let b=await fetch(g);const x=fv&&(l==="stream"||l==="response");if(fv&&(s||x)){const S={};["status","statusText","headers"].forEach(C=>{S[C]=b[C]});const E=X.toFiniteNumber(b.headers.get("content-length"));b=new Response(d1(b.body,h1,s&&p1(E,Fc(s,!0)),x&&v,cv),S)}l=l||"text";let w=await Lc[X.findKey(Lc,l)||"text"](b,e);return!x&&v(),h&&h(),await new Promise((S,E)=>{cS(S,E,{data:w,headers:On.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:g})})}catch(b){throw v(),b&&b.name==="TypeError"&&/fetch/i.test(b.message)?Object.assign(new De("Network Error",De.ERR_NETWORK,e,g),{cause:b.cause||b}):De.from(b,b&&b.code,e,g)}}),dv={http:zO,xhr:xT,fetch:RT};X.forEach(dv,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const v1=e=>`- ${e}`,PT=e=>X.isFunction(e)||e===null||e===!1,hS={getAdapter:e=>{e=X.isArray(e)?e:[e];const{length:t}=e;let n,r;const o={};for(let i=0;i<t;i++){n=e[i];let a;if(r=n,!PT(n)&&(r=dv[(a=String(n)).toLowerCase()],r===void 0))throw new De(`Unknown adapter '${a}'`);if(r)break;o[a||"#"+i]=r}if(!r){const i=Object.entries(o).map(([s,u])=>`adapter ${s} `+(u===!1?"is not supported by the environment":"is not available in the build"));let a=t?i.length>1?`since :
`+i.map(v1).join(`
`):" "+v1(i[0]):"as no adapter specified";throw new De("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:dv};function yp(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ds(null,e)}function m1(e){return yp(e),e.headers=On.from(e.headers),e.data=gp.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),hS.getAdapter(e.adapter||Uu.adapter)(e).then(function(r){return yp(e),r.data=gp.call(e,e.transformResponse,r),r.headers=On.from(r.headers),r},function(r){return lS(r)||(yp(e),r&&r.response&&(r.response.data=gp.call(e,e.transformResponse,r.response),r.response.headers=On.from(r.response.headers))),Promise.reject(r)})}const vS="1.7.2",og={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{og[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const g1={};og.transitional=function(t,n,r){function o(i,a){return"[Axios v"+vS+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,s)=>{if(t===!1)throw new De(o(a," has been removed"+(n?" in "+n:"")),De.ERR_DEPRECATED);return n&&!g1[a]&&(g1[a]=!0,console.warn(o(a," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,a,s):!0}};function IT(e,t,n){if(typeof e!="object")throw new De("options must be an object",De.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;for(;o-- >0;){const i=r[o],a=t[i];if(a){const s=e[i],u=s===void 0||a(s,i,e);if(u!==!0)throw new De("option "+i+" must be "+u,De.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new De("Unknown option "+i,De.ERR_BAD_OPTION)}}const pv={assertOptions:IT,validators:og},Po=pv.validators;class Di{constructor(t){this.defaults=t,this.interceptors={request:new l1,response:new l1}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let o;Error.captureStackTrace?Error.captureStackTrace(o={}):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=$i(this.defaults,n);const{transitional:r,paramsSerializer:o,headers:i}=n;r!==void 0&&pv.assertOptions(r,{silentJSONParsing:Po.transitional(Po.boolean),forcedJSONParsing:Po.transitional(Po.boolean),clarifyTimeoutError:Po.transitional(Po.boolean)},!1),o!=null&&(X.isFunction(o)?n.paramsSerializer={serialize:o}:pv.assertOptions(o,{encode:Po.function,serialize:Po.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=i&&X.merge(i.common,i[n.method]);i&&X.forEach(["delete","get","head","post","put","patch","common"],h=>{delete i[h]}),n.headers=On.concat(a,i);const s=[];let u=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(u=u&&m.synchronous,s.unshift(m.fulfilled,m.rejected))});const l=[];this.interceptors.response.forEach(function(m){l.push(m.fulfilled,m.rejected)});let c,f=0,d;if(!u){const h=[m1.bind(this),void 0];for(h.unshift.apply(h,s),h.push.apply(h,l),d=h.length,c=Promise.resolve(n);f<d;)c=c.then(h[f++],h[f++]);return c}d=s.length;let p=n;for(f=0;f<d;){const h=s[f++],m=s[f++];try{p=h(p)}catch(g){m.call(this,g);break}}try{c=m1.call(this,p)}catch(h){return Promise.reject(h)}for(f=0,d=l.length;f<d;)c=c.then(l[f++],l[f++]);return c}getUri(t){t=$i(this.defaults,t);const n=fS(t.baseURL,t.url);return aS(n,t.params,t.paramsSerializer)}}X.forEach(["delete","get","head","options"],function(t){Di.prototype[t]=function(n,r){return this.request($i(r||{},{method:t,url:n,data:(r||{}).data}))}});X.forEach(["post","put","patch"],function(t){function n(r){return function(i,a,s){return this.request($i(s||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}Di.prototype[t]=n(),Di.prototype[t+"Form"]=n(!0)});class ig{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(o=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](o);r._listeners=null}),this.promise.then=o=>{let i;const a=new Promise(s=>{r.subscribe(s),i=s}).then(o);return a.cancel=function(){r.unsubscribe(i)},a},t(function(i,a,s){r.reason||(r.reason=new ds(i,a,s),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new ig(function(o){t=o}),cancel:t}}}function OT(e){return function(n){return e.apply(null,n)}}function TT(e){return X.isObject(e)&&e.isAxiosError===!0}const hv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hv).forEach(([e,t])=>{hv[t]=e});function mS(e){const t=new Di(e),n=K2(Di.prototype.request,t);return X.extend(n,Di.prototype,t,{allOwnKeys:!0}),X.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return mS($i(e,o))},n}const kt=mS(Uu);kt.Axios=Di;kt.CanceledError=ds;kt.CancelToken=ig;kt.isCancel=lS;kt.VERSION=vS;kt.toFormData=qf;kt.AxiosError=De;kt.Cancel=kt.CanceledError;kt.all=function(t){return Promise.all(t)};kt.spread=OT;kt.isAxiosError=TT;kt.mergeConfig=$i;kt.AxiosHeaders=On;kt.formToJSON=e=>uS(X.isHTMLForm(e)?new FormData(e):e);kt.getAdapter=hS.getAdapter;kt.HttpStatusCode=hv;kt.default=kt;const DT="https://api.themoviedb.org/3",NT="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIwOGNkNGVlNjUzMTkxNDNiNWQ4N2U3ZmQyMDZjMjY2OSIsInN1YiI6IjY2NWMwNzAzMjBlMGYxYTQwMDkxODMxOSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.prM0LMObejNPEKMOf3fhx5ZjCAeABHfJAtKjmrCFMdI",AT={Authorization:"bearer "+NT},Vi=async(e,t)=>{try{const{data:n}=await kt.get(DT+e,{headers:AT,params:t});return n}catch(n){return console.log(n),n}};var gS={exports:{}},yS={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Za=N;function MT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var FT=typeof Object.is=="function"?Object.is:MT,LT=Za.useState,BT=Za.useEffect,jT=Za.useLayoutEffect,$T=Za.useDebugValue;function VT(e,t){var n=t(),r=LT({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return jT(function(){o.value=n,o.getSnapshot=t,bp(o)&&i({inst:o})},[e,n,t]),BT(function(){return bp(o)&&i({inst:o}),e(function(){bp(o)&&i({inst:o})})},[e]),$T(n),n}function bp(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!FT(e,n)}catch{return!0}}function WT(e,t){return t()}var UT=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?WT:VT;yS.useSyncExternalStore=Za.useSyncExternalStore!==void 0?Za.useSyncExternalStore:UT;gS.exports=yS;var zT=gS.exports,bS={exports:{}},xS={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xf=N,HT=zT;function GT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var qT=typeof Object.is=="function"?Object.is:GT,KT=HT.useSyncExternalStore,XT=Xf.useRef,YT=Xf.useEffect,QT=Xf.useMemo,JT=Xf.useDebugValue;xS.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=XT(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=QT(function(){function u(p){if(!l){if(l=!0,c=p,p=r(p),o!==void 0&&a.hasValue){var h=a.value;if(o(h,p))return f=h}return f=p}if(h=f,qT(c,p))return h;var m=r(p);return o!==void 0&&o(h,m)?h:(c=p,f=m)}var l=!1,c,f,d=n===void 0?null:n;return[function(){return u(t())},d===null?void 0:function(){return u(d())}]},[t,n,r,o]);var s=KT(e,i[0],i[1]);return YT(function(){a.hasValue=!0,a.value=s},[s]),JT(s),s};bS.exports=xS;var ZT=bS.exports;function eD(e){e()}let wS=eD;const tD=e=>wS=e,nD=()=>wS,y1=Symbol.for("react-redux-context"),b1=typeof globalThis<"u"?globalThis:{};function rD(){var e;if(!N.createContext)return{};const t=(e=b1[y1])!=null?e:b1[y1]=new Map;let n=t.get(N.createContext);return n||(n=N.createContext(null),t.set(N.createContext,n)),n}const ai=rD();function ag(e=ai){return function(){return N.useContext(e)}}const SS=ag(),oD=()=>{throw new Error("uSES not initialized!")};let CS=oD;const iD=e=>{CS=e},aD=(e,t)=>e===t;function sD(e=ai){const t=e===ai?SS:ag(e);return function(r,o={}){const{equalityFn:i=aD,stabilityCheck:a=void 0,noopCheck:s=void 0}=typeof o=="function"?{equalityFn:o}:o,{store:u,subscription:l,getServerState:c,stabilityCheck:f,noopCheck:d}=t();N.useRef(!0);const p=N.useCallback({[r.name](m){return r(m)}}[r.name],[r,f,a]),h=CS(l.addNestedSub,u.getState,c||u.getState,p,i);return N.useDebugValue(h),h}}const Xi=sD();function Re(){return Re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Re.apply(null,arguments)}function uD(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var ES={exports:{}},Xe={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wt=typeof Symbol=="function"&&Symbol.for,sg=Wt?Symbol.for("react.element"):60103,ug=Wt?Symbol.for("react.portal"):60106,Yf=Wt?Symbol.for("react.fragment"):60107,Qf=Wt?Symbol.for("react.strict_mode"):60108,Jf=Wt?Symbol.for("react.profiler"):60114,Zf=Wt?Symbol.for("react.provider"):60109,ed=Wt?Symbol.for("react.context"):60110,lg=Wt?Symbol.for("react.async_mode"):60111,td=Wt?Symbol.for("react.concurrent_mode"):60111,nd=Wt?Symbol.for("react.forward_ref"):60112,rd=Wt?Symbol.for("react.suspense"):60113,lD=Wt?Symbol.for("react.suspense_list"):60120,od=Wt?Symbol.for("react.memo"):60115,id=Wt?Symbol.for("react.lazy"):60116,cD=Wt?Symbol.for("react.block"):60121,fD=Wt?Symbol.for("react.fundamental"):60117,dD=Wt?Symbol.for("react.responder"):60118,pD=Wt?Symbol.for("react.scope"):60119;function er(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case sg:switch(e=e.type,e){case lg:case td:case Yf:case Jf:case Qf:case rd:return e;default:switch(e=e&&e.$$typeof,e){case ed:case nd:case id:case od:case Zf:return e;default:return t}}case ug:return t}}}function _S(e){return er(e)===td}Xe.AsyncMode=lg;Xe.ConcurrentMode=td;Xe.ContextConsumer=ed;Xe.ContextProvider=Zf;Xe.Element=sg;Xe.ForwardRef=nd;Xe.Fragment=Yf;Xe.Lazy=id;Xe.Memo=od;Xe.Portal=ug;Xe.Profiler=Jf;Xe.StrictMode=Qf;Xe.Suspense=rd;Xe.isAsyncMode=function(e){return _S(e)||er(e)===lg};Xe.isConcurrentMode=_S;Xe.isContextConsumer=function(e){return er(e)===ed};Xe.isContextProvider=function(e){return er(e)===Zf};Xe.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===sg};Xe.isForwardRef=function(e){return er(e)===nd};Xe.isFragment=function(e){return er(e)===Yf};Xe.isLazy=function(e){return er(e)===id};Xe.isMemo=function(e){return er(e)===od};Xe.isPortal=function(e){return er(e)===ug};Xe.isProfiler=function(e){return er(e)===Jf};Xe.isStrictMode=function(e){return er(e)===Qf};Xe.isSuspense=function(e){return er(e)===rd};Xe.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Yf||e===td||e===Jf||e===Qf||e===rd||e===lD||typeof e=="object"&&e!==null&&(e.$$typeof===id||e.$$typeof===od||e.$$typeof===Zf||e.$$typeof===ed||e.$$typeof===nd||e.$$typeof===fD||e.$$typeof===dD||e.$$typeof===pD||e.$$typeof===cD)};Xe.typeOf=er;ES.exports=Xe;var hD=ES.exports,kS=hD,vD={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},mD={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},RS={};RS[kS.ForwardRef]=vD;RS[kS.Memo]=mD;var Qe={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cg=Symbol.for("react.element"),fg=Symbol.for("react.portal"),ad=Symbol.for("react.fragment"),sd=Symbol.for("react.strict_mode"),ud=Symbol.for("react.profiler"),ld=Symbol.for("react.provider"),cd=Symbol.for("react.context"),gD=Symbol.for("react.server_context"),fd=Symbol.for("react.forward_ref"),dd=Symbol.for("react.suspense"),pd=Symbol.for("react.suspense_list"),hd=Symbol.for("react.memo"),vd=Symbol.for("react.lazy"),yD=Symbol.for("react.offscreen"),PS;PS=Symbol.for("react.module.reference");function fr(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case cg:switch(e=e.type,e){case ad:case ud:case sd:case dd:case pd:return e;default:switch(e=e&&e.$$typeof,e){case gD:case cd:case fd:case vd:case hd:case ld:return e;default:return t}}case fg:return t}}}Qe.ContextConsumer=cd;Qe.ContextProvider=ld;Qe.Element=cg;Qe.ForwardRef=fd;Qe.Fragment=ad;Qe.Lazy=vd;Qe.Memo=hd;Qe.Portal=fg;Qe.Profiler=ud;Qe.StrictMode=sd;Qe.Suspense=dd;Qe.SuspenseList=pd;Qe.isAsyncMode=function(){return!1};Qe.isConcurrentMode=function(){return!1};Qe.isContextConsumer=function(e){return fr(e)===cd};Qe.isContextProvider=function(e){return fr(e)===ld};Qe.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===cg};Qe.isForwardRef=function(e){return fr(e)===fd};Qe.isFragment=function(e){return fr(e)===ad};Qe.isLazy=function(e){return fr(e)===vd};Qe.isMemo=function(e){return fr(e)===hd};Qe.isPortal=function(e){return fr(e)===fg};Qe.isProfiler=function(e){return fr(e)===ud};Qe.isStrictMode=function(e){return fr(e)===sd};Qe.isSuspense=function(e){return fr(e)===dd};Qe.isSuspenseList=function(e){return fr(e)===pd};Qe.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===ad||e===ud||e===sd||e===dd||e===pd||e===yD||typeof e=="object"&&e!==null&&(e.$$typeof===vd||e.$$typeof===hd||e.$$typeof===ld||e.$$typeof===cd||e.$$typeof===fd||e.$$typeof===PS||e.getModuleId!==void 0)};Qe.typeOf=fr;function bD(){const e=nD();let t=null,n=null;return{clear(){t=null,n=null},notify(){e(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){let r=[],o=t;for(;o;)r.push(o),o=o.next;return r},subscribe(r){let o=!0,i=n={callback:r,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){!o||t===null||(o=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}const x1={notify(){},get:()=>[]};function xD(e,t){let n,r=x1,o=0,i=!1;function a(m){c();const g=r.subscribe(m);let v=!1;return()=>{v||(v=!0,g(),f())}}function s(){r.notify()}function u(){h.onStateChange&&h.onStateChange()}function l(){return i}function c(){o++,n||(n=e.subscribe(u),r=bD())}function f(){o--,n&&o===0&&(n(),n=void 0,r.clear(),r=x1)}function d(){i||(i=!0,c())}function p(){i&&(i=!1,f())}const h={addNestedSub:a,notifyNestedSubs:s,handleChangeWrapper:u,isSubscribed:l,trySubscribe:d,tryUnsubscribe:p,getListeners:()=>r};return h}const wD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",SD=wD?N.useLayoutEffect:N.useEffect;function CD({store:e,context:t,children:n,serverState:r,stabilityCheck:o="once",noopCheck:i="once"}){const a=N.useMemo(()=>{const l=xD(e);return{store:e,subscription:l,getServerState:r?()=>r:void 0,stabilityCheck:o,noopCheck:i}},[e,r,o,i]),s=N.useMemo(()=>e.getState(),[e]);SD(()=>{const{subscription:l}=a;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),s!==e.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[a,s]);const u=t||ai;return N.createElement(u.Provider,{value:a},n)}function IS(e=ai){const t=e===ai?SS:ag(e);return function(){const{store:r}=t();return r}}const ED=IS();function _D(e=ai){const t=e===ai?ED:IS(e);return function(){return t().dispatch}}const kD=_D();iD(ZT.useSyncExternalStoreWithSelector);tD(Bf.unstable_batchedUpdates);function Sr(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(o){return"'"+o+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function si(e){return!!e&&!!e[it]}function mo(e){var t;return!!e&&(function(n){if(!n||typeof n!="object")return!1;var r=Object.getPrototypeOf(n);if(r===null)return!0;var o=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return o===Object||typeof o=="function"&&Function.toString.call(o)===MD}(e)||Array.isArray(e)||!!e[R1]||!!(!((t=e.constructor)===null||t===void 0)&&t[R1])||dg(e)||pg(e))}function Wi(e,t,n){n===void 0&&(n=!1),ps(e)===0?(n?Object.keys:Fa)(e).forEach(function(r){n&&typeof r=="symbol"||t(r,e[r],e)}):e.forEach(function(r,o){return t(o,r,e)})}function ps(e){var t=e[it];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:dg(e)?2:pg(e)?3:0}function Ma(e,t){return ps(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function RD(e,t){return ps(e)===2?e.get(t):e[t]}function OS(e,t,n){var r=ps(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function TS(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function dg(e){return ND&&e instanceof Map}function pg(e){return AD&&e instanceof Set}function xi(e){return e.o||e.t}function hg(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=NS(e);delete t[it];for(var n=Fa(t),r=0;r<n.length;r++){var o=n[r],i=t[o];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function vg(e,t){return t===void 0&&(t=!1),mg(e)||si(e)||!mo(e)||(ps(e)>1&&(e.set=e.add=e.clear=e.delete=PD),Object.freeze(e),t&&Wi(e,function(n,r){return vg(r,!0)},!0)),e}function PD(){Sr(2)}function mg(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function qr(e){var t=yv[e];return t||Sr(18,e),t}function ID(e,t){yv[e]||(yv[e]=t)}function vv(){return Su}function xp(e,t){t&&(qr("Patches"),e.u=[],e.s=[],e.v=t)}function Bc(e){mv(e),e.p.forEach(OD),e.p=null}function mv(e){e===Su&&(Su=e.l)}function w1(e){return Su={p:[],l:Su,h:e,m:!0,_:0}}function OD(e){var t=e[it];t.i===0||t.i===1?t.j():t.g=!0}function wp(e,t){t._=t.p.length;var n=t.p[0],r=e!==void 0&&e!==n;return t.h.O||qr("ES5").S(t,e,r),r?(n[it].P&&(Bc(t),Sr(4)),mo(e)&&(e=jc(t,e),t.l||$c(t,e)),t.u&&qr("Patches").M(n[it].t,e,t.u,t.s)):e=jc(t,n,[]),Bc(t),t.u&&t.v(t.u,t.s),e!==DS?e:void 0}function jc(e,t,n){if(mg(t))return t;var r=t[it];if(!r)return Wi(t,function(s,u){return S1(e,r,t,s,u,n)},!0),t;if(r.A!==e)return t;if(!r.P)return $c(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=r.i===4||r.i===5?r.o=hg(r.k):r.o,i=o,a=!1;r.i===3&&(i=new Set(o),o.clear(),a=!0),Wi(i,function(s,u){return S1(e,r,o,s,u,n,a)}),$c(e,o,!1),n&&e.u&&qr("Patches").N(r,n,e.u,e.s)}return r.o}function S1(e,t,n,r,o,i,a){if(si(o)){var s=jc(e,o,i&&t&&t.i!==3&&!Ma(t.R,r)?i.concat(r):void 0);if(OS(n,r,s),!si(s))return;e.m=!1}else a&&n.add(o);if(mo(o)&&!mg(o)){if(!e.h.D&&e._<1)return;jc(e,o),t&&t.A.l||$c(e,o)}}function $c(e,t,n){n===void 0&&(n=!1),!e.l&&e.h.D&&e.m&&vg(t,n)}function Sp(e,t){var n=e[it];return(n?xi(n):e)[t]}function C1(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Lo(e){e.P||(e.P=!0,e.l&&Lo(e.l))}function Cp(e){e.o||(e.o=hg(e.t))}function gv(e,t,n){var r=dg(t)?qr("MapSet").F(t,n):pg(t)?qr("MapSet").T(t,n):e.O?function(o,i){var a=Array.isArray(o),s={i:a?1:0,A:i?i.A:vv(),P:!1,I:!1,R:{},l:i,t:o,k:null,o:null,j:null,C:!1},u=s,l=Cu;a&&(u=[s],l=$s);var c=Proxy.revocable(u,l),f=c.revoke,d=c.proxy;return s.k=d,s.j=f,d}(t,n):qr("ES5").J(t,n);return(n?n.A:vv()).p.push(r),r}function TD(e){return si(e)||Sr(22,e),function t(n){if(!mo(n))return n;var r,o=n[it],i=ps(n);if(o){if(!o.P&&(o.i<4||!qr("ES5").K(o)))return o.t;o.I=!0,r=E1(n,i),o.I=!1}else r=E1(n,i);return Wi(r,function(a,s){o&&RD(o.t,a)===s||OS(r,a,t(s))}),i===3?new Set(r):r}(e)}function E1(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return hg(e)}function DD(){function e(i,a){var s=o[i];return s?s.enumerable=a:o[i]=s={configurable:!0,enumerable:a,get:function(){var u=this[it];return Cu.get(u,i)},set:function(u){var l=this[it];Cu.set(l,i,u)}},s}function t(i){for(var a=i.length-1;a>=0;a--){var s=i[a][it];if(!s.P)switch(s.i){case 5:r(s)&&Lo(s);break;case 4:n(s)&&Lo(s)}}}function n(i){for(var a=i.t,s=i.k,u=Fa(s),l=u.length-1;l>=0;l--){var c=u[l];if(c!==it){var f=a[c];if(f===void 0&&!Ma(a,c))return!0;var d=s[c],p=d&&d[it];if(p?p.t!==f:!TS(d,f))return!0}}var h=!!a[it];return u.length!==Fa(a).length+(h?0:1)}function r(i){var a=i.k;if(a.length!==i.t.length)return!0;var s=Object.getOwnPropertyDescriptor(a,a.length-1);if(s&&!s.get)return!0;for(var u=0;u<a.length;u++)if(!a.hasOwnProperty(u))return!0;return!1}var o={};ID("ES5",{J:function(i,a){var s=Array.isArray(i),u=function(c,f){if(c){for(var d=Array(f.length),p=0;p<f.length;p++)Object.defineProperty(d,""+p,e(p,!0));return d}var h=NS(f);delete h[it];for(var m=Fa(h),g=0;g<m.length;g++){var v=m[g];h[v]=e(v,c||!!h[v].enumerable)}return Object.create(Object.getPrototypeOf(f),h)}(s,i),l={i:s?5:4,A:a?a.A:vv(),P:!1,I:!1,R:{},l:a,t:i,k:u,o:null,g:!1,C:!1};return Object.defineProperty(u,it,{value:l,writable:!0}),u},S:function(i,a,s){s?si(a)&&a[it].A===i&&t(i.p):(i.u&&function u(l){if(l&&typeof l=="object"){var c=l[it];if(c){var f=c.t,d=c.k,p=c.R,h=c.i;if(h===4)Wi(d,function(b){b!==it&&(f[b]!==void 0||Ma(f,b)?p[b]||u(d[b]):(p[b]=!0,Lo(c)))}),Wi(f,function(b){d[b]!==void 0||Ma(d,b)||(p[b]=!1,Lo(c))});else if(h===5){if(r(c)&&(Lo(c),p.length=!0),d.length<f.length)for(var m=d.length;m<f.length;m++)p[m]=!1;else for(var g=f.length;g<d.length;g++)p[g]=!0;for(var v=Math.min(d.length,f.length),y=0;y<v;y++)d.hasOwnProperty(y)||(p[y]=!0),p[y]===void 0&&u(d[y])}}}}(i.p[0]),t(i.p))},K:function(i){return i.i===4?n(i):r(i)}})}var _1,Su,gg=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",ND=typeof Map<"u",AD=typeof Set<"u",k1=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",DS=gg?Symbol.for("immer-nothing"):((_1={})["immer-nothing"]=!0,_1),R1=gg?Symbol.for("immer-draftable"):"__$immer_draftable",it=gg?Symbol.for("immer-state"):"__$immer_state",MD=""+Object.prototype.constructor,Fa=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,NS=Object.getOwnPropertyDescriptors||function(e){var t={};return Fa(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},yv={},Cu={get:function(e,t){if(t===it)return e;var n=xi(e);if(!Ma(n,t))return function(o,i,a){var s,u=C1(i,a);return u?"value"in u?u.value:(s=u.get)===null||s===void 0?void 0:s.call(o.k):void 0}(e,n,t);var r=n[t];return e.I||!mo(r)?r:r===Sp(e.t,t)?(Cp(e),e.o[t]=gv(e.A.h,r,e)):r},has:function(e,t){return t in xi(e)},ownKeys:function(e){return Reflect.ownKeys(xi(e))},set:function(e,t,n){var r=C1(xi(e),t);if(r!=null&&r.set)return r.set.call(e.k,n),!0;if(!e.P){var o=Sp(xi(e),t),i=o==null?void 0:o[it];if(i&&i.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(TS(n,o)&&(n!==void 0||Ma(e.t,t)))return!0;Cp(e),Lo(e)}return e.o[t]===n&&(n!==void 0||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return Sp(e.t,t)!==void 0||t in e.t?(e.R[t]=!1,Cp(e),Lo(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=xi(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.i!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty:function(){Sr(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Sr(12)}},$s={};Wi(Cu,function(e,t){$s[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),$s.deleteProperty=function(e,t){return $s.set.call(this,e,t,void 0)},$s.set=function(e,t,n){return Cu.set.call(this,e[0],t,n,e[0])};var FD=function(){function e(n){var r=this;this.O=k1,this.D=!0,this.produce=function(o,i,a){if(typeof o=="function"&&typeof i!="function"){var s=i;i=o;var u=r;return function(m){var g=this;m===void 0&&(m=s);for(var v=arguments.length,y=Array(v>1?v-1:0),b=1;b<v;b++)y[b-1]=arguments[b];return u.produce(m,function(x){var w;return(w=i).call.apply(w,[g,x].concat(y))})}}var l;if(typeof i!="function"&&Sr(6),a!==void 0&&typeof a!="function"&&Sr(7),mo(o)){var c=w1(r),f=gv(r,o,void 0),d=!0;try{l=i(f),d=!1}finally{d?Bc(c):mv(c)}return typeof Promise<"u"&&l instanceof Promise?l.then(function(m){return xp(c,a),wp(m,c)},function(m){throw Bc(c),m}):(xp(c,a),wp(l,c))}if(!o||typeof o!="object"){if((l=i(o))===void 0&&(l=o),l===DS&&(l=void 0),r.D&&vg(l,!0),a){var p=[],h=[];qr("Patches").M(o,l,p,h),a(p,h)}return l}Sr(21,o)},this.produceWithPatches=function(o,i){if(typeof o=="function")return function(l){for(var c=arguments.length,f=Array(c>1?c-1:0),d=1;d<c;d++)f[d-1]=arguments[d];return r.produceWithPatches(l,function(p){return o.apply(void 0,[p].concat(f))})};var a,s,u=r.produce(o,i,function(l,c){a=l,s=c});return typeof Promise<"u"&&u instanceof Promise?u.then(function(l){return[l,a,s]}):[u,a,s]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var t=e.prototype;return t.createDraft=function(n){mo(n)||Sr(8),si(n)&&(n=TD(n));var r=w1(this),o=gv(this,n,void 0);return o[it].C=!0,mv(r),o},t.finishDraft=function(n,r){var o=n&&n[it],i=o.A;return xp(i,r),wp(void 0,i)},t.setAutoFreeze=function(n){this.D=n},t.setUseProxies=function(n){n&&!k1&&Sr(20),this.O=n},t.applyPatches=function(n,r){var o;for(o=r.length-1;o>=0;o--){var i=r[o];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}o>-1&&(r=r.slice(o+1));var a=qr("Patches").$;return si(n)?a(n,r):this.produce(n,function(s){return a(s,r)})},e}(),Qn=new FD,LD=Qn.produce;Qn.produceWithPatches.bind(Qn);Qn.setAutoFreeze.bind(Qn);Qn.setUseProxies.bind(Qn);Qn.applyPatches.bind(Qn);Qn.createDraft.bind(Qn);Qn.finishDraft.bind(Qn);const AS=LD;function Ui(e){"@babel/helpers - typeof";return Ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ui(e)}function BD(e,t){if(Ui(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Ui(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MS(e){var t=BD(e,"string");return Ui(t)=="symbol"?t:t+""}function Vs(e,t,n){return(t=MS(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?P1(Object(n),!0).forEach(function(r){Vs(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P1(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function an(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var I1=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Ep=function(){return Math.random().toString(36).substring(7).split("").join(".")},Vc={INIT:"@@redux/INIT"+Ep(),REPLACE:"@@redux/REPLACE"+Ep(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Ep()}};function jD(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function FS(e,t,n){var r;if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(an(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(an(1));return n(FS)(e,t)}if(typeof e!="function")throw new Error(an(2));var o=e,i=t,a=[],s=a,u=!1;function l(){s===a&&(s=a.slice())}function c(){if(u)throw new Error(an(3));return i}function f(m){if(typeof m!="function")throw new Error(an(4));if(u)throw new Error(an(5));var g=!0;return l(),s.push(m),function(){if(g){if(u)throw new Error(an(6));g=!1,l();var y=s.indexOf(m);s.splice(y,1),a=null}}}function d(m){if(!jD(m))throw new Error(an(7));if(typeof m.type>"u")throw new Error(an(8));if(u)throw new Error(an(9));try{u=!0,i=o(i,m)}finally{u=!1}for(var g=a=s,v=0;v<g.length;v++){var y=g[v];y()}return m}function p(m){if(typeof m!="function")throw new Error(an(10));o=m,d({type:Vc.REPLACE})}function h(){var m,g=f;return m={subscribe:function(y){if(typeof y!="object"||y===null)throw new Error(an(11));function b(){y.next&&y.next(c())}b();var x=g(b);return{unsubscribe:x}}},m[I1]=function(){return this},m}return d({type:Vc.INIT}),r={dispatch:d,subscribe:f,getState:c,replaceReducer:p},r[I1]=h,r}function $D(e){Object.keys(e).forEach(function(t){var n=e[t],r=n(void 0,{type:Vc.INIT});if(typeof r>"u")throw new Error(an(12));if(typeof n(void 0,{type:Vc.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(an(13))})}function VD(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];typeof e[o]=="function"&&(n[o]=e[o])}var i=Object.keys(n),a;try{$D(n)}catch(s){a=s}return function(u,l){if(u===void 0&&(u={}),a)throw a;for(var c=!1,f={},d=0;d<i.length;d++){var p=i[d],h=n[p],m=u[p],g=h(m,l);if(typeof g>"u")throw l&&l.type,new Error(an(14));f[p]=g,c=c||g!==m}return c=c||i.length!==Object.keys(u).length,c?f:u}}function Wc(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.length===0?function(r){return r}:t.length===1?t[0]:t.reduce(function(r,o){return function(){return r(o.apply(void 0,arguments))}})}function WD(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return function(){var o=r.apply(void 0,arguments),i=function(){throw new Error(an(15))},a={getState:o.getState,dispatch:function(){return i.apply(void 0,arguments)}},s=t.map(function(u){return u(a)});return i=Wc.apply(void 0,s)(o.dispatch),Se(Se({},o),{},{dispatch:i})}}}function LS(e){var t=function(r){var o=r.dispatch,i=r.getState;return function(a){return function(s){return typeof s=="function"?s(o,i,e):a(s)}}};return t}var bv=LS();bv.withExtraArgument=LS;var BS=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),UD=function(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],o=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},es=function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e},zD=Object.defineProperty,HD=Object.defineProperties,GD=Object.getOwnPropertyDescriptors,O1=Object.getOwnPropertySymbols,qD=Object.prototype.hasOwnProperty,KD=Object.prototype.propertyIsEnumerable,T1=function(e,t,n){return t in e?zD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Qo=function(e,t){for(var n in t||(t={}))qD.call(t,n)&&T1(e,n,t[n]);if(O1)for(var r=0,o=O1(t);r<o.length;r++){var n=o[r];KD.call(t,n)&&T1(e,n,t[n])}return e},_p=function(e,t){return HD(e,GD(t))},XD=function(e,t,n){return new Promise(function(r,o){var i=function(u){try{s(n.next(u))}catch(l){o(l)}},a=function(u){try{s(n.throw(u))}catch(l){o(l)}},s=function(u){return u.done?r(u.value):Promise.resolve(u.value).then(i,a)};s((n=n.apply(e,t)).next())})},YD=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Wc:Wc.apply(null,arguments)};function QD(e){if(typeof e!="object"||e===null)return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(var n=t;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return t===n}function Jo(e,t){function n(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(t){var i=t.apply(void 0,r);if(!i)throw new Error("prepareAction did not return an object");return Qo(Qo({type:e,payload:i.payload},"meta"in i&&{meta:i.meta}),"error"in i&&{error:i.error})}return{type:e,payload:r[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(r){return r.type===e},n}var JD=function(e){BS(t,e);function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.apply(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o}return Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.prototype.concat.apply(this,n)},t.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(t.bind.apply(t,es([void 0],n[0].concat(this)))):new(t.bind.apply(t,es([void 0],n.concat(this))))},t}(Array),ZD=function(e){BS(t,e);function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.apply(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o}return Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.prototype.concat.apply(this,n)},t.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(t.bind.apply(t,es([void 0],n[0].concat(this)))):new(t.bind.apply(t,es([void 0],n.concat(this))))},t}(Array);function xv(e){return mo(e)?AS(e,function(){}):e}function eN(e){return typeof e=="boolean"}function tN(){return function(t){return nN(t)}}function nN(e){e===void 0&&(e={});var t=e.thunk,n=t===void 0?!0:t;e.immutableCheck,e.serializableCheck,e.actionCreatorCheck;var r=new JD;return n&&(eN(n)?r.push(bv):r.push(bv.withExtraArgument(n.extraArgument))),r}var rN=!0;function oN(e){var t=tN(),n=e||{},r=n.reducer,o=r===void 0?void 0:r,i=n.middleware,a=i===void 0?t():i,s=n.devTools,u=s===void 0?!0:s,l=n.preloadedState,c=l===void 0?void 0:l,f=n.enhancers,d=f===void 0?void 0:f,p;if(typeof o=="function")p=o;else if(QD(o))p=VD(o);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var h=a;typeof h=="function"&&(h=h(t));var m=WD.apply(void 0,h),g=Wc;u&&(g=YD(Qo({trace:!rN},typeof u=="object"&&u)));var v=new ZD(m),y=v;Array.isArray(d)?y=es([m],d):typeof d=="function"&&(y=d(v));var b=g.apply(void 0,y);return FS(p,c,b)}function jS(e){var t={},n=[],r,o={addCase:function(i,a){var s=typeof i=="string"?i:i.type;if(!s)throw new Error("`builder.addCase` cannot be called with an empty action type");if(s in t)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return t[s]=a,o},addMatcher:function(i,a){return n.push({matcher:i,reducer:a}),o},addDefaultCase:function(i){return r=i,o}};return e(o),[t,n,r]}function iN(e){return typeof e=="function"}function aN(e,t,n,r){n===void 0&&(n=[]);var o=typeof t=="function"?jS(t):[t,n,r],i=o[0],a=o[1],s=o[2],u;if(iN(e))u=function(){return xv(e())};else{var l=xv(e);u=function(){return l}}function c(f,d){f===void 0&&(f=u());var p=es([i[d.type]],a.filter(function(h){var m=h.matcher;return m(d)}).map(function(h){var m=h.reducer;return m}));return p.filter(function(h){return!!h}).length===0&&(p=[s]),p.reduce(function(h,m){if(m)if(si(h)){var g=h,v=m(g,d);return v===void 0?h:v}else{if(mo(h))return AS(h,function(y){return m(y,d)});var v=m(h,d);if(v===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return v}return h},f)}return c.getInitialState=u,c}function sN(e,t){return e+"/"+t}function uN(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");typeof process<"u";var n=typeof e.initialState=="function"?e.initialState:xv(e.initialState),r=e.reducers||{},o=Object.keys(r),i={},a={},s={};o.forEach(function(c){var f=r[c],d=sN(t,c),p,h;"reducer"in f?(p=f.reducer,h=f.prepare):p=f,i[c]=p,a[d]=p,s[c]=h?Jo(d,h):Jo(d)});function u(){var c=typeof e.extraReducers=="function"?jS(e.extraReducers):[e.extraReducers],f=c[0],d=f===void 0?{}:f,p=c[1],h=p===void 0?[]:p,m=c[2],g=m===void 0?void 0:m,v=Qo(Qo({},d),a);return aN(n,function(y){for(var b in v)y.addCase(b,v[b]);for(var x=0,w=h;x<w.length;x++){var S=w[x];y.addMatcher(S.matcher,S.reducer)}g&&y.addDefaultCase(g)})}var l;return{name:t,reducer:function(c,f){return l||(l=u()),l(c,f)},actions:s,caseReducers:i,getInitialState:function(){return l||(l=u()),l.getInitialState()}}}var lN="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",cN=function(e){e===void 0&&(e=21);for(var t="",n=e;n--;)t+=lN[Math.random()*64|0];return t},fN=["name","message","stack","code"],kp=function(){function e(t,n){this.payload=t,this.meta=n}return e}(),D1=function(){function e(t,n){this.payload=t,this.meta=n}return e}(),dN=function(e){if(typeof e=="object"&&e!==null){for(var t={},n=0,r=fN;n<r.length;n++){var o=r[n];typeof e[o]=="string"&&(t[o]=e[o])}return t}return{message:String(e)}};(function(){function e(t,n,r){var o=Jo(t+"/fulfilled",function(l,c,f,d){return{payload:l,meta:_p(Qo({},d||{}),{arg:f,requestId:c,requestStatus:"fulfilled"})}}),i=Jo(t+"/pending",function(l,c,f){return{payload:void 0,meta:_p(Qo({},f||{}),{arg:c,requestId:l,requestStatus:"pending"})}}),a=Jo(t+"/rejected",function(l,c,f,d,p){return{payload:d,error:(r&&r.serializeError||dN)(l||"Rejected"),meta:_p(Qo({},p||{}),{arg:f,requestId:c,rejectedWithValue:!!d,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"})}}),s=typeof AbortController<"u"?AbortController:function(){function l(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return l.prototype.abort=function(){},l}();function u(l){return function(c,f,d){var p=r!=null&&r.idGenerator?r.idGenerator(l):cN(),h=new s,m;function g(y){m=y,h.abort()}var v=function(){return XD(this,null,function(){var y,b,x,w,S,E,C;return UD(this,function(k){switch(k.label){case 0:return k.trys.push([0,4,,5]),w=(y=r==null?void 0:r.condition)==null?void 0:y.call(r,l,{getState:f,extra:d}),hN(w)?[4,w]:[3,2];case 1:w=k.sent(),k.label=2;case 2:if(w===!1||h.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return S=new Promise(function(_,T){return h.signal.addEventListener("abort",function(){return T({name:"AbortError",message:m||"Aborted"})})}),c(i(p,l,(b=r==null?void 0:r.getPendingMeta)==null?void 0:b.call(r,{requestId:p,arg:l},{getState:f,extra:d}))),[4,Promise.race([S,Promise.resolve(n(l,{dispatch:c,getState:f,extra:d,requestId:p,signal:h.signal,abort:g,rejectWithValue:function(_,T){return new kp(_,T)},fulfillWithValue:function(_,T){return new D1(_,T)}})).then(function(_){if(_ instanceof kp)throw _;return _ instanceof D1?o(_.payload,p,l,_.meta):o(_,p,l)})])];case 3:return x=k.sent(),[3,5];case 4:return E=k.sent(),x=E instanceof kp?a(null,p,l,E.payload,E.meta):a(E,p,l),[3,5];case 5:return C=r&&!r.dispatchConditionRejection&&a.match(x)&&x.meta.condition,C||c(x),[2,x]}})})}();return Object.assign(v,{abort:g,requestId:p,arg:l,unwrap:function(){return v.then(pN)}})}}return Object.assign(u,{pending:i,rejected:a,fulfilled:o,typePrefix:t})}return e.withTypes=function(){return e},e})();function pN(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function hN(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var yg="listenerMiddleware";Jo(yg+"/add");Jo(yg+"/removeAll");Jo(yg+"/remove");var N1;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);DD();const $S=uN({name:"home",initialState:{url:{},genres:{}},reducers:{getApiConfiguration:(e,t)=>{e.url=t.payload},getGenres:(e,t)=>{e.genres=t.payload}}}),{getApiConfiguration:vN,getGenres:mN}=$S.actions,gN=$S.reducer;var VS={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},A1=_n.createContext&&_n.createContext(VS),Zo=function(){return Zo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Zo.apply(this,arguments)},yN=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n};function WS(e){return e&&e.map(function(t,n){return _n.createElement(t.tag,Zo({key:n},t.attr),WS(t.child))})}function bo(e){return function(t){return _n.createElement(bN,Zo({attr:Zo({},e.attr)},t),WS(e.child))}}function bN(e){var t=function(n){var r=e.attr,o=e.size,i=e.title,a=yN(e,["attr","size","title"]),s=o||n.size||"1em",u;return n.className&&(u=n.className),e.className&&(u=(u?u+" ":"")+e.className),_n.createElement("svg",Zo({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,a,{className:u,style:Zo(Zo({color:e.color||n.color},n.style),e.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),i&&_n.createElement("title",null,i),e.children)};return A1!==void 0?_n.createElement(A1.Consumer,null,function(n){return t(n)}):t(VS)}function M1(e){return bo({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"}}]})(e)}function xN(e){return bo({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M27 193.6c-8.2-8.2-12.2-18.6-12.2-31.2s4-23 12.2-31.2S45.6 119 58.2 119h912.4c12.6 0 23 4 31.2 12.2s12.2 18.6 12.2 31.2-4 23-12.2 31.2-18.6 12.2-31.2 12.2H58.2c-12.6 0-23-4-31.2-12.2zm974.8 285.2c8.2 8.2 12.2 18.6 12.2 31.2s-4 23-12.2 31.2-18.6 12.2-31.2 12.2H58.2c-12.6 0-23-4-31.2-12.2S14.8 522.6 14.8 510s4-23 12.2-31.2 18.6-12.2 31.2-12.2h912.4c12.6 0 23 4 31.2 12.2zm0 347.4c8.2 8.2 12.2 18.6 12.2 31.2s-4 23-12.2 31.2-18.6 12.2-31.2 12.2H58.2c-12.6 0-23-4-31.2-12.2S14.8 870 14.8 857.4s4-23 12.2-31.2S45.6 814 58.2 814h912.4c12.6 0 23 4.2 31.2 12.2z"}}]})(e)}function F1(e){return bo({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M7.116 8l-4.558 4.558.884.884L8 8.884l4.558 4.558.884-.884L8.884 8l4.558-4.558-.884-.884L8 7.116 3.442 2.558l-.884.884L7.116 8z"}}]})(e)}const hn=({children:e})=>P.jsx("div",{className:"contentWrapper",children:e}),wN="/devmood/assets/logo-CA6kzjqT.png",SN=()=>{const[e,t]=N.useState("top"),[n,r]=N.useState(0),[o,i]=N.useState(!1),[a,s]=N.useState(""),[u,l]=N.useState(""),c=Wf(),f=eg();N.useEffect(()=>{window.scrollTo(0,0)},[f]);const d=()=>{window.scrollY>200?window.scrollY>n&&!o?t("hide"):t("show"):t("top"),r(window.scrollY)};N.useEffect(()=>(window.addEventListener("scroll",d),()=>{window.removeEventListener("scroll",d)}),[n]);const p=v=>{v.key==="Enter"&&a.length>0&&(c(`/search/${a}`),setTimeout(()=>{l(!1)},1e3))},h=()=>{i(!1),l(!0)},m=()=>{i(!0),l(!1)},g=v=>{c(v==="movie"?"/explore/movie":"/explore/tv"),i(!1)};return P.jsxs("header",{className:`header ${o?"mobileView":""} ${e}`,children:[P.jsxs(hn,{children:[P.jsx("div",{className:"logo",onClick:()=>c("/devmood/"),children:P.jsx("img",{src:wN,alt:""})}),P.jsxs("ul",{className:"menuItems",children:[P.jsx("li",{className:"menuItem",onClick:()=>g("movie"),children:"Movies"}),P.jsx("li",{className:"menuItem",onClick:()=>g("tv"),children:"TV Shows"}),P.jsx("li",{className:"menuItem",children:P.jsx(M1,{onClick:h})})]}),P.jsxs("div",{className:"mobileMenuItems",children:[P.jsx(M1,{onClick:h}),o?P.jsx(F1,{onClick:()=>i(!1)}):P.jsx(xN,{onClick:m})]})]}),u&&P.jsx("div",{className:"searchBar",children:P.jsx(hn,{children:P.jsxs("div",{className:"searchInput",children:[P.jsx("input",{type:"text",placeholder:"Search for a movie or tv show....",onChange:v=>s(v.target.value),onKeyUp:p}),P.jsx(F1,{onClick:()=>l(!1)})]})})})]})};function CN(e){return bo({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"}}]})(e)}function EN(e){return bo({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"}}]})(e)}function _N(e){return bo({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"}}]})(e)}function kN(e){return bo({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"}}]})(e)}const RN=()=>P.jsx("footer",{className:"footer",children:P.jsxs(hn,{children:[P.jsxs("ul",{className:"menuItems",children:[P.jsx("li",{className:"menuItem",children:"Terms Of Use"}),P.jsx("li",{className:"menuItem",children:"Privacy-Policy"}),P.jsx("li",{className:"menuItem",children:"About"}),P.jsx("li",{className:"menuItem",children:"Blog"}),P.jsx("li",{className:"menuItem",children:"FAQ"})]}),P.jsxs("div",{className:"infoText",children:["MoodFlix is a web application that uses facial expression recognition to detect a user's emotions and age, and then suggests movies and shows based on these factors.",P.jsxs("p",{children:["All rights reserved. Team WorkWizards",P.jsx("p",{children:"Nuh Islam"}),P.jsx("p",{children:"Iftikhr Zakir"}),P.jsx("p",{children:"Noshin Nawar"}),P.jsx("p",{children:"Raiyan Ibrahim"})]})]}),P.jsxs("div",{className:"socialIcons",children:[P.jsx("span",{className:"icon",children:P.jsx(CN,{})}),P.jsx("span",{className:"icon",children:P.jsx(EN,{})}),P.jsx("span",{className:"icon",children:P.jsx(kN,{})}),P.jsx("span",{className:"icon",children:P.jsx(_N,{})})]})]})}),Ir=e=>{const[t,n]=N.useState(null),[r,o]=N.useState(null),[i,a]=N.useState(null);return N.useEffect(()=>{o("loading..."),n(null),a(null),Vi(e).then(s=>{o(!1),n(s)}).catch(s=>{o(!1),a("Something went wrong!")})},[e]),{data:t,loading:r,error:i}};var US={exports:{}};(()=>{var e={296:(o,i,a)=>{var s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,f=parseInt,d=typeof a.g=="object"&&a.g&&a.g.Object===Object&&a.g,p=typeof self=="object"&&self&&self.Object===Object&&self,h=d||p||Function("return this")(),m=Object.prototype.toString,g=Math.max,v=Math.min,y=function(){return h.Date.now()};function b(w){var S=typeof w;return!!w&&(S=="object"||S=="function")}function x(w){if(typeof w=="number")return w;if(function(C){return typeof C=="symbol"||function(k){return!!k&&typeof k=="object"}(C)&&m.call(C)=="[object Symbol]"}(w))return NaN;if(b(w)){var S=typeof w.valueOf=="function"?w.valueOf():w;w=b(S)?S+"":S}if(typeof w!="string")return w===0?w:+w;w=w.replace(s,"");var E=l.test(w);return E||c.test(w)?f(w.slice(2),E?2:8):u.test(w)?NaN:+w}o.exports=function(w,S,E){var C,k,_,T,D,U,j=0,A=!1,M=!1,$=!0;if(typeof w!="function")throw new TypeError("Expected a function");function O(J){var ne=C,ie=k;return C=k=void 0,j=J,T=w.apply(ie,ne)}function L(J){var ne=J-U;return U===void 0||ne>=S||ne<0||M&&J-j>=_}function B(){var J=y();if(L(J))return G(J);D=setTimeout(B,function(ne){var ie=S-(ne-U);return M?v(ie,_-(ne-j)):ie}(J))}function G(J){return D=void 0,$&&C?O(J):(C=k=void 0,T)}function q(){var J=y(),ne=L(J);if(C=arguments,k=this,U=J,ne){if(D===void 0)return function(ie){return j=ie,D=setTimeout(B,S),A?O(ie):T}(U);if(M)return D=setTimeout(B,S),O(U)}return D===void 0&&(D=setTimeout(B,S)),T}return S=x(S)||0,b(E)&&(A=!!E.leading,_=(M="maxWait"in E)?g(x(E.maxWait)||0,S):_,$="trailing"in E?!!E.trailing:$),q.cancel=function(){D!==void 0&&clearTimeout(D),j=0,C=U=k=D=void 0},q.flush=function(){return D===void 0?T:G(y())},q}},96:(o,i,a)=>{var s="Expected a function",u=NaN,l="[object Symbol]",c=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,p=/^0o[0-7]+$/i,h=parseInt,m=typeof a.g=="object"&&a.g&&a.g.Object===Object&&a.g,g=typeof self=="object"&&self&&self.Object===Object&&self,v=m||g||Function("return this")(),y=Object.prototype.toString,b=Math.max,x=Math.min,w=function(){return v.Date.now()};function S(C){var k=typeof C;return!!C&&(k=="object"||k=="function")}function E(C){if(typeof C=="number")return C;if(function(T){return typeof T=="symbol"||function(D){return!!D&&typeof D=="object"}(T)&&y.call(T)==l}(C))return u;if(S(C)){var k=typeof C.valueOf=="function"?C.valueOf():C;C=S(k)?k+"":k}if(typeof C!="string")return C===0?C:+C;C=C.replace(c,"");var _=d.test(C);return _||p.test(C)?h(C.slice(2),_?2:8):f.test(C)?u:+C}o.exports=function(C,k,_){var T=!0,D=!0;if(typeof C!="function")throw new TypeError(s);return S(_)&&(T="leading"in _?!!_.leading:T,D="trailing"in _?!!_.trailing:D),function(U,j,A){var M,$,O,L,B,G,q=0,J=!1,ne=!1,ie=!0;if(typeof U!="function")throw new TypeError(s);function se(ce){var _e=M,ke=$;return M=$=void 0,q=ce,L=U.apply(ke,_e)}function me(ce){var _e=ce-G;return G===void 0||_e>=j||_e<0||ne&&ce-q>=O}function he(){var ce=w();if(me(ce))return Ee(ce);B=setTimeout(he,function(_e){var ke=j-(_e-G);return ne?x(ke,O-(_e-q)):ke}(ce))}function Ee(ce){return B=void 0,ie&&M?se(ce):(M=$=void 0,L)}function Ie(){var ce=w(),_e=me(ce);if(M=arguments,$=this,G=ce,_e){if(B===void 0)return function(ke){return q=ke,B=setTimeout(he,j),J?se(ke):L}(G);if(ne)return B=setTimeout(he,j),se(G)}return B===void 0&&(B=setTimeout(he,j)),L}return j=E(j)||0,S(A)&&(J=!!A.leading,O=(ne="maxWait"in A)?b(E(A.maxWait)||0,j):O,ie="trailing"in A?!!A.trailing:ie),Ie.cancel=function(){B!==void 0&&clearTimeout(B),q=0,M=G=$=B=void 0},Ie.flush=function(){return B===void 0?L:Ee(w())},Ie}(C,k,{leading:T,maxWait:k,trailing:D})}},703:(o,i,a)=>{var s=a(414);function u(){}function l(){}l.resetWarningCache=u,o.exports=function(){function c(p,h,m,g,v,y){if(y!==s){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}function f(){return c}c.isRequired=c;var d={array:c,bigint:c,bool:c,func:c,number:c,object:c,string:c,symbol:c,any:c,arrayOf:f,element:c,elementType:c,instanceOf:f,node:c,objectOf:f,oneOf:f,oneOfType:f,shape:f,exact:f,checkPropTypes:l,resetWarningCache:u};return d.PropTypes=d,d}},697:(o,i,a)=>{o.exports=a(703)()},414:o=>{o.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},t={};function n(o){var i=t[o];if(i!==void 0)return i.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.n=o=>{var i=o&&o.__esModule?()=>o.default:()=>o;return n.d(i,{a:i}),i},n.d=(o,i)=>{for(var a in i)n.o(i,a)&&!n.o(o,a)&&Object.defineProperty(o,a,{enumerable:!0,get:i[a]})},n.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),n.o=(o,i)=>Object.prototype.hasOwnProperty.call(o,i),n.r=o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var r={};(()=>{n.r(r),n.d(r,{LazyLoadComponent:()=>Ye,LazyLoadImage:()=>ys,trackWindowScroll:()=>G});const o=N;var i=n.n(o),a=n(697);const s=Bf;var u=n.n(s);function l(){return typeof window<"u"&&"IntersectionObserver"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype}function c(ee){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},c(ee)}function f(ee,W){var te=Object.keys(ee);if(Object.getOwnPropertySymbols){var oe=Object.getOwnPropertySymbols(ee);W&&(oe=oe.filter(function(Ne){return Object.getOwnPropertyDescriptor(ee,Ne).enumerable})),te.push.apply(te,oe)}return te}function d(ee,W,te){return(W=h(W))in ee?Object.defineProperty(ee,W,{value:te,enumerable:!0,configurable:!0,writable:!0}):ee[W]=te,ee}function p(ee,W){for(var te=0;te<W.length;te++){var oe=W[te];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(ee,h(oe.key),oe)}}function h(ee){var W=function(te,oe){if(c(te)!=="object"||te===null)return te;var Ne=te[Symbol.toPrimitive];if(Ne!==void 0){var Me=Ne.call(te,"string");if(c(Me)!=="object")return Me;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(te)}(ee);return c(W)==="symbol"?W:String(W)}function m(ee,W){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(te,oe){return te.__proto__=oe,te},m(ee,W)}function g(ee){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},g(ee)}var v=function(ee){ee.forEach(function(W){W.isIntersecting&&W.target.onVisible()})},y={},b=function(ee){(function(K,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function");K.prototype=Object.create(Q&&Q.prototype,{constructor:{value:K,writable:!0,configurable:!0}}),Object.defineProperty(K,"prototype",{writable:!1}),Q&&m(K,Q)})(Ve,ee);var W,te,oe,Ne,Me=(oe=Ve,Ne=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var K,Q=g(oe);if(Ne){var ye=g(this).constructor;K=Reflect.construct(Q,arguments,ye)}else K=Q.apply(this,arguments);return function(ve,fe){if(fe&&(c(fe)==="object"||typeof fe=="function"))return fe;if(fe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Le){if(Le===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Le}(ve)}(this,K)});function Ve(K){var Q;if(function(ve,fe){if(!(ve instanceof fe))throw new TypeError("Cannot call a class as a function")}(this,Ve),(Q=Me.call(this,K)).supportsObserver=!K.scrollPosition&&K.useIntersectionObserver&&l(),Q.supportsObserver){var ye=K.threshold;Q.observer=function(ve){return y[ve]=y[ve]||new IntersectionObserver(v,{rootMargin:ve+"px"}),y[ve]}(ye)}return Q}return W=Ve,te=[{key:"componentDidMount",value:function(){this.placeholder&&this.observer&&(this.placeholder.onVisible=this.props.onVisible,this.observer.observe(this.placeholder)),this.supportsObserver||this.updateVisibility()}},{key:"componentWillUnmount",value:function(){this.observer&&this.placeholder&&this.observer.unobserve(this.placeholder)}},{key:"componentDidUpdate",value:function(){this.supportsObserver||this.updateVisibility()}},{key:"getPlaceholderBoundingBox",value:function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.scrollPosition,Q=this.placeholder.getBoundingClientRect(),ye=u().findDOMNode(this.placeholder).style,ve=parseInt(ye.getPropertyValue("margin-left"),10)||0,fe=parseInt(ye.getPropertyValue("margin-top"),10)||0;return{bottom:K.y+Q.bottom+fe,left:K.x+Q.left+ve,right:K.x+Q.right+ve,top:K.y+Q.top+fe}}},{key:"isPlaceholderInViewport",value:function(){if(typeof window>"u"||!this.placeholder)return!1;var K=this.props,Q=K.scrollPosition,ye=K.threshold,ve=this.getPlaceholderBoundingBox(Q),fe=Q.y+window.innerHeight,Le=Q.x,st=Q.x+window.innerWidth,ut=Q.y;return ut-ye<=ve.bottom&&fe+ye>=ve.top&&Le-ye<=ve.right&&st+ye>=ve.left}},{key:"updateVisibility",value:function(){this.isPlaceholderInViewport()&&this.props.onVisible()}},{key:"render",value:function(){var K=this,Q=this.props,ye=Q.className,ve=Q.height,fe=Q.placeholder,Le=Q.style,st=Q.width;if(fe&&typeof fe.type!="function")return i().cloneElement(fe,{ref:function(tt){return K.placeholder=tt}});var ut=function(tt){for(var Ut=1;Ut<arguments.length;Ut++){var St=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?f(Object(St),!0).forEach(function(en){d(tt,en,St[en])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(St)):f(Object(St)).forEach(function(en){Object.defineProperty(tt,en,Object.getOwnPropertyDescriptor(St,en))})}return tt}({display:"inline-block"},Le);return st!==void 0&&(ut.width=st),ve!==void 0&&(ut.height=ve),i().createElement("span",{className:ye,ref:function(tt){return K.placeholder=tt},style:ut},fe)}}],te&&p(W.prototype,te),Object.defineProperty(W,"prototype",{writable:!1}),Ve}(i().Component);b.propTypes={onVisible:a.PropTypes.func.isRequired,className:a.PropTypes.string,height:a.PropTypes.oneOfType([a.PropTypes.number,a.PropTypes.string]),placeholder:a.PropTypes.element,threshold:a.PropTypes.number,useIntersectionObserver:a.PropTypes.bool,scrollPosition:a.PropTypes.shape({x:a.PropTypes.number.isRequired,y:a.PropTypes.number.isRequired}),width:a.PropTypes.oneOfType([a.PropTypes.number,a.PropTypes.string])},b.defaultProps={className:"",placeholder:null,threshold:100,useIntersectionObserver:!0};const x=b;var w=n(296),S=n.n(w),E=n(96),C=n.n(E),k=function(ee){var W=getComputedStyle(ee,null);return W.getPropertyValue("overflow")+W.getPropertyValue("overflow-y")+W.getPropertyValue("overflow-x")};const _=function(ee){if(!(ee instanceof HTMLElement))return window;for(var W=ee;W&&W instanceof HTMLElement;){if(/(scroll|auto)/.test(k(W)))return W;W=W.parentNode}return window};function T(ee){return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},T(ee)}var D=["delayMethod","delayTime"];function U(){return U=Object.assign?Object.assign.bind():function(ee){for(var W=1;W<arguments.length;W++){var te=arguments[W];for(var oe in te)Object.prototype.hasOwnProperty.call(te,oe)&&(ee[oe]=te[oe])}return ee},U.apply(this,arguments)}function j(ee,W){for(var te=0;te<W.length;te++){var oe=W[te];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(ee,(Ne=function(Me,Ve){if(T(Me)!=="object"||Me===null)return Me;var K=Me[Symbol.toPrimitive];if(K!==void 0){var Q=K.call(Me,"string");if(T(Q)!=="object")return Q;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Me)}(oe.key),T(Ne)==="symbol"?Ne:String(Ne)),oe)}var Ne}function A(ee,W){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(te,oe){return te.__proto__=oe,te},A(ee,W)}function M(ee,W){if(W&&(T(W)==="object"||typeof W=="function"))return W;if(W!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $(ee)}function $(ee){if(ee===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee}function O(ee){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},O(ee)}var L=function(){return typeof window>"u"?0:window.scrollX||window.pageXOffset},B=function(){return typeof window>"u"?0:window.scrollY||window.pageYOffset};const G=function(ee){var W=function(te){(function(ye,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function");ye.prototype=Object.create(ve&&ve.prototype,{constructor:{value:ye,writable:!0,configurable:!0}}),Object.defineProperty(ye,"prototype",{writable:!1}),ve&&A(ye,ve)})(Q,te);var oe,Ne,Me,Ve,K=(Me=Q,Ve=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var ye,ve=O(Me);if(Ve){var fe=O(this).constructor;ye=Reflect.construct(ve,arguments,fe)}else ye=ve.apply(this,arguments);return M(this,ye)});function Q(ye){var ve;if(function(Le,st){if(!(Le instanceof st))throw new TypeError("Cannot call a class as a function")}(this,Q),(ve=K.call(this,ye)).useIntersectionObserver=ye.useIntersectionObserver&&l(),ve.useIntersectionObserver)return M(ve);var fe=ve.onChangeScroll.bind($(ve));return ye.delayMethod==="debounce"?ve.delayedScroll=S()(fe,ye.delayTime):ye.delayMethod==="throttle"&&(ve.delayedScroll=C()(fe,ye.delayTime)),ve.state={scrollPosition:{x:L(),y:B()}},ve.baseComponentRef=i().createRef(),ve}return oe=Q,(Ne=[{key:"componentDidMount",value:function(){this.addListeners()}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"componentDidUpdate",value:function(){typeof window>"u"||this.useIntersectionObserver||_(u().findDOMNode(this.baseComponentRef.current))!==this.scrollElement&&(this.removeListeners(),this.addListeners())}},{key:"addListeners",value:function(){typeof window>"u"||this.useIntersectionObserver||(this.scrollElement=_(u().findDOMNode(this.baseComponentRef.current)),this.scrollElement.addEventListener("scroll",this.delayedScroll,{passive:!0}),window.addEventListener("resize",this.delayedScroll,{passive:!0}),this.scrollElement!==window&&window.addEventListener("scroll",this.delayedScroll,{passive:!0}))}},{key:"removeListeners",value:function(){typeof window>"u"||this.useIntersectionObserver||(this.scrollElement.removeEventListener("scroll",this.delayedScroll),window.removeEventListener("resize",this.delayedScroll),this.scrollElement!==window&&window.removeEventListener("scroll",this.delayedScroll))}},{key:"onChangeScroll",value:function(){this.useIntersectionObserver||this.setState({scrollPosition:{x:L(),y:B()}})}},{key:"render",value:function(){var ye=this.props,ve=(ye.delayMethod,ye.delayTime,function(Le,st){if(Le==null)return{};var ut,tt,Ut=function(en,ta){if(en==null)return{};var mi,il,Vy={},Wy=Object.keys(en);for(il=0;il<Wy.length;il++)mi=Wy[il],ta.indexOf(mi)>=0||(Vy[mi]=en[mi]);return Vy}(Le,st);if(Object.getOwnPropertySymbols){var St=Object.getOwnPropertySymbols(Le);for(tt=0;tt<St.length;tt++)ut=St[tt],st.indexOf(ut)>=0||Object.prototype.propertyIsEnumerable.call(Le,ut)&&(Ut[ut]=Le[ut])}return Ut}(ye,D)),fe=this.useIntersectionObserver?null:this.state.scrollPosition;return i().createElement(ee,U({forwardRef:this.baseComponentRef,scrollPosition:fe},ve))}}])&&j(oe.prototype,Ne),Object.defineProperty(oe,"prototype",{writable:!1}),Q}(i().Component);return W.propTypes={delayMethod:a.PropTypes.oneOf(["debounce","throttle"]),delayTime:a.PropTypes.number,useIntersectionObserver:a.PropTypes.bool},W.defaultProps={delayMethod:"throttle",delayTime:300,useIntersectionObserver:!0},W};function q(ee){return q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},q(ee)}function J(ee,W){for(var te=0;te<W.length;te++){var oe=W[te];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(ee,(Ne=function(Me,Ve){if(q(Me)!=="object"||Me===null)return Me;var K=Me[Symbol.toPrimitive];if(K!==void 0){var Q=K.call(Me,"string");if(q(Q)!=="object")return Q;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Me)}(oe.key),q(Ne)==="symbol"?Ne:String(Ne)),oe)}var Ne}function ne(ee,W){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(te,oe){return te.__proto__=oe,te},ne(ee,W)}function ie(ee){return ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},ie(ee)}var se=function(ee){(function(K,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function");K.prototype=Object.create(Q&&Q.prototype,{constructor:{value:K,writable:!0,configurable:!0}}),Object.defineProperty(K,"prototype",{writable:!1}),Q&&ne(K,Q)})(Ve,ee);var W,te,oe,Ne,Me=(oe=Ve,Ne=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var K,Q=ie(oe);if(Ne){var ye=ie(this).constructor;K=Reflect.construct(Q,arguments,ye)}else K=Q.apply(this,arguments);return function(ve,fe){if(fe&&(q(fe)==="object"||typeof fe=="function"))return fe;if(fe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Le){if(Le===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Le}(ve)}(this,K)});function Ve(K){return function(Q,ye){if(!(Q instanceof ye))throw new TypeError("Cannot call a class as a function")}(this,Ve),Me.call(this,K)}return W=Ve,(te=[{key:"render",value:function(){return i().createElement(x,this.props)}}])&&J(W.prototype,te),Object.defineProperty(W,"prototype",{writable:!1}),Ve}(i().Component);const me=G(se);function he(ee){return he=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},he(ee)}function Ee(ee,W){for(var te=0;te<W.length;te++){var oe=W[te];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(ee,(Ne=function(Me,Ve){if(he(Me)!=="object"||Me===null)return Me;var K=Me[Symbol.toPrimitive];if(K!==void 0){var Q=K.call(Me,"string");if(he(Q)!=="object")return Q;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Me)}(oe.key),he(Ne)==="symbol"?Ne:String(Ne)),oe)}var Ne}function Ie(ee,W){return Ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(te,oe){return te.__proto__=oe,te},Ie(ee,W)}function ce(ee){if(ee===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee}function _e(ee){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},_e(ee)}var ke=function(ee){(function(K,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function");K.prototype=Object.create(Q&&Q.prototype,{constructor:{value:K,writable:!0,configurable:!0}}),Object.defineProperty(K,"prototype",{writable:!1}),Q&&Ie(K,Q)})(Ve,ee);var W,te,oe,Ne,Me=(oe=Ve,Ne=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var K,Q=_e(oe);if(Ne){var ye=_e(this).constructor;K=Reflect.construct(Q,arguments,ye)}else K=Q.apply(this,arguments);return function(ve,fe){if(fe&&(he(fe)==="object"||typeof fe=="function"))return fe;if(fe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ce(ve)}(this,K)});function Ve(K){var Q;(function(st,ut){if(!(st instanceof ut))throw new TypeError("Cannot call a class as a function")})(this,Ve),Q=Me.call(this,K);var ye=K.afterLoad,ve=K.beforeLoad,fe=K.scrollPosition,Le=K.visibleByDefault;return Q.state={visible:Le},Le&&(ve(),ye()),Q.onVisible=Q.onVisible.bind(ce(Q)),Q.isScrollTracked=!!(fe&&Number.isFinite(fe.x)&&fe.x>=0&&Number.isFinite(fe.y)&&fe.y>=0),Q}return W=Ve,(te=[{key:"componentDidUpdate",value:function(K,Q){Q.visible!==this.state.visible&&this.props.afterLoad()}},{key:"onVisible",value:function(){this.props.beforeLoad(),this.setState({visible:!0})}},{key:"render",value:function(){if(this.state.visible)return this.props.children;var K=this.props,Q=K.className,ye=K.delayMethod,ve=K.delayTime,fe=K.height,Le=K.placeholder,st=K.scrollPosition,ut=K.style,tt=K.threshold,Ut=K.useIntersectionObserver,St=K.width;return this.isScrollTracked||Ut&&l()?i().createElement(x,{className:Q,height:fe,onVisible:this.onVisible,placeholder:Le,scrollPosition:st,style:ut,threshold:tt,useIntersectionObserver:Ut,width:St}):i().createElement(me,{className:Q,delayMethod:ye,delayTime:ve,height:fe,onVisible:this.onVisible,placeholder:Le,style:ut,threshold:tt,width:St})}}])&&Ee(W.prototype,te),Object.defineProperty(W,"prototype",{writable:!1}),Ve}(i().Component);ke.propTypes={afterLoad:a.PropTypes.func,beforeLoad:a.PropTypes.func,useIntersectionObserver:a.PropTypes.bool,visibleByDefault:a.PropTypes.bool},ke.defaultProps={afterLoad:function(){return{}},beforeLoad:function(){return{}},useIntersectionObserver:!0,visibleByDefault:!1};const Ye=ke;function Ue(ee){return Ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},Ue(ee)}var et=["afterLoad","beforeLoad","delayMethod","delayTime","effect","placeholder","placeholderSrc","scrollPosition","threshold","useIntersectionObserver","visibleByDefault","wrapperClassName","wrapperProps"];function Mn(ee,W){var te=Object.keys(ee);if(Object.getOwnPropertySymbols){var oe=Object.getOwnPropertySymbols(ee);W&&(oe=oe.filter(function(Ne){return Object.getOwnPropertyDescriptor(ee,Ne).enumerable})),te.push.apply(te,oe)}return te}function Fn(ee){for(var W=1;W<arguments.length;W++){var te=arguments[W]!=null?arguments[W]:{};W%2?Mn(Object(te),!0).forEach(function(oe){mn(ee,oe,te[oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(te)):Mn(Object(te)).forEach(function(oe){Object.defineProperty(ee,oe,Object.getOwnPropertyDescriptor(te,oe))})}return ee}function mn(ee,W,te){return(W=vr(W))in ee?Object.defineProperty(ee,W,{value:te,enumerable:!0,configurable:!0,writable:!0}):ee[W]=te,ee}function pr(){return pr=Object.assign?Object.assign.bind():function(ee){for(var W=1;W<arguments.length;W++){var te=arguments[W];for(var oe in te)Object.prototype.hasOwnProperty.call(te,oe)&&(ee[oe]=te[oe])}return ee},pr.apply(this,arguments)}function hr(ee,W){for(var te=0;te<W.length;te++){var oe=W[te];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(ee,vr(oe.key),oe)}}function vr(ee){var W=function(te,oe){if(Ue(te)!=="object"||te===null)return te;var Ne=te[Symbol.toPrimitive];if(Ne!==void 0){var Me=Ne.call(te,"string");if(Ue(Me)!=="object")return Me;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(te)}(ee);return Ue(W)==="symbol"?W:String(W)}function Ln(ee,W){return Ln=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(te,oe){return te.__proto__=oe,te},Ln(ee,W)}function mr(ee){return mr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},mr(ee)}var Bn=function(ee){(function(K,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function");K.prototype=Object.create(Q&&Q.prototype,{constructor:{value:K,writable:!0,configurable:!0}}),Object.defineProperty(K,"prototype",{writable:!1}),Q&&Ln(K,Q)})(Ve,ee);var W,te,oe,Ne,Me=(oe=Ve,Ne=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var K,Q=mr(oe);if(Ne){var ye=mr(this).constructor;K=Reflect.construct(Q,arguments,ye)}else K=Q.apply(this,arguments);return function(ve,fe){if(fe&&(Ue(fe)==="object"||typeof fe=="function"))return fe;if(fe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Le){if(Le===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Le}(ve)}(this,K)});function Ve(K){var Q;return function(ye,ve){if(!(ye instanceof ve))throw new TypeError("Cannot call a class as a function")}(this,Ve),(Q=Me.call(this,K)).state={loaded:!1},Q}return W=Ve,(te=[{key:"onImageLoad",value:function(){var K=this;return this.state.loaded?null:function(Q){K.props.onLoad(Q),K.props.afterLoad(),K.setState({loaded:!0})}}},{key:"getImg",value:function(){var K=this.props,Q=(K.afterLoad,K.beforeLoad,K.delayMethod,K.delayTime,K.effect,K.placeholder,K.placeholderSrc,K.scrollPosition,K.threshold,K.useIntersectionObserver,K.visibleByDefault,K.wrapperClassName,K.wrapperProps,function(ye,ve){if(ye==null)return{};var fe,Le,st=function(tt,Ut){if(tt==null)return{};var St,en,ta={},mi=Object.keys(tt);for(en=0;en<mi.length;en++)St=mi[en],Ut.indexOf(St)>=0||(ta[St]=tt[St]);return ta}(ye,ve);if(Object.getOwnPropertySymbols){var ut=Object.getOwnPropertySymbols(ye);for(Le=0;Le<ut.length;Le++)fe=ut[Le],ve.indexOf(fe)>=0||Object.prototype.propertyIsEnumerable.call(ye,fe)&&(st[fe]=ye[fe])}return st}(K,et));return i().createElement("img",pr({},Q,{onLoad:this.onImageLoad()}))}},{key:"getLazyLoadImage",value:function(){var K=this.props,Q=K.beforeLoad,ye=K.className,ve=K.delayMethod,fe=K.delayTime,Le=K.height,st=K.placeholder,ut=K.scrollPosition,tt=K.style,Ut=K.threshold,St=K.useIntersectionObserver,en=K.visibleByDefault,ta=K.width;return i().createElement(Ye,{beforeLoad:Q,className:ye,delayMethod:ve,delayTime:fe,height:Le,placeholder:st,scrollPosition:ut,style:tt,threshold:Ut,useIntersectionObserver:St,visibleByDefault:en,width:ta},this.getImg())}},{key:"getWrappedLazyLoadImage",value:function(K){var Q=this.props,ye=Q.effect,ve=Q.height,fe=Q.placeholderSrc,Le=Q.width,st=Q.wrapperClassName,ut=Q.wrapperProps,tt=this.state.loaded,Ut=tt?" lazy-load-image-loaded":"",St=tt||!fe?{}:{backgroundImage:"url(".concat(fe,")"),backgroundSize:"100% 100%"};return i().createElement("span",pr({className:st+" lazy-load-image-background "+ye+Ut,style:Fn(Fn({},St),{},{color:"transparent",display:"inline-block",height:ve,width:Le})},ut),K)}},{key:"render",value:function(){var K=this.props,Q=K.effect,ye=K.placeholderSrc,ve=K.visibleByDefault,fe=K.wrapperClassName,Le=K.wrapperProps,st=this.getLazyLoadImage();return(Q||ye)&&!ve||fe||Le?this.getWrappedLazyLoadImage(st):st}}])&&hr(W.prototype,te),Object.defineProperty(W,"prototype",{writable:!1}),Ve}(i().Component);Bn.propTypes={onLoad:a.PropTypes.func,afterLoad:a.PropTypes.func,beforeLoad:a.PropTypes.func,delayMethod:a.PropTypes.string,delayTime:a.PropTypes.number,effect:a.PropTypes.string,placeholderSrc:a.PropTypes.string,threshold:a.PropTypes.number,useIntersectionObserver:a.PropTypes.bool,visibleByDefault:a.PropTypes.bool,wrapperClassName:a.PropTypes.string,wrapperProps:a.PropTypes.object},Bn.defaultProps={onLoad:function(){},afterLoad:function(){return{}},beforeLoad:function(){return{}},delayMethod:"throttle",delayTime:300,effect:"",placeholderSrc:null,threshold:100,useIntersectionObserver:!0,visibleByDefault:!1,wrapperClassName:""};const ys=Bn})(),US.exports=r})();var PN=US.exports;const ei=({src:e,className:t})=>P.jsx(PN.LazyLoadImage,{className:t||"",alt:"",effect:"blur",src:e}),IN=()=>{const[e,t]=N.useState(""),[n,r]=N.useState(""),o=Wf(),{url:i}=Xi(c=>c.home),{data:a,loading:s}=Ir("/movie/upcoming");N.useEffect(()=>{var f,d;const c=i.backdrop+((d=(f=a==null?void 0:a.results)==null?void 0:f[Math.floor(Math.random()*20)])==null?void 0:d.backdrop_path);t(c)},[a]);const u=c=>{c.key==="Enter"&&n.length>0&&o(`/search/${n}`)},l=async()=>{n.length>0&&o(`/search/${n}`)};return P.jsxs("div",{className:"heroBanner",children:[!s&&P.jsx("div",{className:"backdrop-img",children:P.jsx(ei,{src:e})}),P.jsx("div",{className:"opacity-layer"}),P.jsx(hn,{children:P.jsxs("div",{className:"heroBannerContent",children:[P.jsx("span",{className:"title",children:"MoodFlix"}),P.jsx("span",{className:"subTitle",children:"Explore Movies and TV shows for your Mood."}),P.jsxs("div",{className:"searchInput",children:[P.jsx("input",{type:"text",placeholder:"Search for a movie or tv show....",onChange:c=>r(c.target.value),onKeyUp:u}),P.jsx("button",{onClick:l,children:"Search"})]})]})})]})};function ON(e){return bo({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.5 7.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"}}]})(e)}function TN(e){return bo({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"}}]})(e)}var zS={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(zl,function(){var n=1e3,r=6e4,o=36e5,i="millisecond",a="second",s="minute",u="hour",l="day",c="week",f="month",d="quarter",p="year",h="date",m="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(j){var A=["th","st","nd","rd"],M=j%100;return"["+j+(A[(M-20)%10]||A[M]||A[0])+"]"}},b=function(j,A,M){var $=String(j);return!$||$.length>=A?j:""+Array(A+1-$.length).join(M)+j},x={s:b,z:function(j){var A=-j.utcOffset(),M=Math.abs(A),$=Math.floor(M/60),O=M%60;return(A<=0?"+":"-")+b($,2,"0")+":"+b(O,2,"0")},m:function j(A,M){if(A.date()<M.date())return-j(M,A);var $=12*(M.year()-A.year())+(M.month()-A.month()),O=A.clone().add($,f),L=M-O<0,B=A.clone().add($+(L?-1:1),f);return+(-($+(M-O)/(L?O-B:B-O))||0)},a:function(j){return j<0?Math.ceil(j)||0:Math.floor(j)},p:function(j){return{M:f,y:p,w:c,d:l,D:h,h:u,m:s,s:a,ms:i,Q:d}[j]||String(j||"").toLowerCase().replace(/s$/,"")},u:function(j){return j===void 0}},w="en",S={};S[w]=y;var E="$isDayjsObject",C=function(j){return j instanceof D||!(!j||!j[E])},k=function j(A,M,$){var O;if(!A)return w;if(typeof A=="string"){var L=A.toLowerCase();S[L]&&(O=L),M&&(S[L]=M,O=L);var B=A.split("-");if(!O&&B.length>1)return j(B[0])}else{var G=A.name;S[G]=A,O=G}return!$&&O&&(w=O),O||!$&&w},_=function(j,A){if(C(j))return j.clone();var M=typeof A=="object"?A:{};return M.date=j,M.args=arguments,new D(M)},T=x;T.l=k,T.i=C,T.w=function(j,A){return _(j,{locale:A.$L,utc:A.$u,x:A.$x,$offset:A.$offset})};var D=function(){function j(M){this.$L=k(M.locale,null,!0),this.parse(M),this.$x=this.$x||M.x||{},this[E]=!0}var A=j.prototype;return A.parse=function(M){this.$d=function($){var O=$.date,L=$.utc;if(O===null)return new Date(NaN);if(T.u(O))return new Date;if(O instanceof Date)return new Date(O);if(typeof O=="string"&&!/Z$/i.test(O)){var B=O.match(g);if(B){var G=B[2]-1||0,q=(B[7]||"0").substring(0,3);return L?new Date(Date.UTC(B[1],G,B[3]||1,B[4]||0,B[5]||0,B[6]||0,q)):new Date(B[1],G,B[3]||1,B[4]||0,B[5]||0,B[6]||0,q)}}return new Date(O)}(M),this.init()},A.init=function(){var M=this.$d;this.$y=M.getFullYear(),this.$M=M.getMonth(),this.$D=M.getDate(),this.$W=M.getDay(),this.$H=M.getHours(),this.$m=M.getMinutes(),this.$s=M.getSeconds(),this.$ms=M.getMilliseconds()},A.$utils=function(){return T},A.isValid=function(){return this.$d.toString()!==m},A.isSame=function(M,$){var O=_(M);return this.startOf($)<=O&&O<=this.endOf($)},A.isAfter=function(M,$){return _(M)<this.startOf($)},A.isBefore=function(M,$){return this.endOf($)<_(M)},A.$g=function(M,$,O){return T.u(M)?this[$]:this.set(O,M)},A.unix=function(){return Math.floor(this.valueOf()/1e3)},A.valueOf=function(){return this.$d.getTime()},A.startOf=function(M,$){var O=this,L=!!T.u($)||$,B=T.p(M),G=function(Ee,Ie){var ce=T.w(O.$u?Date.UTC(O.$y,Ie,Ee):new Date(O.$y,Ie,Ee),O);return L?ce:ce.endOf(l)},q=function(Ee,Ie){return T.w(O.toDate()[Ee].apply(O.toDate("s"),(L?[0,0,0,0]:[23,59,59,999]).slice(Ie)),O)},J=this.$W,ne=this.$M,ie=this.$D,se="set"+(this.$u?"UTC":"");switch(B){case p:return L?G(1,0):G(31,11);case f:return L?G(1,ne):G(0,ne+1);case c:var me=this.$locale().weekStart||0,he=(J<me?J+7:J)-me;return G(L?ie-he:ie+(6-he),ne);case l:case h:return q(se+"Hours",0);case u:return q(se+"Minutes",1);case s:return q(se+"Seconds",2);case a:return q(se+"Milliseconds",3);default:return this.clone()}},A.endOf=function(M){return this.startOf(M,!1)},A.$set=function(M,$){var O,L=T.p(M),B="set"+(this.$u?"UTC":""),G=(O={},O[l]=B+"Date",O[h]=B+"Date",O[f]=B+"Month",O[p]=B+"FullYear",O[u]=B+"Hours",O[s]=B+"Minutes",O[a]=B+"Seconds",O[i]=B+"Milliseconds",O)[L],q=L===l?this.$D+($-this.$W):$;if(L===f||L===p){var J=this.clone().set(h,1);J.$d[G](q),J.init(),this.$d=J.set(h,Math.min(this.$D,J.daysInMonth())).$d}else G&&this.$d[G](q);return this.init(),this},A.set=function(M,$){return this.clone().$set(M,$)},A.get=function(M){return this[T.p(M)]()},A.add=function(M,$){var O,L=this;M=Number(M);var B=T.p($),G=function(ne){var ie=_(L);return T.w(ie.date(ie.date()+Math.round(ne*M)),L)};if(B===f)return this.set(f,this.$M+M);if(B===p)return this.set(p,this.$y+M);if(B===l)return G(1);if(B===c)return G(7);var q=(O={},O[s]=r,O[u]=o,O[a]=n,O)[B]||1,J=this.$d.getTime()+M*q;return T.w(J,this)},A.subtract=function(M,$){return this.add(-1*M,$)},A.format=function(M){var $=this,O=this.$locale();if(!this.isValid())return O.invalidDate||m;var L=M||"YYYY-MM-DDTHH:mm:ssZ",B=T.z(this),G=this.$H,q=this.$m,J=this.$M,ne=O.weekdays,ie=O.months,se=O.meridiem,me=function(Ie,ce,_e,ke){return Ie&&(Ie[ce]||Ie($,L))||_e[ce].slice(0,ke)},he=function(Ie){return T.s(G%12||12,Ie,"0")},Ee=se||function(Ie,ce,_e){var ke=Ie<12?"AM":"PM";return _e?ke.toLowerCase():ke};return L.replace(v,function(Ie,ce){return ce||function(_e){switch(_e){case"YY":return String($.$y).slice(-2);case"YYYY":return T.s($.$y,4,"0");case"M":return J+1;case"MM":return T.s(J+1,2,"0");case"MMM":return me(O.monthsShort,J,ie,3);case"MMMM":return me(ie,J);case"D":return $.$D;case"DD":return T.s($.$D,2,"0");case"d":return String($.$W);case"dd":return me(O.weekdaysMin,$.$W,ne,2);case"ddd":return me(O.weekdaysShort,$.$W,ne,3);case"dddd":return ne[$.$W];case"H":return String(G);case"HH":return T.s(G,2,"0");case"h":return he(1);case"hh":return he(2);case"a":return Ee(G,q,!0);case"A":return Ee(G,q,!1);case"m":return String(q);case"mm":return T.s(q,2,"0");case"s":return String($.$s);case"ss":return T.s($.$s,2,"0");case"SSS":return T.s($.$ms,3,"0");case"Z":return B}return null}(Ie)||B.replace(":","")})},A.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},A.diff=function(M,$,O){var L,B=this,G=T.p($),q=_(M),J=(q.utcOffset()-this.utcOffset())*r,ne=this-q,ie=function(){return T.m(B,q)};switch(G){case p:L=ie()/12;break;case f:L=ie();break;case d:L=ie()/3;break;case c:L=(ne-J)/6048e5;break;case l:L=(ne-J)/864e5;break;case u:L=ne/o;break;case s:L=ne/r;break;case a:L=ne/n;break;default:L=ne}return O?L:T.a(L)},A.daysInMonth=function(){return this.endOf(f).$D},A.$locale=function(){return S[this.$L]},A.locale=function(M,$){if(!M)return this.$L;var O=this.clone(),L=k(M,$,!0);return L&&(O.$L=L),O},A.clone=function(){return T.w(this.$d,this)},A.toDate=function(){return new Date(this.valueOf())},A.toJSON=function(){return this.isValid()?this.toISOString():null},A.toISOString=function(){return this.$d.toISOString()},A.toString=function(){return this.$d.toUTCString()},j}(),U=D.prototype;return _.prototype=U,[["$ms",i],["$s",a],["$m",s],["$H",u],["$W",l],["$M",f],["$y",p],["$D",h]].forEach(function(j){U[j[1]]=function(A){return this.$g(A,j[0],j[1])}}),_.extend=function(j,A){return j.$i||(j(A,D,_),j.$i=!0),_},_.locale=k,_.isDayjs=C,_.unix=function(j){return _(1e3*j)},_.en=S[w],_.Ls=S,_.p={},_})})(zS);var DN=zS.exports;const Uc=om(DN),bg="/devmood/assets/no-poster-DjFr0uax.png";/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var wv=function(e,t){return wv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},wv(e,t)};function NN(e,t){wv(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var AN=100,MN=100,L1=50,Sv=50,Cv=50;function B1(e){var t=e.className,n=e.counterClockwise,r=e.dashRatio,o=e.pathRadius,i=e.strokeWidth,a=e.style;return N.createElement("path",{className:t,style:Object.assign({},a,LN({pathRadius:o,dashRatio:r,counterClockwise:n})),d:FN({pathRadius:o,counterClockwise:n}),strokeWidth:i,fillOpacity:0})}function FN(e){var t=e.pathRadius,n=e.counterClockwise,r=t,o=n?1:0;return`
      M `+Sv+","+Cv+`
      m 0,-`+r+`
      a `+r+","+r+" "+o+" 1 1 0,"+2*r+`
      a `+r+","+r+" "+o+" 1 1 0,-"+2*r+`
    `}function LN(e){var t=e.counterClockwise,n=e.dashRatio,r=e.pathRadius,o=Math.PI*2*r,i=(1-n)*o;return{strokeDasharray:o+"px "+o+"px",strokeDashoffset:(t?-i:i)+"px"}}var BN=function(e){NN(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getBackgroundPadding=function(){return this.props.background?this.props.backgroundPadding:0},t.prototype.getPathRadius=function(){return L1-this.props.strokeWidth/2-this.getBackgroundPadding()},t.prototype.getPathRatio=function(){var n=this.props,r=n.value,o=n.minValue,i=n.maxValue,a=Math.min(Math.max(r,o),i);return(a-o)/(i-o)},t.prototype.render=function(){var n=this.props,r=n.circleRatio,o=n.className,i=n.classes,a=n.counterClockwise,s=n.styles,u=n.strokeWidth,l=n.text,c=this.getPathRadius(),f=this.getPathRatio();return N.createElement("svg",{className:i.root+" "+o,style:s.root,viewBox:"0 0 "+AN+" "+MN,"data-test-id":"CircularProgressbar"},this.props.background?N.createElement("circle",{className:i.background,style:s.background,cx:Sv,cy:Cv,r:L1}):null,N.createElement(B1,{className:i.trail,counterClockwise:a,dashRatio:r,pathRadius:c,strokeWidth:u,style:s.trail}),N.createElement(B1,{className:i.path,counterClockwise:a,dashRatio:f*r,pathRadius:c,strokeWidth:u,style:s.path}),l?N.createElement("text",{className:i.text,style:s.text,x:Sv,y:Cv},l):null)},t.defaultProps={background:!1,backgroundPadding:0,circleRatio:1,classes:{root:"CircularProgressbar",trail:"CircularProgressbar-trail",path:"CircularProgressbar-path",text:"CircularProgressbar-text",background:"CircularProgressbar-background"},counterClockwise:!1,className:"",maxValue:100,minValue:0,strokeWidth:8,styles:{root:{},trail:{},path:{},text:{},background:{}},text:""},t}(N.Component);function jN(e){var t=e.rotation,n=e.strokeLinecap,r=e.textColor,o=e.textSize,i=e.pathColor,a=e.pathTransition,s=e.pathTransitionDuration,u=e.trailColor,l=e.backgroundColor,c=t==null?void 0:"rotate("+t+"turn)",f=t==null?void 0:"center center";return{root:{},path:Cl({stroke:i,strokeLinecap:n,transform:c,transformOrigin:f,transition:a,transitionDuration:s==null?void 0:s+"s"}),trail:Cl({stroke:u,strokeLinecap:n,transform:c,transformOrigin:f}),text:Cl({fill:r,fontSize:o}),background:Cl({fill:l})}}function Cl(e){return Object.keys(e).forEach(function(t){e[t]==null&&delete e[t]}),e}const xg=({rating:e})=>P.jsx("div",{className:"circleRating",children:P.jsx(BN,{value:e,maxValue:10,text:e,styles:jN({pathColor:e<5?"red":e<7?"orange":"green"})})}),wg=({data:e})=>{const{genres:t}=Xi(n=>n.home);return P.jsx("div",{className:"genres",children:e==null?void 0:e.map(n=>{var r,o;if((r=t[n])!=null&&r.name)return P.jsx("div",{className:"genre",children:(o=t[n])==null?void 0:o.name},n)})})},hs=({data:e,loading:t,endpoint:n,title:r})=>{const o=N.useRef(),{url:i}=Xi(l=>l.home),a=Wf(),s=l=>{const c=o.current,f=l==="left"?c.scrollLeft-(c.offsetWidth+20):c.scrollLeft+(c.offsetWidth+20);c.scrollTo({left:f,behavior:"smooth"})},u=()=>P.jsxs("div",{className:"skeletonItem",children:[P.jsx("div",{className:"posterBlock skeleton"}),P.jsxs("div",{className:"textBlock",children:[P.jsx("div",{className:"title skeleton"}),P.jsx("div",{className:"date skeleton"})]})]});return P.jsx("div",{className:"carousel",children:P.jsxs(hn,{children:[r&&P.jsx("div",{className:"carouselTitle",children:r}),P.jsx(ON,{className:"carouselLeftNav arrow",onClick:()=>s("left")}),P.jsx(TN,{className:"carouselRighttNav arrow",onClick:()=>s("right")}),t?P.jsxs("div",{className:"loadingSkeleton",children:[u(),u(),u(),u(),u()]}):P.jsx("div",{className:"carouselItems",ref:o,children:e==null?void 0:e.map(l=>{const c=l.poster_path?i.poster+l.poster_path:bg;return P.jsxs("div",{className:"carouselItem",onClick:()=>a(`/${l.media_type||n}/${l.id}`),children:[P.jsxs("div",{className:"posterBlock",children:[P.jsx(ei,{src:c}),P.jsx(xg,{rating:l.vote_average.toFixed(1)}),P.jsx(wg,{data:l.genre_ids.slice(0,2)})]}),P.jsxs("div",{className:"textBlock",children:[P.jsx("span",{className:"title",children:l.title||l.name}),P.jsx("span",{className:"date",children:Uc(l.release_date||l.first_air_date).format("MMM D, YYYY")})]})]},l.id)})})]})})},md=({data:e,onTabChange:t})=>{const[n,r]=N.useState(0),[o,i]=N.useState(0),a=(s,u)=>{i(u*100),setTimeout(()=>{r(u)},300),t(s,u)};return P.jsx("div",{className:"switchingTabs",children:P.jsxs("div",{className:"tabItems",children:[e.map((s,u)=>P.jsx("span",{className:`tabItem ${n===u?"active":""}`,onClick:()=>a(s,u),children:s},u)),P.jsx("span",{className:"movingBg",style:{left:o}})]})})},$N=()=>{const[e,t]=N.useState("day"),{data:n,loading:r}=Ir(`/trending/movie/${e}`),o=i=>{t(i==="Day"?"day":"week")};return P.jsxs("div",{className:"carouselSection",children:[P.jsxs(hn,{children:[P.jsx("span",{className:"carouselTitle",children:"Trending"}),P.jsx(md,{data:["Day","Week"],onTabChange:o})]}),P.jsx(hs,{data:n==null?void 0:n.results,loading:r})]})},VN=()=>{const[e,t]=N.useState("movie"),{data:n,loading:r}=Ir(`/${e}/popular`),o=i=>{t(i==="Movies"?"movie":"tv")};return P.jsxs("div",{className:"carouselSection",children:[P.jsxs(hn,{children:[P.jsx("span",{className:"carouselTitle",children:"What's Popular"}),P.jsx(md,{data:["Movies","TV Shows"],onTabChange:o})]}),P.jsx(hs,{data:n==null?void 0:n.results,loading:r,endpoint:e})]})},WN=()=>{const[e,t]=N.useState("movie"),{data:n,loading:r}=Ir(`/${e}/top_rated`),o=i=>{t(i==="Movies"?"movie":"tv")};return P.jsxs("div",{className:"carouselSection",children:[P.jsxs(hn,{children:[P.jsx("span",{className:"carouselTitle",children:"Top Rated"}),P.jsx(md,{data:["Movies","TV Shows"],onTabChange:o})]}),P.jsx(hs,{data:n==null?void 0:n.results,loading:r,endpoint:e})]})},HS=N.createContext(),GS=()=>N.useContext(HS),UN=({children:e})=>{const[t,n]=N.useState(!1),[r,o]=N.useState([]),[i,a]=N.useState([]),s=N.useRef(null),u=()=>{n(!0),a([])},l=()=>{n(!1),s.current&&s.current.srcObject&&s.current.srcObject.getTracks().forEach(f=>f.stop()),a(r)},c=f=>o(f);return P.jsx(HS.Provider,{value:{videoPlaying:t,startVideo:u,stopVideo:l,detections:r,updateDetections:c,videoRef:s,results:i},children:e})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qS=function(e,t){return(qS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(e,t)};function Tr(e,t){function n(){this.constructor=e}qS(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function de(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(l){try{u(r.next(l))}catch(c){i(c)}}function s(l){try{u(r.throw(l))}catch(c){i(c)}}function u(l){l.done?o(l.value):new n(function(c){c(l.value)}).then(a,s)}u((r=r.apply(e,[])).next())})}function pe(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(c[0]===6&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(f){c=[6,f],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var zN=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var o=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+o+"."),this.set(t,o)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return HN(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],u=a[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function HN(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Y(){return KS}var KS=null,zc=new Map,Ev=new Map;function XS(e,t){var n=QS(e,t);return zc.get(n)}function GN(e){return Ev.get(e)}function j1(e){for(var t=zc.entries(),n=[];;){var r=t.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===e&&n.push(s)}return n}function YS(e){var t=e.kernelName,n=e.backendName,r=QS(t,n);if(zc.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");zc.set(r,e)}function qN(e){var t=e.kernelName;Ev.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Ev.set(t,e)}function QS(e,t){return t+"_"+e}function _v(e,t,n){return Math.max(e,Math.min(t,n))}function JS(e){return e%2==0?e:e+1}function KN(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function I(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function qe(e,t,n){n===void 0&&(n=""),I($t(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function vs(e){I(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function ts(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Kr(e)&&!n)for(var r=0;r<e.length;++r)ts(e[r],t,n);else t.push(e);return t}function ge(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function $t(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function wt(e){return e%1==0}function XN(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function kv(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function La(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function $1(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(e())r();else{i++;var s=t(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function YN(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function Ft(e,t){var n=t.length;return I((e=e==null?t.map(function(r,o){return o}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),I(e.every(function(r){return wt(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function Ci(e,t){for(var n=[],r=[],o=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||o?null:Ft(t,e).sort(),a=0,s=0;s<e.length;++s){if(i!=null){if(i[a]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(i[a]==null||i[a]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),i[a]<=s&&a++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Eu(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Hc(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function QN(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function JN(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function ZN(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Kr(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function ZS(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function eA(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Sg(e){return typeof e=="string"||e instanceof String}function tA(e){return typeof e=="boolean"}function nA(e){return typeof e=="number"}function zu(e){return Array.isArray(e)?zu(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":nA(e)?"float32":Sg(e)?"string":tA(e)?"bool":"float32"}function Rv(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Pv(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Xr(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function eC(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=ts(e)),n&&QN(e,t),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)Math.round(e[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function V1(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var u=i[0],l=0;l<u;l++)s[l]=a[o+l];else{u=i[0];var c=i.slice(1),f=c.reduce(function(d,p){return d*p});for(l=0;l<u;l++)s[l]=r(o+l*f,c,a)}return s}(0,e,t)}function tC(e,t){for(var n=Hu(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Hu(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Br(){return Y().platform.now()}function nC(e){e.forEach(function(t){I(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function rA(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Y().platform.encode(e,t)}function Gc(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",Y().platform.decode(e,t)}function W1(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function oA(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}var iA=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new aA)}return e.prototype.profileKernel=function(t,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(l,c,f){if(c!=="float32")return!1;for(var d=0;d<l.length;d++){var p=l[d];if(isNaN(p)||!isFinite(p))return console.warn("Found "+p+" in the result of '"+f+"'"),!0}})(u,s.dtype,t),a.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),i.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),o},e}(),aA=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,o,i,a){var s=typeof o=="number"?La(o+"ms",9):o.error,u=La(t,25),l=n.rank,c=n.size,f=La(n.shape.toString(),14),d="";for(var p in i){var h=i[p].shape||n.shape,m=h.length;d+=p+": "+m+"D "+(m>0?h:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),U1=20,Ps=3,Rp=7;function sA(e,t,n,r){var o=Xr(t),i=function(l,c,f,d){var p=ge(c),h=d[d.length-1],m=new Array(h).fill(0),g=c.length,v=f==="complex64"?Os(l):l;if(g>1)for(var y=0;y<p/h;y++)for(var b=y*h,x=0;x<h;x++)m[x]=Math.max(m[x],Is(v[b+x],0,f).length);return m}(e,t,n,o),a=t.length,s=function l(c,f,d,p,h,m){m===void 0&&(m=!0);var g=d==="complex64"?2:1,v=f[0],y=f.length;if(y===0)return d==="complex64"?[Is(Os(c)[0],0,d)]:d==="bool"?[rC(c[0])]:[c[0].toString()];if(y===1){if(v>U1){var b=Ps*g,x=Array.from(c.slice(0,b)),w=Array.from(c.slice((v-Ps)*g,v*g));return d==="complex64"&&(x=Os(x),w=Os(w)),["["+x.map(function(A,M){return Is(A,h[M],d)}).join(", ")+", ..., "+w.map(function(A,M){return Is(A,h[v-Ps+M],d)}).join(", ")+"]"]}return["["+(d==="complex64"?Os(c):Array.from(c)).map(function(A,M){return Is(A,h[M],d)}).join(", ")+"]"]}var S=f.slice(1),E=p.slice(1),C=p[0]*g,k=[];if(v>U1){for(var _=0;_<Ps;_++){var T=(D=_*C)+C;k.push.apply(k,l(c.slice(D,T),S,d,E,h,!1))}for(k.push("..."),_=v-Ps;_<v;_++)T=(D=_*C)+C,k.push.apply(k,l(c.slice(D,T),S,d,E,h,_===v-1))}else for(_=0;_<v;_++){var D;T=(D=_*C)+C,k.push.apply(k,l(c.slice(D,T),S,d,E,h,_===v-1))}var U=y===2?",":"";for(k[0]="["+k[0]+U,_=1;_<k.length-1;_++)k[_]=" "+k[_]+U;var j=`,
`;for(_=2;_<y;_++)j+=`
`;return k[k.length-1]=" "+k[k.length-1]+"]"+(m?"":j),k}(e,t,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function Is(e,t,n){return La(Array.isArray(e)?parseFloat(e[0].toFixed(Rp))+" + "+parseFloat(e[1].toFixed(Rp))+"j":Sg(e)?"'"+e+"'":n==="bool"?rC(e):parseFloat(e.toFixed(Rp)).toString(),t)}function rC(e){return e===0?"false":"true"}function Os(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var _u=function(){function e(t,n,r){var o=this;if(this.dtype=n,this.shape=t.slice(),this.size=ge(t),r!=null){var i=r.length;I(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Hc(n,this.size),this.strides=Xr(t)}return e.prototype.set=function(t){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),I(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,o=0,i=t;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Wr().makeTensor(this.values,this.shape,this.dtype)},e}(),Wr=null,H=null,oC=null,ct=function(){function e(t,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=ge(t),this.strides=Xr(t),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),I(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,o){return this.throwIfDisposed(),this.reshape([t,n,r,o])},e.prototype.as5D=function(t,n,r,o,i){return this.throwIfDisposed(),this.reshape([t,n,r,o,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),H.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return de(this,void 0,void 0,function(){var t;return pe(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,H.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return H.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return de(this,void 0,void 0,function(){var t;return pe(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,V1(this.shape,t)]}})})},e.prototype.arraySync=function(){return V1(this.shape,this.dataSync())},e.prototype.data=function(){return de(this,void 0,void 0,function(){var t,n;return pe(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Wr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(o){return Gc(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=Wr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return Gc(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return de(this,void 0,void 0,function(){var t;return pe(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Wr().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(Wr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),H.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),H.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),H.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),H.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),H.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),H.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),H.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),sA(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),H.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),H.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),H.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),H.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),H.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),H.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),H.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),H.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),H.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),H.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),H.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),H.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,o,i){return r===void 0&&(r=.001),oC("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,i,o,r)},e.prototype.batchNorm=function(t,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),H.batchNorm(this,t,n,r,o,i)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),H.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),H.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),H.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),H.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),H.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),H.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),H.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),H.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),H.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),H.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),H.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),H.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),H.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),H.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),H.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),H.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),H.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),H.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),H.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),H.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),H.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),H.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),H.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),H.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),H.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),H.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),H.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),H.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),H.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),H.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),H.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),H.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),H.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),H.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),H.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),H.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),H.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),H.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),H.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),H.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),H.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),H.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),H.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),H.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),H.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),H.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),H.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),H.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),H.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),H.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),H.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),H.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),H.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),H.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),H.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),H.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),H.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),H.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),H.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),H.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),H.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),H.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),H.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),H.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),H.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),H.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),H.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),H.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),H.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),H.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),H.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),H.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),H.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),H.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),H.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),H.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),H.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),H.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),H.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),H.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),H.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),H.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),H.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),H.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),H.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),H.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),H.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),H.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),H.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),H.conv1d(this,t,n,r,o,i,a)},e.prototype.conv2d=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),H.conv2d(this,t,n,r,o,i,a)},e.prototype.conv2dTranspose=function(t,n,r,o,i){return this.throwIfDisposed(),H.conv2dTranspose(this,t,n,r,o,i)},e.prototype.depthwiseConv2D=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),H.depthwiseConv2d(this,t,n,r,o,i,a)},e.prototype.separableConv2d=function(t,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),H.separableConv2d(this,t,n,r,o,i,a)},e.prototype.avgPool=function(t,n,r,o){return this.throwIfDisposed(),H.avgPool(this,t,n,r,o)},e.prototype.maxPool=function(t,n,r,o){return this.throwIfDisposed(),H.maxPool(this,t,n,r,o)},e.prototype.localResponseNormalization=function(t,n,r,o){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),H.localResponseNormalization(this,t,n,r,o)},e.prototype.pool=function(t,n,r,o,i){return this.throwIfDisposed(),H.pool(this,t,n,r,o,i)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Wr().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),H.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),H.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),H.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),H.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,o,i,a,s,u){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),H.stridedSlice(this,t,n,r,o,i,a,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),H.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),H.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),H.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),H.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),H.spectral.irfft(this)},e}();Object.defineProperty(ct,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var z1,Iv,Ov,Tv,Dv,ns=function(e){function t(n,r,o,i){var a=e.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return Tr(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!$t(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");Wr().disposeTensor(this),this.dataId=n.dataId,Wr().incRef(this,null)},t.prototype.dispose=function(){Wr().disposeVariable(this),this.isDisposedInternal=!0},t}(ct);Object.defineProperty(ns,Symbol.hasInstance,{value:function(e){return e instanceof ct&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(z1||(z1={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Iv||(Iv={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Ov||(Ov={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Tv||(Tv={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Dv||(Dv={}));var uA={float32:Tv,int32:Iv,bool:Ov,complex64:Dv};function Kt(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return uA[e][t]}function Pp(e){return Kt(e,"int32")}function ht(e,t){if(e.dtype===t.dtype)return[e,t];var n=Kt(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function lA(e,t){I(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function iC(e){var t=[];return function n(r,o,i){if(r!=null){if(r instanceof ct)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var l=s[u];i.has(l)||(i.add(l),n(l,o,i))}}}}(e,t,new Set),t}var Ip,H1=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),cA=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new H1}return e.prototype.ready=function(){return de(this,void 0,void 0,function(){var t,n,r;return pe(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,o.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return de(this,void 0,void 0,function(){var n,r,o;return pe(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new iA(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;j1(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;j1(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=t,t.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,o=this,i=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var o=r();return n(),o}catch(i){throw n(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,o,i){return this.runKernelFunc(null,n,null,t,r,o,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,o,i,a,s){var u,l=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c=[],f=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var d,p=function(y){f&&(c=y.map(function(b){return l.keep(l.clone(b))}))},h=this.state.numBytes,m=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,v=XS(o,this.backendName);return d=v!=null?function(){var y=l.backend.numDataIds();g=v.kernelFunc({inputs:n,attrs:i,backend:l.backend});var b=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,b);var x=b.map(function(S){var E=S.dataId,C=S.shape,k=S.dtype;return l.makeTensorFromDataId(E,C,k)}),w=x.filter(function(S,E){return s[E]});return p((a||[]).slice().concat(w)),x}:function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,p)});var b=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,b),b},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(o,n,function(){return d()}):d()}),f&&this.addTapeNode(o,n,u,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-m,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.makeTensor=function(t,n,r,o){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=t;r==="string"&&Sg(t[0])&&(i=t.map(function(c){return rA(c)}));var a=o.write(i,n,r),s=new ct(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(a),l=eA(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,o){var i=new ct(n,r=r||"float32",t,this.nextTensorId());return this.incRef(i,o),i},e.prototype.makeVariable=function(t,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==t.dtype&&(t=t.asType(o));var i=new ns(t,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(o=t.size*ZS(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof ns||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return de(this,void 0,void 0,function(){var n,r;return pe(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:i},u=GN(t);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(l){return l=l.map(function(c,f){if(c==null){var d=r[f],p=Hu(d.size,d.dtype);return a.makeTensor(p,d.shape,d.dtype)}return c}),o(l.length>1?l:l[0],i)}),this.state.activeTape.push(s)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=iC(t),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,o){var i=this;if(o===void 0&&(o=!1),I(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});I(a instanceof ct,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var f={},d={},p=0;p<l.length;p++)f[l[p].id]=!0;for(p=0;p<u.length;p++){var h=(S=u[p]).inputs;for(var m in h){for(var g=h[m],v=!1,y=0;y<l.length;y++)if(f[g.id]){S.outputs.forEach(function(_){return f[_.id]=!0}),v=!0,d[S.id]=!0;break}if(v)break}}var b={};b[c.id]=!0;var x={};for(p=u.length-1;p>=0;p--)for(h=(S=u[p]).inputs,y=0;y<S.outputs.length;y++)if(b[S.outputs[y].id]){for(var m in h)b[h[m].id]=!0,x[S.id]=!0;break}var w=[];for(p=0;p<u.length;p++){var S;if(d[(S=u[p]).id]&&x[S.id]){var E={};for(var m in S.inputs){var C=S.inputs[m];f[C.id]&&(E[m]=C)}var k=Object.assign({},S);k.inputs=E,k.outputs=S.outputs,w.push(k)}}return w}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[a.id]=r??(u=a.shape,l=tC(ge(u),"float32"),V.makeTensor(l,u,"float32")),function(d,p,h){for(var m=function(v){var y=p[v],b=[];if(y.outputs.forEach(function(E){var C=d[E.id];C!=null?b.push(C):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var x=y.gradient(b),w=function(E){if(!(E in x))throw new Error("Cannot backprop through input "+E+". Available gradients found: "+Object.keys(x)+".");var C=h(function(){return x[E]()});if(C.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+E+" must have 'float32' dtype, but has '"+C.dtype+"'");var k=y.inputs[E];if(!$t(C.shape,k.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+E+"' has shape '"+C.shape+"', which does not match the shape of the input '"+k.shape+"'");if(d[k.id]==null)d[k.id]=C;else{var _=d[k.id];d[k.id]=_.add(C),_.dispose()}};for(var S in y.inputs)w(S)},g=p.length-1;g>=0;g--)m(g)}(c,s,function(d){return i.tidy(d)});var f=n.map(function(d){return c[d.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(d){for(var p=0,h=d.saved;p<h.length;p++)h[p].dispose()}),i.state.activeTape=null),{value:a,grads:f}})},e.prototype.customGrad=function(t){var n=this;return I(Rv(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];I(o.every(function(s){return s instanceof ct}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return I((r=t.apply(void 0,o.concat([u]))).value instanceof ct,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),I(Rv(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];I(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),I(c.every(function(d){return d instanceof ct}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var f={};return c.forEach(function(d,p){f[p]=function(){return d}}),f})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return de(this,void 0,void 0,function(){var n,r;return pe(this,function(o){switch(o.label){case 0:return n=Br(),[4,this.backend.time(t)];case 1:return(r=o.sent()).wallMs=Br()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new H1,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),V=function(){var e=function(){if(Ip==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}Ip=n}return Ip}();if(e._tfengine==null){var t=new zN(e);e._tfengine=new cA(t)}return function(n){KS=n}(e._tfengine.ENV),Wr=function(){return e._tfengine},e._tfengine}();function aC(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var no=Y();no.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),no.registerFlag("IS_BROWSER",function(){return aC()}),no.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),no.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),no.registerFlag("PROD",function(){return!1}),no.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return no.getBool("DEBUG")}),no.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),no.registerFlag("IS_TEST",function(){return!1});var ku,zn,Wn,wi={},Op={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function fA(e,t){wi[e]=t}function Zr(e){e in wi||(wi[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete wi[n]},!1),n===1?r.getContext("webgl",Op)||r.getContext("experimental-webgl",Op):r.getContext("webgl2",Op)}(e));var t=wi[e];return t.isContextLost()?(delete wi[e],Zr(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),wi[e])}function gd(e,t){return[t,e]}function Js(e){var t=ge(e);return kv(Math.ceil(t/4))}function Gu(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Cg(e,t){var n,r,o,i,a,s,u,l,c,f=e;return Y().getNumber("WEBGL_VERSION")===2?(n=f.R32F,r=f.R16F,o=f.RGBA16F,i=f.RGBA32F,a=f.RED,s=4,u=1,l=f.HALF_FLOAT,c=f.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,i=f.RGBA,a=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function be(e,t,n){var r=n();return t&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+vA(o,i))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(ku||(ku={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(zn||(zn={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Wn||(Wn={}));var dA=596e-10,pA=65504;function hA(e){return!!(Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||dA<Math.abs(e)&&Math.abs(e)<pA)}function vA(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function El(e,t,n){return xo(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function mA(e,t,n){var r=xo(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(be(e,t,function(){return e.shaderSource(r,n)}),be(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function gA(e,t,n){var r=xo(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(be(e,t,function(){return e.shaderSource(r,n)}),be(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(o,i){var a=yA.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split(`
`),l=u.length.toString().length+2,c=u.map(function(g,v){return La((v+1).toString(),l)+g}),f=0,d=0;d<c.length;d++)f=Math.max(c[d].length,f);var p=c.slice(0,s-1),h=c.slice(s-1,s),m=c.slice(s);console.log(p.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+La(h[0],f),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(m.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Tp,Dp,yA=/ERROR: [0-9]+:([0-9]+):/g;function bA(e,t){return xo(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function xA(e,t,n){if(be(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Np(e,t,n){if(be(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function wA(e,t,n){var r=xo(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return be(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),be(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function SA(e,t,n){var r=xo(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return be(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),be(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function CA(e,t){return xo(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function EA(e,t){var n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function _A(e,t){return xo(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function G1(e,t,n,r,o,i,a,s){var u=e.getAttribLocation(n,r);return u!==-1&&(be(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,o)}),be(e,t,function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,a,s)}),be(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function kA(e,t,n,r){TA(e,r),be(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),be(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function RA(e,t,n,r){return xo(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function PA(e,t,n){return e.getUniformLocation(t,n)}function IA(e,t,n,r,o,i){be(e,t,function(){return kA(e,t,r,i)}),be(e,t,function(){return e.uniform1i(o,i)})}function Ap(e,t,n,r){be(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),be(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function q1(e,t,n){be(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),be(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function _l(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+OA(e,t))}function OA(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function xo(e,t,n,r){var o=be(e,t,function(){return n()});if(o==null)throw new Error(r);return o}function TA(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function qc(e,t){return t===void 0&&(t=2),ge(e.slice(0,e.length-t))}function Kc(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Mp(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[qc(e)].concat(Kc(e))),t}function DA(e,t){var n;t===void 0&&(t=!1);var r=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?JS(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var o=Ci(e);e=o.newShape}var i=ge(e);if(e.length<=1&&i<=r)return[1,i];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=qc(e),s=2,u=2;return e.length&&(s=(n=Kc(e))[0],u=n[1]),kv(i=a*(s/2)*(u/2)).map(function(l){return 2*l})}return kv(i)}function kl(e){return e%2==0}function Rl(e,t){if($t(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||kl(n)&&kl(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&kl(e[0])&&kl(t[0])}function NA(e){if(Tp==null){var t=Zr(e);Tp=t.getParameter(t.MAX_TEXTURE_SIZE)}return Tp}function AA(e){if(Dp==null){var t=Zr(e);Dp=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Dp)}function MA(e){if(e===0)return 0;var t=Zr(e);return ar(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:ar(t,"EXT_disjoint_timer_query")?1:0}function ar(e,t){return e.getExtension(t)!=null}function K1(e){try{if(Zr(e)!=null)return!0}catch{return!1}return!1}function FA(e){if(e===0)return!1;var t=Zr(e);if(e===1){if(!ar(t,"OES_texture_float"))return!1}else if(!ar(t,"EXT_color_buffer_float"))return!1;return Nv(t)}function LA(e){if(e===0)return!1;var t=Zr(e);if(e!==1){if(ar(t,"EXT_color_buffer_float"))return Nv(t);if(ar(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=Cg(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!ar(t,"OES_texture_float")&&!!ar(t,"WEBGL_color_buffer_float")&&Nv(t)}function Nv(e){var t=Cg(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function BA(e){return e===2&&Zr(e).fenceSync!=null}var Pe=Y();function sC(e){Y().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ue(e,t){return V.tidy(e,t)}function Tn(e){iC(e).forEach(function(t){return t.dispose()})}function jA(e){return V.keep(e)}function Xc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Y().getBool("IS_TEST")||console.warn.apply(console,e)}function pi(e,t){var n=e;if(Kr(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Kr(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&Y().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!Kr(i))return void I(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});I(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),I(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),l=0;l<i.length;++l)o(i[l],u,s.concat(l))}(e,r,[]),r}function X1(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function R(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof ct)return X1(r,e.dtype,t,n),e;var o=zu(e);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),X1(r,o,t,n),e==null||!Kr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=pi(e,o);Kr(e)||Array.isArray(e)||(e=[e]);var s=o!=="string"?eC(e,o,Y().getBool("DEBUG")):ts(e,[],!0);return V.makeTensor(s,a,o)}function Yc(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(o,i){return R(o,t+"["+i+"]",n)},r)}function uC(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function $A(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(e[i++]):o.push(t[a++]);return o}function sn(e,t){for(var n=[],r=e.length,o=0;o<r;o++)t.indexOf(o)===-1&&n.push(e[o]);return[n,t.map(function(i){return e[i]})]}function Dn(e,t){return $A(e,t.map(function(n){return 1}),t)}function Vn(e,t,n){I(uC(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function eo(e,t){if(uC(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(o){return n.push(o)}),n}function Eg(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function to(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function VA(e,t){var n=e[0].length;e.forEach(function(o,i){I(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),I(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(o,i){for(var a=0;a<n;a++)I(a===t||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function rs(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function F(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];V.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),V.endScope(s),s}catch(u){throw V.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}Pe.registerFlag("HAS_WEBGL",function(){return Pe.getNumber("WEBGL_VERSION")>0}),Pe.registerFlag("WEBGL_VERSION",function(){return K1(2)?2:K1(1)?1:0}),Pe.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Pe.get("WEBGL_VERSION")===2}),Pe.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Pe.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Pe.registerFlag("WEBGL_PACK",function(){return Pe.getBool("HAS_WEBGL")}),Pe.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_CLIP",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Pe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_PACK_REDUCE",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_CONV_IM2COL",function(){return Pe.getBool("WEBGL_PACK")}),Pe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return NA(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return AA(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Pe.getNumber("WEBGL_VERSION");return e===0?0:MA(e)}),Pe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Pe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Pe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return FA(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Pe.getBool("WEBGL_FORCE_F16_TEXTURES")&&Pe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Pe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return LA(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return BA(Pe.getNumber("WEBGL_VERSION"))}),Pe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Pe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),oC=sC;var qt=F({complex_:function(e,t){var n=R(e,"real","complex"),r=R(t,"imag","complex");return qe(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),V.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),or=F({real_:function(e){var t=R(e,"input","real");return V.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),Ur=F({imag_:function(e){var t=R(e,"input","imag");return V.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Xt(e,t,n){return hi(e,t,pi(e,n),n)}function hi(e,t,n,r){if(r==null&&(r=zu(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Kr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){nC(t);var o=ge(t),i=ge(n);I(o===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==ge(t.slice(a));I(n[a]===t[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Kr(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?eC(e,r,Y().getBool("DEBUG")):ts(e,[],!0),V.makeTensor(e,t,r)}function ae(e,t){if((Kr(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Kr(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return hi(e,[],[],t)}function _t(e,t){vs(e);var n=pi(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return hi(e,null,n,t)}function ti(e,t,n){if(vs(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=pi(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return hi(e,t,r,n)}function _g(e,t,n){if(vs(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=pi(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return hi(e,t,r,n)}function Cn(e,t,n){if(vs(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=pi(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return hi(e,t,r,n)}function WA(e,t,n){if(vs(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=pi(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return hi(e,t,r,n)}function UA(e,t,n){if(vs(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=pi(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return hi(e,t=t||r,r,n)}function zA(e,t,n,r){return t===void 0&&(t=!0),V.makeVariable(e,t,n,r)}function ms(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=ms(e,"float32"),r=rt(e,"float32");return qt(n,r)}var o=tC(ge(e),t);return V.makeTensor(o,e,t)}function rt(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=rt(e,"float32"),r=rt(e,"float32");return qt(n,r)}var o=Hu(ge(e),t);return V.makeTensor(o,e,t)}function Yr(e,t,n){return V.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function HA(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return V.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function Qc(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return rt([0],r);var o=Hu(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return _t(o,r)}var lC=F({onesLike_:function(e){var t=R(e,"x","onesLike");if(t.dtype==="complex64"){var n=lC(or(t)),r=$e(Ur(t));return qt(n,r)}return V.runKernelFunc(function(o){return o.onesLike(t)},{$x:t},function(o,i){return{$x:function(){return $e(o)}}})}}),$e=F({zerosLike_:function(e){var t=R(e,"x","zerosLike");return V.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return $e(n)}}})}}),Dt=F({concat_:function(e,t){t===void 0&&(t=0),I(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=Yc(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=Ft(t,n[0].shape)[0];var r=rs(n.map(function(s){return s.shape}),t);if(ge(r)===0)return Xt([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});VA(o,t);var i=n,a={axis:t};return V.runKernelFunc(function(s){return s.concat(n,t)},i,function(s){var u=o.map(function(l){return l[t]});return kg(s,u,t).map(function(l){return function(){return l}})},"Concat",a)}}),GA=F({concat1d_:function(e){return Dt(e,0)}}),qA=F({concat2d_:function(e,t){return Dt(e,t)}}),KA=F({concat3d_:function(e,t){return Dt(e,t)}}),XA=F({concat4d_:function(e,t){return Dt(e,t)}}),kg=F({split_:function(e,t,n){n===void 0&&(n=0);var r,o=R(e,"x","split");return n=Ft(n,o.shape)[0],typeof t=="number"?(I(o.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(o.shape[n]/t)):(I(o.shape[n]===t.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),V.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return Dt(i,n)}}})}});function Yi(e,t){return e(t={exports:{}},t.exports),t.exports}var YA=Yi(function(e){(function(t,n,r){function o(s){var u,l=this,c=(u=4022871197,function(f){f=f.toString();for(var d=0;d<f.length;d++){var p=.02519603282416938*(u+=f.charCodeAt(d));p-=u=p>>>0,u=(p*=u)>>>0,u+=4294967296*(p-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var f=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=0|f)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new o(s),c=u&&u.state,f=l.next;return f.int32=function(){return 4294967296*l.next()|0},f.double=function(){return f()+11102230246251565e-32*(2097152*f()|0)},f.quick=f,c&&(typeof c=="object"&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.alea=a})(0,e)}),QA=Yi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.xor128=a})(0,e)}),JA=Yi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^f^f<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.xorwow=a})(0,e)}),ZA=Yi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,f=u.x,d=u.i;return l=f[d],c=(l^=l>>>7)^l<<24,c^=(l=f[d+1&7])^l>>>10,c^=(l=f[d+3&7])^l>>>3,c^=(l=f[d+4&7])^l<<7,l=f[d+7&7],c^=(l^=l<<13)^l<<9,f[d]=c,u.i=d+1&7,c},function(l,c){var f,d=[];if(c===(0|c))d[0]=c;else for(c=""+c,f=0;f<c.length;++f)d[7&f]=d[7&f]<<15^c.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?d[7]=-1:d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.x&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.xorshift7=a})(0,e)}),e3=Yi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,f=u.w,d=u.X,p=u.i;return u.w=f=f+1640531527|0,c=d[p+34&127],l=d[p=p+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=d[p]=c^l,u.i=p,c+(f^f>>>16)|0},function(l,c){var f,d,p,h,m,g=[],v=128;for(c===(0|c)?(d=c,c=null):(c+="\0",d=0,v=Math.max(v,c.length)),p=0,h=-32;h<v;++h)c&&(d^=c.charCodeAt((h+32)%c.length)),h===0&&(m=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,h>=0&&(m=m+1640531527|0,p=(f=g[127&h]^=d+m)==0?p+1:0);for(p>=128&&(g[127&(c&&c.length||0)]=-1),p=127,h=512;h>0;--h)d=g[p+34&127],f=g[p=p+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,g[p]=d^f;l.w=m,l.X=g,l.i=p}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.X&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.xor4096=a})(0,e)}),t3=Yi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var f=u.b,d=u.c,p=u.d,h=u.a;return f=f<<25^f>>>7^d,d=d-p|0,p=p<<24^p>>>8^h,h=h-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-p|0,u.d=p<<16^d>>>16^h,u.a=h-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.tychei=a})(0,e)}),Si=Yi(function(e){(function(t,n){var r,o=this,i=256,a=6,s="random",u=n.pow(i,a),l=n.pow(2,52),c=2*l,f=i-1;function d(v,y,b){var x=[],w=m(function C(k,_){var T,D=[],U=typeof k;if(_&&U=="object")for(T in k)try{D.push(C(k[T],_-1))}catch{}return D.length?D:U=="string"?k:k+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,g(t)]:v??function(){try{var C;return r&&(C=r.randomBytes)?C=C(i):(C=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(C)),g(C)}catch{var k=o.navigator,_=k&&k.plugins;return[+new Date,o,_,o.screen,g(t)]}}(),3),x),S=new p(x),E=function(){for(var C=S.g(a),k=u,_=0;C<l;)C=(C+_)*i,k*=i,_=S.g(1);for(;C>=c;)C/=2,k/=2,_>>>=1;return(C+_)/k};return E.int32=function(){return 0|S.g(4)},E.quick=function(){return S.g(4)/4294967296},E.double=E,m(g(S.S),t),(y.pass||b||function(C,k,_,T){return T&&(T.S&&h(T,S),C.state=function(){return h(S,{})}),_?(n[s]=C,k):C})(E,w,"global"in y?y.global:this==n,y.state)}function p(v){var y,b=v.length,x=this,w=0,S=x.i=x.j=0,E=x.S=[];for(b||(v=[b++]);w<i;)E[w]=w++;for(w=0;w<i;w++)E[w]=E[S=f&S+v[w%b]+(y=E[w])],E[S]=y;(x.g=function(C){for(var k,_=0,T=x.i,D=x.j,U=x.S;C--;)k=U[T=f&T+1],_=_*i+U[f&(U[T]=U[D=f&D+k])+(U[D]=k)];return x.i=T,x.j=D,_})(i)}function h(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function m(v,y){for(var b,x=v+"",w=0;w<x.length;)y[f&w]=f&(b^=19*y[f&w])+x.charCodeAt(w++);return g(y)}function g(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=d,m(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch{}}})([],Math)});Si.alea=YA,Si.xor128=QA,Si.xorwow=JA,Si.xorshift7=ZA,Si.xor4096=e3,Si.tychei=t3;var yd=Si.alea,Rg=function(){function e(t,n,r,o,i){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=yd(a.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),n3=function(){function e(t,n,r,o){this.alpha=t,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=yd(i.toString()),this.randn=new Rg(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(t=o*o)*t,r=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),r3=function(){function e(t,n,r,o){var i=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=yd(o)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Te(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",nC(e),new _u(e,t,n)}function o3(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var cC=F({batchToSpaceND_:function(e,t,n){var r=R(e,"x","batchToSpaceND"),o=t.reduce(function(i,a){return i*a});return I(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),I(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),I(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o}),V.runKernelFunc(function(i){return i.batchToSpaceND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,n)}}})}}),i3=F({broadcastTo_:function(e,t){var n=R(e,"broadcastTo","x"),r=n.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map(function(u,l){return u>1?l:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():V.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),a3=F({cast_:function(e,t){var n=R(e,"x","cast");if(!JN(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return V.runKernelFunc(function(o){return o.cast(n,t)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),s3=F({clone_:function(e){var t=R(e,"x","clone",null);return V.runKernelFunc(function(){return V.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),u3=F({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=R(e,"x","cumsum"),i=eo([t|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=to(1,o.rank)[0],u=V.runKernelFunc(function(l){return l.cumsum(a,s,n,r)},{permutedX:a},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return i!=null&&(u=u.transpose(i)),u}}),l3=F({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=R(e,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return I(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),I(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+r.shape}),I(a%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape}),V.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),rr=F({expandDims_:function(e,t){t===void 0&&(t=0);var n=R(e,"x","expandDims",null);I(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(I(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),Cr(n,r)}}),fC=F({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var o=Te([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return Ba(rr(s,0),[n[0],1,1]);if(n.length===2)return Ba(rr(rr(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ba(rr(rr(rr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),c3=F({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var o=R(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,u=V.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return a===1?u.as1D():u}}),Av=F({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=R(e,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),V.runKernelFunc(function(a){return a.oneHot(o,t,n,r)},{$indices:o},function(a){return{$indices:function(){return rt(o.shape,"float32")}}}).reshape(i)}}),Qi=F({pad_:function(e,t,n){n===void 0&&(n=0);var r=R(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return V.runKernelFunc(function(i){return i.pad(r,t,n)},{x:r},function(i){var a=t.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),f3=F({pad1d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Qi(e,[t],n)}}),d3=F({pad2d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Qi(e,t,n)}}),p3=F({pad3d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Qi(e,t,n)}}),h3=F({pad4d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Qi(e,t,n)}}),v3=F({rand_:function(e,t,n){var r=ge(e),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return V.makeTensor(o,e,n)}}),m3=F({randomNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Rg(t,n,r,!1,o),a=Te(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),g3=F({randomGamma_:function(e,t,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new n3(t,n,r,o),a=Te(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),dC=F({randomUniform_:function(e,t,n,r,o){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=Te(e,r),a=new r3(t,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),Cr=F({reshape_:function(e,t){var n=R(e,"x","reshape",null);t=YN(t,n.size),I(n.size===ge(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return V.runKernelFunc(function(o){return o.reshape(n,t)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),pC=F({spaceToBatchND_:function(e,t,n){var r=R(e,"x","spaceToBatchND");return I(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),I(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),I(r.shape.reduce(function(o,i,a){return a>0&&a<=t.length?o&&(i+n[a-1][0]+n[a-1][1])%t[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),V.runKernelFunc(function(o){return o.spaceToBatchND(r,t,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(t,n)}}})}}),hC=F({squeeze_:function(e,t){var n=R(e,"x","squeeze");return Cr(n,Ci(n.shape,t).newShape)}}),Kn=F({stack_:function(e,t){t===void 0&&(t=0);var n=Yc(e,"tensors","stack");if(I(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;I(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){qe(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){I(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(t)});return Dt(a,t)}}),Ba=F({tile_:function(e,t){var n=R(e,"x","tile",null);I(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],o={reps:t};return V.runKernelFunc(function(i,a){var s=i.tile(n,t);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var u=$e(s);if(s.rank===1)for(var l=0;l<t[0];++l)u=u.add(i.slice([l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(l=0;l<t[0];++l)for(var c=0;c<t[1];++c)u=u.add(i.slice([l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(var f=0;f<t[2];++f)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],f*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(f=0;f<t[2];++f)for(var d=0;d<t[3];++d)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],f*s.shape[2],d*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),y3=F({truncatedNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Rg(t,n,r,!0,o),a=Te(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Nt=F({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=R(e,"x","unstack");I(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return V.runKernelFunc(function(o){return o.unstack(n,t)},{x:n},function(o){return{x:function(){return Kn(o,t)}}},"Unpack",r)}}),b3=function(e,t){return de(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,f;return pe(this,function(d){switch(d.label){case 0:return n=R(e,"x","setdiff1d"),r=R(t,"y","setdiff1d"),I(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),I(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),I(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=d.sent(),[4,r.data()];case 2:for(i=d.sent(),a=new Set(i),s=0,c=0;c<o.length;c++)a.has(o[c])||s++;for(u=new _u([s],n.dtype),l=new _u([s],"int32"),c=0,f=0;c<o.length;c++)a.has(o[c])||(u.values[f]=o[c],l.values[f]=c,f++);return[2,[u.toTensor(),l.toTensor()]]}})})};function Jc(e,t,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function Zc(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function ef(e,t,n,r){r===void 0&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?o.push(t[i-1]*e[i]):o.push(e[i]/t[i-1]):o.push(e[i]);return o}function vC(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function mC(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function gC(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var l=Xr(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,o,u,l]}var yC=30;function Fp(e){return e<=yC?e:Pv(e,Math.floor(Math.sqrt(e)))}function x3(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function w3(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}x3(n,t,e)}function tf(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:ge(t.shape)/u,sliceSize:a,strides:Xr(n.slice(0,o)).concat([1]),outputSize:ge(n)}}function S3(e,t,n){I(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),I(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(i){I(t[i]+n[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},o=0;o<e.rank;++o)r(o)}function Y1(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Pg(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function C3(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=_v(0,i,s-1)}function E3(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?_v(0,i,s):_v(-1,i,s-1)}function bC(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function xC(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function _3(e,t){I(Rv(e),function(){return"The f passed in variableGrads(f) must be a function"}),I(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof ns}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],V.registeredVariables)t.push(V.registeredVariables[r]);var o=n?t.filter(function(c){return!c.trainable}):null,i=t.length;I((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=V.gradients(e,t,null,!0),s=a.value,u=a.grads;I(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),I(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,f){u[f]!=null&&(l[c.name]=u[f])}),o!=null&&o.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function bd(e){return V.customGrad(e)}var wo=F({softmax_:function(e,t){t===void 0&&(t=-1);var n=R(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return V.runKernelFunc(function(r,o){var i=r.softmax(n,t);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),k3=F({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=R(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return bd(function(r,o){var i=r.max(t,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(t,!0).log());return o([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),wC=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),SC=function(){function e(){}return e.prototype.time=function(t){return z("time")},e.prototype.read=function(t){return z("read")},e.prototype.readSync=function(t){return z("readSync")},e.prototype.numDataIds=function(){return z("numDataIds")},e.prototype.disposeData=function(t){return z("disposeData")},e.prototype.write=function(t,n,r){return z("write")},e.prototype.move=function(t,n,r,o){return z("move")},e.prototype.memory=function(){return z("memory")},e.prototype.floatPrecision=function(){return z("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,o){return z("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,z("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return z("slice")},e.prototype.stridedSlice=function(t,n,r,o){return z("stridedSlice")},e.prototype.unstack=function(t,n){return z("unstack")},e.prototype.reverse=function(t,n){return z("reverse")},e.prototype.concat=function(t,n){return z("concat")},e.prototype.neg=function(t){return z("neg")},e.prototype.add=function(t,n){return z("add")},e.prototype.addN=function(t){return z("addN")},e.prototype.subtract=function(t,n){return z("subtract")},e.prototype.multiply=function(t,n){return z("multiply")},e.prototype.realDivide=function(t,n){return z("realDivide")},e.prototype.floorDiv=function(t,n){return z("floorDiv")},e.prototype.sum=function(t,n){return z("sum")},e.prototype.prod=function(t,n){return z("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return z("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return z("argMin")},e.prototype.argMax=function(t,n){return z("argMax")},e.prototype.equal=function(t,n){return z("equal")},e.prototype.notEqual=function(t,n){return z("notEqual")},e.prototype.less=function(t,n){return z("less")},e.prototype.lessEqual=function(t,n){return z("lessEqual")},e.prototype.greater=function(t,n){return z("greater")},e.prototype.greaterEqual=function(t,n){return z("greaterEqual")},e.prototype.logicalNot=function(t){return z("logicalNot")},e.prototype.logicalAnd=function(t,n){return z("logicalAnd")},e.prototype.logicalOr=function(t,n){return z("logicalOr")},e.prototype.where=function(t){return z("where")},e.prototype.select=function(t,n,r){return z("select")},e.prototype.topk=function(t,n,r){return z("topk")},e.prototype.min=function(t,n){return z("min")},e.prototype.minimum=function(t,n){return z("minimum")},e.prototype.mod=function(t,n){return z("mod")},e.prototype.max=function(t,n){return z("max")},e.prototype.maximum=function(t,n){return z("maximum")},e.prototype.all=function(t,n){return z("all")},e.prototype.any=function(t,n){return z("any")},e.prototype.squaredDifference=function(t,n){return z("squaredDifference")},e.prototype.ceil=function(t){return z("ceil")},e.prototype.floor=function(t){return z("floor")},e.prototype.round=function(t){return z("round")},e.prototype.sign=function(t){return z("sign")},e.prototype.isNaN=function(t){return z("isNaN")},e.prototype.isInf=function(t){return z("isInf")},e.prototype.isFinite=function(t){return z("isFinite")},e.prototype.pow=function(t,n){return z("pow")},e.prototype.exp=function(t){return z("exp")},e.prototype.expm1=function(t){return z("expm1")},e.prototype.softmax=function(t,n){return z("softmax")},e.prototype.log=function(t){return z("log")},e.prototype.log1p=function(t){return z("log1p")},e.prototype.sqrt=function(t){return z("sqrt")},e.prototype.rsqrt=function(t){return z("rsqrt")},e.prototype.square=function(t){return z("square")},e.prototype.reciprocal=function(t){return z("reciprocal")},e.prototype.relu=function(t){return z("relu")},e.prototype.relu6=function(t){return z("relu6")},e.prototype.prelu=function(t,n){return z("prelu")},e.prototype.elu=function(t){return z("elu")},e.prototype.eluDer=function(t,n){return z("eluDer")},e.prototype.selu=function(t){return z("selu")},e.prototype.int=function(t){return z("int")},e.prototype.clip=function(t,n,r){return z("clip")},e.prototype.abs=function(t){return z("abs")},e.prototype.complexAbs=function(t){return z("complexAbs")},e.prototype.sigmoid=function(t){return z("sigmoid")},e.prototype.softplus=function(t){return z("softplus")},e.prototype.sin=function(t){return z("sin")},e.prototype.cos=function(t){return z("cos")},e.prototype.tan=function(t){return z("tan")},e.prototype.asin=function(t){return z("asin")},e.prototype.acos=function(t){return z("acos")},e.prototype.atan=function(t){return z("atan")},e.prototype.atan2=function(t,n){return z("atan2")},e.prototype.sinh=function(t){return z("sinh")},e.prototype.cosh=function(t){return z("cosh")},e.prototype.tanh=function(t){return z("tanh")},e.prototype.asinh=function(t){return z("asinh")},e.prototype.acosh=function(t){return z("acosh")},e.prototype.atanh=function(t){return z("atanh")},e.prototype.erf=function(t){return z("erf")},e.prototype.step=function(t,n){return z("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,z("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return z("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return z("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return z("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,z("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return z("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return z("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return z("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return z("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return z("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return z("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return z("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,o){return z("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return z("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return z("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return z("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return z("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return z("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,o){return z("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return z("reshape")},e.prototype.cast=function(t,n){return z("cast")},e.prototype.tile=function(t,n){return z("tile")},e.prototype.pad=function(t,n,r){return z("pad")},e.prototype.transpose=function(t,n){return z("transpose")},e.prototype.gather=function(t,n,r){return z("gather")},e.prototype.gatherND=function(t,n){return z("gatherND")},e.prototype.scatterND=function(t,n,r){return z("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return z("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return z("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,o){return z("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return z("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,o){return z("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return z("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,o,i,a){return z("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,o,i){return z("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,o,i,a,s){return z("LRNGrad")},e.prototype.multinomial=function(t,n,r,o){return z("multinomial")},e.prototype.oneHot=function(t,n,r,o){return z("oneHot")},e.prototype.cumsum=function(t,n,r,o){return z("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,o,i){return z("nonMaxSuppression")},e.prototype.fft=function(t){return z("fft")},e.prototype.ifft=function(t){return z("ifft")},e.prototype.complex=function(t,n){return z("complex")},e.prototype.real=function(t){return z("real")},e.prototype.imag=function(t){return z("imag")},e.prototype.cropAndResize=function(t,n,r,o,i,a){return z("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return z("depthToSpace")},e.prototype.split=function(t,n,r){return z("split")},e.prototype.sparseToDense=function(t,n,r,o){return z("sparseToDense")},e.prototype.diag=function(t){return z("diag")},e.prototype.fill=function(t,n,r){return z("fill")},e.prototype.onesLike=function(t){return z("onesLike")},e.prototype.zerosLike=function(t){return z("zerosLike")},e.prototype.linspace=function(t,n,r){return z("linspace")},e.prototype.dispose=function(){return z("dispose")},e}();function z(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Vo(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o,a=e[i]||1;(t[t.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function At(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1,a=t[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function Be(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];i==null&&(i=1);var a=t[t.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function Ru(e,t,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,u=of(t),l=u[0],c=u[1];if(a==="channelsLast")s=[l,c,e[3],e[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[l,c,e[1],e[1]]}return Ji(e,s,n,r,o,i,!1,a)}function nf(e,t,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,u,l=Mv(t),c=l[0],f=l[1],d=l[2];if(a==="NDHWC")u="channelsLast",s=[c,f,d,e[4],e[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,f,d,e[1],e[1]]}return rf(e,s,n,r,o,!1,u,i)}function Ji(e,t,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3];if(s==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],d=e[1],c=e[2],f=e[3]}var p,h=t[0],m=t[1],g=t[3],v=of(n),y=v[0],b=v[1],x=of(r),w=x[0],S=x[1],E=ja(h,w),C=ja(m,S),k=function(j,A,M,$,O,L,B,G){var q,J,ne;if(typeof j=="number"){q={top:j,bottom:j,left:j,right:j,type:j===0?"VALID":"NUMBER"};var ie=function(ce,_e,ke,Ye,Ue){Ye==null&&(Ye=CC(ce,_e,ke));var et=ce[0],Mn=ce[1],Fn=Zs((et-_e+2*Ye)/ke+1,Ue);I(wt(Fn),function(){return"The output # of rows ("+Fn+") must be an integer. Change the stride and/or zero pad parameters"});var mn=Zs((Mn-_e+2*Ye)/ke+1,Ue);return I(wt(mn),function(){return"The output # of columns ("+mn+") must be an integer. Change the stride and/or zero pad parameters"}),[Fn,mn]}([A,M],L,$,j,G);J=ie[0],ne=ie[1]}else if(j==="same"){J=Math.ceil(A/$),ne=Math.ceil(M/O);var se=Math.max(0,(J-1)*$+L-A),me=Math.max(0,(ne-1)*O+B-M),he=Math.floor(se/2),Ee=se-he,Ie=Math.floor(me/2);q={top:he,bottom:Ee,left:Ie,right:me-Ie,type:"SAME"}}else{if(j!=="valid")throw Error("Unknown padding parameter: "+j);q={top:0,bottom:0,left:0,right:0,type:"VALID"},J=Math.ceil((A-L+1)/$),ne=Math.ceil((M-B+1)/O)}return{padInfo:q,outHeight:J,outWidth:ne}}(o,c,f,y,b,E,C,i),_=k.padInfo,T=k.outHeight,D=k.outWidth,U=a?g*d:g;return s==="channelsFirst"?p=[l,U,T,D]:s==="channelsLast"&&(p=[l,T,D,U]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:f,inChannels:d,outHeight:T,outWidth:D,outChannels:U,padInfo:_,strideHeight:y,strideWidth:b,filterHeight:h,filterWidth:m,effectiveFilterHeight:E,effectiveFilterWidth:C,dilationHeight:w,dilationWidth:S,inShape:e,outShape:p,filterShape:t}}function rf(e,t,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3],p=u[4];if(a==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3],p=e[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=e[0],p=e[1],c=e[2],f=e[3],d=e[4]}var h,m=t[0],g=t[1],v=t[2],y=t[4],b=Mv(n),x=b[0],w=b[1],S=b[2],E=Mv(r),C=E[0],k=E[1],_=E[2],T=ja(m,C),D=ja(g,k),U=ja(v,_),j=function(B,G,q,J,ne,ie,se,me,he,Ee,Ie){var ce,_e,ke,Ye;if(typeof B=="number"){ce={top:B,bottom:B,left:B,right:B,front:B,back:B,type:B===0?"VALID":"NUMBER"};var Ue=function(mr,Bn,ys,ee,W,te){W==null&&(W=CC(mr,Bn,ee));var oe=mr[0],Ne=mr[1],Me=mr[2],Ve=Zs((oe-Bn+2*W)/ee+1,te);I(wt(Ve),function(){return"The output # of depths ("+Ve+") must be an integer. Change the stride and/or zero pad parameters"});var K=Zs((Ne-Bn+2*W)/ee+1,te);I(wt(K),function(){return"The output # of rows ("+K+") must be an integer. Change the stride and/or zero pad parameters"});var Q=Zs((Me-Bn+2*W)/ee+1,te);return I(wt(Q),function(){return"The output # of columns ("+Q+") must be an integer. Change the stride and/or zero pad parameters"}),[Ve,K,Q,ys]}([G,q,J,1],me,1,ne,B,Ie);_e=Ue[0],ke=Ue[1],Ye=Ue[2]}else if(B==="same"){_e=Math.ceil(G/ne),ke=Math.ceil(q/ie),Ye=Math.ceil(J/se);var et=(_e-1)*ne+me-G,Mn=(ke-1)*ie+he-q,Fn=(Ye-1)*se+Ee-J,mn=Math.floor(et/2),pr=et-mn,hr=Math.floor(Mn/2),vr=Mn-hr,Ln=Math.floor(Fn/2);ce={top:hr,bottom:vr,left:Ln,right:Fn-Ln,front:mn,back:pr,type:"SAME"}}else{if(B!=="valid")throw Error("Unknown padding parameter: "+B);ce={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},_e=Math.ceil((G-me+1)/ne),ke=Math.ceil((q-he+1)/ie),Ye=Math.ceil((J-Ee+1)/se)}return{padInfo:ce,outDepth:_e,outHeight:ke,outWidth:Ye}}(o,c,f,d,x,w,S,T,D,U,s),A=j.padInfo,M=j.outDepth,$=j.outHeight,O=j.outWidth,L=i?y*p:y;return a==="channelsFirst"?h=[l,L,M,$,O]:a==="channelsLast"&&(h=[l,M,$,O,L]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:f,inWidth:d,inChannels:p,outDepth:M,outHeight:$,outWidth:O,outChannels:L,padInfo:A,strideDepth:x,strideHeight:w,strideWidth:S,filterDepth:m,filterHeight:g,filterWidth:v,effectiveFilterDepth:T,effectiveFilterHeight:D,effectiveFilterWidth:U,dilationDepth:C,dilationHeight:k,dilationWidth:_,inShape:e,outShape:h,filterShape:t}}function CC(e,t,n,r){r===void 0&&(r=1);var o=ja(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function of(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function Mv(e){return typeof e=="number"?[e,e,e]:e}function ja(e,t){return t<=1?e:e+(e-1)*(t-1)}function Zs(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function os(e){var t=of(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function Nn(e,t){return os(e)||os(t)}function Ig(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function EC(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=rt(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!ZN(e.dtype,t))return V.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if(t==="int32")return n.int(e);if(t==="bool"){var s=ae(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function Fv(e,t){return V.makeTensorFromDataId(e.dataId,t,e.dtype)}function _C(e,t,n){var r=(t-e)/(n-1),o=Hu(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return _t(o,"float32")}function Lv(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Q1(e,t){return{real:e[2*t],imag:e[2*t+1]}}function R3(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function P3(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function I3(e,t,n){var r=function(i,a,s){return function(u,l,c){for(var f=0,d=u.length,p=0,h=!1;f<d;){var m=c(l,u[p=f+(d-f>>>1)]);m>0?f=p+1:(d=p,h=!m)}return h?f:-f-1}(i,a,s||O3)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function O3(e,t){return e>t?1:e<t?-1:0}function Og(e,t,n,r,o){return kC(e,t,n,r,o,0).selectedIndices}function Tg(e,t,n,r,o,i){var a=kC(e,t,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function kC(e,t,n,r,o,i,a,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(x,w){return{score:x,boxIndex:w,suppressBeginIndex:0}}).filter(function(x){return x.score>o}).sort(J1),l=i>0?-.5/i:0,c=[],f=[];c.length<n&&u.length>0;){var d=u.pop(),p=d.score,h=d.boxIndex,m=d.suppressBeginIndex;if(p<o)break;for(var g=!1,v=c.length-1;v>=m;--v){var y=T3(e,h,c[v]);if(y>=r){g=!0;break}if(d.score=d.score*D3(r,l,y),d.score<=o)break}d.suppressBeginIndex=c.length,g||(d.score===p?(c.push(h),f.push(d.score)):d.score>o&&I3(u,d,J1))}var b=c.length;return s&&(c.fill(0,b),f.fill(0,b)),{selectedIndices:_t(c,"int32"),selectedScores:_t(f,"float32"),numValidOutputs:ae(b,"int32")}}function T3(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),f=Math.max(o[0],o[2]),d=Math.max(o[1],o[3]),p=(s-i)*(u-a),h=(f-l)*(d-c);if(p<=0||h<=0)return 0;var m=Math.max(i,l),g=Math.max(a,c),v=Math.min(s,f),y=Math.min(u,d),b=Math.max(v-m,0)*Math.max(y-g,0);return b/(p+h-b)}function D3(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function J1(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function RC(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map(function(i){o[n]=i;var a=e.slice(r,o);return r[n]+=i,a})}function PC(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=Te(n,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var u=e.locToIndex(a);o.values[r]=e.values[u]}return o.toTensor()}function IC(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],u=a[1],l=Eu(n,s*r),c=Eu("int32",s*r),f=0;f<s;f++){for(var d=f*u,p=e.subarray(d,d+u),h=[],m=0;m<p.length;m++)h.push({value:p[m],index:m});h.sort(function(x,w){return w.value-x.value});var g=f*r,v=l.subarray(g,g+r),y=c.subarray(g,g+r);for(m=0;m<r;m++)v[m]=h[m].value,y[m]=h[m].index}var b=t.slice();return b[b.length-1]=r,[Xt(l,b,n),Xt(c,b,"int32")]}function Dg(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=Te(e,"int32"),i=Te([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*e.length;i.values.set(a,s)}return i.toTensor()}var N3=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},A3=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},M3=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=e.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function OC(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function En(e,t){return t===1?[e]:OC(e,t)}function cn(){var e,t,n,r,o,i,a,s,u,l;return Y().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function Ri(e,t,n){n===void 0&&(n="index");var r=Xr(t);return r.map(function(o,i){return"int "+e[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+o:"index -= "+e[i]+" * "+o)+";"}).join("")}function Ng(e){var t=Xr(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var TC=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function F3(e,t,n,r){var o=[];e.forEach(function(p){var h=ge(p.shapeInfo.logicalShape);p.shapeInfo.isUniform?o.push("uniform float "+p.name+(h>1?"["+h+"]":"")+";"):(o.push("uniform sampler2D "+p.name+";"),o.push("uniform int offset"+p.name+";"))});var i,a,s=o.join(`
`),u=e.map(function(p){return function(h,m,g){g===void 0&&(g=!1);var v="";v+=g?DC(h):da(h);var y=h.shapeInfo.logicalShape,b=m.logicalShape;return y.length<=b.length&&(v+=g?function(x,w){var S,E=x.name,C=E.charAt(0).toUpperCase()+E.slice(1),k="get"+C+"AtOutCoords",_=x.shapeInfo.logicalShape.length,T=w.logicalShape.length,D=Vo(x.shapeInfo.logicalShape,w.logicalShape),U=Ze(T),j=T-_,A=["x","y","z","w","u","v"];S=_===0?"":T<2&&D.length>=1?"coords = 0;":D.map(function(q){return"coords."+A[q+j]+" = 0;"}).join(`
`);var M="";M=T<2&&_>0?"coords":x.shapeInfo.logicalShape.map(function(q,J){return"coords."+A[J+j]}).join(", ");var $="return outputValue;",O=ge(x.shapeInfo.logicalShape)===1,L=ge(w.logicalShape)===1;if(_!==1||O||L){if(O&&!L)$=T===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(D.length){var B=_-2,G=_-1;D.indexOf(B)>-1&&D.indexOf(G)>-1?$="return vec4(outputValue.x);":D.indexOf(B)>-1?$="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":D.indexOf(G)>-1&&($="return vec4(outputValue.xx, outputValue.zz);")}}else $=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+k+`() {
      `+U+` coords = getOutputCoords();
      `+S+`
      vec4 outputValue = get`+C+"("+M+`);
      `+$+`
    }
  `}(h,m):function(x,w){var S=x.name,E=S.charAt(0).toUpperCase()+S.slice(1),C="get"+E+"AtOutCoords",k=w.texShape,_=x.shapeInfo.texShape,T=x.shapeInfo.logicalShape.length,D=w.logicalShape.length;if(!x.shapeInfo.isUniform&&T===D&&x.shapeInfo.flatOffset==null&&$t(_,k))return`
      float `+C+`() {
        return sampleTexture(`+S+`, resultUV);
      }
    `;var U,j=Ze(D),A=Vo(x.shapeInfo.logicalShape,w.logicalShape),M=D-T,$=["x","y","z","w","u","v"];U=T===0?"":D<2&&A.length>=1?"coords = 0;":A.map(function(L){return"coords."+$[L+M]+" = 0;"}).join(`
`);var O="";return O=D<2&&T>0?"coords":x.shapeInfo.logicalShape.map(function(L,B){return"coords."+$[B+M]}).join(", "),`
    float `+C+`() {
      `+j+` coords = getOutputCoords();
      `+U+`
      return get`+E+"("+O+`);
    }
  `}(h,m)),v}(p,t,r)}).join(`
`),l=t.texShape,c=cn(),f=function(p){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+p.texture2D+`(textureSampler, uv).r;
    }
  `}(c),d=function(p){return p.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+p.varyingFs+` vec2 resultUV;
    `+p.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+p.defineSpecialNaN+`
    `+p.defineSpecialInf+`
    `+p.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+L3+`
    `+B3+`
    `+j3+`
  `}(c);return t.isPacked?(i=function(p,h){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];return S[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+S[1]+`.0);
      }
    `:S[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+S[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      return 2 * (resTexRC.x * `+S[1]+` + resTexRC.y);
    }
  `}(0,h);case 2:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];if($t(x,w))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+S[0]+", "+S[1]+`));
      }
    `;var E=Math.ceil(x[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));

      int index = resTexRC.x * `+S[1]+` + resTexRC.y;
      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec2(r, c);
    }
  `}(p,h);case 3:return m=p,g=h,v=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(m[2]/2),b=y*Math.ceil(m[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(x,w){for(var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],E=Math.ceil(x[x.length-1]/2),C=E*Math.ceil(x[x.length-2]/2),k=C,_="",T="b, r, c",D=2;D<x.length-1;D++)k*=x[x.length-D-1],_=`
      int b`+D+" = index / "+k+`;
      index -= b`+D+" * "+k+`;
    `+_,T="b"+D+", "+T;return`
    ivec`+x.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      `+_+`

      int b = index / `+C+`;
      index -= b * `+C+`;

      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec`+x.length+"("+T+`);
    }
  `}(p,h)}var m,g,v,y,b}(t.logicalShape,l),a=function(p){return`
    void setOutput(vec4 val) {
      `+p.output+` = val;
    }
  `}(c)):(i=function(p,h){switch(p.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,h);case 2:return function(v,y){return $t(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(p,h);case 3:return m=h,g=Ri(["r","c","d"],p),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var b=Ri(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(p,h);case 5:return function(v,y){var b=Ri(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(p,h);case 6:return function(v,y){var b=Ri(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(p,h);default:throw new Error(p.length+"-D output sampling is not yet supported")}var m,g}(t.logicalShape,l),a=function(p){return`
    void setOutput(float val) {
      `+p.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(d+=$3),[d,f,a,s,i,u,n].join(`
`)}function da(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],f=gi(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+f+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+ra(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=gi(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&$t(r,a)){var s=a[0],u=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var l=Ci(r),c=l.newShape,f=l.keptDims,d=c;if(d.length<r.length){var p=pa(n,d);return`
      `+da(p)+`
      float `+i+`(int row, int col) {
        return `+i+"("+ha(["row","col"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+ra(n)+`
      }
    `;var h=a[0],m=a[1],g=gi(o);return m===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+h+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:h===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+m+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+h+", "+m+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=Ci(r),l=u.newShape,c=u.keptDims,f=l;if(f.length<r.length){var d=pa(n,f);return`
        `+da(d)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+ha(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+ra(n)+`
      }
    `;var p=n.shapeInfo.texShape,h=p[0],m=p[1],g=n.shapeInfo.flatOffset;if(m===a&&g==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+m+".0, "+h+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(m===s&&g==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+".0, "+h+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var v=gi(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+h+", "+m+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,l=Ci(r),c=l.newShape,f=l.keptDims;if(c.length<r.length){var d=pa(n,c);return`
      `+da(d)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+ha(["row","col","depth","depth2"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+ra(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,m=h[0],g=h[1];if(g===u&&p==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(g===a&&p==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var v=gi(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+m+", "+g+", index + "+v+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,l=r[1]*u,c=Ci(r),f=c.newShape,d=c.keptDims;if(f.length<r.length){var p=pa(n,f);return`
      `+da(p)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+ha(["row","col","depth","depth2","depth3"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+ra(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],v=m[1];if(v===l&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(v===a&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var y=gi(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+v+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=Ci(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var l=pa(n,s);return`
      `+da(l)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+ha(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],f=r[4]*c,d=r[3]*f,p=r[2]*d,h=r[1]*p;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+h+", "+p+", "+d+", "+f+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+ra(n)+`
      }
    `;var m=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,v=g[0],y=g[1];if(y===h&&m==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+p+", "+d+", "+f+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===c&&m==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var b=gi(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+h+" + col * "+p+" + depth * "+d+` +
          depth2 * `+f+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function DC(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=cn(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=cn();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=u[0],c=u[1],f=cn();if(u!=null&&$t(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+f.texture2D+"("+a+`, uv);
      }
    `;var d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],p=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+p+", "+d[0]+", "+d[1]+`, row, col);
      return `+f.texture2D+"("+a+`, uv);
    }
  `}(e);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var c=i.slice(1),f=pa(o,c);return`
        `+DC(f)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+ha(["b","row","col"],[1,2])+`);
        }
      `}var d=l[0],p=l[1],h=Math.ceil(i[2]/2),m=h*Math.ceil(i[1]/2),g=cn();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+d+", "+p+", "+m+", "+h+`, b, row, col);
      return `+g.texture2D+"("+a+`, uv);
    }
  `}(e);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=o.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=c[0],d=c[1],p=Math.ceil(i[a-1]/2),h=p*Math.ceil(i[a-2]/2),m="int b, int row, int col",g="b * "+h+" + (row / 2) * "+p+" + (col / 2)",v=2;v<a-1;v++)m="int b"+v+", "+m,h*=i[a-v-1],g="b"+v+" * "+h+" + "+g;var y=cn();return`
    vec4 `+u+"("+m+`) {
      int index = `+g+`;
      int texR = index / `+d+`;
      int texC = index - texR * `+d+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+d+", "+f+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var L3=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,B3=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,j3=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,$3=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function gi(e){return"offset"+e}function ra(e){var t=e.name,n=ge(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Ze(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function pa(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function ha(e,t){return t.map(function(n){return e[n]}).join(", ")}var V3=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,I(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=Ze(l),f=En("coords",l);if(i===1){var d=Ze(s=l+1);a=`
        `+d+" sourceLocR = "+d+"("+f.join()+`, 0);
        ++`+f[l-1]+`;
        `+d+" sourceLocG = "+d+"("+f.join()+`, 0);
        ++`+f[l-2]+`;
        `+d+" sourceLocA = "+d+"("+f.join()+`, 0);
        --`+f[l-1]+`;
        `+d+" sourceLocB = "+d+"("+f.join()+`, 0);
        --`+f[l-2]+";"}else s=l,a=`
        `+c+` sourceLocR = coords;
        ++`+f[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+f[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+f[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+f[l-2]+";";var p=["x","y","z","w","u","v"].slice(0,s),h="."+p[s-1],m=p.map(function(C){return"int "+C}),g=En("sourceLocR",s-1).concat("inIdx.r"),v=En("sourceLocG",s-1).concat("inIdx.g"),y=En("sourceLocB",s-1).concat("inIdx.b"),b=En("sourceLocA",s-1).concat("inIdx.a"),x=n==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",S=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",E=r?"":`
      float getBestIndicesAChannel(`+m.join()+`) {
        return getChannel(getBestIndicesA(`+p.join()+`),
                                          vec2(`+p.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+m.join()+`) {
        return getChannel(getA(`+p.join()+`),
                               vec2(`+p.slice(-2).join()+`));
      }
      `+E+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+f[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+f[l-2]+" < "+(u[l-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+h+", sourceLocG"+h+`,
          sourceLocB`+h+", sourceLocA"+h+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+S+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+w+`
          vec4 candidate = `+S+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+x+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},W3=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,f=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},U3=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=c-1-e.padInfo.front,h=f-1-e.padInfo.top,m=d-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+p+", "+h+", "+m+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+f+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+d+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},z3=function(e,t,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Be(e,t),Be(e,n);var a="0.0";r!=null&&(Be(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(Be(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},H3=function(e,t,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Be(e,t),Be(e,n);var a="vec4(0.0)";r!=null&&(Be(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(Be(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},G3="return areal * breal - aimag * bimag;",q3="return areal * bimag + aimag * breal;",Z1=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Be(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Lp="return a + b;",Bp="return a - b;",eb="return a * b;",NC="return (a < 0.) ? b * a : a;",vt=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Be(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},AC=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,ro=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Be(t,n);var o=this.outputShape.length,i="";if(r)if(o===0||ge(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Ze(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=En("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},K3=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),X3=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),Y3=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},Q3=function(e){this.outputShape=[],this.outputShape=rs(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=t.length,a=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},J3=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=rs(e,t);var n=this.outputShape,r=n.length,o=Ze(r),i=En("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(g,v){return"T"+v});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=a[t],c=a.slice(-2),f=a.join(),d="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+f+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var p=s[u-1];d+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+Pl(a,l,p)+`),
            vec2(`+Pl(c,l,p)+`));
        }`}var h=s.length,m=s[s.length-1];d+=`
        return getChannel(
          getT`+h+"("+Pl(a,l,m)+`),
          vec2(`+Pl(c,l,m)+"));",this.userCode=`
      float getValue(`+a.map(function(g){return"int "+g})+`) {
        `+d+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Pl(e,t,n){var r=e.indexOf(t);return e.map(function(o,i){return i===r?o+" - "+n:o}).join()}var Z3=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},e4=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,l=i?2:3,c=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},t4=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+o+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},n4=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},r4=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},o4=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},tb=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),p=e.inChannels%4,h=e.dataFormat==="channelsLast",m=h?1:2,g=h?2:3,v=h?3:1,y="",b="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+m+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+d+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+h+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(p===1)+`) {

              if (`+h+`) {
                dotProd +=
                    getX(batch, xR, xC, `+d+`) *
                    getW(wR, wC, `+d+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+d+`, xR, xC) *
                    getW(wR, wC, `+d+`, d2);
              }

            } else if (`+(p===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2)
              );

              if (`+h+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(p===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2),
                getW(wR, wC, `+d+` + 2, d2)
              );

              if (`+h+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1),
                  getX(batch, xR, xC, `+d+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC),
                  getX(batch, `+d+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+x+`
        `+b+`
        setOutput(result);
      }
    `},i4=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,f=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),h=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+d+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+p+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(h===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+p+`) *
                  getW(wF, wR, wC, `+p+`, d2);
              } else if (`+(h===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(h===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+p+`),
                  getX(batch, xF, xR, xC, `+p+` + 1),
                  getX(batch, xF, xR, xC, `+p+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+p+`, d2),
                  getW(wF, wR, wC, `+p+` + 1, d2),
                  getW(wF, wR, wC, `+p+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},nb=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=e.outChannels/e.inChannels,m="",g="";n&&(m=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,g="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+m+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+h+`;
        int q = d2 - d1 * `+h+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+g+`
        setOutput(result);
      }
    `},rb=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,h=p,m="int xR; int xC; int xCOffset;",g=0;g<d;g++)for(var v=0;v<p;v++)m+=`
          vec4 xTexelR`+g+"C"+2*v+` = vec4(0.);
          vec4 wR`+g+"C"+v+` = vec4(0.);
          vec4 xR`+g+"C"+v+" = vec4(0.);";for(g=0;g<d;g++)for(var y=0;y<h;y++){if(m+=`
          xR = xRCorner + `+g*c+`;
          xC = xCCorner + `+(v=2*y)*f+`;
        `,l===1){if(v<p&&(m+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+g+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+v+" = vec4(previous.zw, xTexelR"+g+"C"+v+`.xy);
                } else {
                  xR`+g+"C"+v+" = vec4(0, 0, xTexelR"+g+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xR`+g+"C"+v+" = xTexelR"+g+"C"+v+`;
              `,v+1<p)){var b=s%2==0?JS(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(m+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,f>1&&(m+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+v+` = vec4(0.);
                    }
                  `),m+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.xy);
                `):m+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(v+1)+" = xTexelR"+g+"C"+(v+2)+`;
                `}}else v<p&&(m+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(m+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
              `,v+1<p&&(m+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(v+1)+" = vec4(xTexelR"+g+"C"+(v+2)+`.xy, final.xy);
                `)):(m+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+g+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(v+2)+` = vec4(0.);
                }

                xR`+g+"C"+v+` = vec4(
                  xTexelR`+g+"C"+v+".xy, xTexelR"+g+"C"+(v+2)+`.xy);
              `,v+1<p&&(m+=`
                  xR`+g+"C"+(v+1)+` = vec4(
                    xTexelR`+g+"C"+v+".zw, xTexelR"+g+"C"+(v+2)+`.zw);
                `)),m+="}");v<p&&(m+=`
            vec4 wTexelR`+g+"C"+v+" = getW("+g+", "+v+`, d1, q);
            wR`+g+"C"+v+" = vec4(wTexelR"+g+"C"+v+".xz, wTexelR"+g+"C"+v+`.xz);
          `,v+1<p&&(m+=`
              vec4 wTexelR`+g+"C"+(v+1)+" = getW("+g+", "+(v+1)+`, d1, q);
              wR`+g+"C"+(v+1)+` =
                vec4(wTexelR`+g+"C"+(v+1)+".xz, wTexelR"+g+"C"+(v+1)+".xz);"))}for(g=0;g<d;g++)for(v=0;v<p;v++)m+="dotProd += xR"+g+"C"+v+" * wR"+g+"C"+v+";";var x="",w="";n&&(x=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,w="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+m+`

        vec4 result = dotProd;
        `+S+`
        `+w+`
        setOutput(result);
      }
    `},a4=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],u=e[3],l=t[0],c=n[0],f=n[1];this.outputShape=[l,c,f,u];var d=r==="bilinear"?1:0,p=[a-1+".0",s-1+".0"],h=p[0],m=p[1],g=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],v=g[0],y=g[1],b=g[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],w=x[0],S=x[1],E=x[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+w+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+S+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+h+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+E+`;
        if( in_x < 0.0 || in_x > `+m+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+d+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},s4=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Ze(r)+` coords = getOutputCoords();
        int end = `+ob(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+ob(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function ob(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var u4=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ku.DENSE;var t=Js(e),n=cn();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ri(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},l4=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ku.DENSE;var t=Js(e),n=cn();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ri(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},c4=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),f4=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},d4=function(e){this.variableNames=["A"],this.outTexUsage=zn.DOWNLOAD;var t=cn();this.outputShape=e,this.userCode=`
      `+TC+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},p4=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=zn.DOWNLOAD;var t=cn();this.outputShape=e,this.userCode=`
      `+TC+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},h4=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=cn(),o=t[0],i=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+Ng(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},v4=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=cn(),o=t[0],i=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Ng(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},m4="return real * expR - imag * expI;",g4="return real * expI + imag * expR;",ib=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},y4=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),b4=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=Ze(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=0;f<a.length;f++)f===s?c.push("int(getIndices("+l[f]+"))"):c.push(""+l[f]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},x4=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Ze(t.length),o=Ze(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function w4(e,t){var n=cn();return mA(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function S4(e,t){return wA(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function C4(e,t){return SA(e,t,new Uint16Array([0,1,2,2,1,3]))}function qu(e,t,n,r,o,i,a){EA(n,r);var s=CA(e,t),u=e.TEXTURE_2D;return be(e,t,function(){return e.bindTexture(u,s)}),be(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),be(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),be(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),be(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),be(e,t,function(){return e.texImage2D(u,0,o,n,r,0,i,a,null)}),be(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function E4(e,t,n,r,o){var i=gd(n,r);return qu(e,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function _4(e,t,n,r,o){var i=gd(n,r);return qu(e,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function k4(e,t,n,r,o){var i=gd(n,r);return qu(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function R4(e,t,n,r,o){var i=Gu(n,r);return qu(e,t,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function P4(e,t,n,r,o){var i=Gu(n,r);return qu(e,t,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function I4(e,t,n,r){return be(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),G1(e,t,n,"clipSpacePos",r,3,20,0)&&G1(e,t,n,"uv",r,2,20,12)}function O4(e,t,n,r,o,i,a){var s,u,l;be(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,l=a.internalFormatPackedFloat),s.set(i),be(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,o,0,e.RGBA,u,s)}),be(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function T4(e,t,n,r){be(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?be(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):be(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),be(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function D4(e,t,n,r,o){var i=e.createBuffer();be(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return be(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)}),be(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),be(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function N4(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function A4(e,t,n,r,o){var i=gd(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return be(e,t,function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function M4(e,t,n,r,o,i,a,s){var u=e,l=new Float32Array(function(c,f){var d=Gu(c,f);return d[0]*d[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function F4(e,t,n,r){var o=new Float32Array(n*r*4);return be(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)}),o}var L4=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Y().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,fA(n,t)):this.gl=Zr(n);var r="WEBGL_color_buffer_float";if(Y().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=El(this.gl,this.debug,"OES_texture_float"),ar(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=El(this.gl,this.debug,"OES_texture_half_float");else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ar(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=El(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ar(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!ar(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=S4(this.gl,this.debug),this.indexBuffer=C4(this.gl,this.debug),this.framebuffer=_A(this.gl,this.debug),this.textureConfig=Cg(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return Y().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;be(n,this.debug,function(){return n.finish()}),be(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),be(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),be(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),be(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),be(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),E4(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),_4(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),k4(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),T4(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,o){this.throwIfDisposed(),O4(this.gl,this.debug,t,n,r,o,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),P4(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),R4(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(q1(this.gl,this.debug,this.framebuffer),this.outputTexture=null),be(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return A4(o.gl,o.debug,n,r,o.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,o,i,a){return M4(this.gl,t,0,0,0,i,a,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return N4(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var o=D4(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,o=this;if(Y().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return F4(o.gl,o.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=gA(n,this.debug,t),o=w4(n,this.debug),i=bA(n,this.debug);return be(n,this.debug,function(){return n.attachShader(i,o)}),be(n,this.debug,function(){return n.attachShader(i,r)}),xA(n,this.debug,i),this.debug&&Np(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=I4(n,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&be(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Np(this.gl,this.debug,this.program),be(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?RA(this.gl,this.debug,t,n):PA(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),be(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),IA(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var o=Gu(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(t,i,a)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&Np(this.gl,this.debug,this.program),_l(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),be(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),be(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=El(this.gl,this.debug,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return de(this,void 0,void 0,function(){var n=this;return pe(this,function(r){switch(r.label){case 0:return[4,$1(function(){return n.disposed||n.isQueryAvailable(t,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||$1(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Ap(this.gl,this.debug,t,this.framebuffer),this.debug&&_l(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Ap(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&_l(this.gl)):q1(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var o=this.gl;Ap(o,this.debug,t,this.framebuffer),this.debug&&_l(o),this.outputTexture=t,be(o,this.debug,function(){return o.viewport(0,0,n,r)}),be(o,this.debug,function(){return o.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,o){var i=this;this.throwIfDisposed(),be(this.gl,this.debug,function(){return i.gl.scissor(t,n,r,o)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function ab(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var o=n.logicalShape,i=t[r],a=i.shape;if(!$t(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!$t(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var B4=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,f=n.dataFormat,d=s.left,p=s.top,h=o*r,m=cn(),g=f==="channelsLast",v=g?0:1,y=g?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+=`
          blockIndex = rc.y + `+w+`;
          pos = rc.x + `+x+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+p+`;
            d0 = offsetY + `+c+" * (pos / "+h+`);

            if(d0 < `+t[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+d+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+h+".) / "+o+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+m.output+` = result;
      }
    `},j4=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},$4=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},V4=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},W4=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,s=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},U4=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,f=u-1-e.padInfo.top,d=l-1-e.padInfo.left,p=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+f+", "+d+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+p+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},jp=function(e,t,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",h="";i&&(p=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,h="result = activation(result);");var m=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+p+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+f[0]+" * "+d[0]+`);
          result += (`+f[1]+" * "+d[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+m+`

        `+h+`

        setOutput(result);
      }
    `},z4=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),H4=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},G4=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=En("rc",t),r=Ze(t),o=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",f=s-2;f<s;f++)c+=l[f]+" >= "+u[f],f<s-1&&(c+="||");return c}(t,e,n),i=function(s,u,l,c){if(s===1)return"";var f=c.slice(-2);return`
    int r = `+f[0]+`;
    int c = `+f[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),a=function(s,u){var l=s.length,c=function(f,d){for(var p=[],h=0;h<=1;h++)for(var m=0;m<=1;m++){for(var g=(h===0?"r":"rp1")+", "+(m===0?"c":"cp1"),v=2;v<f;v++)g=d[d.length-1-v]+","+g;p.push(g)}return p}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},q4=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,o=Ze(r),i=t.map(function(u){return u[0]}).join(","),a=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},K4=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(g,v){return g[0]+e[v]+g[1]});for(var r=e.length,o=Ze(r),i=t.map(function(g){return g[0]}).join(","),a=t.map(function(g,v){return g[0]+e[v]}).join(","),s=En("rc",r),u=En("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",f=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],d=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",h=0,m=r===1?2:4;h<m;h++)p+=`
        `+f[h]+`
        if (`+d+`) {
          result[`+h+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+h+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+p+`
        setOutput(result);
      }
    `},$p=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;var d=t==="avg",p="0.0";if(d||(p="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+c+", "+f+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var h=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(h="avgValue / count");var m=4*Math.floor(r/4),g=r%4,v=`
      if (`+d+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+c+", "+f+`);
      const float initializationValue = `+p+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+p+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+m+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+v+`
          }

          int xC = xCCorner + `+m+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+v+`
          }
        }
        setOutput(`+h+`);
      }
    `}},Vp=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.front,h=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;var g=t==="avg",v="0.0";if(g||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+p+", "+h+", "+m+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+f+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+d+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+f+" * "+d+` +
                      wR * `+d+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var b=4*Math.floor(r/4),x=r%4,w=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+p+", "+h+", "+m+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+b+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+w+`
            }

            int xC = xCCorner + `+b+`;
            if (`+(x===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+w+`
            } else if (`+(x===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+w+`
            } else if (`+(x===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+w+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},X4=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",s="min"):t==="max"&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,f=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,d="vec4";t==="all"?(a="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):t==="any"&&(a="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");var p="";o%n>0&&(p=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+p+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===2)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===3)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+f+`
        }
        setOutput(`+u+`);
      }
    `},Y4=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Ri(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Ng(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},Q4=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],p=1/f,h=1/d,m=2*Math.ceil(p)+2,g=2*Math.ceil(h)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+h+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},J4=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},Z4=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},eM=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],p=1/f,h=1/d,m=2*Math.ceil(p)+2,g=2*Math.ceil(h)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+p+`);
        const float invWidthScale = float(`+h+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},tM=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},nM=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(i,a){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=Ze(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},rM=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=En("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Ze(n);function s(u){var l=e.map(function(c,f){return function(d,p){return t.indexOf(d)!==-1&&e[d]!==1?e[d]+" - "+p[d]+" - 1":""+p[d]}(f,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},sb=function(e,t,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Ze(o.length),u=Ze(i.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",f="";r===1?f="i":r===2&&(f="i, coords[1]");var d="getUpdates("+f+")",p=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+p+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+d+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},oM=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";o%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var f="";o%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+f+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},iM=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var l=Ze(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},aM=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Ze(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return Wp.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(a,s){return"sourceLoc."+Wp[s]+" = start["+s+"] + coords."+Wp[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),Wp=["x","y","z","w","u","v"],sM=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Ze(this.rank),r=En("coords",this.rank),o=En("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,f){return"start["+f+"]"}).join()+");":t.map(function(c,f){return o[f]+" = "+r[f]+" + start["+f+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),uM=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=Ze(n.length),i=Ze(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+e+`);
      `+o+" strides = "+o+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},lM=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var o,i=ub(n,r),a=lb(t,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===Wn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Wn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Wn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Wn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Wn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),o},e.prototype.releaseTexture=function(t,n,r,o){if(this.freeTextures!=null){var i=lb(n,ub(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){t.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function ub(e,t){if(e===zn.UPLOAD)return Wn.PACKED_2X2_FLOAT32;if(e===zn.RENDER||e==null)return function(n){return Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Wn.PACKED_2X2_FLOAT32:Wn.UNPACKED_FLOAT32:n?Wn.PACKED_2X2_FLOAT16:Wn.UNPACKED_FLOAT16}(t);if(e===zn.DOWNLOAD||e===zn.PIXELS)return Wn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function lb(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var cM=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=Ze(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<a.length;c++)l.push("imod("+u[c]+", "+a[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},fM=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=Ze(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<a.length;c++)l[a[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},dM=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Ze(this.rank),i=OC("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},Ag=1.7580993408473768,Mg=1.0507009873554805,Ae=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Dr="if (isnan(x)) return x;",pM="return x;",cb="return abs(x);",MC=Dr+`
  return (x < 0.0) ? 0.0 : x;
`,FC=Dr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,LC="return (x >= 0.0) ? x : (exp(x) - 1.0);",hM=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Ag+`;
  float scale = `+Mg+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,fb="return -x;",db="return ceil(x);",pb="return floor(x);",hb="return exp(x);",vb="return exp(x) - 1.0;",vM=Dr+`
  return sin(x);
`,mM=Dr+`
  return cos(x);
`,gM=Dr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,yM=Dr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,bM=Dr+`
  return atan(x);
`,xM=Dr+"return log(x + sqrt(x * x + 1.0));",wM=Dr+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,SM=Dr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Il="return x;",CM="return x;",BC=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,jC=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$C=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Ts=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},EM=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=En("rc",t),r=Ze(t),o=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),i=n.slice(-2),a=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},Ol={};function Tl(e,t){if(t===void 0&&(t=!1),e==="linear")return t?CM:pM;if(e==="relu")return t?BC:MC;if(e==="elu")return t?$C:LC;if(e==="relu6")return t?jC:FC;if(e==="prelu")return t?AC:NC;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var _M=600,kM=function(e){function t(n){var r,o=e.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!Y().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Zr(Y().getNumber("WEBGL_VERSION"));o.binaryCache=((r=Y().getNumber("WEBGL_VERSION"))in Ol||(Ol[r]={}),Ol[r]),o.gpgpu=new L4(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new lM(o.gpgpu),o.numMBBeforeWarning=Y().global.screen==null?1024:Y().global.screen.height*Y().global.screen.width*window.devicePixelRatio*_M/1024/1024,o.texData=new wC(o,V),o}return Tr(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,o){if(Y().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:zn.UPLOAD}),i},t.prototype.move=function(n,r,o,i){if(Y().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:zn.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new Ts(u,Il):new Ae(u,Il);var f=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:i}],i),d=this.readSync(f.dataId);return this.disposeData(f.dataId),d}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var p,h,m=this.activeTimers!=null;return m&&(p=Br()),i==="complex64"?h=Lv(a.real.dataSync(),a.imag.dataSync()):h=this.getValuesFromTexture(n),m&&(this.downloadWaitMs+=Br()-p),this.convertAndCacheOnCPU(n,h)},t.prototype.read=function(n){return de(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,f,d,p,h,m,g,v,y,b,x,w,S,E,C;return pe(this,function(k){switch(k.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(_){return r.push(_)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,u=o.dtype,l=o.complexTensors,c=o.isPacked,s!=null)return f=void 0,f=c?new Ts(a,Il):new Ae(a,Il),d=this.runWebGLProgram(f,[{dataId:n,shape:a,dtype:u}],u),p=this.read(d.dataId),this.disposeData(d.dataId),[2,p];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Y().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,u!=="complex64"&&Y().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(n),g=this.texData.get(m.dataId),h=(C=this.gpgpu).createBufferFromTexture.apply(C,[g.texture].concat(Js(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:k.sent(),k.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=k.sent(),b=y[0],x=y[1],v=Lv(b,x),[3,5];case 4:h==null?v=this.getValuesFromTexture(n):(w=ge(a),v=this.gpgpu.downloadFloat32MatrixFromBuffer(h,w)),k.label=5;case 5:return m!=null&&this.disposeData(m.dataId),S=this.convertAndCacheOnCPU(n,v),E=this.pendingRead.get(n),this.pendingRead.delete(n),E.forEach(function(_){return _(S)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,S]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!hA(o))throw Y().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,u=ge(i);if(Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),f=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(Js(i))).subarray(0,u);return this.disposeData(l.dataId),f}var d=Y().getBool("WEBGL_PACK")&&s===!0,p=d?Mp(i):i,h=d?new p4(p):new d4(p),m=this.runWebGLProgram(h,[{shape:p,dtype:a,dataId:n}],"float32"),g=this.texData.get(m.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(m.dataId),v},t.prototype.time=function(n){return de(this,void 0,void 0,function(){var r,o,i,a,s,u,l;return pe(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=ts(this.activeTimers.map(function(f){return f.query})).filter(function(f){return f!=null}),s=ts(this.activeTimers.map(function(f){return f.name})).filter(function(f){return f!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return l=c.sent(),u.kernelMs=KN(l),u.getExtraProfileInfo=function(){return l.map(function(f,d){return{name:s[d],ms:f}}).map(function(f){return f.name+": "+f.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Br(),endMs:null}},t.prototype.endTimer=function(n){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=Br(),n)},t.prototype.getQueryTime=function(n){return de(this,void 0,void 0,function(){var r;return pe(this,function(o){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,f=this.dataRefCount.get(c);f>1?this.dataRefCount.set(c,f-1):(this.dataRefCount.delete(c),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var d=this.texData.get(n);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return Y().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=V.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:V.keep(n.clone()),imag:V.keep(r.clone())},o},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(ge(o)===0)return Xt([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=bC(n.shape,r,o);if(i||!a){var s=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sM(o):new aM(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},t.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var u=xC(r,n.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),a},t.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=Pg(r,o,i);if(a.some(function(u){return u===0}))return Xt([],a);var s=new uM(r,i,a);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rM(n.shape,r):new nM(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(p){return or(p)}),i=n.map(function(p){return Ur(p)});return qt(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new J3(n.map(function(p){return p.shape}),r);return this.compileAndRun(l,n)}var c=rs(n.map(function(p){return p.shape}),r),f=n.map(function(p){return p.as2D(-1,ge(p.shape.slice(r)))}),d=new Q3(f.map(function(p){return p.shape}));return this.compileAndRun(d,f).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,fb,n.dtype);var r=new Ae(n.shape,fb);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],l=n.shape[0];if((a===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var c=s===1?n:n.as3D(l,u,1),f=s===1?2:1,d=s===1?r.as3D(l,1,u):r;return this.multiply(c,d).sum(f,!0)}var p=Kt(n.dtype,r.dtype),h=new jp(n.shape,[l,a,s],o,i);return this.compileAndRun(h,[n,r],p)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=i?r.shape[2]:r.shape[1],f=a?o.shape[1]:o.shape[2],d=r.shape[0],p=Kt(r.dtype,o.dtype),h=s!=null,m=l!=null,g=u?Tl(u,!0):null,v=new jp(r.shape,[d,c,f],i,a,h,g,m),y=[r,o];return s&&y.push(s),l&&y.push(l),this.compileAndRun(v,y,p)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new Z1(G3,n.shape,r.shape),s=new Z1(q3,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],l=this.compileAndRun(a,u),c=this.compileAndRun(s,u),f=this.complex(l,c);return l.dispose(),c.dispose(),f}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,eb,n.dtype);var d=new vt(eb,n.shape,r.shape);return this.compileAndRun(d,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){var u=[n,r,o],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(a!=null&&(c=a.shape,u.push(a)),Y().getBool("WEBGL_PACK_NORMALIZATION")){var f=new H3(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(f,u)}var d=new z3(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(d,u)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=Y().getBool("WEBGL_PACK_NORMALIZATION")?new V4(n.shape,r,o,i,a):new j4(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){var l=new $4(r.shape,i,a,s,u);return this.compileAndRun(l,[r,o,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return Gc(a)});return PC(Te(n.shape,n.dtype,o),r)}var i=new cM(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.pad=function(n,r,o){var i=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new K4(n.shape,r,o):new q4(n.shape,r,o);return this.compileAndRun(i,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dM(n.shape,r):new fM(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new b4(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},t.prototype.batchToSpaceND=function(n,r,o){I(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,d){return f*d}),a=Jc(n.shape,r,i),s=Zc(a.length,r.length),u=ef(n.shape,r,i),l=vC(o,r.length),c=mC(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){I(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,p){return d*p}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=Jc(u.shape,r,i,!1),c=Zc(l.length,r.length,!1),f=ef(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(f)},t.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=Fp(a),u=new X4({windowSize:s,inSize:a,batchSize:i},r),l=this.compileAndRun(u,[n],o);return l.shape[1]===1?l:this.reduce(l,r,o)},t.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=Fp(a),u=new M3({windowSize:s,inSize:a,batchSize:i},r,o==null),l=[n];o!=null&&l.push(o);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=Fp(i[i.length-1]),s=new V3(i,a,r,o==null),u=o==null?[n]:[n,o],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){Vn("sum",r,n.rank);var o=sn(n.shape,r),i=o[0],a=ge(o[1]),s=n.as2D(-1,a),u=Pp(n.dtype);return this.reduce(s,"sum",u).reshape(i)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=sn(n.shape,r),i=o[0],a=ge(o[1]),s=n.as2D(-1,a),u=Pp(n.dtype);return this.reduce(s,"prod",u).reshape(i)},t.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=eo([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=to(1,n.rank)[0]);var u=function(p,h,m){for(var g=[],v=p.length,y=0;y<v;y++)y!==h?g.push(p[y]):g.push(m);return g}(s.shape,i,o),l=ge([s.shape[i]]),c=s.as2D(-1,l),f=Pp(n.dtype),d=this.segOpCompute(c,"unsortedSegmentSum",r,f,o).reshape(u);return a!=null&&(d=d.transpose(Eg(a))),d},t.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],u=n.shape[1],l=function(d,p){var h,m=!1;for(d<=yC?(h=d,m=!0):h=Pv(d,Math.floor(Math.sqrt(d)));!m;)h>p||h===d?m=!0:h=Pv(d,h+1);return h}(u,a),c=new oM({windowSize:l,inSize:u,batchSize:s,numSegments:a}),f=this.compileAndRun(c,[n,o],i);return f.shape[1]===a?f:(o=Qc(0,a).tile([u/l]),this.segOpCompute(f,r,o,i,a))},t.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(Vn("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!Y().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=sn(n.shape,i),s=a[0],u=ge(a[1]),l=n.as2D(-1,u);return this.argReduce(l,o).reshape(s)}return this.argReducePacked(n,o)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new s4(n.shape,o,i);return this.compileAndRun(a,[n])},t.prototype.equal=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new vt("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new vt("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new vt("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new vt("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new vt("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new vt("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Ae(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new vt("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new vt("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.select=function(n,r,o){var i=new iM(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],Kt(r.dtype,o.dtype))},t.prototype.where=function(n){Xc("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return Dg(n.shape,r)},t.prototype.topk=function(n,r,o){return IC(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Vn("min",r,n.rank);var o=sn(n.shape,r),i=o[0],a=ge(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new vt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.mod=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new vt(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);Vn("max",r,n.rank);var o=sn(n.shape,r),i=o[0],a=ge(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new vt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.all=function(n,r){Vn("all",r,n.rank);var o=sn(n.shape,r),i=o[0],a=ge(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},t.prototype.any=function(n,r){Vn("any",r,n.rank);var o=sn(n.shape,r),i=o[0],a=ge(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},t.prototype.realDivide=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new vt(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new vt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Lp);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=Kt(n.dtype,r.dtype);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Lp,o);var i=new vt(Lp,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.packedUnaryOp=function(n,r,o){var i=new Ts(n.shape,r);return this.compileAndRun(i,[n],o)},t.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new ro(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},t.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(d){var p=d[0],h=d[1],m=i.makeComplexComponentTensorInfo(n,p),g=i.makeComplexComponentTensorInfo(r,h),v=new vt(o,n.shape,r.shape);return i.compileAndRun(v,[m,g],Kt(p.dtype,h.dtype))}),l=u[0],c=u[1],f=this.complex(l,c);return l.dispose(),c.dispose(),f},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>Y().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(l){return l.dtype}).reduce(function(l,c){return Kt(l,c)}),s=n.map(function(l){return l.shape}),u=Y().getBool("WEBGL_PACK")?new A3(n[0].shape,s):new N3(n[0].shape,s);return this.compileAndRun(u,n,a)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Bp);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=Kt(n.dtype,r.dtype);if(Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Bp,n.dtype);var i=new vt(Bp,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.pow=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new vt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=Kt(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,db,n.dtype);var r=new Ae(n.shape,db);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,pb,n.dtype);var r=new Ae(n.shape,pb);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Ae(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Ae(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Ae(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Ae(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Ae(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,hb,n.dtype);var r=new Ae(n.shape,hb);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,vb,n.dtype);var r=new Ae(n.shape,vb);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var o=Ft([r],n.shape),i=this.max(n,o),a=Dn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Ae(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Ae(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Ae(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Ae(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Ae(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=Y().getBool("WEBGL_PACK")?new Ts(n.shape,BC):new Ae(n.shape,MC),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=Y().getBool("WEBGL_PACK")?new Ts(n.shape,jC):new Ae(n.shape,FC),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(AC,n.shape,r.shape):new vt(NC,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.elu=function(n){if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,$C,n.dtype);var r=new Ae(n.shape,LC);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new vt("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.selu=function(n){var r=new Ae(n.shape,hM);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Ae(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,o){var i,a=(i=Y().getBool("WEBGL_PACK_CLIP")?new X3(n.shape):new K3(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,cb,n.dtype);var r=new Ae(n.shape,cb);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new Y3(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},t.prototype.sigmoid=function(n){var r=new Ae(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Ae(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Ae(n.shape,vM);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Ae(n.shape,mM);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Ae(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Ae(n.shape,gM);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Ae(n.shape,yM);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Ae(n.shape,bM);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new vt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.sinh=function(n){var r=new Ae(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Ae(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Ae(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Ae(n.shape,xM);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Ae(n.shape,wM);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Ae(n.shape,SM);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Ae(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var o=new Ae(n.shape,function(i){return i===void 0&&(i=0),Dr+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},t.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var u=n.shape,l=this.texData.get(n.dataId),c=o.inChannels,f=u[0]*u[1]*u[2],d=o.outChannels,p=o.dataFormat==="channelsLast",h=(f===1||d===1)&&c>1e3,m=u[2]%2!=0&&!!l.isPacked;if(h||!Y().getBool("WEBGL_LAZILY_UNPACK")||!Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!m){var g=p?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,g,o.inChannels]),y=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var b=p?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),x={dataId:n.dataId,shape:[1,b,o.inChannels],dtype:n.dtype},w=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,I(Rl(l.shape,x.shape),function(){return"packed reshape "+l.shape+" to "+x.shape+" isn't free"});var S=this.reshape(r,[1,o.inChannels,o.outChannels]),E=this.fusedBatchMatMul({a:x,b:S,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),C=this.texData.get(E.dataId);return I(C.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=w,C.shape=o.outShape,V.makeTensorFromDataId(E.dataId,o.outShape,E.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var u=o.filterWidth,l=o.filterHeight,c=o.inChannels,f=o.outWidth,d=o.outHeight,p=o.dataFormat==="channelsLast",h=u*l*c,m=d*f,g=[h,m],v=n.squeeze([0]),y=r.reshape([1,h,-1]),b=new B4(g,v.shape,o),x=this.compileAndRun(b,[v]).reshape([1,g[0],g[1]]),w=i!=null,S=s!=null,E=a?Tl(a,!0):null,C=new jp(x.shape,[1,m,o.outChannels],!0,!1,w,E,S),k=[x,y];i&&k.push(i),S&&k.push(s);var _=this.compileAndRun(C,k);return p?_.reshape([1,d,f,o.outChannels]):_.reshape([1,o.outChannels,d,f])},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,u);if(Y().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,u);var l=a!=null,c=u!=null,f=s?Tl(s,!1):null,d=new tb(i,l,f,c),p=[r,o];return a&&p.push(a),u&&p.push(u),this.compileAndRun(d,p)},t.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(Y().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new tb(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerInput=function(n,r,o){var i=new e4(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerFilter=function(n,r,o){var i=new Z3(o);return this.compileAndRun(i,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,f=u?Tl(u,c):null,d=[o,i],p=s!=null,h=l!=null;return p&&d.push(s),h&&d.push(l),c?(r=new rb(a,p,f,h),this.compileAndRun(r,d)):(r=new nb(a,p,f,h),this.compileAndRun(r,d))},t.prototype.depthwiseConv2D=function(n,r,o){var i;return Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new rb(o),this.compileAndRun(i,[n,r])):(i=new nb(o),this.compileAndRun(i,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new o4(o);return this.compileAndRun(i,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new r4(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3d=function(n,r,o){var i=new i4(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerInput=function(n,r,o){var i=new n4(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerFilter=function(n,r,o){var i=new t4(o);return this.compileAndRun(i,[n,r])},t.prototype.maxPool=function(n,r){var o=new $p(r,"max",!1);return this.compileAndRun(o,[n])},t.prototype.avgPool=function(n,r){var o=new $p(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,o,i){var a=new $p(i,"max",!0),s=this.compileAndRun(a,[r]),u=new W4(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,o){var i=new W3(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.cast=function(n,r){return EC(n,r,this)},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.avgPool3d=function(n,r){var o=new Vp(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,o){var i=new U3(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var o=new Vp(r,"max",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new Vp(i,"max",!0),s=this.compileAndRun(a,[r]),u=new U4(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!Rl(n.shape,r)&&(o.texture===null||!Rl(o.shape,r))){var i=this.packedReshape(n,r);return V.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Fv(n,r)},t.prototype.resizeBilinear=function(n,r,o,i){var a=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Z4(n.shape,r,o,i):new J4(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,o){var i=new Q4(n,r,o);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new tM(n.shape,r,o,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new eM(n,r,o);return this.compileAndRun(i,[n])},t.prototype.multinomial=function(n,r,o,i){var a=r?n:wo(n),s=a.shape[0],u=a.shape[1],l=new z4(s,u,o),c=l.getCustomSetupFunc(i);return this.compileAndRun(l,[a],"int32",c)},t.prototype.oneHot=function(n,r,o,i){var a=new H4(n.size,r,o,i);return this.compileAndRun(a,[n])},t.prototype.diag=function(n){var r=new f4(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return Xc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Og(n.dataSync(),r.dataSync(),o,i,a)},t.prototype.cropAndResize=function(n,r,o,i,a,s){var u=new a4(n.shape,r.shape,i,a,s);return this.compileAndRun(u,[n,r,o],"float32")},t.prototype.depthToSpace=function(n,r,o){I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],l=a*r,c=s*r,f=u/(r*r),d=new c4(o==="NHWC"?[i,l,c,f]:[i,f,l,c],r,o);return this.compileAndRun(d,[n])},t.prototype.split=function(n,r,o){return RC(n,r,o)},t.prototype.scatterND=function(n,r,o){var i=tf(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,f=[c/u,u],d=n.reshape([s,a]),p=r.reshape([s,u]);if(c===0)return Fv(Xt([]),o);var h=ae(0),m=new sb(s,a,d.rank,p.rank,l,f);return this.compileAndRun(m,[p,d,h]).reshape(o)},t.prototype.sparseToDense=function(n,r,o,i){var a=tf(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.strides,c=a.outputSize,f=new sb(u,s,n.rank,r.rank,l,[c,1]);return this.compileAndRun(f,[r,n,i]).reshape(o)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new ib(m4,n.shape,r),a=new ib(g4,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(i,s),l=this.compileAndRun(a,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=gC(n,r),s=a[0],u=a[1],l=a[2],c=a[3],f=r.reshape([u,i]),d=n.reshape([n.size/l,l]),p=new x4(i,c,[u,l]);return this.compileAndRun(p,[d,f]).reshape(s)},t.prototype.fill=function(n,r,o){if((o=o||zu(r))==="string"){var i=Hc(o,ge(n));return i.fill(r),V.makeTensor(i,n,o,this)}var a=new y4(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,o){return _C(n,r,o)},t.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return V.makeTensorFromDataId(o,n,r,this)},t.prototype.unpackTensor=function(n){var r=new EM(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new G4(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var o=[qc(n.shape)].concat(Kc(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[qc(r)].concat(Kc(r)),s=new Y4(a,o),u=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,u=Mp(a);return r=i?new l4(u):new u4(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,o),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===ku.DENSE){var c=Js(n.outputShape);l.texShape=c.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),ge(u.shape)===0)return l.values=Eu(u.dtype,0),u;var f=[],d=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var x=s.texData.get(b.dataId);if(x.texture==null){if(!n.packedInputs&&ge(b.shape)<=Y().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:x.values};n.packedInputs&&(x.isPacked=!0,x.shape=b.shape)}else if(!!x.isPacked!=!!n.packedInputs)b=x.isPacked?s.unpackTensor(b):s.packTensor(b),f.push(b),x=s.texData.get(b.dataId);else if(x.isPacked&&!Rl(x.shape,b.shape)){var w=b,S=b.shape;b.shape=x.shape,b=s.packedReshape(b,S),f.push(b),x=s.texData.get(b.dataId),w.shape=S}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:x,isUniform:!1}});this.uploadToGPU(u.dataId);var p,h={shape:u.shape,texData:l,isUniform:!1},m=function(b,x,w){var S="";x.concat(w).forEach(function(k){var _=k.texData!=null&&k.texData.slice!=null&&k.texData.slice.flatOffset>0,T=k.isUniform?"uniform":k.texData.texShape;S+=k.shape+"_"+T+"_"+_});var E=b.userCode,C=b.constructor.name;return C+="_"+S+"_"+E}(n,d,h),g=this.getAndSaveBinary(m,function(){return function(b,x,w,S){var E=x.userCode,C=w.map(function(O,L){var B={logicalShape:O.shape,texShape:O.isUniform?null:O.texData.texShape,isUniform:O.isUniform,isPacked:!O.isUniform&&O.texData.isPacked,flatOffset:null};return O.texData!=null&&O.texData.slice!=null&&O.texData.slice.flatOffset>0&&(B.flatOffset=O.texData.slice.flatOffset),{name:x.variableNames[L],shapeInfo:B}}),k=C.map(function(O){return O.shapeInfo}),_={logicalShape:S.shape,texShape:S.texData.texShape,isUniform:!1,isPacked:S.texData.isPacked,flatOffset:null},T=F3(C,_,E,x.packedInputs),D=b.createProgram(T),U=null,j=b.getUniformLocation(D,"NAN",!1);Y().getNumber("WEBGL_VERSION")===1&&(U=b.getUniformLocation(D,"INFINITY",!1));for(var A={},M=0;M<x.variableNames.length;M++){var $=x.variableNames[M];A[$]=b.getUniformLocation(D,$,!1),A["offset"+$]=b.getUniformLocation(D,"offset"+$,!1)}return{program:x,source:T,webGLProgram:D,uniformLocations:A,inShapeInfos:k,outShapeInfo:_,infLoc:U,nanLoc:j}}(s.gpgpu,n,d,h)}),v=this.activeTimers!=null;if(v&&(p=this.startTimer()),function(b,x,w,S,E){ab(x.inShapeInfos,w),ab([x.outShapeInfo],[S]);var C=S.texData.texture,k=S.texData.texShape;S.texData.isPacked?b.setOutputPackedMatrixTexture(C,k[0],k[1]):b.setOutputMatrixTexture(C,k[0],k[1]),b.setProgram(x.webGLProgram),Y().getNumber("WEBGL_VERSION")===1&&x.infLoc!==null&&b.gl.uniform1f(x.infLoc,1/0),x.nanLoc!==null&&b.gl.uniform1f(x.nanLoc,NaN),w.forEach(function(_,T){var D=x.program.variableNames[T],U=x.uniformLocations[D],j=x.uniformLocations["offset"+D];if(U!=null)if(_.isUniform)if(ge(_.shape)<2)b.gl.uniform1f(U,_.uniformValues[0]);else{var A=_.uniformValues;A instanceof Float32Array||(A=new Float32Array(A)),b.gl.uniform1fv(U,A)}else _.texData.slice!=null&&j!=null&&b.gl.uniform1i(j,_.texData.slice.flatOffset),b.setInputMatrixTexture(_.texData.texture,U,T)}),E!=null&&E(b,x.webGLProgram),b.executeProgram()}(this.gpgpu,g,d,h,i),f.forEach(function(b){return s.disposeData(b.dataId)}),v&&(p=this.endTimer(p),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(p)})),!Y().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return V.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(Y().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ue(function(){if(!Y().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=Y().getBool("DEBUG");Y().set("DEBUG",!1);var o=n.abs(ae(1e-8)).dataSync()[0];if(Y().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,u=o.texture,l=o.usage,c=o.isPacked;if(u==null){var f,d=this.activeTimers!=null;d&&(f=Br());var p=o.texShape;if(p==null&&(p=DA(i,c),o.texShape=p),s!=null){var h=Mp(i),m=void 0,g=p[1],v=p[0],y=s instanceof Uint8Array;c?(g=(r=Gu(p[0],p[1]))[0],v=r[1],m=new v4(h,[v,g],y)):m=new h4(h,[v,g],y);var b=this.makeTensorInfo([v,g],a);this.texData.get(b.dataId).usage=y?zn.PIXELS:zn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),g,v,s);var x=this.runWebGLProgram(m,[b],a,null,!0),w=this.texData.get(x.dataId);o.texture=w.texture,o.texShape=w.texShape,o.isPacked=w.isPacked,o.usage=w.usage,this.disposeData(b.dataId),this.texData.delete(x.dataId),o.values=null,d&&(this.uploadWaitMs+=Br()-f)}else{var S=this.acquireTexture(p,l,a,c);o.texture=S}}},t.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),l=0;l<u.length;++l)u[l]=Math.round(a[l]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},t.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*ZS(r)},t}(SC);aC()&&V.registerBackend("webgl",function(){return new kM},2);var RM=F({square_:function(e){var t=R(e,"x","square"),n=[t];return V.runKernelFunc(function(r,o){return o([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),Pu="SquaredDifference",VC=F({squaredDifference_:function(e,t){var n,r=R(e,"a","squaredDifference"),o=R(t,"b","squaredDifference");n=ht(r,o),r=n[0],o=n[1],Be(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return V.runKernelFunc(function(s,u){var l=s.squaredDifference(r,o);return u([r,o]),l},i,function(s,u){var l=u[0],c=u[1],f=ae(2);return{a:function(){return s.mul(l.sub(c).mul(f))},b:function(){return s.mul(c.sub(l).mul(f))}}},Pu,{},a,[])}}),PM=F({abs_:function(e){var t=R(e,"x","abs");return t.dtype==="complex64"?V.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):V.runKernelFunc(function(n,r){var o=n.abs(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),IM=F({acos_:function(e){var t=R(e,"x","acos");return V.runKernelFunc(function(n,r){var o=n.acos(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ae(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),OM=F({acosh_:function(e){var t=R(e,"x","acosh");return V.runKernelFunc(function(n,r){var o=n.acosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),TM=F({asin_:function(e){var t=R(e,"x","asin");return V.runKernelFunc(function(n,r){var o=n.asin(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ae(1).sub(o.toFloat().square()).sqrt())}}})}}),DM=F({asinh_:function(e){var t=R(e,"x","asinh");return V.runKernelFunc(function(n,r){var o=n.asinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ae(1).add(o.toFloat().square()).sqrt())}}})}}),NM=F({atan_:function(e){var t=R(e,"x","atan");return V.runKernelFunc(function(n,r){var o=n.atan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),AM=F({atanh_:function(e){var t=R(e,"x","atanh");return V.runKernelFunc(function(n,r){var o=n.atanh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(ae(1).sub(o.toFloat().square()))}}})}}),MM=F({ceil_:function(e){var t=R(e,"x","ceil");return V.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return $e(n)}}})}}),Fg=F({clipByValue_:function(e,t,n){var r=R(e,"x","clipByValue");I(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var o=[r],i={min:t,max:n};return V.runKernelFunc(function(a,s){var u=a.clip(r,t,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),$e(a))}}},"ClipByValue",i,o)}}),FM=F({cos_:function(e){var t=R(e,"x","cos"),n=[t];return V.runKernelFunc(function(r,o){var i=r.cos(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),LM=F({cosh_:function(e){var t=R(e,"x","cosh");return V.runKernelFunc(function(n,r){var o=n.cosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),BM=F({erf_:function(e){var t=R(e,"x","erf");return I(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),V.runKernelFunc(function(n,r){var o=n.erf(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Bv=F({exp_:function(e){var t=R(e,"x","exp");return V.runKernelFunc(function(n,r){var o=n.exp(t);return r([o]),o},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),jM=F({expm1_:function(e){var t=R(e,"x","expm1");return V.runKernelFunc(function(n,r){var o=n.expm1(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),$M=F({floor_:function(e){var t=R(e,"x","floor");return V.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return $e(n)}}})}}),VM=F({log_:function(e){var t=R(e,"x","log"),n=[t];return V.runKernelFunc(function(r,o){var i=r.log(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),WM=F({log1p_:function(e){var t=R(e,"x","log1p");return V.runKernelFunc(function(n,r){var o=n.log1p(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),UM=F({logSigmoid_:function(e){var t=R(e,"x","logSigmoid");return V.runKernelFunc(function(n,r){var o=n.softplus(t.neg()).neg();return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),af=F({neg_:function(e){var t=R(e,"x","neg"),n=[t];return V.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),zM=F({reciprocal_:function(e){var t=R(e,"x","reciprocal");return V.runKernelFunc(function(n,r){var o=n.reciprocal(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),HM=F({round_:function(e){var t=R(e,"x","round");return V.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return $e(n)}}})}}),WC=F({rsqrt_:function(e){var t=R(e,"x","rsqrt"),n=[t];return V.runKernelFunc(function(r,o){var i=r.rsqrt(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),UC=F({sigmoid_:function(e){var t=R(e,"x","sigmoid");return V.runKernelFunc(function(n,r){var o=n.sigmoid(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(ae(1).sub(o)))}}},"Sigmoid")}}),GM=F({sign_:function(e){var t=R(e,"x","sign");return V.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return $e(n)}}})}}),qM=F({isNaN_:function(e){var t=R(e,"x","isNaN");return V.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return $e(n)}}})}}),KM=F({isInf_:function(e){var t=R(e,"x","isInf");return V.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return $e(n)}}})}}),XM=F({isFinite_:function(e){var t=R(e,"x","isFinite");return V.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return $e(n)}}})}}),YM=F({sin_:function(e){var t=R(e,"x","sin"),n=[t];return V.runKernelFunc(function(r,o){var i=r.sin(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),QM=F({sinh_:function(e){var t=R(e,"x","sinh");return V.runKernelFunc(function(n,r){var o=n.sinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),JM=F({softplus_:function(e){var t=R(e,"x","softplus");return V.runKernelFunc(function(n,r){var o=n.softplus(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),ZM=F({sqrt_:function(e){var t=R(e,"x","sqrt");return V.runKernelFunc(function(n,r){var o=n.sqrt(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),eF=F({step_:function(e,t){t===void 0&&(t=0);var n=R(e,"x","step");return V.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return $e(r)}}})}}),tF=F({tan_:function(e){var t=R(e,"x","tan");return V.runKernelFunc(function(n,r){var o=n.tan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),nF=F({tanh_:function(e){var t=R(e,"x","tanh");return V.runKernelFunc(function(n,r){var o=n.tanh(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return ae(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function zC(e,t,n,r,o,i){var a,s,u=R(e,"x","batchNorm"),l=R(t,"mean","batchNorm"),c=R(n,"variance","batchNorm");return o!=null&&(a=R(o,"scale","batchNorm")),r!=null&&(s=R(r,"offset","batchNorm")),I(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),I(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Ku(u,l,c,s,a,i)}function HC(e,t,n,r,o,i){var a,s,u=R(e,"x","batchNorm"),l=R(t,"mean","batchNorm"),c=R(n,"variance","batchNorm");return o!=null&&(a=R(o,"scale","batchNorm")),r!=null&&(s=R(r,"offset","batchNorm")),I(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),I(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Ku(u,l,c,s,a,i)}function GC(e,t,n,r,o,i){var a,s,u=R(e,"x","batchNorm"),l=R(t,"mean","batchNorm"),c=R(n,"variance","batchNorm");return o!=null&&(a=R(o,"scale","batchNorm")),r!=null&&(s=R(r,"offset","batchNorm")),I(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),I(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),I(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Ku(u,l,c,s,a,i)}function Ku(e,t,n,r,o,i){i==null&&(i=.001);var a,s,u,l=R(e,"x","batchNorm"),c=R(t,"mean","batchNorm"),f=R(n,"variance","batchNorm");o!=null&&(a=R(o,"scale","batchNorm")),r!=null&&(s=R(r,"offset","batchNorm")),I(c.rank===f.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),I(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),I(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var d=[l,c,f,a];return V.runKernelFunc(function(p,h){var m=p.batchNormalization(u,Dl(c),Dl(f),i,Dl(a),Dl(s));return h([l,c,f,a]),m},{x:l,mean:c,variance:f,scale:a,offset:s},function(p,h){var m=h,g=m[0],v=m[1],y=m[2],b=m[3],x=b??ae(1),w=At(v.shape,u.shape),S=[];if(v.rank===1){for(var E=0;E<u.shape.length-1;++E)S.push(u.shape[E]);S.push(1)}var C=g.sub(v),k=p.mul(x),_=WC(y.add(ae(i))),T=_.mul(_).mul(_).mul(ae(-.5));return{x:function(){return v.rank===1?p.mul(Ba(_.as4D(1,1,1,v.shape[0]),S)).mul(x).reshape(g.shape):p.mul(_).mul(x).reshape(g.shape)},mean:function(){var D=_.mul(ae(-1)).mul(k);return v.rank===1&&(D=D.sum(w)),D.reshape(v.shape)},variance:function(){var D=T.mul(C).mul(k);return v.rank===1&&(D=D.sum(w)),D.reshape(v.shape)},scale:function(){var D=C.mul(_),U=p.mul(D);return v.rank===1&&(U=U.sum(w)),U.reshape(v.shape)},offset:function(){var D=p;return v.rank===1&&(D=D.sum(w)),D.reshape(v.shape)}}},"BatchNormalization",{varianceEpsilon:i},d).reshape(l.shape)}function Dl(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function xd(){sC("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var rF=F({batchNormalization2d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),xd(),zC(e,t,n,i,o,r)}}),oF=F({batchNormalization3d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),xd(),HC(e,t,n,i,o,r)}}),iF=F({batchNormalization4d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),xd(),GC(e,t,n,i,o,r)}}),aF=F({batchNormalization_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),xd(),Ku(e,t,n,i,o,r)}}),qC=F({batchNorm_:Ku}),sF=F({batchNorm2d_:zC}),uF=F({batchNorm3d_:HC}),lF=F({batchNorm4d_:GC}),wd=F({logicalAnd_:function(e,t){var n=R(e,"a","logicalAnd","bool"),r=R(t,"b","logicalAnd","bool");return Be(n.shape,r.shape),V.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),cF=F({logicalNot_:function(e){var t=R(e,"x","logicalNot","bool");return V.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),KC=F({logicalOr_:function(e,t){var n=R(e,"a","logicalOr","bool"),r=R(t,"b","logicalOr","bool");return Be(n.shape,r.shape),V.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),fF=F({logicalXor_:function(e,t){var n=R(e,"a","logicalXor","bool"),r=R(t,"b","logicalXor","bool");return Be(n.shape,r.shape),KC(e,t).logicalAnd(wd(e,t).logicalNot())}}),zi=F({where_:function(e,t,n){var r=R(t,"a","where"),o=R(n,"b","where"),i=R(e,"condition","where","bool");return qe(r.shape,o.shape,"Error in where: "),i.rank===1?I(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):qe(i.shape,o.shape,"Error in where: "),V.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return $e(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),XC=function(e){return de(this,void 0,void 0,function(){var t,n,r;return pe(this,function(o){switch(o.label){case 0:return[4,(t=R(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=Dg(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Fe=F({add_:function(e,t){var n,r=R(e,"a","add"),o=R(t,"b","add");n=ht(r,o),r=n[0],o=n[1];var i=Be(r.shape,o.shape);return V.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=At(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=At(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),dF=F({addN_:function(e){I(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),I(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(o,i){return R(o,"tensors"+i,"addN")}),n=t[0];t.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(o){if(!$t(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return V.runKernelFunc(function(o){return o.addN(t)},r,function(o){var i={};return t.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),pF=F({addStrict_:function(e,t){var n=R(e,"a","addStrict"),r=R(t,"b","addStrict");return qe(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),hF=F({atan2_:function(e,t){var n,r=R(e,"a","atan2"),o=R(t,"b","atan2");n=ht(r,o),r=n[0],o=n[1];var i=Be(r.shape,o.shape);return V.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=Fe(u.square(),l.square()),f=a.mul(l.div(c)),d=At(u.shape,i);return d.length>0&&(f=f.sum(d)),f.reshape(u.shape)},$b:function(){var c=Fe(u.square(),l.square()),f=af(a.mul(u.div(c))),d=At(l.shape,i);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}})}}),wr=F({div_:function(e,t){var n,r=R(e,"a","div"),o=R(t,"b","div");if(n=ht(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return YC(r,o);var i=Be(r.shape,o.shape);return V.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),f=At(u.shape,i);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),f=At(l.shape,i);f.length>0&&(c=c.sum(f).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"Div")}}),vF=F({divNoNan_:function(e,t){var n,r=R(e,"a","div"),o=R(t,"b","div");r=(n=ht(r,o))[0],o=n[1];var i=wr(r,o),a=$e(i),s=o.equal(a);return zi(s,a,i)}}),mF=F({divStrict_:function(e,t){var n=R(e,"a","div"),r=R(t,"b","div");return qe(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),YC=F({floorDiv_:function(e,t){var n,r=R(e,"a","floorDiv"),o=R(t,"b","floorDiv");n=ht(r,o),r=n[0],o=n[1];var i=Be(r.shape,o.shape);return V.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),f=At(u.shape,i);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),f=At(l.shape,i);f.length>0&&(c=c.sum(f).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"FloorDiv")}}),Lg=F({maximum_:function(e,t){var n,r=R(e,"a","maximum"),o=R(t,"b","maximum");return n=ht(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Be(r.shape,o.shape),V.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),gF=F({maximumStrict_:function(e,t){var n=R(e,"a","maximumStrict"),r=R(t,"b","maximumStrict");return qe(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),QC=F({minimum_:function(e,t){var n,r=R(e,"a","minimum"),o=R(t,"b","minimum");return n=ht(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Be(r.shape,o.shape),V.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),yF=F({minimumStrict_:function(e,t){var n=R(e,"a","minimumStrict"),r=R(t,"b","minimumStrict");return qe(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),bF=F({mod_:function(e,t){var n,r=R(e,"a","mod"),o=R(t,"b","mod");n=ht(r,o),r=n[0],o=n[1];var i=Be(r.shape,o.shape);return V.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=At(u.shape,i);return c.length>0?a.sum(c).reshape(u.shape):a},$b:function(){var c=a.mul(u.div(l).floor().neg()),f=At(l.shape,i);return f.length>0?c.sum(f).reshape(l.shape):c}}})}}),xF=F({modStrict_:function(e,t){var n=R(e,"a","modStrict"),r=R(t,"b","modStrict");return qe(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),dn=F({mul_:function(e,t){var n,r=R(e,"a","mul"),o=R(t,"b","mul");n=ht(r,o),r=n[0],o=n[1];var i=Be(r.shape,o.shape);return V.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.mul(l.toFloat()),f=At(u.shape,i);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),f=At(l.shape,i);return f.length>0?c.sum(f).reshape(l.shape):c}}},"Mul")}}),wF=F({mulStrict_:function(e,t){var n=R(e,"a","mul"),r=R(t,"b","mul");return qe(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),sf=F({pow_:function(e,t){var n,r=R(e,"base","pow"),o=R(t,"exp","pow");n=ht(r,o),r=n[0],o=n[1];var i=Be(r.shape,o.shape),a=[r,o];return V.runKernelFunc(function(s,u){var l=s.pow(r,o);return u([r,o,l]),l},{a:r,b:o},function(s,u){var l=u[0],c=u[1],f=u[2];return{a:function(){var d=c.toFloat(),p=s.mul(d.mul(l.pow(d.sub(ae(1))))),h=At(l.shape,i);return h.length>0&&(p=p.sum(h)),p.reshape(l.shape)},b:function(){var d=l.greater(0),p=l.log().where(d,$e(l)),h=s.mul(f.mul(p)),m=At(c.shape,i);return m.length>0&&(h=h.sum(m)),h.reshape(c.shape)}}},"Pow",{},a,[!0])}}),SF=F({powStrict_:function(e,t){return qe(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),CF=F({squaredDifferenceStrict_:function(e,t){var n=R(e,"a","squaredDifferenceStrict"),r=R(t,"b","squaredDifferenceStrict");return qe(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Mt=F({sub_:function(e,t){var n,r=R(e,"a","sub"),o=R(t,"b","sub");n=ht(r,o),r=n[0],o=n[1];var i=Be(r.shape,o.shape);return V.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=At(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=At(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),EF=F({subStrict_:function(e,t){var n=R(e,"a","subStrict"),r=R(t,"b","subStrict");return qe(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),JC=F({equal_:function(e,t){var n,r=R(e,"a","equal"),o=R(t,"b","equal");return n=ht(r,o),r=n[0],o=n[1],Be(r.shape,o.shape),V.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),_F=F({equalStrict_:function(e,t){var n=R(e,"a","equalStrict"),r=R(t,"b","equalStrict");return qe(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),kF=F({greater_:function(e,t){var n,r=R(e,"a","greater"),o=R(t,"b","greater");return n=ht(r,o),r=n[0],o=n[1],Be(r.shape,o.shape),V.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),ZC=F({greaterEqual_:function(e,t){var n,r=R(e,"a","greaterEqual"),o=R(t,"b","greaterEqual");return n=ht(r,o),r=n[0],o=n[1],Be(r.shape,o.shape),V.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return $e(s)},b:function(){return $e(u)}}},"GreaterEqual")}}),RF=F({greaterEqualStrict_:function(e,t){var n=R(e,"a","greaterEqualStrict"),r=R(t,"b","greaterEqualStrict");return qe(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),PF=F({greaterStrict_:function(e,t){var n=R(e,"a","greaterStrict"),r=R(t,"b","greaterStrict");return qe(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),IF=F({less_:function(e,t){var n,r=R(e,"a","less"),o=R(t,"b","less");return n=ht(r,o),r=n[0],o=n[1],Be(r.shape,o.shape),V.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),OF=F({lessEqual_:function(e,t){var n,r=R(e,"a","lessEqual"),o=R(t,"b","lessEqual");return n=ht(r,o),r=n[0],o=n[1],Be(r.shape,o.shape),V.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),TF=F({lessEqualStrict_:function(e,t){var n=R(e,"a","lessEqualStrict"),r=R(t,"b","lessEqualStrict");return qe(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),DF=F({lessStrict_:function(e,t){var n=R(e,"a","lessStrict"),r=R(t,"b","lessStrict");return qe(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),NF=F({notEqual_:function(e,t){var n,r=R(e,"a","notEqual"),o=R(t,"b","notEqual");return n=ht(r,o),r=n[0],o=n[1],Be(r.shape,o.shape),V.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),AF=F({notEqualStrict_:function(e,t){var n=R(e,"a","notEqualStrict"),r=R(t,"b","notEqualStrict");return qe(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function mb(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function gb(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Bg=F({gather_:function(e,t,n){n===void 0&&(n=0);var r=R(e,"x","gather"),o=R(t,"indices","gather","int32");n=Ft(n,r.shape)[0];var i=function(a,s,u){for(var l=a.shape[u],c=[],f=1,d=1,p=0;p<u;p++)c.push(a.shape[p]),f*=a.shape[p];for(p=0;p<s.rank;p++)c.push(s.shape[p]);for(p=u+1;p<a.rank;p++)c.push(a.shape[p]),d*=a.shape[p];return{batchSize:f,sliceSize:d,dimSize:l,outputShape:c}}(r,o,n);return V.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,f=l.slice(0,n),d=f.length,p=l.slice(n,l.length).slice(1),h=p.length,m=mb(0,d),g=mb(d+1,d+1+h),v=gb([f,[c],p]),y=a.reshape(v),b=u.reshape([c]),x=gb([[d],m,g]),w=y.transpose(x),S=eE(w,b,r.shape[n]),E=Eg(x);return S=S.transpose(E)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),eE=F({unsortedSegmentSum_:function(e,t,n){var r=R(e,"x","unsortedSegmentSum"),o=R(t,"segmentIds","unsortedSegmentSum","int32");return I(wt(n),function(){return"numSegments must be of dtype int"}),V.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,l){for(var c=Lg(l,$e(l)),f=Bg(u,c),d=ZC(l,ae(0,"int32")),p=f.rank-d.rank,h=0;h<p;++h)d=rr(d,h+1);d=wd(d,ms(f.shape,"bool"));var m=$e(f);return zi(d,f,m)}(i,s)}}})}}),MF=function(e,t,n){return de(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,f,d,p,h,m;return pe(this,function(g){switch(g.label){case 0:for(r=R(e,"tensor","boolMask"),o=R(t,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,I(a>0,function(){return"mask cannot be scalar"}),qe(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+a;l++)u*=s[l];return c=s.slice(0,i).concat([u],s.slice(i+a)),f=r.reshape(c),d=o.reshape([-1]),[4,XC(d)];case 1:return p=g.sent(),h=p.squeeze([1]),m=Bg(f,h,i),e!==r&&r.dispose(),t!==o&&o.dispose(),h.dispose(),f.dispose(),d.dispose(),p.dispose(),[2,m]}})})};function tE(e,t,n,r,o,i,a){i===void 0&&(i="NHWC"),I(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),I(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),I(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),I(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=i==="NHWC"?s[3]:s[1],f=i==="NHWC"?u.shape[3]:u.shape[1];I(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),I(f===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&I(wt(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=Ig(i),p=Ji(s,n.shape,r,1,o,a,!1,d),h=V.runKernelFunc(function(m,g){var v=m.conv2dDerInput(u,n,p);return g([n,u]),v},{dy4D:u,filter:n},function(m,g){var v=g[0],y=g[1];return{dy4D:function(){return dr(m,v,r,o,i,1,a)},filter:function(){return jg(m,y,v.shape,r,o,i,a)}}});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function Up(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function nE(e,t,n,r,o){I(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,a=t,s=!1;t.rank===4&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],l=a.shape[4];I(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),I(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),I(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),I(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),I(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=rf(i,n.shape,r,1,o),f=V.runKernelFunc(function(d){return d.conv3dDerInput(a,n,c)},{dy5D:a});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var FF=F({conv1d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=R(e,"x","conv1d"),u=R(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),I(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),I(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&I(wt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),I(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),I(Nn(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),I(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),p=dr(d,f,[1,n],r,"NHWC",[1,i],a);return c?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),dr=F({conv2d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=R(e,"x","conv2d"),u=R(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),I(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&I(wt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var f=o==="NHWC"?l.shape[3]:l.shape[1];I(f===u.shape[2],function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."}),I(Nn(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var d=Ig(o),p=Ji(l.shape,u.shape,n,i,r,a,!1,d),h=[u,l],m=V.runKernelFunc(function(g,v){var y=g.conv2d(l,u,p);return v([u,l]),y},{x:l,filter:u},function(g,v){var y=v,b=y[0],x=y[1];return I(os(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return rE(x.shape,g,b,n,r,o)},filter:function(){return jg(x,g,b.shape,n,r,o)}}},"Conv2D",p,h);return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),LF=F({conv3d_:function(e,t,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=R(e,"x","conv3d"),s=R(t,"filter","conv3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),I(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),I(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),I(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),I(function(d,p){return Up(d)||Up(p)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),I(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=rf(u.shape,s.shape,n,i,r),f=V.runKernelFunc(function(d,p){var h=d.conv3d(u,s,c);return p([u,s]),h},{x:u,$filter:s},function(d,p){I(Up(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var h=p[0],m=p[1];return{x:function(){return nE(h.shape,d,m,n,r)},$filter:function(){return function(g,v,y,b,x){var w=g;g.rank===4&&(w=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var S=v;S.rank===4&&(S=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),I(w.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+w.shape+"."}),I(S.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+S.shape+"."}),I(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),I(w.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+w.shape[4]+") must match input depth in filter ("+y[3]+"."}),I(S.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+S.shape[4]+") must match output depth for filter ("+y[4]+")."});var E=rf(w.shape,y,b,1,x);return V.runKernelFunc(function(C){return C.conv3dDerFilter(w,S,E)},{x5D:w,dy5D:S})}(h,d,m.shape,n,r)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),jg=F({conv2dDerFilter_:function(e,t,n,r,o,i,a){i===void 0&&(i="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),I(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),I(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),I(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?u.shape[3]:u.shape[1];I(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),I(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),a!=null&&I(wt(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=Ig(i),d=Ji(s.shape,n,r,1,o,a,!1,f);return V.runKernelFunc(function(p){return p.conv2dDerFilter(s,u,d)},{x4D:s,dy4D:u})}}),rE=F({conv2dDerInput_:tE}),Sd=F({depthwiseConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=R(e,"x","depthwiseConv2d"),u=R(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),I(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),I(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),I(Nn(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&I(wt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var f=Ji(l.shape,u.shape,n,i,r,a,!0),d=[l,u],p=V.runKernelFunc(function(h,m){var g=h.depthwiseConv2D(l,u,f);return m([l,u]),g},{x:l,filter:u},function(h,m){I(os(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var g=m[0],v=m[1];return{x:function(){return oE(g.shape,h,v,f)},filter:function(){return iE(g,h,v.shape,f)}}},"DepthwiseConv2dNative",f,d);return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),oE=F({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,i=!1;t.rank===3&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=V.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),iE=F({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;e.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),V.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),$g=F({separableConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=R(e,"x","separableConv2d"),u=R(t,"depthwiseFilter","separableConv2d"),l=R(n,"pointwiseFilter","separableConv2d"),c=s,f=!1;if(s.rank===3&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");I(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),I(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),I(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),I(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),I(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var d=u.shape[2],p=u.shape[3];I(l.shape[2]===d*p,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*p+", but got "+l.shape[2]+"."});var h=Sd(c,u,r,o,a,i),m=dr(h,l,1,"valid",a);return f?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),BF=F({conv2dTranspose_:function(e,t,n,r,o,i){return tE(n,R(e,"x","conv2dTranspose"),R(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),jF=F({conv3dTranspose_:function(e,t,n,r,o){return nE(n,R(e,"x","conv3dTranspose"),R(t,"filter","conv3dTranspose"),r,o)}}),Cd=F({matMul_:function(e,t,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=R(e,"a","matMul"),a=R(t,"b","matMul");o=ht(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],f=i.shape.slice(0,-2),d=a.shape.slice(0,-2),p=ge(f),h=ge(d);I(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),I($t(f,d),function(){return"Error in matMul: outer dimensions ("+f+") and ("+d+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),I(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var m=i.shape.slice(0,-2).concat([l,c]),g=n?i.as3D(p,s,l):i.as3D(p,l,s),v=r?a.as3D(h,c,u):a.as3D(h,u,c),y={transposeA:n,transposeB:r};return V.runKernelFunc(function(b,x){var w=b.batchMatMul(g,v,n,r);return x([g,v]),w},{a:g,b:v},function(b,x){var w=x,S=w[0],E=w[1];return n||r?!n&&r?{a:function(){return b.matMul(E,!1,!1)},b:function(){return b.matMul(S,!0,!1)}}:n&&!r?{a:function(){return E.matMul(b,!1,!0)},b:function(){return S.matMul(b,!1,!1)}}:{a:function(){return E.matMul(b,!0,!0)},b:function(){return b.matMul(S,!0,!0)}}:{a:function(){return b.matMul(E,!1,!0)},b:function(){return S.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(m)}}),$F=F({dot_:function(e,t){var n=R(e,"t1","dot"),r=R(t,"t2","dot");I(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return I(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),VF=F({outerProduct_:function(e,t){var n=R(e,"v1","outerProduct"),r=R(t,"v2","outerProduct");return I(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Xu=F({reverse_:function(e,t){var n=R(e,"x","reverse");if(n.rank===0)return n.clone();var r=Ft(t,n.shape);return V.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),WF=F({reverse1d_:function(e){var t=R(e,"x","reverse");return I(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Xu(t,0)}}),UF=F({reverse2d_:function(e,t){var n=R(e,"x","reverse");return I(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Xu(n,t)}}),zF=F({reverse3d_:function(e,t){var n=R(e,"x","reverse");return I(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Xu(n,t)}}),HF=F({reverse4d_:function(e,t){var n=R(e,"x","reverse");return I(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Xu(n,t)}});function aE(e,t,n,r,o,i){var a=R(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),I(Nn(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&I(wt(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Ru(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&$t(l.inShape,l.outShape))return a.clone();var c=[s],f=V.runKernelFunc(function(d,p){var h=d.maxPool(s,l);return p([s,h]),h},{x:s},function(d,p){var h=p[0],m=p[1];return{x:function(){return function(g,v,y,b,x,w,S,E){var C=R(g,"dy","maxPoolBackprop"),k=R(v,"input","maxPoolBackprop"),_=R(y,"output","maxPoolBackprop");I(k.rank===C.rank,function(){return"Rank of input ("+k.rank+") does not match rank of dy ("+C.rank+")"}),I(Nn(x,w),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),I(C.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+C.rank+"."}),I(k.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+k.rank+"."});var T=Ru(k.shape,b,x,w,S,E);return V.runKernelFunc(function(D){return D.maxPoolBackprop(C,k,_,T)},{$dy:C,$input:k})}(d,h,m,t,n,r,o)}}},"MaxPool",l,c);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function sE(e,t,n,r,o,i){var a=R(e,"x","avgPool","float32");I(Nn(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&I(wt(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Ru(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&$t(l.inShape,l.outShape))return a.clone();var c=V.runKernelFunc(function(f){return f.avgPool(s,l)},{x:s},function(f){return{x:function(){return function(d,p,h,m,g,v){var y=R(d,"dy","avgPoolBackprop"),b=R(p,"input","avgPoolBackprop");I(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),I(Nn(m,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+g+"'"});var x=b,w=y,S=!1;b.rank===3&&(S=!0,x=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),w=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),I(w.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+w.rank+"."}),I(x.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var E=Ru(x.shape,h,m,g,v),C=V.runKernelFunc(function(k){return k.avgPoolBackprop(w,x,E)},{dy4D:w,input4D:x});return S?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}(f,s,t,n,r,o)}}},"AvgPool",l);return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var Lt=F({maxPool_:function(e,t,n,r,o){return aE(e,t,n,1,r,o)}}),Yu=F({avgPool_:function(e,t,n,r,o){return sE(e,t,n,1,r,o)}}),GF=F({pool_:function(e,t,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=R(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(Nn(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var l,c=Ru(s.shape,t,i,o,r),f=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(x,w){var S=x.map(function(k,_){return k+(k-1)*(w[_]-1)}).map(function(k){return k-1}),E=S.map(function(k){return Math.floor(k/2)}),C=S.map(function(k,_){return k-E[_]});return S.map(function(k,_){return[E[_],C[_]]})}([c.filterHeight,c.filterWidth],f):[[0,0],[0,0]];var d=f[0]===1&&f[1]===1,p=function(x,w,S){var E=S.map(function(j){return j[0]}),C=S.map(function(j){return j[1]}),k=x.concat(E,C),_=w.map(function(j,A){return(j-k[A]%j)%j}),T=C.map(function(j,A){return j+_[A]}),D=w.map(function(j,A){return[E[A],T[A]]}),U=w.map(function(j,A){return[0,_[A]]});return[D,U]}([c.inHeight,c.inWidth],f,l),h=p[0],m=p[1],g=d?r:"valid",v=d?s:pC(s,f,h),y=(n==="avg"?function(){return sE(v,t,i,1,g)}:function(){return aE(v,t,i,1,g)})(),b=d?y:cC(y,f,m);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),qF=F({maxPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=R(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),I(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),I(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(Nn(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&I(wt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=nf(u.shape,t,n,a,r,o,i),f=V.runKernelFunc(function(d,p){var h=d.maxPool3d(u,c);return p([u,h]),h},{x:u},function(d,p){var h=p[0],m=p[1];return{x:function(){return function(g,v,y,b,x,w,S,E){var C=R(g,"dy","maxPool3dBackprop"),k=R(v,"input","maxPool3dBackprop"),_=R(y,"output","maxPool3dBackprop"),T=C,D=k,U=_,j=!1;k.rank===4&&(j=!0,T=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3]),D=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),U=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3])),I(T.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+T.rank+"."}),I(D.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+D.rank+"."}),I(U.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+U.rank+"."}),w==null&&(w=[1,1,1]),I(Nn(x,w),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),E!=null&&I(wt(S),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+E+" but got pad "+S+"."});var A=nf(D.shape,b,x,w,S,E),M=V.runKernelFunc(function($){return $.maxPool3dBackprop(T,D,U,A)},{dy5D:T,input5D:D});return j?M.as4D(M.shape[1],M.shape[2],M.shape[3],M.shape[4]):M}(d,h,m,t,n,a,r,o)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),KF=F({avgPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=R(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),I(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),I(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(Nn(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&I(wt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=nf(u.shape,t,n,a,r,o,i),f=V.runKernelFunc(function(d){return d.avgPool3d(u,c)},{x:u},function(d){return{x:function(){return function(p,h,m,g,v,y,b){var x=R(p,"dy","avgPool3dBackprop"),w=R(h,"input","avgPool3dBackprop"),S=x,E=w,C=!1;w.rank===4&&(C=!0,S=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),E=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3])),I(S.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+S.rank+"."}),I(E.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+E.rank+"."}),v==null&&(v=[1,1,1]),I(Nn(g,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+v+"'"}),b!=null&&I(wt(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var k=nf(E.shape,m,g,v,y,b),_=V.runKernelFunc(function(T){return T.avgPool3dBackprop(S,E,k)},{dy5D:S,input5D:E});return C?_.as4D(_.shape[1],_.shape[2],_.shape[3],_.shape[4]):_}(d,u,t,n,a,r,o)}}});return f=f.cast(u.dtype),l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),Jr=F({slice_:function(e,t,n){var r,o,i=R(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(u){I(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(I(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),i.shape[l]-r[l])}),S3(i,r,o);var a=i.shape,s={begin:r,size:o};return V.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],a[c]-r[c]-o[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),XF=F({slice1d_:function(e,t,n){var r=R(e,"x","slice1d");return I(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Jr(r,[t],[n])}}),YF=F({slice2d_:function(e,t,n){var r=R(e,"x","slice2d");return I(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Jr(r,t,n)}}),uE=F({slice3d_:function(e,t,n){var r=R(e,"x","slice3d");return I(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Jr(r,t,n)}}),QF=F({slice4d_:function(e,t,n){var r=R(e,"x","slice4d");return I(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Jr(r,t,n)}});function lE(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape(Dn(t.shape,r))),e.rank<n.rank&&(e=e.reshape(Dn(e.shape,r))),{x:function(){var i=e.mul(n.equal(t).cast(e.dtype));return o==null?i:i.transpose(o)}}}var JF=F({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","all","bool"),o=Ft(t,r.shape),i=o,a=eo(i,r.rank);a!=null&&(r=r.transpose(a),i=to(i.length,r.rank));var s=V.runKernelFunc(function(l){return l.all(r,i)},{$x:r});if(n){var u=Dn(s.shape,o);return s.reshape(u)}return s}}),ZF=F({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","any","bool"),o=Ft(t,r.shape),i=o,a=eo(i,r.rank);a!=null&&(r=r.transpose(a),i=to(i.length,r.rank));var s=V.runKernelFunc(function(l){return l.any(r,i)},{$x:r});if(n){var u=Dn(s.shape,o);return s.reshape(u)}return s}}),eL=F({argMax_:function(e,t){t===void 0&&(t=0);var n=R(e,"x","argMax");t==null&&(t=0);var r=Ft(t,n.shape),o=eo(r,n.rank);o!=null&&(n=n.transpose(o),r=to(r.length,n.rank));var i={axis:r[0]},a=[n];return V.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return $e(l)}}},"ArgMax",i,a)}}),tL=F({argMin_:function(e,t){t===void 0&&(t=0);var n=R(e,"x","argMin");t==null&&(t=0);var r=Ft(t,n.shape),o=eo(r,n.rank);return o!=null&&(n=n.transpose(o),r=to(r.length,n.rank)),V.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return $e(s)}}})}}),nL=F({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","logSumExp"),o=Ft(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=Dn(s.shape,o);return s.reshape(u)}return s}}),Ed=F({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","max"),o=r,i=Ft(t,r.shape),a=i,s=eo(a,r.rank);s!=null&&(r=r.transpose(s),a=to(a.length,r.rank));var u=[r],l=V.runKernelFunc(function(f,d){var p=f.max(r,a);return d([o,p]),p},{x:r},function(f,d){return lE(f,d[1],d[0],i,s)},"Max",{axes:a},u,[!0]);if(n){var c=Dn(l.shape,i);l=l.reshape(c)}return l}}),rL=F({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","mean"),o=Ft(t,r.shape),i=ge(sn(r.shape,o)[1]);return bd(function(a){var s=ae(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=a.shape.slice();return o.forEach(function(c){l[c]=1}),u.reshape(l).mul(ms(a.shape,"float32")).div(i)}}})(r)}}),oL=F({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","min"),o=r,i=Ft(t,r.shape),a=i,s=eo(a,r.rank);s!=null&&(r=r.transpose(s),a=to(a.length,r.rank));var u=[r],l=V.runKernelFunc(function(f,d){var p=f.min(r,a);return d([o,p]),p},{x:r},function(f,d){return lE(f,d[1],d[0],i,s)},"Min",{axes:a},u,[!0]);if(n){var c=Dn(l.shape,i);l=l.reshape(c)}return l}}),iL=F({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=Ft(t,(e=R(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;n||(i=Dn(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),cE=F({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=Ft(t,r.shape);return bd(function(i){var a=eo(o,i.rank),s=o,u=i;a!=null&&(u=i.transpose(a),s=to(s.length,i.rank));var l=function(p){var h=i.shape.slice();return o.forEach(function(m){h[m]=1}),p.reshape(h).mul(ms(i.shape,"float32"))},c={axes:s},f=V.runKernelFunc(function(p){return p.sum(u,s)},{x:u},function(p){return{x:function(){return l(p)}}},"Sum",c);if(n){var d=Dn(f.shape,o);f=f.reshape(d)}return{value:f,gradFunc:l}})(r)}}),aL=F({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=R(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=Ft(t,r.shape),i=eo(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=to(a.length,r.rank));var u=V.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(n){var l=Dn(u.shape,o);u=u.reshape(l)}return u}}),fE=F({elu_:function(e){var t=R(e,"x","elu");return V.runKernelFunc(function(n,r){var o=n.elu(t);return r([o]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return V.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),sL=F({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=R(e,"x","leakyRelu");return Lg(ae(t).mul(n),n)}}),dE=F({prelu_:function(e,t){var n=R(e,"x","prelu"),r=R(t,"alpha","prelu");return V.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return zi(u,o,o.mul(s))},alpha:function(){var l=zi(u,$e(o),o.mul(a)),c=At(s.shape,o.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),ft=F({relu_:function(e){var t=R(e,"x","relu");return t.dtype==="bool"?t.toInt():V.runKernelFunc(function(n,r){var o=n.relu(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),pE=F({relu6_:function(e){var t=R(e,"x","relu6");return t.dtype==="bool"?t.toInt():V.runKernelFunc(function(n,r){var o=n.relu6(t);return r([t]),o},{x:t},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),uL=F({selu_:function(e){var t=R(e,"x","selu");return V.runKernelFunc(function(n,r){var o=n.selu(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(ae(0)),a=ae(Ag),s=ae(Mg),u=n.mul(s),l=n.mul(a).mul(o.toFloat().exp());return zi(i,u,l)}}})}}),ui=F({transpose_:function(e,t){var n=R(e,"x","transpose");if(t==null&&(t=n.shape.map(function(o,i){return i}).reverse()),I(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(o){I(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return V.runKernelFunc(function(o){return o.transpose(n,t)},{x:n},function(o){var i=Eg(t);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),lL=F({localResponseNormalization_:function(e,t,n,r,o){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=R(e,"x","localResponseNormalization");I(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),I(wt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=V.runKernelFunc(function(l,c){var f=l.localResponseNormalization4D(a,t,n,r,o);return c([a,f]),f},{x4D:a},function(l,c){var f=c[0],d=c[1];return{x4D:function(){return V.runKernelFunc(function(p){return p.LRNGrad(l,f,d,t,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),hE=F({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(ae(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=R(e,"x","norm"),t,n),i=o.shape;if(r){var a=Ft(n,e.shape);i=Dn(o.shape,a)}return o.reshape(i)}}),cL=F({basicLSTMCell_:function(e,t,n,r,o,i){var a=R(e,"forgetBias","basicLSTMCell"),s=R(t,"lstmKernel","basicLSTMCell"),u=R(n,"lstmBias","basicLSTMCell"),l=R(r,"data","basicLSTMCell"),c=R(o,"c","basicLSTMCell"),f=R(i,"h","basicLSTMCell"),d=l.concat(f,1).matMul(s).add(u),p=d.shape[0],h=d.shape[1]/4,m=[p,h],g=d.slice([0,0],m),v=d.slice([0,h],m),y=d.slice([0,2*h],m),b=d.slice([0,3*h],m),x=g.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),fL=F({multiRNNCell_:function(e,t,n,r){for(var o=R(t,"data","multiRNNCell"),i=Yc(n,"c","multiRNNCell"),a=Yc(r,"h","multiRNNCell"),s=o,u=[],l=0;l<e.length;l++){var c=e[l](s,i[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var f=[],d=[];for(l=0;l<u.length;l+=2)f.push(u[l]),d.push(u[l+1]);return[f,d]}}),dL=F({movingAverage_:function(e,t,n,r,o){o===void 0&&(o=!0);var i=R(e,"v","movingAverage"),a=R(t,"x","movingAverage"),s=R(n,"decay","movingAverage");lA(i,a),I($t(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=ae(1),l=u.sub(s),c=a.sub(i).mul(l);if(o){I(r!=null,function(){return"When using zeroDebias: true, step is required."});var f=R(r,"step","movingAverage");c=c.div(u.sub(sf(s,f)))}return i.add(c)}}),pL=F({stridedSlice_:function(e,t,n,r,o,i,a,s,u){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var l=R(e,"x","stridedSlice"),c=Y1(s),f=l.shape.slice();c.forEach(function(g){t[g]=0,n[g]=1,f.splice(g,0,1)}),l=l.reshape(f);for(var d=0;d<l.rank;d++)t[d]=C3(o,t,r,l.shape,d),n[d]=E3(i,n,r,l.shape,d),r[d]=r[d]||1;var p=Y1(u);p.forEach(function(g){n[g]=t[g]+1,r[g]=1});var h=Pg(t,n,r),m=h.filter(function(g,v){return p.indexOf(v)===-1});return r.every(function(g){return g===1})?Jr(l,t,h).reshape(m):V.runKernelFunc(function(g){return g.stridedSlice(l,t,n,r)},{$x:l}).reshape(m)}}),hL=F({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=R(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=V.runKernelFunc(function(a){return a.topk(r,t,n)},{$x:r});return{values:i[0],indices:i[1]}}}),vL=F({scatterND_:function(e,t,n){var r=R(e,"indices","scatterND","int32"),o=R(t,"updates","scatterND");return w3(o,r,n),V.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),Vg=F({fft_:function(e){I(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return V.runKernelFunc(function(o){return o.fft(r)},{input:e}).reshape(e.shape)}}),uf=F({ifft_:function(e){I(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return V.runKernelFunc(function(o){return o.ifft(r)},{input:e}).reshape(e.shape)}}),Wg=F({rfft_:function(e,t){I(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],o=e.size/r;if(t!=null&&t<r){var i=e.shape.map(function(v){return 0}),a=e.shape.map(function(v){return v});a[e.shape.length-1]=t,n=e.slice(i,a),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(v){return v});s[e.shape.length-1]=t-r,n=e.concat(rt(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=qt(n,u).as2D(o,r),c=Vg(l),f=Math.floor(r/2)+1,d=or(c),p=Ur(c),h=d.split([f,r-f],d.shape.length-1),m=p.split([f,r-f],p.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=f,qt(h[0],m[0]).reshape(g)}}),vE=F({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=uf(r);return or(o)}var i=[n,2*(t-1)],a=or(e).as2D(n,t),s=Ur(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(ae(-1)),c=a.concat(u,1),f=s.concat(l,1);return r=qt(c,f).as2D(i[0],i[1]),o=uf(r),or(o)}}),mL=Object.freeze({fft:Vg,ifft:uf,rfft:Wg,irfft:vE}),gL=F({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var o=R(e,"sparseIndices","sparseToDense","int32"),i=R(t,"sparseValues","sparseToDense"),a=R(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var f=s.rank>0?s.shape[0]:1,d=s.rank>1?s.shape[1]:1;if(l.length!==d)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+d+".");var p=u.size;if(u.rank!==0&&(u.rank!==1||p!==f))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+f+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),V.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),yL=F({gatherND_:function(e,t){var n=R(t,"indices","gatherND","int32"),r=R(e,"x","gatherND");return V.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),bL=F({diag_:function(e){var t=R(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return V.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),xL=F({dropout_:function(e,t,n,r){var o=R(e,"x","dropout");if(I(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),I(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof ct?o.clone():o;var i=function(u,l){if(l==null)return u.shape.slice();if($t(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],f=0;f<u.shape.length;f++)l[f]==null&&u.shape[f]!=null?c.push(u.shape[f]):c.push(l[f]);return c}return l}(o,n),a=1-t,s=dC(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function mE(e,t,n){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=t-n*Math.cos(a)}return _t(o,"float32")}var Ug=F({hannWindow_:function(e){return mE(e,.5,.5)}}),gE=F({hammingWindow_:function(e){return mE(e,.54,.46)}}),zg=F({frame_:function(e,t,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+t<=e.size;)a.push(Jr(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=Dt([Jr(e,i,t-s),Yr([s],o)]);a.push(u),i+=n}return a.length===0?ti([],[0,t]):Dt(a).as2D(a.length,t)}}),yE=F({stft_:function(e,t,n,r,o){var i;o===void 0&&(o=Ug),r==null&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=zg(e,t,n),s=dn(a,o(t)),u=[],l=0;l<a.shape[0];l++)u.push(Wg(s.slice([l,0],[1,t]),r));return Dt(u)}}),wL=Object.freeze({hannWindow:Ug,hammingWindow:gE,frame:zg,stft:yE}),fn,SL=function(e,t,n){return n===void 0&&(n=1),de(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,f,d,p,h,m,g;return pe(this,function(v){switch(v.label){case 0:return r=R(e,"predictions","inTopK"),o=R(t,"targets","inTopK"),I(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),I(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),qe(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],I(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=v.sent(),[4,o.data()];case 2:for(s=v.sent(),u=[a.length/i,i],c=u[1],f=Eu("bool",l=u[0]),d=0;d<l;d++){for(p=d*c,h=a.subarray(p,p+c),m=[],g=0;g<h.length;g++)m.push({value:h[g],index:g});for(m.sort(function(y,b){return b.value-y.value}),f[d]=0,g=0;g<n;g++)if(m[g].index===s[d]){f[d]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,Xt(f,o.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(fn||(fn={}));var CL=F({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=fn.SUM_BY_NONZERO_WEIGHTS);var o=R(e,"labels","absoluteDifference"),i=R(t,"predictions","absoluteDifference"),a=null;n!=null&&(a=R(n,"weights","absoluteDifference")),qe(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return So(s,a,r)}}),So=F({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=fn.SUM_BY_NONZERO_WEIGHTS);var r=R(e,"losses","computeWeightedLoss"),o=null;t!=null&&(o=R(t,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===fn.NONE)return i;if(n===fn.SUM)return i.sum();if(n===fn.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(ae(a)):s}if(n===fn.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(ae(r.size));var u=o.mul(ms(r.shape)).notEqual(ae(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),EL=F({cosineDistance_:function(e,t,n,r,o){o===void 0&&(o=fn.SUM_BY_NONZERO_WEIGHTS);var i=R(e,"labels","cosineDistance"),a=R(t,"predictions","cosineDistance"),s=null;r!=null&&(s=R(r,"weights","cosineDistance")),qe(i.shape,a.shape,"Error in cosineDistance: ");var u=ae(1).sub(i.mul(a).sum(n,!0));return So(u,s,o)}}),_L=F({hingeLoss_:function(e,t,n,r){r===void 0&&(r=fn.SUM_BY_NONZERO_WEIGHTS);var o=R(e,"labels","hingeLoss"),i=R(t,"predictions","hingeLoss"),a=null;n!=null&&(a=R(n,"weights","hingeLoss")),qe(o.shape,i.shape,"Error in hingeLoss: ");var s=ae(1);o=ae(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return So(u,a,r)}}),kL=F({huberLoss_:function(e,t,n,r,o){r===void 0&&(r=1),o===void 0&&(o=fn.SUM_BY_NONZERO_WEIGHTS);var i=R(e,"labels","huberLoss"),a=R(t,"predictions","huberLoss"),s=null;n!=null&&(s=R(n,"weights","huberLoss")),qe(i.shape,a.shape,"Error in huberLoss: ");var u=ae(r),l=a.sub(i).abs(),c=QC(l,u),f=l.sub(c),d=ae(.5).mul(c.square()).add(u.mul(f));return So(d,s,o)}}),RL=F({logLoss_:function(e,t,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=fn.SUM_BY_NONZERO_WEIGHTS);var i=R(e,"labels","logLoss"),a=R(t,"predictions","logLoss"),s=null;n!=null&&(s=R(n,"weights","logLoss")),qe(i.shape,a.shape,"Error in logLoss: ");var u=ae(1),l=ae(r),c=i.mul(a.add(l).log()).neg().sub(u.sub(i).mul(u.sub(a).add(l).log()));return So(c,s,o)}}),PL=F({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=fn.SUM_BY_NONZERO_WEIGHTS);var o=R(e,"labels","meanSquaredError"),i=R(t,"predictions","meanSquaredError"),a=null;n!=null&&(a=R(n,"weights","meanSquaredError")),qe(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return So(s,a,r)}}),IL=F({sigmoidCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=fn.SUM_BY_NONZERO_WEIGHTS);var i=R(e,"multiClassLabels","sigmoidCrossEntropy"),a=R(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=R(n,"weights","sigmoidCrossEntropy")),qe(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ae(r),l=ae(1),c=ae(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var f=function(d,p){var h=R(d,"labels","sigmoidCrossEntropyWithLogits"),m=R(p,"logits","sigmoidCrossEntropyWithLogits");qe(h.shape,m.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=m.relu(),v=m.mul(h),y=m.abs().neg().exp().log1p();return g.sub(v).add(y)}(i,a);return So(f,s,o)}}),OL=F({softmaxCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=fn.SUM_BY_NONZERO_WEIGHTS);var i=R(e,"onehotLabels","softmaxCrossEntropy"),a=R(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=R(n,"weights","softmaxCrossEntropy")),qe(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ae(r),l=ae(1),c=ae(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var f=function(d,p,h){if(h===void 0&&(h=-1),h===-1&&(h=p.rank-1),h!==p.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+p.rank+" and dim was "+h);return bd(function(m,g,v){var y=g.logSumExp([h],!0),b=g.toFloat().sub(y);return v([m,b]),{value:b.mul(m).neg().sum([h]),gradFunc:function(x,w){var S=w[0],E=w[1],C=Dn(x.shape,[h]);return[x.reshape(C).mul(S.toFloat().sub(E.exp())),x.reshape(C).mul(E.exp().sub(S.toFloat()))]}}})(d,p)}(i,a);return So(f,s,o)}}),TL=Object.freeze({get Reduction(){return fn},absoluteDifference:CL,computeWeightedLoss:So,cosineDistance:EL,hingeLoss:_L,huberLoss:kL,logLoss:RL,meanSquaredError:PL,sigmoidCrossEntropy:IL,softmaxCrossEntropy:OL});function yb(e,t){return t===void 0&&(t=!1),V.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=fC(n),i=e.clone(),a=ti([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(f){var d,p=i,h=s,m=o;d=V.tidy(function(){var g=i.slice([f,f],[n-f,1]),v=g.norm(),y=i.slice([f,f],[1,1]),b=ti([[-1]]).where(y.greater(0),ti([[1]])),x=y.sub(b.mul(v)),w=g.div(x);s=w.shape[0]===1?a.clone():a.concat(w.slice([1,0],[w.shape[0]-1,w.shape[1]]),0);var S=b.matMul(x).div(v).neg(),E=i.slice([f,0],[n-f,r]),C=S.mul(s);if(f===0)i=E.sub(C.matMul(s.transpose().matMul(E)));else{var k=E.sub(C.matMul(s.transpose().matMul(E)));i=i.slice([0,0],[f,r]).concat(k,0)}var _=o.slice([0,f],[n,o.shape[1]-f]);if(f===0)o=_.sub(_.matMul(s).matMul(C.transpose()));else{var T=_.sub(_.matMul(s).matMul(C.transpose()));o=o.slice([0,0],[n,f]).concat(T,1)}return[s,i,o]}),s=d[0],i=d[1],o=d[2],Tn([p,h,m])},c=0;c<u;++c)l(c);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var DL=F({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=R(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=Qc(0,a,1,"int32").reshape([-1,1]),l=Qc(0,s,1,"int32"),c=Mt(u,l),f=wd(c.lessEqual(ae(+t,"int32")),c.greaterEqual(ae(-n,"int32"))),d=rt([a,s],r.dtype);return Kn(Nt(r.reshape([-1,a,s])).map(function(p){return zi(f,p,d)})).reshape(o)}}),NL=F({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,I(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){I(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},o=1;o<e.length;++o)r(o)}else t=!0,e=kg(e,e.shape[0],0).map(function(u){return hC(u,[0])});I(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],a=e,s=function(u){i.push(V.tidy(function(){var l=a[u];if(u>0)for(var c=0;c<u;++c){var f=cE(i[c].mulStrict(l)).mul(i[c]);l=l.sub(f)}return l.div(hE(l,"euclidean"))}))};for(o=0;o<e.length;++o)s(o);return t?Kn(i,0):i}}),AL=F({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return yb(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(a,s){return a*s}),r=Nt(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=yb(a,t),u=s[0],l=s[1];o.push(u),i.push(l)}),[Kn(o,0).reshape(e.shape),Kn(i,0).reshape(e.shape)]}}),ML=Object.freeze({bandPart:DL,gramSchmidt:NL,qr:AL});function _d(e,t,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=e.shape[0];return n=Math.min(n,a),I(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),I(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),I(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),I(t.rank===1,function(){return"scores must be a 1D tensor"}),I(t.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]}),I(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var FL=F({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=R(e,"images","resizeBilinear");I(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=V.runKernelFunc(function(l,c){return c([o]),l.resizeBilinear(o,a,s,n)},{x:o},function(l,c){return{x:function(){return V.runKernelFunc(function(f){return f.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),LL=F({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=R(e,"images","resizeNearestNeighbor");I(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),I(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=V.runKernelFunc(function(l,c){return c([o]),l.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(l,c){return{batchImages:function(){return V.runKernelFunc(function(f){return f.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),BL=F({nonMaxSuppression_:function(e,t,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=R(e,"boxes","nonMaxSuppression"),a=R(t,"scores","nonMaxSuppression"),s=_d(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return V.runKernelFunc(function(l){return l.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),jL=function(e,t,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),de(this,void 0,void 0,function(){var i,a,s,u,l,c,f;return pe(this,function(d){switch(d.label){case 0:return i=R(e,"boxes","nonMaxSuppressionAsync"),a=R(t,"scores","nonMaxSuppressionAsync"),s=_d(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],f=Og(l,c,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,f]}})})},$L=F({nonMaxSuppressionWithScore_:function(e,t,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=R(e,"boxes","nonMaxSuppression"),s=R(t,"scores","nonMaxSuppression"),u=_d(a,s,n,r,o,i),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},c=V.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),VL=function(e,t,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),de(this,void 0,void 0,function(){var a,s,u,l,c,f,d;return pe(this,function(p){switch(p.label){case 0:return a=R(e,"boxes","nonMaxSuppressionAsync"),s=R(t,"scores","nonMaxSuppressionAsync"),u=_d(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=p.sent(),c=l[0],f=l[1],d=Tg(c,f,n,r,o,i),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,d]}})})},WL=F({cropAndResize_:function(e,t,n,r,o,i){var a=R(e,"image","cropAndResize"),s=R(t,"boxes","cropAndResize","float32"),u=R(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=s.shape[0];return I(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),I(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),I(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),I(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),I(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),I(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),V.runKernelFunc(function(c,f){return c.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),Hg=Object.freeze({resizeBilinear:FL,resizeNearestNeighbor:LL,nonMaxSuppression:BL,nonMaxSuppressionAsync:jL,nonMaxSuppressionWithScore:$L,nonMaxSuppressionWithScoreAsync:VL,cropAndResize:WL}),Gg=function(e,t){return!(e>0)||t==="linear"},qg=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Kg=function(e,t){var n=t,r=At(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},Xg=function(e,t,n){if(t==="linear")return e;if(t==="relu")return ft(e);if(t==="elu")return fE(e);if(t==="relu6")return pE(e);if(t==="prelu")return dE(e,n);throw new Error("Unknown fused activation "+t+".")},UL=F({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,i=o!==void 0&&o,a=e.transposeB,s=a!==void 0&&a,u=e.bias,l=e.activation,c=l===void 0?"linear":l,f=e.preluActivationWeights;if(Gg(V.state.gradientDepth,c)===!1){var d=Cd(n,r,i,s);return u!=null&&(d=Fe(d,u)),Xg(d,c,f)}var p=R(n,"a","fused matMul"),h=R(r,"b","fused matMul");t=ht(p,h),p=t[0],h=t[1];var m=i?p.shape[p.rank-2]:p.shape[p.rank-1],g=s?h.shape[h.rank-1]:h.shape[h.rank-2],v=i?p.shape[p.rank-1]:p.shape[p.rank-2],y=s?h.shape[h.rank-2]:h.shape[h.rank-1],b=p.shape.slice(0,-2),x=h.shape.slice(0,-2),w=ge(b),S=ge(x);I(p.rank>=2&&h.rank>=2&&p.rank===h.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+h.rank+"."}),I($t(b,x),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+p.shape+" and "+h.shape+" must match."}),I(m===g,function(){return"Error in fused matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+p.shape+" and "+h.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var E,C,k=p.shape.slice(0,-2).concat([v,y]),_=i?p.as3D(w,m,v):p.as3D(w,v,m),T=s?h.as3D(S,y,g):h.as3D(S,g,y);u!=null&&Be(k,(E=ht(E=R(u,"bias","fused matMul"),p)[0]).shape),f!=null&&(C=R(f,"prelu weights","fused matMul"));var D={a:_,b:T};u!=null&&(D.bias=E),f!=null&&(D.preluActivationWeights=C);var U=[_,T];return V.runKernelFunc(function(j,A){var M=j.fusedBatchMatMul({a:_,b:T,transposeA:i,transposeB:s,bias:E,activation:c,preluActivationWeights:C});return A([_,T,M]),M},D,function(j,A){var M=A[0],$=A[1],O=A[2],L=qg(j,O,c),B={};return u!=null&&(B={bias:function(){return Kg(E,L)}}),Object.assign(i||s?!i&&s?{a:function(){return L.matMul($,!1,!1)},b:function(){return L.matMul(M,!0,!1)}}:i&&!s?{a:function(){return $.matMul(L,!1,!0)},b:function(){return M.matMul(L,!1,!1)}}:{a:function(){return $.matMul(L,!0,!0)},b:function(){return L.matMul(M,!0,!0)}}:{a:function(){return L.matMul($,!1,!0)},b:function(){return M.matMul(L,!0,!1)}},B)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:c},U,[!0]).reshape(k)}}),zL=F({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,p=e.preluActivationWeights;if(d=d||"linear",Gg(V.state.gradientDepth,d)===!1){var h=dr(t,n,r,o,a,u,l);return c!=null&&(h=Fe(h,c)),Xg(h,d,p)}var m=R(t,"x","conv2d"),g=R(n,"filter","conv2d"),v=m,y=!1;m.rank===3&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),I(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),I(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),l!=null&&I(wt(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."}),I(v.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),I(Nn(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),I(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var b,x,w=Ji(v.shape,g.shape,r,u,o,l);c!=null&&(b=ht(b=R(c,"bias","fused conv2d"),m)[0],Be(w.outShape,b.shape)),p!=null&&(x=R(p,"prelu weights","fused conv2d"));var S={x:v,filter:g};c!=null&&(S.bias=b),p!=null&&(S.preluActivationWeights=x);var E=[g,v],C=V.runKernelFunc(function(k,_){var T=k.fusedConv2d({input:v,filter:g,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return _([g,v,T]),T},S,function(k,_){var T=_,D=T[0],U=T[1],j=T[2],A=qg(k,j,d);I(os(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var M={};return c!=null&&(M={bias:function(){return Kg(b,A)}}),Object.assign({x:function(){return rE(U.shape,A,D,r,o)},filter:function(){return jg(U,A,D.shape,r,o)}},M)},"FusedConv2D",{convInfo:w,activation:d},E,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),HL=F({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,p=e.preluActivationWeights;if(Gg(V.state.gradientDepth,d)===!1){var h=Sd(t,n,r,o,a,u,l);return c!=null&&(h=Fe(h,c)),Xg(h,d,p)}var m=R(t,"x","depthwiseConv2d"),g=R(n,"filter","depthwiseConv2d"),v=m,y=!1;m.rank===3&&(y=!0,v=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),I(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),I(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),I(v.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),I(Nn(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&I(wt(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."});var b,x,w=Ji(v.shape,g.shape,r,u,o,l,!0);c!=null&&(b=ht(b=R(c,"bias","fused conv2d"),m)[0],Be(w.outShape,b.shape)),p!=null&&(x=R(p,"prelu weights","fused depthwiseConv2d"));var S={x:v,filter:g};c!=null&&(S.bias=b),p!=null&&(S.preluActivationWeights=x);var E=[g,v],C=V.runKernelFunc(function(k,_){var T=k.fusedDepthwiseConv2D({input:v,filter:g,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return _([g,v,T]),T},S,function(k,_){I(os(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var T=_[0],D=_[1],U=_[2],j=qg(k,U,d),A={};return c!=null&&(A={bias:function(){return Kg(b,j)}}),Object.assign({x:function(){return oE(D.shape,j,T,w)},filter:function(){return iE(D,j,T.shape,w)}},A)},"FusedDepthwiseConv2D",{convInfo:w,activation:d},E,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),GL=Object.freeze({matMul:UL,conv2d:zL,depthwiseConv2d:HL}),qL=Object.freeze({image:Hg,linalg:ML,losses:TL,spectral:mL,fused:GL,signal:wL,square:RM,squaredDifference:VC,conv1d:FF,conv2d:dr,conv3d:LF,depthwiseConv2d:Sd,separableConv2d:$g,conv2dTranspose:BF,conv3dTranspose:jF,op:F,batchNormalization2d:rF,batchNormalization3d:oF,batchNormalization4d:iF,batchNormalization:aF,batchNorm:qC,batchNorm2d:sF,batchNorm3d:uF,batchNorm4d:lF,booleanMaskAsync:MF,complex:qt,real:or,imag:Ur,concat:Dt,concat1d:GA,concat2d:qA,concat3d:KA,concat4d:XA,split:kg,matMul:Cd,dot:$F,outerProduct:VF,reverse:Xu,reverse1d:WF,reverse2d:UF,reverse3d:zF,reverse4d:HF,maxPool:Lt,avgPool:Yu,pool:GF,maxPool3d:qF,avgPool3d:KF,slice:Jr,slice1d:XF,slice2d:YF,slice3d:uE,slice4d:QF,abs:PM,acos:IM,acosh:OM,asin:TM,asinh:DM,atan:NM,atanh:AM,ceil:MM,clipByValue:Fg,cos:FM,cosh:LM,erf:BM,exp:Bv,expm1:jM,floor:$M,log:VM,log1p:WM,logSigmoid:UM,neg:af,reciprocal:zM,round:HM,rsqrt:WC,sigmoid:UC,sign:GM,isNaN:qM,isInf:KM,isFinite:XM,sin:YM,sinh:QM,softplus:JM,sqrt:ZM,step:eF,tan:tF,tanh:nF,all:JF,any:ZF,argMax:eL,argMin:tL,logSumExp:nL,max:Ed,mean:rL,min:oL,moments:iL,sum:cE,prod:aL,equal:JC,equalStrict:_F,greater:kF,greaterEqual:ZC,greaterEqualStrict:RF,greaterStrict:PF,less:IF,lessEqual:OF,lessEqualStrict:TF,lessStrict:DF,notEqual:NF,notEqualStrict:AF,add:Fe,addN:dF,addStrict:pF,atan2:hF,div:wr,divNoNan:vF,divStrict:mF,floorDiv:YC,maximum:Lg,maximumStrict:gF,minimum:QC,minimumStrict:yF,mod:bF,modStrict:xF,mul:dn,mulStrict:wF,pow:sf,powStrict:SF,squaredDifferenceStrict:CF,sub:Mt,subStrict:EF,elu:fE,leakyRelu:sL,prelu:dE,relu:ft,relu6:pE,selu:uL,logicalAnd:wd,logicalNot:cF,logicalOr:KC,logicalXor:fF,where:zi,whereAsync:XC,buffer:Te,print:o3,batchToSpaceND:cC,broadcastTo:i3,cast:a3,clone:s3,cumsum:u3,depthToSpace:l3,expandDims:rr,eye:fC,multinomial:c3,oneHot:Av,pad:Qi,pad1d:f3,pad2d:d3,pad3d:p3,pad4d:h3,rand:v3,randomNormal:m3,randomGamma:g3,randomUniform:dC,reshape:Cr,spaceToBatchND:pC,squeeze:hC,stack:Kn,tile:Ba,truncatedNormal:y3,unstack:Nt,setdiff1dAsync:b3,fill:Yr,linspace:HA,ones:ms,range:Qc,scalar:ae,tensor:Xt,tensor1d:_t,tensor2d:ti,tensor3d:_g,tensor4d:Cn,tensor5d:WA,tensor6d:UA,variable:zA,zeros:rt,onesLike:lC,zerosLike:$e,transpose:ui,softmax:wo,logSoftmax:k3,localResponseNormalization:lL,norm:hE,gather:Bg,unsortedSegmentSum:eE,basicLSTMCell:cL,multiRNNCell:fL,movingAverage:dL,stridedSlice:pL,topk:hL,scatterND:vL,fft:Vg,ifft:uf,rfft:Wg,irfft:vE,sparseToDense:gL,gatherND:yL,diag:bL,dropout:xL,hannWindow:Ug,hammingWindow:gE,frame:zg,stft:yE,inTopKAsync:SL});function Z(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&I(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function zp(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var KL=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new wC(n,V),n}return Tr(t,e),t.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,Y().get("IS_NODE")&&Xc(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},t.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return de(this,void 0,void 0,function(){return pe(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?Lv(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return Gc(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Te(n.shape,n.dtype,o)},t.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return V.makeTensorFromDataId(i,r,o,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return de(this,void 0,void 0,function(){var r;return pe(this,function(o){return r=Br(),n(),[2,{kernelMs:Br()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:V.keep(n.clone()),imag:V.keep(r.clone())},o},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(Z(n,"slice"),bC(n.shape,r,o)){var i=xC(r,n.strides),a=ge(o);return Xt(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=Te(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(f,d){return f+r[d]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,o,i){Z(n,"stridedSlice");var a=Pg(r,o,i);if(a.some(function(p){return p===0}))return Xt([],a);for(var s=Te(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),f=new Array(c.length),d=0;d<f.length;d++)f[d]=c[d]*i[d]+r[d];s.set.apply(s,[u.get.apply(u,f)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=Te([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.reverse=function(n,r){Z(n,"reverse");for(var o=Te(n.shape,n.dtype),i=this.bufferSync(n),a=function(u){var l=o.indexToLoc(u),c=l.slice();r.forEach(function(f){return c[f]=n.shape[f]-1-c[f]}),o.set.apply(o,[i.get.apply(i,c)].concat(l))},s=0;s<o.size;s++)a(s);return o.toTensor()},t.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(p){return or(p)}),a=n.map(function(p){return Ur(p)});return qt(this.concat(i,r),this.concat(a,r))}var s=n.map(function(p){var h=ge(p.shape.slice(r));return p.as2D(-1,h)}),u=rs(s.map(function(p){return p.shape}),1),l=Te(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(p){l.set(o.readSync(p.dataId),c),c+=p.size})}else{var f=0;s.forEach(function(p){for(var h=o.readSync(p.dataId),m=0,g=0;g<p.shape[0];++g)for(var v=g*u[1]+f,y=0;y<p.shape[1];++y)l[v+y]=h[m++];f+=p.shape[1]})}var d=rs(n.map(function(p){return p.shape}),r);return Xt(l,d,n[0].dtype)},t.prototype.neg=function(n){return Z(n,"neg"),this.multiply(ae(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,Kt(n.dtype,r.dtype),function(o,i){return o+i})},t.prototype.addN=function(n){var r=this;Z(n,"addN");for(var o=n.map(function(c){return r.readSync(c.dataId)}),i=Te(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var u=o[s],l=0;l<a.length;l++)a[l]+=u[l];return i.toTensor()},t.prototype.softmax=function(n,r){var o=Ft([r],n.shape),i=this.max(n,o),a=Dn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,Kt(n.dtype,r.dtype),function(o,i){return o-i})},t.prototype.pow=function(n,r){return Z([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},t.prototype.batchMatMul=function(n,r,o,i){Z([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=i?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],p=d[0],h=d[1],m=d[2],g=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=g[0],y=g[1],b=g[2],x=s*u,w=Te([l,s,u],n.dtype),S=w.values,E=this.blockSize,C=0;C<l;C++)for(var k=0;k<s;k+=E)for(var _=0;_<u;_+=E)for(var T=0;T<a;T+=E)for(var D=Math.min(k+E,s),U=Math.min(_+E,u),j=Math.min(T+E,a),A=k;A<D;A++)for(var M=_;M<U;M++){for(var $=0,O=T;O<j;O++)$+=c[C*p+A*h+O*m]*f[O*v+M*y+C*b];S[C*x+(A*u+M)]+=$}return w.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,o,i,a);return s&&(c=this.add(c,s)),u&&(c=zp(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,Kt(n.dtype,r.dtype),function(o,i){return o*i})},t.prototype.realDivide=function(n,r){return Z([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},t.prototype.floorDiv=function(n,r){return Z([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},t.prototype.sum=function(n,r){Z(n,"sum"),Vn("sum",r,n.rank);for(var o=sn(n.shape,r),i=o[0],a=o[1],s=rt(i,Kt(n.dtype,"int32")),u=ge(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,p=0,h=0;h<u;++h)p+=c[d+h];l[f]=p}return s},t.prototype.prod=function(n,r){Z(n,"sum");for(var o=sn(n.shape,r),i=o[0],a=o[1],s=rt(i,Kt(n.dtype,"int32")),u=ge(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,p=1,h=0;h<u;++h)p*=c[d+h];l[f]=p}return s},t.prototype.unsortedSegmentSum=function(n,r,o){Z(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=ae(s,"int32"),l=JC(u,r).asType("float32").mul(n).sum(0);i.push(l)}return Kn(i)},t.prototype.argMin=function(n,r){Z(n,"argMin");var o=[r];Vn("argMin",o,n.rank);for(var i=sn(n.shape,o),a=i[0],s=i[1],u=rt(a,"int32"),l=ge(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var p=d*l,h=f[p],m=0,g=0;g<l;++g){var v=f[p+g];v<h&&(h=v,m=g)}c[d]=m}return u},t.prototype.argMax=function(n,r){Z(n,"argMax");var o=[r];Vn("argMax",o,n.rank);for(var i=sn(n.shape,o),a=i[0],s=i[1],u=rt(a,"int32"),l=ge(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var p=d*l,h=f[p],m=0,g=0;g<l;++g){var v=f[p+g];v>h&&(h=v,m=g)}c[d]=m}return u},t.prototype.cumsum=function(n,r,o,i){if(Z(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=Kt(n.dtype,"int32"),s=rt(n.shape,a),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],f=i?function(g,v){return g+c-v-1}:function(g,v){return g+v},d=0;d<l.length;d+=c)for(var p=0;p<c;p++){var h=f(d,p);if(p===0)u[h]=o?0:l[h];else{var m=f(d,p-1);u[h]=o?l[m]+u[m]:l[h]+u[m]}}return s},t.prototype.equal=function(n,r){return Z([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},t.prototype.notEqual=function(n,r){return Z([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},t.prototype.less=function(n,r){return Z([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},t.prototype.lessEqual=function(n,r){return Z([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},t.prototype.greater=function(n,r){return Z([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},t.prototype.greaterEqual=function(n,r){return Z([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},t.prototype.logicalNot=function(n){Z(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return Z([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},t.prototype.logicalOr=function(n,r){return Z([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},t.prototype.select=function(n,r,o){Z([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=rt(r.shape,Kt(r.dtype,o.dtype)),l=this.readSync(u.dataId),c=0,f=n.rank===0||n.rank>1||r.rank===1?1:ge(r.shape.slice(1)),d=0;d<i.length;d++)for(var p=0;p<f;p++)i[d]===1?l[c++]=a[d]:l[c++]=s[d];return u},t.prototype.where=function(n){Z([n],"where");var r=this.readSync(n.dataId);return Dg(n.shape,r)},t.prototype.topk=function(n,r,o){return Z(n,"topk"),IC(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Z(n,"min"),Vn("min",r,n.rank);for(var o=sn(n.shape,r),i=o[0],a=o[1],s=rt(i,n.dtype),u=ge(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,p=c[d],h=0;h<u;++h){var m=c[d+h];m<p&&(p=m)}l[f]=p}return s},t.prototype.minimum=function(n,r){return Z([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},t.prototype.mod=function(n,r){return Z([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},t.prototype.max=function(n,r){Z(n,"max"),Vn("max",r,n.rank);for(var o=sn(n.shape,r),i=o[0],a=o[1],s=rt(i,n.dtype),u=ge(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,p=c[d],h=0;h<u;++h){var m=c[d+h];m>p&&(p=m)}l[f]=p}return s},t.prototype.maximum=function(n,r){return Z([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},t.prototype.all=function(n,r){Z(n,"all"),Vn("all",r,n.rank);for(var o=sn(n.shape,r),i=o[0],a=o[1],s=rt(i,n.dtype),u=ge(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,p=c[d],h=0;h<u;++h){var m=c[d+h];p=p&&m}l[f]=p}return s},t.prototype.any=function(n,r){Z(n,"any"),Vn("any",r,n.rank);for(var o=sn(n.shape,r),i=o[0],a=o[1],s=rt(i,n.dtype),u=ge(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,p=c[d],h=0;h<u;++h){var m=c[d+h];p=p||m}l[f]=p}return s},t.prototype.squaredDifference=function(n,r){return Z([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},t.prototype.ceil=function(n){Z(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.floor=function(n){Z(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.sign=function(n){Z(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},t.prototype.isNaN=function(n){Z(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isInf=function(n){Z(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isFinite=function(n){Z(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.round=function(n){Z(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},t.prototype.exp=function(n){Z(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.expm1=function(n){Z(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.log=function(n){Z(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.log1p=function(n){Z(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.sqrt=function(n){Z(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.rsqrt=function(n){Z(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.reciprocal=function(n){Z(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){Z(n,"relu");for(var r=rt(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},t.prototype.relu6=function(n){Z(n,"relu");for(var r=rt(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},t.prototype.prelu=function(n,r){return Z([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},t.prototype.elu=function(n){Z(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){Z([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},t.prototype.selu=function(n){Z(n,"selu");for(var r=Ag,o=Mg,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},t.prototype.clip=function(n,r,o){Z(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){Z(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){Z(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){Z(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,u=i[a]<r,l=Math.exp(i[a]),c=void 0;c=u?l:s?i[a]:Math.log(1+l),o[a]=c}return this.makeOutput(o,n.shape,"float32")},t.prototype.sin=function(n){Z(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){Z(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){Z(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){Z(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){Z(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){Z(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return Z([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},t.prototype.sinh=function(n){Z(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){Z(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){Z(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=XN(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){Z(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){Z(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){Z(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){Z(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),Z(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,o,i);return a&&(l=this.add(l,a)),s&&(l=zp(this,l,s,u)),l},t.prototype.conv2d=function(n,r,o){Z([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,f=o.dataFormat==="channelsLast",d=Te(o.outShape,n.dtype),p=n.strides[0],h=f?n.strides[1]:n.strides[2],m=f?n.strides[2]:1,g=f?1:n.strides[1],v=d.strides[0],y=f?d.strides[1]:d.strides[2],b=f?d.strides[2]:1,x=f?1:d.strides[1],w=this.readSync(n.dataId),S=this.readSync(r.dataId),E=d.values,C=0;C<o.batchSize;++C)for(var k=C*p,_=C*v,T=0;T<o.outHeight;++T)for(var D=_+T*y,U=T*o.strideHeight-c,j=0;j<i;j++){var A=U+j*s;if(!(A<0||A>=o.inHeight))for(var M=j*r.strides[0],$=k+A*h,O=0;O<o.outWidth;++O)for(var L=D+O*b,B=O*o.strideWidth-l,G=0;G<a;G++){var q=B+G*u;if(!(q<0||q>=o.inWidth))for(var J=$+q*m,ne=M+G*r.strides[1],ie=0;ie<o.inChannels;++ie){for(var se=w[J+ie*g],me=0;me<o.outChannels;++me)E[L+me*x]+=se*S[ne+me];ne+=o.outChannels}}}return d.toTensor()},t.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,l=o.dilationHeight,c=o.dilationWidth,f=o.padInfo.front,d=o.padInfo.left,p=o.padInfo.top,h=Te(o.outShape,n.dtype),m=this.readSync(n.dataId),g=this.readSync(r.dataId),v=h.values,y=0;y<o.batchSize;++y)for(var b=y*n.strides[0],x=y*h.strides[0],w=0;w<o.outDepth;++w)for(var S=x+w*h.strides[1],E=w*o.strideDepth-f,C=0;C<i;C++){var k=E+C*u;if(!(k<0||k>=o.inDepth))for(var _=C*r.strides[0],T=b+k*n.strides[1],D=0;D<o.outHeight;++D)for(var U=S+D*h.strides[2],j=D*o.strideHeight-p,A=0;A<a;A++){var M=j+A*l;if(!(M<0||M>=o.inHeight))for(var $=_+A*r.strides[1],O=T+M*n.strides[2],L=0;L<o.outWidth;++L)for(var B=U+L*o.outChannels,G=L*o.strideWidth-d,q=0;q<s;q++){var J=G+q*c;if(!(J<0||J>=o.inWidth))for(var ne=$+q*r.strides[2],ie=O+J*o.inChannels,se=ne,me=0;me<o.inChannels;++me){for(var he=m[ie+me],Ee=0;Ee<o.outChannels;++Ee)v[B+Ee]+=he*g[se+Ee];se+=o.outChannels}}}}return h.toTensor()},t.prototype.conv2dDerInput=function(n,r,o){Z([n,r],"conv2dDerInput");for(var i=Te(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],f=l[1],d=l[2],p=o.batchSize,h=o.filterHeight,m=o.filterWidth,g=o.inChannels,v=o.inHeight,y=o.inWidth,b=o.outChannels,x=o.outHeight,w=o.outWidth,S=o.strideHeight,E=o.strideWidth,C=o.dataFormat,k=h-1-o.padInfo.top,_=m-1-o.padInfo.left,T=C==="channelsLast",D=i.strides[0],U=T?i.strides[1]:i.strides[2],j=T?i.strides[2]:1,A=T?1:i.strides[1],M=n.strides[0],$=T?n.strides[1]:n.strides[2],O=T?n.strides[2]:1,L=T?1:n.strides[1],B=0;B<p;++B)for(var G=0;G<g;++G)for(var q=0;q<v;++q)for(var J=q-k,ne=Math.max(0,Math.ceil(J/S)),ie=Math.min(x,(h+J)/S),se=0;se<y;++se){for(var me=se-_,he=Math.max(0,Math.ceil(me/E)),Ee=Math.min(w,(m+me)/E),Ie=0,ce=ne;ce<ie;++ce)for(var _e=ce*S-J,ke=he;ke<Ee;++ke)for(var Ye=M*B+$*ce+O*ke,Ue=c*(h-1-_e)+f*(m-1-(ke*E-me))+d*G,et=0;et<b;++et)Ie+=s[Ye+L*et]*u[Ue+et];a[D*B+U*q+j*se+A*G]=Ie}return i.toTensor()},t.prototype.conv3dDerInput=function(n,r,o){for(var i=Te(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],f=s[3],d=this.readSync(n.dataId),p=n.strides,h=p[0],m=p[1],g=p[2],v=p[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],E=b[3],C=o.batchSize,k=o.filterDepth,_=o.filterHeight,T=o.filterWidth,D=o.inChannels,U=o.inDepth,j=o.inHeight,A=o.inWidth,M=o.outChannels,$=o.outDepth,O=o.outHeight,L=o.outWidth,B=o.strideDepth,G=o.strideHeight,q=o.strideWidth,J=k-1-o.padInfo.front,ne=_-1-o.padInfo.top,ie=T-1-o.padInfo.left,se=0;se<C;++se)for(var me=0;me<D;++me)for(var he=0;he<U;++he)for(var Ee=he-J,Ie=Math.max(0,Math.ceil(Ee/B)),ce=Math.min($,(k+Ee)/B),_e=0;_e<j;++_e)for(var ke=_e-ne,Ye=Math.max(0,Math.ceil(ke/G)),Ue=Math.min(O,(_+ke)/G),et=0;et<A;++et){for(var Mn=et-ie,Fn=Math.max(0,Math.ceil(Mn/q)),mn=Math.min(L,(T+Mn)/q),pr=0,hr=Ie;hr<ce;++hr)for(var vr=hr*B-Ee,Ln=Ye;Ln<Ue;++Ln)for(var mr=Ln*G-ke,Bn=Fn;Bn<mn;++Bn)for(var ys=h*se+m*hr+g*Ln+v*Bn,ee=x*(k-1-vr)+w*(_-1-mr)+S*(T-1-(Bn*q-Mn))+E*me,W=0;W<M;++W)pr+=d[ys+W]*y[ee+W];a[u*se+l*he+c*_e+f*et+me]=pr}return i.toTensor()},t.prototype.conv2dDerFilter=function(n,r,o){Z([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dataFormat==="channelsLast",c=Te(o.filterShape,"float32"),f=o.padInfo.left,d=o.padInfo.top,p=this.bufferSync(n),h=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((d-m)/i)),v=Math.min(o.outHeight,(o.inHeight+d-m)/i),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((f-y)/a)),x=Math.min(o.outWidth,(o.inWidth+f-y)/a),w=0;w<o.inChannels;++w)for(var S=0;S<o.outChannels;++S){for(var E=0,C=0;C<o.batchSize;++C)for(var k=g;k<v;++k)for(var _=m+k*i-d,T=b;T<x;++T){var D=y+T*a-f;E+=l?p.get(C,_,D,w)*h.get(C,k,T,S):p.get(C,w,_,D)*h.get(C,S,k,T)}c.set(E,m,y,w,S)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,f=Te(o.filterShape,"float32"),d=f.values,p=f.strides,h=p[0],m=p[1],g=p[2],v=p[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],E=b[3],C=this.readSync(n.dataId),k=n.strides,_=k[0],T=k[1],D=k[2],U=k[3],j=o.padInfo.front,A=o.padInfo.left,M=o.padInfo.top,$=0;$<u;++$)for(var O=Math.max(0,Math.ceil((j-$)/i)),L=Math.min(o.outDepth,(o.inDepth+j-$)/i),B=$*h,G=0;G<l;++G)for(var q=Math.max(0,Math.ceil((M-G)/a)),J=Math.min(o.outHeight,(o.inHeight+M-G)/a),ne=G*m+B,ie=0;ie<c;++ie)for(var se=Math.max(0,Math.ceil((A-ie)/s)),me=Math.min(o.outWidth,(o.inWidth+A-ie)/s),he=ie*g+ne,Ee=0;Ee<o.inChannels;++Ee)for(var Ie=Ee*v+he,ce=0;ce<o.outChannels;++ce){for(var _e=0,ke=0;ke<o.batchSize;++ke)for(var Ye=ke*_,Ue=ke*x,et=O;et<L;++et)for(var Mn=($+et*i-j)*T+Ye,Fn=et*w+Ue,mn=q;mn<J;++mn)for(var pr=(G+mn*a-M)*D+Mn,hr=mn*S+Fn,vr=se;vr<me;++vr){var Ln=vr*E+hr;_e+=C[(ie+vr*s-A)*U+pr+Ee]*y[Ln+ce]}d[Ie+ce]=_e}return f.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,o,i);return a&&(l=this.add(l,a)),s&&(l=zp(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,o){Z([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,f=o.outChannels/o.inChannels,d=Te(o.outShape,n.dtype),p=this.readSync(n.dataId),h=this.readSync(r.dataId),m=d.values,g=0;g<o.batchSize;++g)for(var v=g*n.strides[0],y=g*d.strides[0],b=0;b<o.outHeight;++b)for(var x=y+b*d.strides[1],w=b*o.strideHeight-l,S=0;S<i;++S){var E=w+S*s;if(!(E<0||E>=o.inHeight))for(var C=S*r.strides[0],k=v+E*n.strides[1],_=0;_<o.outWidth;++_)for(var T=x+_*d.strides[2],D=_*o.strideWidth-c,U=0;U<a;++U){var j=D+U*u;if(!(j<0||j>=o.inWidth))for(var A=C+U*r.strides[1],M=k+j*o.inChannels,$=T,O=A,L=0;L<o.inChannels;++L){for(var B=p[M+L],G=0;G<f;++G)m[$+G]+=B*h[O+G];$+=f,O+=f}}}return d.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,o){Z([n,r],"depthwiseConv2DDerInput");for(var i=Te(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],f=this.readSync(n.dataId),d=n.strides,p=d[0],h=d[1],m=d[2],g=this.readSync(r.dataId),v=r.strides,y=v[0],b=v[1],x=v[2],w=o.batchSize,S=o.filterHeight,E=o.filterWidth,C=o.inChannels,k=o.inHeight,_=o.inWidth,T=o.outChannels,D=o.outHeight,U=o.outWidth,j=o.strideHeight,A=o.strideWidth,M=S-1-o.padInfo.top,$=E-1-o.padInfo.left,O=T/C,L=0;L<w;++L)for(var B=0;B<C;++B)for(var G=0;G<k;++G)for(var q=G-M,J=Math.max(0,Math.ceil(q/j)),ne=Math.min(D,(S+q)/j),ie=0;ie<_;++ie){for(var se=ie-$,me=Math.max(0,Math.ceil(se/A)),he=Math.min(U,(E+se)/A),Ee=0,Ie=J;Ie<ne;++Ie)for(var ce=Ie*j-q,_e=me;_e<he;++_e)for(var ke=p*L+h*Ie+m*_e,Ye=y*(S-1-ce)+b*(E-1-(_e*A-se))+x*B,Ue=0;Ue<O;++Ue)Ee+=f[ke+(B*O+Ue)]*g[Ye+Ue];a[u*L+l*G+c*ie+B]=Ee}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){Z([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=Te(o.filterShape,"float32"),c=o.padInfo.left,f=o.padInfo.top,d=o.outChannels/o.inChannels,p=this.bufferSync(n),h=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((f-m)/i)),v=Math.min(o.outHeight,(o.inHeight+f-m)/i),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((c-y)/a)),x=Math.min(o.outWidth,(o.inWidth+c-y)/a),w=0;w<o.outChannels;++w){for(var S=Math.trunc(w/d),E=w%d,C=0,k=0;k<o.batchSize;++k)for(var _=g;_<v;++_)for(var T=m+_*i-f,D=b;D<x;++D){var U=y+D*a-c;C+=p.get(k,T,U,S)*h.get(k,_,D,w)}l.set(C,m,y,S,E)}return l.toTensor()},t.prototype.tile=function(n,r){return Z(n,"tile"),PC(this.bufferSync(n),r)},t.prototype.pad=function(n,r,o){Z(n,"pad");var i=r.map(function(d,p){return d[0]+n.shape[p]+d[1]}),a=r.map(function(d){return d[0]}),s=this.bufferSync(n),u=Te(i,n.dtype);o!==0&&u.values.fill(o);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),f=c.map(function(d,p){return d+a[p]});u.set.apply(u,[s.get.apply(s,c)].concat(f))}return u.toTensor()},t.prototype.transpose=function(n,r){Z(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=Te(o,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var l=u.indexToLoc(i),c=new Array(l.length),f=0;f<c.length;f++)c[f]=l[r[f]];var d=s.locToIndex(c);s.values[d]=a[i]}return s.toTensor()},t.prototype.gather=function(n,r,o){Z([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=Te(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),f=c.slice();f[o]=a[c[o]];var d=u.locToIndex(f);s.values[l]=u.values[d]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,o){Z([n],"batchToSpaceND");var i=r.reduce(function(f,d){return f*d}),a=Jc(n.shape,r,i),s=Zc(a.length,r.length),u=ef(n.shape,r,i),l=vC(o,r.length),c=mC(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){Z([n],"spaceToBatchND");var i=r.reduce(function(d,p){return d*p}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=Jc(u.shape,r,i,!1),c=Zc(l.length,r.length,!1),f=ef(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(f)},t.prototype.pool=function(n,r,o){Z(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=r.padInfo.top,d=r.padInfo.left,p=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,h=this.readSync(n.dataId),m=Te(r.outShape,n.dtype),g=m.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3],x=0;x<r.batchSize;++x)for(var w=x*v,S=x*n.strides[0],E=0;E<r.inChannels;++E)for(var C=0;C<r.outHeight;++C)for(var k=C*i-f,_=Math.max(0,k),T=Math.min(r.inHeight,l+k),D=w+C*y,U=0;U<r.outWidth;++U){for(var j=U*a-d,A=Math.max(0,j),M=Math.min(r.inWidth,c+j),$=p,O=0,L=0,B=_;B<T;B+=s){for(var G=S+B*n.strides[1],q=A;q<M;q+=u){var J=h[G+q*n.strides[2]+E];o==="max"&&J>$?$=J:o==="avg"&&(O+=J,L++)}if(isNaN($))break}g[D+U*b+E]=o==="avg"?O/L:$}return m.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var o=Te(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=r.padInfo.top,d=r.padInfo.left,p=this.bufferSync(n),h=0;h<r.batchSize;++h)for(var m=0;m<r.inChannels;++m)for(var g=0;g<r.outHeight;++g){for(var v=g*i-f,y=v;y<0;)y+=s;for(var b=Math.min(r.inHeight,l+v),x=0;x<r.outWidth;++x){for(var w=x*a-d,S=w;S<0;)S+=u;for(var E=Math.min(r.inWidth,c+w),C=Number.NEGATIVE_INFINITY,k=-1,_=y;_<b;_+=s)for(var T=_-v,D=S;D<E;D+=u){var U=D-w,j=p.get(h,_,D,m);j>C&&(C=j,k=T*c+U)}o.set(k,h,g,x,m)}}return o.toTensor()},t.prototype.maxPoolBackprop=function(n,r,o,i){Z([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,f=i.effectiveFilterHeight,d=i.effectiveFilterWidth,p=d-1-i.padInfo.left,h=f-1-i.padInfo.top,m=Te(r.shape,"float32"),g=this.bufferSync(a),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var x=0;x<i.inHeight;++x)for(var w=0;w<i.inWidth;++w){for(var S=x-h,E=w-p,C=0,k=0;k<f;k+=l){var _=(S+k)/s;if(!(_<0||_>=i.outHeight||Math.floor(_)!==_))for(var T=0;T<d;T+=c){var D=(E+T)/u;if(!(D<0||D>=i.outWidth||Math.floor(D)!==D)){var U=f*d-1-g.get(y,_,D,b)===k*d+T?1:0;U!==0&&(C+=v.get(y,_,D,b)*U)}}}m.set(C,y,x,w,b)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,o){Z([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dilationHeight,c=o.dilationWidth,f=o.effectiveFilterHeight,d=o.effectiveFilterWidth,p=d-1-o.padInfo.left,h=f-1-o.padInfo.top,m=Te(r.shape,"float32"),g=1/(s*u),v=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var b=0;b<o.inChannels;++b)for(var x=0;x<o.inHeight;++x)for(var w=0;w<o.inWidth;++w){for(var S=x-h,E=w-p,C=0,k=0;k<f;k+=l){var _=(S+k)/i;if(!(_<0||_>=o.outHeight||Math.floor(_)!==_))for(var T=0;T<d;T+=c){var D=(E+T)/a;D<0||D>=o.outWidth||Math.floor(D)!==D||(C+=v.get(y,_,D,b))}}m.set(C*g,y,x,w,b)}return m.toTensor()},t.prototype.pool3d=function(n,r,o){Z(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),b=Te(r.outShape,n.dtype),x=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[3]*r.outShape[4],C=r.outShape[4],k=0;k<r.batchSize;++k)for(var _=k*w,T=k*n.strides[0],D=0;D<r.inChannels;++D)for(var U=0;U<r.outDepth;++U){for(var j=U*i-h,A=j;A<0;)A+=u;for(var M=Math.min(r.inDepth,f+j),$=_+U*S,O=0;O<r.outHeight;++O){for(var L=O*a-m,B=L;B<0;)B+=l;for(var G=Math.min(r.inHeight,d+L),q=$+O*E,J=0;J<r.outWidth;++J){for(var ne=J*s-g,ie=ne;ie<0;)ie+=c;for(var se=Math.min(r.inWidth,p+ne),me=q+J*C,he=v,Ee=0,Ie=0,ce=A;ce<M;ce+=u){for(var _e=T+ce*n.strides[1],ke=B;ke<G;ke+=l){for(var Ye=_e+ke*n.strides[2],Ue=ie;Ue<se;Ue+=c){var et=y[Ye+Ue*n.strides[3]+D];if(o==="max"&&et>he?he=et:o==="avg"&&(Ee+=et,Ie++),isNaN(he))break}if(isNaN(he))break}if(isNaN(he))break}x[me+D]=o==="avg"?Ee/Ie:he}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return Z(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,o){Z([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,f=o.dilationDepth,d=o.dilationHeight,p=o.dilationWidth,h=o.effectiveFilterDepth,m=o.effectiveFilterHeight,g=o.effectiveFilterWidth,v=h-1-o.padInfo.front,y=g-1-o.padInfo.left,b=m-1-o.padInfo.top,x=Te(r.shape,"float32"),w=1/(u*l*c),S=this.bufferSync(n),E=0;E<o.batchSize;++E)for(var C=0;C<o.inChannels;++C)for(var k=0;k<o.inDepth;++k)for(var _=0;_<o.inHeight;++_)for(var T=0;T<o.inWidth;++T){for(var D=k-v,U=_-b,j=T-y,A=0,M=0;M<h;M+=f){var $=(D+M)/i;if(!($<0||$>=o.outDepth||Math.floor($)!==$))for(var O=0;O<m;O+=d){var L=(U+O)/a;if(!(L<0||L>=o.outHeight||Math.floor(L)!==L))for(var B=0;B<g;B+=p){var G=(j+B)/s;G<0||G>=o.outWidth||Math.floor(G)!==G||(A+=S.get(E,$,L,G,C))}}}x.set(A*w,E,k,_,T,C)}return x.toTensor()},t.prototype.maxPool3d=function(n,r){return Z(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var o=Te(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outDepth;++x){for(var w=x*i-h,S=w;S<0;)S+=u;for(var E=Math.min(r.inDepth,f+w),C=0;C<r.outHeight;++C){for(var k=C*a-m,_=k;_<0;)_+=l;for(var T=Math.min(r.inHeight,d+k),D=0;D<r.outWidth;++D){for(var U=D*s-g,j=U;j<0;)j+=c;for(var A=Math.min(r.inWidth,p+U),M=Number.NEGATIVE_INFINITY,$=-1,O=S;O<E;O+=u)for(var L=O-w,B=_;B<T;B+=l)for(var G=B-k,q=j;q<A;q+=c){var J=q-U,ne=v.get(y,O,B,q,b);ne>=M&&(M=ne,$=L*d*p+G*d+J)}o.set($,y,x,C,D,b)}}}return o.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,o,i){Z([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,f=i.dilationHeight,d=i.dilationWidth,p=i.effectiveFilterDepth,h=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=p-1-i.padInfo.front,v=m-1-i.padInfo.left,y=h-1-i.padInfo.top,b=Te(r.shape,"float32"),x=this.bufferSync(a),w=this.bufferSync(n),S=0;S<i.batchSize;++S)for(var E=0;E<i.inChannels;++E)for(var C=0;C<i.inDepth;++C)for(var k=0;k<i.inHeight;++k)for(var _=0;_<i.inWidth;++_){for(var T=C-g,D=k-y,U=_-v,j=0,A=0;A<p;A+=c){var M=(T+A)/s;if(!(M<0||M>=i.outDepth||Math.floor(M)!==M))for(var $=0;$<h;$+=f){var O=(D+$)/u;if(!(O<0||O>=i.outHeight||Math.floor(O)!==O))for(var L=0;L<m;L+=d){var B=(U+L)/l;if(!(B<0||B>=i.outWidth||Math.floor(B)!==B)){var G=p*h*m-1-x.get(S,M,O,B,E)===A*h*m+$*m+L?1:0;G!==0&&(j+=w.get(S,M,O,B,E)*G)}}}}b.set(j,S,C,k,_,E)}return b.toTensor()},t.prototype.cast=function(n,r){return EC(n,r,this)},t.prototype.reshape=function(n,r){return Fv(n,r)},t.prototype.avgPool=function(n,r){return Z(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,o,i){Z(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],f=this.readSync(n.dataId),d=new Float32Array(ge([s,r,o,c])),p=[i&&r>1?u-1:u,i&&o>1?l-1:l],h=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=0,g=p[0]/h[0],v=p[1]/h[1],y=0;y<s;y++)for(var b=0;b<r;b++)for(var x=g*b,w=Math.floor(x),S=x-w,E=Math.min(u-1,Math.ceil(x)),C=y*n.strides[0]+w*n.strides[1],k=y*n.strides[0]+E*n.strides[1],_=0;_<o;_++)for(var T=v*_,D=Math.floor(T),U=T-D,j=Math.min(l-1,Math.ceil(T)),A=C+D*n.strides[2],M=k+D*n.strides[2],$=C+j*n.strides[2],O=k+j*n.strides[2],L=0;L<c;L++){var B=f[A+L],G=f[M+L],q=B+(f[$+L]-B)*U,J=q+(G+(f[O+L]-G)*U-q)*S;d[m++]=J}return Xt(d,[s,r,o,c])},t.prototype.resizeBilinearBackprop=function(n,r,o){Z([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,f=c[1],d=c[2],p=new Float32Array(a*s*u*l),h=[o&&f>1?s-1:s,o&&d>1?u-1:u],m=[o&&f>1?f-1:f,o&&d>1?d-1:d],g=h[0]/m[0],v=h[1]/m[1],y=this.readSync(n.dataId),b=0,x=0;x<a;x++)for(var w=x*r.strides[0],S=0;S<f;S++)for(var E=S*g,C=Math.floor(E),k=Math.min(Math.ceil(E),s-1),_=w+C*r.strides[1],T=w+k*r.strides[1],D=E-C,U=1-D,j=0;j<d;j++)for(var A=j*v,M=Math.floor(A),$=Math.min(Math.ceil(A),u-1),O=A-M,L=1-O,B=_+M*r.strides[2],G=_+$*r.strides[2],q=T+M*r.strides[2],J=T+$*r.strides[2],ne=U*L,ie=U*O,se=D*L,me=D*O,he=0;he<l;he++){var Ee=y[b++];p[B+he]+=Ee*ne,p[G+he]+=Ee*ie,p[q+he]+=Ee*se,p[J+he]+=Ee*me}return Cn(p,[a,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,o,i){Z(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],f=this.readSync(n.dataId),d=new Float32Array(s*r*o*c),p=[i&&r>1?u-1:u,i&&o>1?l-1:l],h=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=p[0]/h[0],g=p[1]/h[1],v=0,y=0;y<s;y++)for(var b=y*n.strides[0],x=0;x<r;x++)for(var w=m*x,S=b+Math.min(u-1,i?Math.round(w):Math.floor(w))*n.strides[1],E=0;E<o;E++)for(var C=g*E,k=S+Math.min(l-1,i?Math.round(C):Math.floor(C))*n.strides[2],_=0;_<c;_++){var T=f[k+_];d[v++]=T}return Xt(d,[s,r,o,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){Z([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,f=c[1],d=c[2],p=new Float32Array(a*s*u*l),h=this.readSync(n.dataId),m=[o&&f>1?s-1:s,o&&d>1?u-1:u],g=[o&&f>1?f-1:f,o&&d>1?d-1:d],v=m[0]/g[0],y=m[1]/g[1],b=1/v,x=1/y,w=2*Math.ceil(b)+2,S=2*Math.ceil(x)+2,E=0;E<a;E++)for(var C=E*r.strides[0],k=0;k<s;k++)for(var _=C+k*r.strides[1],T=Math.floor(k*b),D=Math.floor(T-w/2),U=0;U<u;U++)for(var j=_+U*r.strides[2],A=Math.floor(U*x),M=Math.floor(A-S/2),$=0;$<l;$++){for(var O=0,L=0;L<w;L++){var B=L+D;if(!(B<0||B>=f)){var G=C+B*n.strides[1],q=B*v;if(k===Math.min(s-1,o?Math.round(q):Math.floor(q)))for(var J=0;J<S;J++){var ne=J+M;if(!(ne<0||ne>=d)){var ie=G+ne*n.strides[2],se=ne*y;U===Math.min(u-1,o?Math.round(se):Math.floor(se))&&(O+=h[ie+$])}}}}p[j+$]=O}return Cn(p,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){Z([n,r,o,a,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(o.dataId),f=a?this.readSync(a.dataId):new Float32Array([1]),d=s?this.readSync(s.dataId):new Float32Array([0]),p=new Float32Array(u.length),h=d.length,m=f.length,g=c.length,v=l.length,y=0,b=0,x=0,w=0,S=0;S<u.length;++S)p[S]=d[y++]+(u[S]-l[b++])*f[x++]/Math.sqrt(c[w++]+i),y>=h&&(y=0),b>=v&&(b=0),x>=m&&(x=0),w>=g&&(w=0);return Cn(p,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){Z(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,f=new Float32Array(c);function d(g){for(var v=g%s,y=g-v+Math.max(0,v-r),b=g-v+Math.min(v+r,u),x=0;y<=b;y++){var w=l[y];x+=w*w}return x}for(var p=0;p<c;p++){var h=d(p),m=l[p]*Math.pow(o+i*h,-a);f[p]=m}return Cn(f,n.shape)},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){Z(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=this.readSync(o.dataId),p=new Float32Array(n.size),h=n.size,m=0;m<h;m++){for(var g=m%l,v=m-g+Math.max(0,g-i),y=m-g+Math.min(l,g+i+1),b=0,x=v;x<y;x++)b+=Math.pow(f[x],2);for(b=s*b+a,x=v;x<y;x++){var w=-2*s*u*f[x]*d[m]/b;m===x&&(w+=Math.pow(b,-u)),w*=c[m],p[x]+=w}}return Cn(p,n.shape)},t.prototype.multinomial=function(n,r,o,i){Z(n,"multinomial");for(var a=r?n:wo(n),s=a.shape[0],u=a.shape[1],l=rt([s,o],"int32"),c=this.readSync(l.dataId),f=this.readSync(a.dataId),d=0;d<s;++d){var p=d*u,h=new Float32Array(u-1);h[0]=f[p];for(var m=1;m<h.length;++m)h[m]=h[m-1]+f[p+m];for(var g=yd(i.toString()),v=d*o,y=0;y<o;++y){var b=g();c[v+y]=h.length;for(var x=0;x<h.length;x++)if(b<h[x]){c[v+y]=x;break}}}return l},t.prototype.oneHot=function(n,r,o,i){Z(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return ti(a,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return Z(n,"nonMaxSuppression"),Og(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=Te(n.shape,"float32"),s=Te(n.shape,"float32"),u=or(n).as2D(o,i),l=Ur(n).as2D(o,i),c=0;c<o;c++)for(var f=u.slice([c,0],[1,i]),d=l.slice([c,0],[1,i]),p=qt(f,d),h=this.readSync(this.fftImpl(p,r).dataId),m=0;m<i;m++){var g=Q1(h,m);a.values[c*i+m]=g.real,s.values[c*i+m]=g.imag}return qt(a.toTensor(),s.toTensor()).as2D(o,i)},t.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=qt(or(a).div(ae(i)),Ur(a).div(ae(i)))),a}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),f=new Float32Array(l.length/2),d=0;d<l.length;d+=2)c[d/2]=l[d],f[d/2]=l[d+1];return{real:c,imag:f}}(this.fourierTransformByMatmul(s,i,r));return qt(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(v){for(var y=Math.ceil(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=0;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(i),u=qt(s.real,s.imag).as1D(),l=function(v){for(var y=Math.floor(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=2;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(i),c=qt(l.real,l.imag).as1D();u=this.fftRadix2(u,a,o),c=this.fftRadix2(c,a,o);var f=function(v,y){for(var b=new Float32Array(v/2),x=new Float32Array(v/2),w=0;w<Math.ceil(v/2);w++){var S=(y?2:-2)*Math.PI*(w/v);b[w]=Math.cos(S),x[w]=Math.sin(S)}return{real:b,imag:x}}(r,o),d=qt(f.real,f.imag).mul(c),p=u.add(d),h=u.sub(d),m=or(p).concat(or(h)),g=Ur(p).concat(Ur(h));return qt(m,g).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,l=0;l<r;l++){var c=P3(a*l,r,o),f=Q1(n,l);s+=f.real*c.real-f.imag*c.imag,u+=f.real*c.imag+f.imag*c.real}o&&(s/=r,u/=r),R3(i,s,u,a)}return i},t.prototype.depthToSpace=function(n,r,o){I(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],l=a*r,c=s*r,f=u/(r*r),d=this.readSync(n.dataId),p=new Float32Array(i*l*c*f),h=0,m=0;m<i;++m)for(var g=0;g<l;++g)for(var v=Math.floor(g/r),y=g%r,b=0;b<c;++b)for(var x=Math.floor(b/r),w=(y*r+b%r)*f,S=0;S<f;++S){var E=S+w+u*(x+s*(v+a*m));p[h++]=d[E]}return Cn(p,[i,l,c,f])},t.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=Be(n.shape,r.shape),s=Te(a,o),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=Vo(n.shape,a),f=Vo(r.shape,a),d=s.values;if(c.length+f.length===0)for(var p=0;p<d.length;++p)d[p]=i(u[p%u.length],l[p%l.length]);else{var h=this.bufferSync(n),m=this.bufferSync(r),g=function(v){var y=s.indexToLoc(v),b=y.slice(-n.rank);c.forEach(function(E){return b[E]=0});var x=h.locToIndex(b),w=y.slice(-r.rank);f.forEach(function(E){return w[E]=0});var S=m.locToIndex(w);d[v]=i(u[x],l[S])};for(p=0;p<d.length;++p)g(p)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=Be(n.shape,r.shape),a=Te(i,"float32"),s=Te(i,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=Vo(n.shape,i),f=Vo(r.shape,i),d=a.values,p=s.values;if(c.length+f.length===0)for(var h=0;h<d.length;h++){var m=h%u.length,g=h%l.length,v=o(u[2*m],u[2*m+1],l[2*g],l[2*g+1]);d[h]=v.real,p[h]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),x=function(w){var S=a.indexToLoc(w),E=S.slice(-n.rank);c.forEach(function(D){return E[D]=0});var C=y.locToIndex(E),k=S.slice(-r.rank);f.forEach(function(D){return k[D]=0});var _=b.locToIndex(k),T=o(u[2*C],u[2*C+1],l[2*_],l[2*_+1]);d[w]=T.real,p[w]=T.imag};for(h=0;h<d.length;h++)x(h)}return this.complex(a.toTensor(),s.toTensor())},t.prototype.split=function(n,r,o){return RC(n,r,o)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,o,i,a,s){for(var u=n.shape,l=u[0],c=u[1],f=u[2],d=u[3],p=r.shape[0],h=i[0],m=i[1],g=Te([p,h,m,d],"float32"),v=this.readSync(r.dataId),y=this.readSync(o.dataId),b=this.readSync(n.dataId),x=n.strides,w=g.strides,S=0;S<p;S++){var E=4*S,C=v[E],k=v[E+1],_=v[E+2],T=v[E+3],D=y[S];if(!(D>=l))for(var U=h>1?(_-C)*(c-1)/(h-1):0,j=m>1?(T-k)*(f-1)/(m-1):0,A=0;A<h;A++){var M=h>1?C*(c-1)+A*U:.5*(C+_)*(c-1);if(M<0||M>c-1)for(var $=0;$<m;$++)for(var O=0;O<d;O++){var L=O+$*w[2]+A*w[1]+S*w[0];g.values[L]=s}else if(a==="bilinear"){var B=Math.floor(M),G=Math.ceil(M),q=M-B;for($=0;$<m;$++)if((ce=m>1?k*(f-1)+$*j:.5*(k+T)*(f-1))<0||ce>f-1)for(O=0;O<d;O++)L=O+$*w[2]+A*w[1]+S*w[0],g.values[L]=s;else{var J=Math.floor(ce),ne=Math.ceil(ce),ie=ce-J;for(O=0;O<d;O++){var se=b[L=O+J*x[2]+B*x[1]+D*x[0]],me=b[L=O+ne*x[2]+B*x[1]+D*x[0]],he=b[L=O+J*x[2]+G*x[1]+D*x[0]],Ee=se+(me-se)*ie,Ie=he+(b[L=O+ne*x[2]+G*x[1]+D*x[0]]-he)*ie;L=O+$*w[2]+A*w[1]+S*w[0],g.values[L]=Ee+(Ie-Ee)*q}}}else for($=0;$<m;++$){var ce;if((ce=m>1?k*(f-1)+$*j:.5*(k+T)*(f-1))<0||ce>f-1)for(O=0;O<d;O++)L=O+$*w[2]+A*w[1]+S*w[0],g.values[L]=s;else{var _e=Math.round(ce),ke=Math.round(M);for(O=0;O<d;O++){var Ye=O+_e*x[2]+ke*x[1]+D*x[0],Ue=O+$*w[2]+A*w[1]+S*w[0];g.values[Ue]=b[Ye]}}}}}return g.toTensor()},t.prototype.sparseToDense=function(n,r,o,i){var a=tf(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.sliceSize,c=a.strides,f=a.outputSize;return this.scatter(n,r,o,f,l,u,s,c,i,!1)},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=gC(n,r),s=a[0],u=a[1],l=a[2],c=a[3];if(u===0)return Xt([],s,n.dtype);for(var f=new _u([u,l],n.dtype),d=this.readSync(r.dataId),p=this.readSync(n.dataId),h=0;h<u;h++){for(var m=[],g=0,v=0;v<i;v++){var y=d[h*i+v];g+=y*c[v],m.push(y)}if(g<0||g>=n.size/l)throw new Error("Invalid indices: "+m+" does not index into "+n.shape);for(var b=0;b<l;b++)f.values[h*l+b]=p[g*l+b]}return f.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,o){var i=tf(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,f=ae(0);return this.scatter(n,r,o,c,u,s,a,l,f,!0)},t.prototype.fill=function(n,r,o){var i=Hc(o=o||zu(r),ge(n));return i.fill(r),V.makeTensor(i,n,o,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Hc(n.dtype,ge(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,o){return _C(n,r,o)},t.prototype.scatter=function(n,r,o,i,a,s,u,l,c,f){var d=[i/a,a],p=this.readSync(n.dataId),h=this.readSync(r.dataId);if(i===0)return Xt([],o,r.dtype);var m=new _u(d,r.dtype);m.values.fill(this.readSync(c.dataId)[0]);for(var g=0;g<s;g++){for(var v=[],y=0,b=0;b<u;b++){var x=p[g*u+b];v.push(x),y+=x*l[b]}if(y<0||y>=i/a)throw new Error("Invalid indices: "+v+" does not index into "+o);for(var w=0;w<a;w++)f?m.values[y*a+w]+=h[g*a+w]:m.values[y*a+w]=r.rank===0?h[0]:h[g*a+w]}return m.toTensor().reshape(o)},t}(SC);V.registerBackend("cpu",function(){return new KL},1);for(var Hp=0,bb=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n;Z(i,"NonMaxSuppressionWithScore");var p=Tg(d.data.get(i.dataId).values,d.data.get(a.dataId).values,u,l,c,f);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;Z(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Pu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n;Z([o,i],Pu);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,l=function(d,p,h,m,g,v){var y=Be(d,p),b=y.length,x=Xr(y),w=Eu(g,ge(y)),S=d.length,E=p.length,C=Xr(d),k=Xr(p),_=Vo(d,y),T=Vo(p,y);if(_.length+T.length===0)for(var D=0;D<w.length;++D)w[D]=v(h[D%h.length],m[D%m.length]);else{var U=function(j){var A=oA(j,b,x),M=A.slice(-S);_.forEach(function(B){return M[B]=0});var $=W1(M,S,C),O=A.slice(-E);T.forEach(function(B){return O[B]=0});var L=W1(O,E,k);w[j]=v(h[$],m[L])};for(D=0;D<w.length;++D)U(D)}return[w,y]}(o.shape,i.shape,s,u,o.dtype,function(d,p){var h=d-p;return h*h}),c=l[0],f=l[1];return{dataId:a.write(c,f,o.dtype),shape:f,dtype:o.dtype}}}];Hp<bb.length;Hp++)YS(bb[Hp]);var oa,XL=function(e){this.variableNames=["A"];var t=cn(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},YL=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=cn(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var Gp=0,xb=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],f=[c,l],d=[c,l,i];(s||a)&&(oa==null&&(oa=document.createElement("canvas").getContext("2d")),oa.canvas.width=l,oa.canvas.height=c,oa.drawImage(o,0,0,l,c),o=oa.canvas);var p=n.makeTensorInfo(f,"int32");n.texData.get(p.dataId).usage=zn.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),o);var h=Y().getBool("WEBGL_PACK")?new YL(d):new XL(d),m=n.runWebGLProgram(h,[p],"int32");return n.disposeData(p.dataId),m}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Xc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n,p=Tg(d.readSync(i.dataId),d.readSync(a.dataId),u,l,c,f);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,i=new Ae(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Pu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n,s=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ro("return (a - b) * (a - b);",o.shape,i.shape):new vt("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Gp<xb.length;Gp++)YS(xb[Gp]);for(var qp=0,wb=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:Pu,gradFunc:function(e,t){var n=t[0],r=t[1],o=ae(2);return{a:function(){return dn(e,dn(o,Mt(n,r)))},b:function(){return dn(e,dn(o,Mt(r,n)))}}}}];qp<wb.length;qp++)qN(wb[qp]);var QL=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();Y().get("IS_BROWSER")&&Y().setPlatform("browser",new QL);var Kp,JL=function(){return require("node-fetch")},ZL=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return Y().global.fetch!=null?Y().global.fetch(t,n):(Kp==null&&(Kp=JL()),Kp(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();Y().get("IS_NODE")&&Y().setPlatform("node",new ZL);var jv={float32:4,int32:4,uint16:2,uint8:1,bool:1},lf=4;function bE(e,t){for(var n={},r=0,o=function(s){var u=s.name,l=s.dtype,c=s.shape,f=ge(c),d=void 0;if("quantization"in s){var p=s.quantization;if(p.dtype!=="uint8"&&p.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+p.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var h=jv[p.dtype],m=e.slice(r,r+f*h),g=p.dtype==="uint8"?new Uint8Array(m):new Uint16Array(m);if(l==="float32")d=Float32Array.from(g,function(S){return S*p.scale+p.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=Int32Array.from(g,function(S){return Math.round(S*p.scale+p.min)})}r+=f*h}else if(l==="string"){var v=ge(s.shape);d=[];for(var y=0;y<v;y++){var b=new Uint32Array(e.slice(r,r+lf))[0];r+=lf;var x=new Uint8Array(e.slice(r,r+b));d.push(x),r+=b}}else{var w=jv[l];if(m=e.slice(r,r+f*w),l==="float32")d=new Float32Array(m);else if(l==="int32")d=new Int32Array(m);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=new Uint8Array(m)}r+=f*w}n[u]=Xt(d,c,l)},i=0,a=t;i<a.length;i++)o(a[i]);return n}function eB(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(i){if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var $v=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Sb(e){return $v?Buffer.byteLength(e):new Blob([e]).size}function Yg(e){var t=0;e.forEach(function(o){t+=o.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function Cb(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Qu(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:Sb(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:Sb(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var Hn=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var a=i(t,r);a!==null&&o.push(a)}),o},e}(),$a="://",ni=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){I(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith($a)&&(t=t.slice(0,t.indexOf($a))),I(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();I(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function ic(e){if(e.indexOf($a)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+ni.getSchemes().join(","));return{scheme:e.split($a)[0],path:e.split($a)[1]}}function Eb(e,t,n){return n===void 0&&(n=!1),de(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,f;return pe(this,function(d){switch(d.label){case 0:return I(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),I((r=Hn.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),I(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),o=r[0],I((i=Hn.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),I(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),a=i[0],s=ic(e).scheme,u=ic(e).path,l=s===ic(e).scheme,[4,o.load()];case 1:return c=d.sent(),n&&l?[4,ni.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,a.save(c)];case 4:return f=d.sent(),!n||l?[3,6]:[4,ni.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,f.modelArtifactsInfo]}})})}var Pi="models_store",Wo="model_info_store";function xE(){if(!Y().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Vv(e){var t=e.result;t.createObjectStore(Pi,{keyPath:"modelPath"}),t.createObjectStore(Wo,{keyPath:"modelPath"})}var Va=function(){function e(t){if(this.indexedDB=xE(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){return pe(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return de(this,void 0,void 0,function(){return pe(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Vv(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(Pi,"readonly"),l=u.objectStore(Pi).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(l.result.modelArtifacts)},l.onerror=function(m){return s.close(),i(l.error)},u.oncomplete=function(){return s.close()}}else{var c,f=Qu(n),d=s.transaction(Wo,"readwrite"),p=d.objectStore(Wo),h=p.put({modelPath:r.modelPath,modelArtifactsInfo:f});h.onsuccess=function(){var m=(c=s.transaction(Pi,"readwrite")).objectStore(Pi).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:f});m.onsuccess=function(){return o({modelArtifactsInfo:f})},m.onerror=function(g){var v=(p=d.objectStore(Wo)).delete(r.modelPath);v.onsuccess=function(){return s.close(),i(m.error)},v.onerror=function(y){return s.close(),i(m.error)}}},h.onerror=function(m){return s.close(),i(h.error)},d.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),_b=function(e){return Y().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Va.URL_SCHEME)?(t=e.slice(Va.URL_SCHEME.length),new Va(t)):null;var t};Hn.registerSaveRouter(_b),Hn.registerLoadRouter(_b);var tB=function(){function e(){this.indexedDB=xE()}return e.prototype.listModels=function(){return de(this,void 0,void 0,function(){var t=this;return pe(this,function(n){return[2,new Promise(function(r,o){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Vv(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(Wo,"readonly"),u=s.objectStore(Wo).getAll();u.onsuccess=function(){for(var l={},c=0,f=u.result;c<f.length;c++){var d=f[c];l[d.modelPath]=d.modelArtifactsInfo}r(l)},u.onerror=function(l){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},e.prototype.removeModel=function(t){return de(this,void 0,void 0,function(){var n=this;return pe(this,function(r){var o;return t=(o=t).startsWith(Va.URL_SCHEME)?o.slice(Va.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Vv(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(Wo,"readwrite"),f=c.objectStore(Wo),d=f.get(t);d.onsuccess=function(){if(d.result==null)return l.close(),a(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var p=f.delete(t),h=function(){var m=(u=l.transaction(Pi,"readwrite")).objectStore(Pi).delete(t);m.onsuccess=function(){return i(d.result.modelArtifactsInfo)},m.onerror=function(g){return a(d.error)}};p.onsuccess=h,p.onerror=function(m){return h(),l.close(),a(d.error)}},d.onerror=function(p){return l.close(),a(d.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return a(s.error)}})]})})},e}();if(Y().getBool("IS_BROWSER"))try{ni.registerManager(Va.URL_SCHEME,new tB)}catch{}var ao="/",va="tensorflowjs_models",wE="info",nB="model_topology",rB="weight_specs",oB="weight_data",iB="model_metadata";function SE(e){return{info:[va,e,wE].join(ao),topology:[va,e,nB].join(ao),weightSpecs:[va,e,rB].join(ao),weightData:[va,e,oB].join(ao),modelMetadata:[va,e,iB].join(ao)}}function aB(e){var t=e.split(ao);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(ao)}var Wa=function(){function e(t){if(!Y().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=SE(this.modelPath)}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){var n,r,o;return pe(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),o=Qu(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if($v)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return de(this,void 0,void 0,function(){var t,n,r,o,i,a,s;return pe(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if($v){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var f=atob(l),d=new Uint8Array(f.length),p=0;p<f.length;++p)d.set([f.charCodeAt(p)],p);return d.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),kb=function(e){return Y().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Wa.URL_SCHEME)?(t=e.slice(Wa.URL_SCHEME.length),new Wa(t)):null;var t};Hn.registerSaveRouter(kb),Hn.registerLoadRouter(kb);var sB=function(){function e(){I(Y().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),I(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return de(this,void 0,void 0,function(){var t,n,r,o,i,a;return pe(this,function(s){for(t={},n=va+ao,r=ao+wE,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=aB(i),t[a]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return de(this,void 0,void 0,function(){var n,r;return pe(this,function(o){var i;if(t=(i=t).startsWith(Wa.URL_SCHEME)?i.slice(Wa.URL_SCHEME.length):i,n=SE(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(Y().getBool("IS_BROWSER"))try{ni.registerManager(Wa.URL_SCHEME,new sB)}catch{}var uB="model",lB=".json",cB=".weights.bin";function Rb(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var Xp=function(){function e(t){if(!Y().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=uB),this.modelTopologyFileName=t+lB,this.weightDataFileName=t+cB}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){var n,r,o,i,a,s;return pe(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,Rb(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,Rb(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Qu(t)}]}})})},e.URL_SCHEME="downloads://",e}(),fB=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return de(this,void 0,void 0,function(){var t,n,r=this;return pe(this,function(o){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&i({modelTopology:c});var f=l.weightsManifest;if(f!=null){var d;try{d=r.checkManifestAndWeightFiles(f,n)}catch(g){return void a(g)}var p=[],h=[],m=[];f.forEach(function(g){g.paths.forEach(function(v){h.push(v),m.push(null)}),p.push.apply(p,g.weights)}),f.forEach(function(g){g.paths.forEach(function(v){var y=new FileReader;y.onload=function(b){var x=b.target.result,w=h.indexOf(v);m[w]=x,m.indexOf(null)===-1&&i({modelTopology:c,weightSpecs:p,weightData:Yg(m),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(b){return a("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(d[v])})})}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],o=n.map(function(u){return Cb(u.name)}),i={},a=0,s=t;a<s.length;a++)s[a].paths.forEach(function(u){var l=Cb(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),o.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");i[u]=n[o.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},e}();function Pb(e,t,n,r){(function(i){I(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,a){I(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),I(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),I(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(e.map(function(i){return i.then(function(a){var s=n+ ++o/e.length*(r-n);return t(s),a}),i}))}function CE(e,t){return de(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c;return pe(this,function(f){switch(f.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?Y().platform.fetch:t.fetchFunc,r=e.map(function(d){return n(d,t.requestInit,{isBinary:!0})}),o=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=f.sent(),[3,4];case 2:return[4,Pb(r,t.onProgress,o,i)];case 3:a=f.sent(),f.label=4;case 4:return s=a.map(function(d){return d.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=f.sent(),[3,8];case 6:return[4,Pb(s,t.onProgress,u,l)];case 7:c=f.sent(),f.label=8;case 8:return[2,c]}})})}function Ib(e){var t=this;return function(n,r,o){return r===void 0&&(r=""),de(t,void 0,void 0,function(){var i,a,s,u,l,c,f,d,p,h;return pe(this,function(m){switch(m.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(g,v){var y=0;g.weights.forEach(function(b){var x="quantization"in b?b.quantization.dtype:b.dtype,w=jv[x]*ge(b.shape),S=function(){i[v]=!0,a[v]==null&&(a[v]=[]),a[v].push({manifestEntry:b,groupOffset:y,sizeBytes:w})};o!=null?o.forEach(function(E,C){E===b.name&&(S(),s[C]=!0)}):S(),u.push(b.name),y+=w})}),!s.every(function(g){return g}))throw l=o.filter(function(g,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=i.reduce(function(g,v,y){return v&&g.push(y),g},[]),f=[],c.forEach(function(g){n[g].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;f.push(y)})}),[4,e(f)];case 1:return d=m.sent(),p={},h=0,c.forEach(function(g){for(var v=n[g].paths.length,y=0,b=0;b<v;b++)y+=d[h+b].byteLength;for(var x=new ArrayBuffer(y),w=new Uint8Array(x),S=0,E=0;E<v;E++){var C=new Uint8Array(d[h+E]);w.set(C,S),S+=C.byteLength}a[g].forEach(function(k){var _=bE(x.slice(k.groupOffset,k.groupOffset+k.sizeBytes),[k.manifestEntry]);for(var T in _)p[T]=_[T]}),h+=v}),[2,p]}})})}}Hn.registerSaveRouter(function(e){return Y().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Xp.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new Xp(t)}(e.slice(Xp.URL_SCHEME.length)):null});var EE=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(I(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=Y().platform.fetch,I(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&I(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){var n,r,o,i;return pe(this,function(a){switch(a.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:Qu(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return de(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u,l,c,f,d;return pe(this,function(p){switch(p.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=p.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");p.label=2;case 2:return p.trys.push([2,4,,5]),[4,t.json()];case 3:return n=p.sent(),[3,5];case 4:throw p.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:d=p.sent(),c=d[0],f=d[1],p.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:f,userDefinedMetadata:l,generatedBy:a,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return de(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,f,d;return pe(this,function(p){switch(p.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(h){var m=h.lastIndexOf("/"),g=h.lastIndexOf("?"),v=h.substring(0,m),y=g>m?h.substring(g):"";return[v+"/",y]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return f=[],t.forEach(function(h){h.paths.forEach(function(m){f.push(a+m+i)})}),[4,CE(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return d=p.sent(),[2,[s,Yg(d)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Wv(e){return e.match(EE.URL_SCHEME_REGEX)!=null}var Ob=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return Wv(n)}):Wv(e))?Uv(e,{onProgress:t}):null};function Uv(e,t){return new EE(e,t)}Hn.registerSaveRouter(Ob),Hn.registerLoadRouter(Ob);var Yp=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return de(this,void 0,void 0,function(){return pe(this,function(t){return[2,this.modelArtifacts]})})},e}(),dB=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return de(this,void 0,void 0,function(){return pe(this,function(n){return[2,this.saveHandler(t)]})})},e}(),_E=Object.freeze({browserFiles:function(e){return new fB(e)},browserHTTPRequest:function(e,t){return Uv(e,t)},concatenateArrayBuffers:Yg,decodeWeights:bE,encodeWeights:function(e,t){return de(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return pe(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),i=function(l){var c=o[l],f=Array.isArray(e)?e[l].tensor:e[c];if(f.dtype!=="float32"&&f.dtype!=="int32"&&f.dtype!=="bool"&&f.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+f.dtype);var d={name:c,shape:f.shape,dtype:f.dtype};if(f.dtype==="string"){var p=new Promise(function(h){return de(s,void 0,void 0,function(){var m,g,v,y,b,x,w;return pe(this,function(S){switch(S.label){case 0:return[4,f.bytes()];case 1:for(m=S.sent(),g=m.reduce(function(E,C){return E+C.length},0)+lf*m.length,v=new Uint8Array(g),y=0,b=0;b<m.length;b++)x=m[b],w=new Uint8Array(new Uint32Array([x.length]).buffer),v.set(w,y),y+=lf,v.set(x,y),y+=x.length;return h(v),[2]}})})});r.push(p)}else r.push(f.data());t!=null&&(d.group=t),n.push(d)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:eB(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new Yp(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Yp({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Yp({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Hn.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Qu,getSaveHandlers:function(e){return Hn.getSaveHandlers(e)},http:Uv,isHTTPScheme:Wv,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),de(this,void 0,void 0,function(){return pe(this,function(o){return[2,Ib(function(i){return CE(i,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return Hn.registerLoadRouter(e)},registerSaveRouter:function(e){return Hn.registerSaveRouter(e)},weightsLoaderFactory:Ib,withSaveHandler:function(e){return new dB(e)},copyModel:function(e,t){return de(this,void 0,void 0,function(){return pe(this,function(n){return[2,Eb(e,t,!1)]})})},listModels:function(){return de(this,void 0,void 0,function(){var e,t,n,r,o,i,a;return pe(this,function(s){switch(s.label){case 0:e=ni.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,ni.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())t[o+$a+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return de(this,void 0,void 0,function(){return pe(this,function(n){return[2,Eb(e,t,!0)]})})},removeModel:function(e){return de(this,void 0,void 0,function(){var t;return pe(this,function(n){return t=ic(e),[2,ni.getManager(t.scheme).removeModel(t.path)]})})}}),ia;F({confusionMatrix_:function(e,t,n){var r=R(e,"labels","confusionMatrix"),o=R(t,"predictions","confusionMatrix");I(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),I(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),I(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),I(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),I(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=Av(r.asType("int32"),n),a=Av(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var pB=F({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(XS("FromPixels",V.backendName)!=null)return V.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],f=l[1];if(a?s=e.getContext("2d").getImageData(0,0,c,f).data:r||n?s=e.data:(i||o)&&(ia==null&&(ia=document.createElement("canvas").getContext("2d")),ia.canvas.width=c,ia.canvas.height=f,ia.drawImage(e,0,0,c,f),s=ia.getImageData(0,0,c,f).data),t===4)u=new Int32Array(s);else{var d=c*f;u=new Int32Array(d*t);for(var p=0;p<d;p++)for(var h=0;h<t;++h)u[p*t+h]=s[4*p+h]}return _g(u,[f,c,t],"int32")}}),Qg=Object.freeze({toPixels:function(e,t){return de(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,f,d,p,h,m,g,v,y,b,x,w,S,E,C;return pe(this,function(k){switch(k.label){case 0:if(n=R(e,"img","toPixels"),e instanceof ct||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=k.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=k.sent(),f=c[0],d=c[1],p=f[0],h=d[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(p<0||h>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+p+" - "+h+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(p<0||h>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+p+" - "+h+"].")}for(m=n.dtype==="float32"?255:1,g=new Uint8ClampedArray(i*o*4),v=0;v<o*i;++v)y=void 0,b=void 0,x=void 0,w=void 0,a===1?(y=s[v]*m,b=s[v]*m,x=s[v]*m,w=255):a===3?(y=s[3*v]*m,b=s[3*v+1]*m,x=s[3*v+2]*m,w=255):a===4&&(y=s[4*v]*m,b=s[4*v+1]*m,x=s[4*v+2]*m,w=s[4*v+3]*m),g[(S=4*v)+0]=Math.round(y),g[S+1]=Math.round(b),g[S+2]=Math.round(x),g[S+3]=Math.round(w);return t!=null&&(t.width=i,t.height=o,E=t.getContext("2d"),C=new ImageData(g,i,o),E.putImageData(C,0,0)),n!==e&&n.dispose(),[2,g]}})})},fromPixels:pB}),hB=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),vB=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Zi(e){I(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),I(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),I(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),vB.register(e)}var ea=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Tr(t,e),t.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var u=o.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return Tn(s),r?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return _3(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&Tn(this.iterations_)},t.prototype.saveIterations=function(){return de(this,void 0,void 0,function(){return pe(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ae(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return pe(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return pe(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return de(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},t}(hB);Object.defineProperty(ea,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var mB=function(e){function t(n,r,o){o===void 0&&(o=null);var i=e.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=V.backend.epsilon()),i}return Tr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=V.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:ue(function(){return $e(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:ue(function(){return $e(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable,l=r.accumulatedUpdates[i].variable;ue(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),f=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),d=l.mul(r.rho).add(f.square().mul(1-r.rho));u.assign(c),l.assign(d);var p=f.mul(-r.learningRate).add(a);a.assign(p)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Tn(this.accumulatedGrads.map(function(n){return n.variable})),Tn(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){var n;return pe(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(ea);Zi(mB);var gB=function(e){function t(n,r){r===void 0&&(r=.1);var o=e.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return Tr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=V.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:ue(function(){return Yr(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable;ue(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(V.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Tn(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return pe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(ea);Zi(gB);var yB=function(e){function t(n,r,o,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],ue(function(){a.accBeta1=ae(r).variable(),a.accBeta2=ae(o).variable()}),i==null&&(a.epsilon=V.backend.epsilon()),a}return Tr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);ue(function(){var i=Mt(1,r.accBeta1),a=Mt(1,r.accBeta2);o.forEach(function(s,u){var l=V.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ue(function(){return $e(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:ue(function(){return $e(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedSecondMoment[u].variable,p=f.mul(r.beta1).add(c.mul(1-r.beta1)),h=d.mul(r.beta2).add(c.square().mul(1-r.beta2)),m=p.div(i),g=h.div(a);f.assign(p),d.assign(h);var v=m.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Tn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&Tn(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){var n;return pe(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){var r,o=this;return pe(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),ue(function(){o.accBeta1.assign(sf(o.beta1,o.iterations_+1)),o.accBeta2.assign(sf(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(ea);Zi(yB);var bB=function(e){function t(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],ue(function(){s.iteration=ae(0).variable(),s.accBeta1=ae(r).variable()}),i==null&&(s.epsilon=V.backend.epsilon()),s}return Tr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);ue(function(){var i=Mt(1,r.accBeta1),a=wr(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var l=V.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:$e(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:$e(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedWeightedInfNorm[u].variable,p=f.mul(r.beta1).add(c.mul(1-r.beta1)),h=d.mul(r.beta2),m=c.abs(),g=h.maximum(m);f.assign(p),d.assign(g);var v=a.div(i).mul(p.div(g.add(r.epsilon))).add(l);l.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Tn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&Tn(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return pe(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return pe(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(ea);Zi(bB);var kE=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return Tr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=V.registeredVariables[o];ue(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=jA(ae(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return pe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(ea);Zi(kE);var xB=function(e){function t(n,r,o){o===void 0&&(o=!1);var i=e.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=ae(i.momentum),i}return Tr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=V.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:ue(function(){return $e(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[o];u!=null&&ue(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Tn(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){return pe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){return pe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(kE);Zi(xB);var wB=function(e){function t(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=V.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return Tr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=V.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:ue(function(){return $e(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:ue(function(){return $e(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:ue(function(){return $e(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[i].variable,l=r.accumulatedMoments[i].variable;ue(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var f=r.accumulatedMeanGrads[i].variable,d=f.mul(r.decay).add(s.mul(1-r.decay)),p=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(d.square().add(r.epsilon)).sqrt()));u.assign(c),f.assign(d),l.assign(p);var h=a.sub(p);a.assign(h)}else{var m=u.mul(r.decay).add(s.square().mul(1-r.decay));p=l.mul(r.momentum).add(s.mul(r.learningRate).div(m.add(r.epsilon).sqrt())),u.assign(m),l.assign(p),h=a.sub(p),a.assign(h)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Tn(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Tn(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&Tn(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return de(this,void 0,void 0,function(){var n;return pe(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return de(this,void 0,void 0,function(){var r;return pe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(ea);Zi(wB);ct.prototype.squaredDifference=function(e){return VC(this,e)},H=qL;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var zv=function(e,t){return zv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},zv(e,t)};function Oe(e,t){zv(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var ln=function(){return ln=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ln.apply(this,arguments)};function xe(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(f){a(f)}}function u(c){try{l(r.throw(c))}catch(f){a(f)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(e,[])).next())})}function we(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],o=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function eu(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var Ni=function(){function e(t,n){if(!Ai(t)||!Ai(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function kd(e,t){return e instanceof ct&&e.shape.length===t}function SB(e){return kd(e,2)}function Rd(e){return kd(e,3)}function ri(e){return kd(e,4)}function CB(e){return e%1!==0}function Tb(e){return e%2===0}function EB(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function Db(e){return e&&e.width&&e.height}function _B(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new Ni(Math.round(n*o),Math.round(r*o))}function Jg(e){return e.reduce(function(t,n){return t.add(n)},new Ge(0,0)).div(new Ge(e.length,e.length))}function Iu(e,t,n){return Array(e).fill(0).map(function(r,o){return t+o*n})}function Ai(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function Nb(e){return Ai(e)&&0<=e&&e<=1}var Ge=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),li=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(Ai),i=[r.x,r.y,r.width,r.height].every(Ai);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],l=a[2],c=a[3];e.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(Ai)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new Ge(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new Ge(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new Ge(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new Ge(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,i=t.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:n,y:r,width:o,height:i})},e.prototype.rescale=function(t){var n=Db(t)?t.width:t,r=Db(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new e({x:o,y:i,width:a,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),l=Math.max(i,0),c=a-u,f=s-l,d=Math.min(c,t-u),p=Math.min(f,n-l);return new e({x:u,y:l,width:d,height:p}).floor()},e.prototype.shift=function(t,n){var r=this,o=r.width,i=r.height,a=this.x+t,s=this.y+n;return new e({x:a,y:s,width:o,height:i})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,u=o,l=this.left,c=this.top,f=this.right,d=this.bottom;return f>n&&(s=-f+n+r,f=n),d>t&&(u=-d+t+o,d=t),l<1&&(u=2-l,l=1),c<1&&(u=2-c,c=1),{dy:a,edy:u,dx:i,edx:s,y:c,ey:d,x:l,ex:f,w:r,h:o}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Pd=function(e){Oe(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return t}(li),RE=function(){function e(t,n,r,o,i){this._imageDims=new Ni(i.width,i.height),this._score=t,this._classScore=n,this._className=r,this._box=new li(o).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new li(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Nr=function(e){Oe(t,e);function t(n,r,o){return e.call(this,n,n,"",r,o)||this}return t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new t(i,a,s)},t}(RE);function kB(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),o=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*o;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function RB(e){var t=e.map(function(s){return s.x}),n=e.map(function(s){return s.y}),r=t.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),i=t.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new Pd(r,o,i,a)}function Ou(e,t,n,r){r===void 0&&(r=!0);for(var o=t.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,l=[],c=0;c<u.length;c++){var f=u[c],d=e[s],p=e[f];l.push(kB(d,p,r))}o=o.filter(function(h,m){return l[m]<=n})};o.length>0;)a();return i}function Ju(e,t){return ue(function(){var n=t[0],r=t[1],o=t[2],i=Yr(eu(e.shape.slice(0,3),[1]),n),a=Yr(eu(e.shape.slice(0,3),[1]),r),s=Yr(eu(e.shape.slice(0,3),[1]),o),u=Dt([i,a,s],3);return Mt(e,u)})}function PB(e,t){return t===void 0&&(t=!1),ue(function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(t?.5:1)),s=r>o?2:1,u=function(p){var h=e.shape.slice();return h[s]=p,Yr(h,0)},l=u(a),c=i-l.shape[s],f=t&&c?u(c):null,d=[f,e,l].filter(function(p){return!!p}).map(function(p){return p.toFloat()});return Dt(d,s)})}function Qp(e){return 1/(1+Math.exp(-e))}var Zg=function(e){Oe(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{x:n,y:r,width:o,height:i},a)||this}return t}(li),IB=.5,OB=.43,TB=.45,Tu=function(){function e(t,n,r){r===void 0&&(r=new Ge(0,0));var o=n.width,i=n.height;this._imgDims=new Ni(o,i),this._shift=r,this._positions=t.map(function(a){return a.mul(new Ge(o,i)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new Ge(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new Ge(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new Ge(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof Nr?t.box.floor():new li(t);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],o=t[2],i=function(f){return o.sub(f).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/TB),u=Jg(t),l=Math.floor(Math.max(0,u.x-IB*s)),c=Math.floor(Math.max(0,u.y-OB*s));return new Zg(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))},e.prototype.alignMinBbox=function(t){var n=RB(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),DB=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],Jg([n[3],n[4]])]},t}(Tu),NB=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Jg)},t}(Tu),Ab=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+EB(this.distance)+")":"")},e}(),Mb=function(e){Oe(t,e);function t(n,r){var o=e.call(this,n)||this;return o._label=r,o}return t.assertIsValidLabeledBox=function(n,r){if(li.assertIsValidBox(n,r),!Ai(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(li),Nl=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){Oe(t,e);function t(n,r,o,i){var a=e.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return t.assertIsValidPredictedBox=function(n,r){if(Mb.assertIsValidLabeledBox(n,r),!Nb(n.score)||!Nb(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(Mb);function PE(e){return e.detection instanceof Nr}function Du(e,t){var n={detection:t};return Object.assign({},e,n)}function IE(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function OE(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(o,i){e.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function TE(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=OE();return ln({Canvas:e||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:t||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function DE(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function NE(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var Pt;function AB(){if(!Pt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Pt}function Hv(e){Pt=e}function ey(){DE()&&Hv(IE()),NE()&&Hv(TE())}function MB(e){if(Pt||ey(),!Pt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?Pt.Canvas:t,r=e.Image,o=r===void 0?Pt.Image:r;Pt.Canvas=n,Pt.Image=o,Pt.createCanvasElement=e.createCanvasElement||function(){return new n},Pt.createImageElement=e.createImageElement||function(){return new o},Pt.ImageData=e.ImageData||Pt.ImageData,Pt.Video=e.Video||Pt.Video,Pt.fetch=e.fetch||Pt.fetch,Pt.readFile=e.readFile||Pt.readFile}var vn={getEnv:AB,setEnv:Hv,initialize:ey,createBrowserEnv:IE,createFileSystem:OE,createNodejsEnv:TE,monkeyPatch:MB,isBrowser:DE,isNodejs:NE};ey();function AE(e){return!vn.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function Hi(e){var t=vn.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var o=AE(e);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Fb;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(Fb||(Fb={}));function ME(e){var t=vn.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function FB(e){return new Promise(function(t,n){if(e instanceof vn.getEnv().Canvas||ME(e))return t();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),t(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}e.addEventListener("load",r),e.addEventListener("error",o)})}function ty(e){var t=vn.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new Ni(e.naturalWidth,e.naturalHeight):e instanceof r?new Ni(e.videoWidth,e.videoHeight):new Ni(e.width,e.height)}function Id(e){var t=e.width,n=e.height,r=vn.getEnv().createCanvasElement,o=r();return o.width=t,o.height=n,o}function ny(e,t){var n=vn.getEnv().ImageData;if(!(e instanceof n)&&!ME(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=ty(e),o=r.width,i=r.height,a=Id({width:o,height:i});return e instanceof n?Hi(a).putImageData(e,0,0):Hi(a).drawImage(e,0,0,o,i),a}function LB(e,t){return xe(this,void 0,void 0,function(){var n,r,o,i,a,s;return we(this,function(u){switch(u.label){case 0:return n=vn.getEnv().createCanvasElement(),r=e.shape.slice(ri(e)?1:0),o=r[0],i=r[1],a=r[2],s=ue(function(){return e.as3D(o,i,a).toInt()}),[4,Qg.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function Lb(e){var t=vn.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}function BB(e,t,n){n===void 0&&(n=!1);var r=vn.getEnv(),o=r.Image,i=r.Canvas;if(!(e instanceof o||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=ty(e),s=t/Math.max(a.height,a.width),u=s*a.width,l=s*a.height,c=Id({width:t,height:t}),f=e instanceof i?e:ny(e),d=Math.abs(u-l)/2,p=n&&u<l?d:0,h=n&&l<u?d:0;return Hi(c).drawImage(f,p,h,u,l),c}var cf=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(o,i){if(Rd(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(ri(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof vn.getEnv().Canvas?o:ny(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return Iu(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return _B({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,ue(function(){var o=Iu(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof ct){var u=ri(s)?s:s.expandDims();return u=PB(u,n),(u.shape[1]!==t||u.shape[2]!==t)&&(u=Hg.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(s instanceof vn.getEnv().Canvas)return Qg.fromPixels(BB(s,t,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=Kn(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,t,t,3);return i})},e}();function Vt(e){return xe(this,void 0,void 0,function(){var t,n,r;return we(this,function(o){switch(o.label){case 0:if(e instanceof cf)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(e)?" at input index "+i+":":""},r=t.map(AE),r.forEach(function(i,a){if(!Lb(i)&&!Rd(i)&&!ri(i))throw typeof t[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+t[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(ri(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return Lb(i)&&FB(i)}))];case 1:return o.sent(),[2,new cf(r,Array.isArray(e))]}})})}function ry(e,t){return xe(this,void 0,void 0,function(){var n,r,o,i,a,s,u;return we(this,function(l){switch(l.label){case 0:return n=vn.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,Vt(e)];case 1:if(o=l.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,LB(i)];case 3:a=l.sent(),l.label=4;case 4:r=a,l.label=5;case 5:return s=Hi(r),u=t.map(function(c){return c instanceof Nr?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(c){var f=c.x,d=c.y,p=c.width,h=c.height,m=Id({width:p,height:h});return Hi(m).putImageData(s.getImageData(f,d,p,h),0,0),m})]}})})}function oy(e,t){return xe(this,void 0,void 0,function(){return we(this,function(n){if(!Rd(e)&&!ri(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(ri(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,ue(function(){var r=e.shape.slice(ri(e)?1:0),o=r[0],i=r[1],a=r[2],s=t.map(function(l){return l instanceof Nr?l.forSize(i,o).box:l}).map(function(l){return l.clipAtImageBorders(i,o)}),u=s.map(function(l){var c=l.x,f=l.y,d=l.width,p=l.height;return uE(e.as3D(o,i,a),[f,c,0],[p,d,a])});return u})]})})}function jB(e,t){return xe(this,void 0,void 0,function(){var n,r;return we(this,function(o){switch(o.label){case 0:return n=vn.getEnv().fetch,[4,n(e,t)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function $B(e){return xe(this,void 0,void 0,function(){return we(this,function(t){switch(t.label){case 0:return[4,jB(e)];case 1:return[2,t.sent().json()]}})})}function FE(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var o=e.split("/").filter(function(s){return s}),i=e.endsWith(".json")?o[o.length-1]:n,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=e.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function VB(e,t){return xe(this,void 0,void 0,function(){var n,r,o,i;return we(this,function(a){switch(a.label){case 0:return n=FE(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,$B(r)];case 1:return i=a.sent(),[2,_E.loadWeights(i,o)]}})})}function WB(e,t,n){n===void 0&&(n=!1);var r=n?ty(t):t,o=r.width,i=r.height;return e.width=o,e.height=i,{width:o,height:i}}var Co=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;return r[o]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof ns})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof ns)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;t.reassignParamFromPath(r,o.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=Xt(o.dataSync());o.dispose(),t.reassignParamFromPath(r,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return xe(this,void 0,void 0,function(){return we(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return xe(this,void 0,void 0,function(){var n;return we(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,VB(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return xe(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,f;return we(this,function(d){switch(d.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=vn.getEnv().readFile,r=FE(t,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(p){return Promise.all(p.map(function(h){return n(h).then(function(m){return m.buffer})}))},s=_E.weightsLoaderFactory(a),c=(l=JSON).parse,[4,n(o)];case 1:return u=c.apply(l,[d.sent().toString()]),[4,s(u,i)];case 2:return f=d.sent(),this.loadFromWeightMap(f),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+t);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof ct))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:o}},e}();function Gn(e,t,n){return ue(function(){var r=$g(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Fe(r,t.bias),r})}function Jp(e,t,n){return n===void 0&&(n=!1),ue(function(){var r=ft(n?Fe(dr(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Gn(e,t.conv0,[2,2])),o=Gn(r,t.conv1,[1,1]),i=ft(Fe(r,o)),a=Gn(i,t.conv2,[1,1]);return ft(Fe(r,Fe(o,a)))})}function Al(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),ue(function(){var o=ft(n?Fe(dr(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Gn(e,t.conv0,r?[2,2]:[1,1])),i=Gn(o,t.conv1,[1,1]),a=ft(Fe(o,i)),s=Gn(a,t.conv2,[1,1]),u=ft(Fe(o,Fe(i,s))),l=Gn(u,t.conv3,[1,1]);return ft(Fe(o,Fe(i,Fe(s,l))))})}function Rr(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),ue(function(){var o=Fe(dr(e,t.filters,[1,1],n),t.bias);return r?ft(o):o})}function Eo(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function Od(e,t){return function(n,r,o,i){var a=Cn(e(n*r*o*o),[o,o,n,r]),s=_t(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function iy(e,t){return function(n,r,o){var i=ti(e(n*r),[n,r]),a=_t(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var LE=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function ay(e,t){return function(n,r,o){var i=Cn(e(9*n),[3,3,n,1]),a=Cn(e(n*r),[1,1,n,r]),s=_t(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new LE(i,a,s)}}function sy(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new LE(n,r,o)}}function vi(e,t){return function(n,r,o){var i=e[n];if(!kd(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:o||n}),i}}function _o(e){var t=e;function n(o){var i=t.slice(0,o);return t=t.slice(o),i}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function BE(e,t){var n=Od(e,t),r=ay(e,t);function o(a,s,u,l){l===void 0&&(l=!1);var c=l?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),f=r(s,s,u+"/conv1"),d=r(s,s,u+"/conv2");return{conv0:c,conv1:f,conv2:d}}function i(a,s,u,l){l===void 0&&(l=!1);var c=o(a,s,u,l),f=c.conv0,d=c.conv1,p=c.conv2,h=r(s,s,u+"/conv3");return{conv0:f,conv1:d,conv2:p,conv3:h}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function UB(e){var t=[],n=_o(e),r=n.extractWeights,o=n.getRemainingWeights,i=BE(r,t).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:l}}}function jE(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function $E(e,t){var n=vi(e,t),r=jE(n),o=sy(n);function i(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),f=o(s+"/conv2");return{conv0:l,conv1:c,conv2:f}}function a(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),f=o(s+"/conv2"),d=o(s+"/conv3");return{conv0:l,conv1:c,conv2:f,conv3:d}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function zB(e){var t=[],n=$E(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Eo(e,t),{params:r,paramMappings:t}}var VE=function(e){Oe(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return ue(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=Ju(o,i).div(ae(255)),s=Al(a,r.dense0,!0);return s=Al(s,r.dense1),s=Al(s,r.dense2),s=Al(s,r.dense3),s=Yu(s,[7,7],[2,2],"valid"),s})},t.prototype.forward=function(n){return xe(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Vt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return zB(n)},t.prototype.extractParams=function(n){return UB(n)},t}(Co);function zr(e,t){return ue(function(){return Fe(Cd(e,t.weights),t.bias)})}function HB(e,t,n){var r=[],o=_o(e),i=o.extractWeights,a=o.getRemainingWeights,s=iy(i,r),u=s(t,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function GB(e){var t=[],n=vi(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return Eo(e,t),{params:o,paramMappings:t}}function WE(e){var t={},n={};return Object.keys(e).forEach(function(r){var o=r.startsWith("fc")?n:t;o[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var UE=function(e){Oe(t,e);function t(n,r){var o=e.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ue(function(){var i=n instanceof cf?r.faceFeatureExtractor.forwardInput(n):n;return zr(i.as2D(i.shape[0],-1),o.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return HB(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=WE(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),GB(i)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},t}(Co),Bb=["neutral","happy","sad","angry","fearful","disgusted","surprised"],qB=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);Bb.forEach(function(r,o){n[r]=t[o]})}return e.prototype.asSortedArray=function(){var t=this;return Bb.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),KB=function(e){Oe(t,e);function t(n){return n===void 0&&(n=new VE),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return ue(function(){return wo(r.runNet(n))})},t.prototype.forward=function(n){return xe(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Vt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictExpressions=function(n){return xe(this,void 0,void 0,function(){var r,o,i,a,s=this;return we(this,function(u){switch(u.label){case 0:return[4,Vt(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(Nt(o).map(function(l){return xe(s,void 0,void 0,function(){var c;return we(this,function(f){switch(f.label){case 0:return[4,l.data()];case 1:return c=f.sent(),l.dispose(),[2,c]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(l){return new qB(l)}),[2,r.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(UE);function zE(e,t){var n={expressions:t};return Object.assign({},e,n)}function HE(e){return PE(e)&&e.landmarks instanceof Tu&&e.unshiftedLandmarks instanceof Tu&&e.alignedRect instanceof Nr}function Td(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),i=e.detection.imageDims,a=new Nr(e.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:t,alignedRect:a};return Object.assign({},e,s)}function XB(e,t){var n=Od(e,t),r=ay(e,t);function o(a,s,u){var l=r(a,s,u+"/separable_conv0"),c=r(s,s,u+"/separable_conv1"),f=n(a,s,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:c,expansion_conv:f}}function i(a,s){var u=r(a,a,s+"/separable_conv0"),l=r(a,a,s+"/separable_conv1"),c=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function YB(e,t){var n=[],r=_o(e),o=r.extractWeights,i=r.getRemainingWeights,a=XB(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,l=a.extractReductionBlockParams,c=a.extractMainBlockParams,f=s(3,32,3,"entry_flow/conv_in"),d=l(32,64,"entry_flow/reduction_block_0"),p=l(64,128,"entry_flow/reduction_block_1"),h={conv_in:f,reduction_block_0:d,reduction_block_1:p},m={};Iu(t,0,1).forEach(function(b){m["main_block_"+b]=c(128,"middle_flow/main_block_"+b)});var g=l(128,256,"exit_flow/reduction_block"),v=u(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:v};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:h,middle_flow:m,exit_flow:y}}}function QB(e,t){var n=vi(e,t),r=jE(n),o=sy(n);function i(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:c}}function a(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function JB(e,t){var n=[],r=QB(e,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),l=a("entry_flow/reduction_block_0"),c=a("entry_flow/reduction_block_1"),f={conv_in:u,reduction_block_0:l,reduction_block_1:c},d={};Iu(t,0,1).forEach(function(g){d["main_block_"+g]=s("middle_flow/main_block_"+g)});var p=a("exit_flow/reduction_block"),h=i("exit_flow/separable_conv"),m={reduction_block:p,separable_conv:h};return Eo(e,n),{params:{entry_flow:f,middle_flow:d,exit_flow:m},paramMappings:n}}function GE(e,t,n){return Fe(dr(e,t.filters,n,"same"),t.bias)}function Zp(e,t,n){n===void 0&&(n=!0);var r=n?ft(e):e;return r=Gn(r,t.separable_conv0,[1,1]),r=Gn(ft(r),t.separable_conv1,[1,1]),r=Lt(r,[3,3],[2,2],"same"),r=Fe(r,GE(e,t.expansion_conv,[2,2])),r}function ZB(e,t){var n=Gn(ft(e),t.separable_conv0,[1,1]);return n=Gn(ft(n),t.separable_conv1,[1,1]),n=Gn(ft(n),t.separable_conv2,[1,1]),n=Fe(n,e),n}var ej=function(e){Oe(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return ue(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=Ju(i,a).div(ae(256)),u=ft(GE(s,o.entry_flow.conv_in,[2,2]));return u=Zp(u,o.entry_flow.reduction_block_0,!1),u=Zp(u,o.entry_flow.reduction_block_1),Iu(r._numMainBlocks,0,1).forEach(function(l){u=ZB(u,o.middle_flow["main_block_"+l])}),u=Zp(u,o.exit_flow.reduction_block),u=ft(Gn(u,o.exit_flow.separable_conv,[1,1])),u})},t.prototype.forward=function(n){return xe(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Vt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return JB(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return YB(n,this._numMainBlocks)},t}(Co);function tj(e){var t=[],n=_o(e),r=n.extractWeights,o=n.getRemainingWeights,i=iy(r,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}function nj(e){var t=[],n=vi(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Eo(e,t),{params:o,paramMappings:t}}var ff;(function(e){e.FEMALE="female",e.MALE="male"})(ff||(ff={}));var rj=function(e){Oe(t,e);function t(n){n===void 0&&(n=new ej(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ue(function(){var i=n instanceof cf?r.faceFeatureExtractor.forwardInput(n):n,a=Yu(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=zr(a,o.fc.age).as1D(),u=zr(a,o.fc.gender);return{age:s,gender:u}})},t.prototype.forwardInput=function(n){var r=this;return ue(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:wo(a)}})},t.prototype.forward=function(n){return xe(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Vt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return xe(this,void 0,void 0,function(){var r,o,i,a,s,u,l=this;return we(this,function(c){switch(c.label){case 0:return[4,Vt(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),i=Nt(o.age),a=Nt(o.gender),s=i.map(function(f,d){return{ageTensor:f,genderTensor:a[d]}}),[4,Promise.all(s.map(function(f){var d=f.ageTensor,p=f.genderTensor;return xe(l,void 0,void 0,function(){var h,m,g,v,y;return we(this,function(b){switch(b.label){case 0:return[4,d.data()];case 1:return h=b.sent()[0],[4,p.data()];case 2:return m=b.sent()[0],g=m>.5,v=g?ff.MALE:ff.FEMALE,y=g?m:1-m,d.dispose(),p.dispose(),[2,{age:h,gender:v,genderProbability:y}]}})})}))];case 3:return u=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return tj(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=WE(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),nj(i)},t.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(Co),qE=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var u=s.width,l=s.height,c=r/Math.max(l,u);return{width:u*c,height:l*c}}),a=i.length;return ue(function(){var s=function(d,p){return Kn([Yr([68],d),Yr([68],p)],1).as2D(1,136).as1D()},u=function(d,p){var h=i[d],m=h.width,g=h.height;return p(m,g)?Math.abs(m-g)/2:0},l=function(d){return u(d,function(p,h){return p<h})},c=function(d){return u(d,function(p,h){return h<p})},f=n.mul(Yr([a,136],r)).sub(Kn(Array.from(Array(a),function(d,p){return s(l(p),c(p))}))).div(Kn(Array.from(Array(a),function(d,p){return s(i[p].width,i[p].height)})));return f})},t.prototype.forwardInput=function(n){var r=this;return ue(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},t.prototype.forward=function(n){return xe(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Vt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.detectLandmarks=function(n){return xe(this,void 0,void 0,function(){var r,o,i,a=this;return we(this,function(s){switch(s.label){case 0:return[4,Vt(n)];case 1:return r=s.sent(),o=ue(function(){return Nt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,l){return xe(a,void 0,void 0,function(){var c,f,d,p,h;return we(this,function(m){switch(m.label){case 0:return d=(f=Array).from,[4,u.data()];case 1:return c=d.apply(f,[m.sent()]),p=c.filter(function(g,v){return Tb(v)}),h=c.filter(function(g,v){return!Tb(v)}),[2,new NB(Array(68).fill(0).map(function(g,v){return new Ge(p[v],h[v])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(UE),KE=function(e){Oe(t,e);function t(n){return n===void 0&&(n=new VE),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(qE);function oj(e){var t=[],n=$E(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Eo(e,t),{params:r,paramMappings:t}}function ij(e){var t=[],n=_o(e),r=n.extractWeights,o=n.getRemainingWeights,i=BE(r,t).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}var aj=function(e){Oe(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return ue(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=Ju(o,i).div(ae(255)),s=Jp(a,r.dense0,!0);return s=Jp(s,r.dense1),s=Jp(s,r.dense2),s=Yu(s,[14,14],[2,2],"valid"),s})},t.prototype.forward=function(n){return xe(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Vt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return oj(n)},t.prototype.extractParams=function(n){return ij(n)},t}(Co),sj=function(e){Oe(t,e);function t(n){return n===void 0&&(n=new aj),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(qE);(function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(KE);function uj(e,t){return Fe(dn(e,t.weights),t.biases)}function uy(e,t,n,r,o){o===void 0&&(o="same");var i=t.conv,a=i.filters,s=i.bias,u=dr(e,a,n,o);return u=Fe(u,s),u=uj(u,t.scale),r?ft(u):u}function lj(e,t){return uy(e,t,[1,1],!0)}function XE(e,t){return uy(e,t,[1,1],!1)}function YE(e,t){return uy(e,t,[2,2],!0,"valid")}function cj(e,t){function n(s,u,l){var c=e(s),f=c.length/(u*l*l);if(CB(f))throw new Error("depth has to be an integer: "+f+", weights.length: "+c.length+", numFilters: "+u+", filterSize: "+l);return ue(function(){return ui(Cn(c,[u,f,l,l]),[2,3,1,0])})}function r(s,u,l,c){var f=n(s,u,l),d=_t(e(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:f,bias:d}}function o(s,u){var l=_t(e(s)),c=_t(e(s));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:c}}function i(s,u,l,c){var f=r(s,u,l,c+"/conv"),d=o(u,c+"/scale");return{conv:f,scale:d}}function a(s,u,l,c,f){f===void 0&&(f=!1);var d=i((f?.5:1)*s,u,l,c+"/conv1"),p=i(s,u,l,c+"/conv2");return{conv1:d,conv2:p}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function fj(e){var t=_o(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=cj(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),f=s(9216,32,3,"conv32_3"),d=s(36864,64,3,"conv64_down",!0),p=s(36864,64,3,"conv64_1"),h=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),x=s(589824,256,3,"conv256_1"),w=s(589824,256,3,"conv256_2"),S=s(589824,256,3,"conv256_down_out"),E=ue(function(){return ui(ti(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var C={conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:f,conv64_down:d,conv64_1:p,conv64_2:h,conv64_3:m,conv128_down:g,conv128_1:v,conv128_2:y,conv256_down:b,conv256_1:x,conv256_2:w,conv256_down_out:S,fc:E};return{params:C,paramMappings:o}}function dj(e,t){var n=vi(e,t);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function o(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),l=r(a);return{conv:{filters:s,bias:u},scale:l}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function pj(e){var t=[],n=dj(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),f=o("conv64_2"),d=o("conv64_3"),p=o("conv128_down"),h=o("conv128_1"),m=o("conv128_2"),g=o("conv256_down"),v=o("conv256_1"),y=o("conv256_2"),b=o("conv256_down_out"),x=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!SB(x))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+x);var w={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:f,conv64_3:d,conv128_down:p,conv128_1:h,conv128_2:m,conv256_down:g,conv256_1:v,conv256_2:y,conv256_down_out:b,fc:x};return Eo(e,t),{params:w,paramMappings:t}}function Mr(e,t){var n=lj(e,t.conv1);return n=XE(n,t.conv2),n=Fe(n,e),n=ft(n),n}function Ml(e,t){var n=YE(e,t.conv1);n=XE(n,t.conv2);var r=Yu(e,2,2,"valid"),o=rt(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=eu(n.shape);s[1]=1;var u=rt(s);n=Dt([n,u],1);var l=eu(n.shape);l[2]=1;var c=rt(l);n=Dt([n,c],2)}return r=i?Dt([r,o],3):r,n=Fe(r,n),n=ft(n),n}var hj=function(e){Oe(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return ue(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=Ju(o,i).div(ae(256)),s=YE(a,r.conv32_down);s=Lt(s,3,2,"valid"),s=Mr(s,r.conv32_1),s=Mr(s,r.conv32_2),s=Mr(s,r.conv32_3),s=Ml(s,r.conv64_down),s=Mr(s,r.conv64_1),s=Mr(s,r.conv64_2),s=Mr(s,r.conv64_3),s=Ml(s,r.conv128_down),s=Mr(s,r.conv128_1),s=Mr(s,r.conv128_2),s=Ml(s,r.conv256_down),s=Mr(s,r.conv256_1),s=Mr(s,r.conv256_2),s=Ml(s,r.conv256_down_out);var u=s.mean([1,2]),l=Cd(u,r.fc);return l})},t.prototype.forward=function(n){return xe(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Vt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return xe(this,void 0,void 0,function(){var r,o,i,a=this;return we(this,function(s){switch(s.label){case 0:return[4,Vt(n)];case 1:return r=s.sent(),o=ue(function(){return Nt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return pj(n)},t.prototype.extractParams=function(n){return fj(n)},t}(Co);function QE(e,t){var n={descriptor:t};return Object.assign({},e,n)}function JE(e,t){var n={age:t};return Object.assign({},e,n)}function ZE(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var e_=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function vj(e,t){function n(u,l){var c=Cn(e(9*u),[3,3,u,1]),f=_t(e(u)),d=_t(e(u)),p=_t(e(u)),h=_t(e(u));return t.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:c,batch_norm_scale:f,batch_norm_offset:d,batch_norm_mean:p,batch_norm_variance:h}}function r(u,l,c,f,d){var p=Cn(e(u*l*c*c),[c,c,u,l]),h=_t(e(l));return t.push({paramPath:f+"/filters"},{paramPath:f+"/"+(d?"batch_norm_offset":"bias")}),{filters:p,bias:h}}function o(u,l,c,f){var d=r(u,l,c,f,!0),p=d.filters,h=d.bias;return{filters:p,batch_norm_offset:h}}function i(u,l,c){var f=n(u,c+"/depthwise_conv"),d=o(u,l,1,c+"/pointwise_conv");return{depthwise_conv:f,pointwise_conv:d}}function a(){var u=o(3,32,3,"mobilenetv1/conv_0"),l=i(32,64,"mobilenetv1/conv_1"),c=i(64,128,"mobilenetv1/conv_2"),f=i(128,128,"mobilenetv1/conv_3"),d=i(128,256,"mobilenetv1/conv_4"),p=i(256,256,"mobilenetv1/conv_5"),h=i(256,512,"mobilenetv1/conv_6"),m=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),v=i(512,512,"mobilenetv1/conv_9"),y=i(512,512,"mobilenetv1/conv_10"),b=i(512,512,"mobilenetv1/conv_11"),x=i(512,1024,"mobilenetv1/conv_12"),w=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:c,conv_3:f,conv_4:d,conv_5:p,conv_6:h,conv_7:m,conv_8:g,conv_9:v,conv_10:y,conv_11:b,conv_12:x,conv_13:w}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),l=o(256,512,3,"prediction_layer/conv_1"),c=o(512,128,1,"prediction_layer/conv_2"),f=o(128,256,3,"prediction_layer/conv_3"),d=o(256,128,1,"prediction_layer/conv_4"),p=o(128,256,3,"prediction_layer/conv_5"),h=o(256,64,1,"prediction_layer/conv_6"),m=o(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),v=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),b=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),x=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),w=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),S=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),E=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),C=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),k=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),_=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),T=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),D={box_encoding_predictor:g,class_predictor:v},U={box_encoding_predictor:y,class_predictor:b},j={box_encoding_predictor:x,class_predictor:w},A={box_encoding_predictor:S,class_predictor:E},M={box_encoding_predictor:C,class_predictor:k},$={box_encoding_predictor:_,class_predictor:T};return{conv_0:u,conv_1:l,conv_2:c,conv_3:f,conv_4:d,conv_5:p,conv_6:h,conv_7:m,box_predictor_0:D,box_predictor_1:U,box_predictor_2:j,box_predictor_3:A,box_predictor_4:M,box_predictor_5:$}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function mj(e){var t=[],n=_o(e),r=n.extractWeights,o=n.getRemainingWeights,i=vj(r,t),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),l=s(),c=_g(r(5118*4),[1,5118,4]),f={extra_dim:c};if(t.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:f},paramMappings:t}}function gj(e,t){var n=vi(e,t);function r(l,c,f){var d=n(l+"/Conv2d_"+c+"_pointwise/weights",4,f+"/filters"),p=n(l+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,f+"/batch_norm_offset");return{filters:d,batch_norm_offset:p}}function o(l){var c="mobilenetv1/conv_"+l,f="MobilenetV1/Conv2d_"+l+"_depthwise",d=c+"/depthwise_conv",p=c+"/pointwise_conv",h=n(f+"/depthwise_weights",4,d+"/filters"),m=n(f+"/BatchNorm/gamma",1,d+"/batch_norm_scale"),g=n(f+"/BatchNorm/beta",1,d+"/batch_norm_offset"),v=n(f+"/BatchNorm/moving_mean",1,d+"/batch_norm_mean"),y=n(f+"/BatchNorm/moving_variance",1,d+"/batch_norm_variance");return{depthwise_conv:{filters:h,batch_norm_scale:m,batch_norm_offset:g,batch_norm_mean:v,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",l,p)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(l,c){var f=n(l+"/weights",4,c+"/filters"),d=n(l+"/biases",1,c+"/bias");return{filters:f,bias:d}}function s(l){var c=a("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),f=a("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:c,class_predictor:f}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function yj(e){var t=[],n=gj(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Rd(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return Eo(e,t),{params:a,paramMappings:t}}function Lr(e,t,n){return ue(function(){var r=dr(e,t.filters,n,"same");return r=Fe(r,t.batch_norm_offset),Fg(r,0,6)})}var bj=.0010000000474974513;function xj(e,t,n){return ue(function(){var r=Sd(e,t.filters,n,"same");return r=qC(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,bj),Fg(r,0,6)})}function wj(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function Sj(e,t){return ue(function(){var n=null,r=Lr(e,t.conv_0,[2,2]),o=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(o.forEach(function(i,a){var s=a+1,u=wj(s);r=xj(r,i.depthwise_conv,u),r=Lr(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function Cj(e,t,n,r,o){var i=e.shape[0],a=Math.min(n,i),s=t.map(function(c,f){return{score:c,boxIndex:f}}).filter(function(c){return c.score>o}).sort(function(c,f){return f.score-c.score}),u=function(c){return c<=r?1:0},l=[];return s.forEach(function(c){if(!(l.length>=a)){for(var f=c.score,d=l.length-1;d>=0;--d){var p=Ej(e,c.boxIndex,l[d]);if(p!==0&&(c.score*=u(p),c.score<=o))break}f===c.score&&l.push(c.boxIndex)}}),l}function Ej(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),f=Math.max(r[n][1],r[n][3]),d=(a-o)*(s-i),p=(c-u)*(f-l);if(d<=0||p<=0)return 0;var h=Math.max(o,u),m=Math.max(i,l),g=Math.min(a,c),v=Math.min(s,f),y=Math.max(g-h,0)*Math.max(v-m,0);return y/(d+p-y)}function _j(e){var t=Nt(ui(e,[1,0])),n=[Mt(t[2],t[0]),Mt(t[3],t[1])],r=[Fe(t[0],wr(n[0],ae(2))),Fe(t[1],wr(n[1],ae(2)))];return{sizes:n,centers:r}}function kj(e,t){var n=_j(e),r=n.sizes,o=n.centers,i=Nt(ui(t,[1,0])),a=wr(dn(Bv(wr(i[2],ae(5))),r[0]),ae(2)),s=Fe(dn(wr(i[0],ae(10)),r[0]),o[0]),u=wr(dn(Bv(wr(i[3],ae(5))),r[1]),ae(2)),l=Fe(dn(wr(i[1],ae(10)),r[1]),o[1]);return ui(Kn([Mt(s,a),Mt(l,u),Fe(s,a),Fe(l,u)]),[1,0])}function Rj(e,t,n){return ue(function(){var r=e.shape[0],o=kj(Cr(Ba(n.extra_dim,[r,1,1]),[-1,4]),Cr(e,[-1,4]));o=Cr(o,[r,o.shape[0]/r,4]);var i=UC(Jr(t,[0,0,1],[-1,-1,-1])),a=Jr(i,[0,0,0],[-1,-1,1]);a=Cr(a,[r,a.shape[1]]);var s=Nt(o),u=Nt(a);return{boxes:s,scores:u}})}function aa(e,t){return ue(function(){var n=e.shape[0],r=Cr(Rr(e,t.box_encoding_predictor),[n,-1,1,4]),o=Cr(Rr(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function Pj(e,t,n){return ue(function(){var r=Lr(e,n.conv_0,[1,1]),o=Lr(r,n.conv_1,[2,2]),i=Lr(o,n.conv_2,[1,1]),a=Lr(i,n.conv_3,[2,2]),s=Lr(a,n.conv_4,[1,1]),u=Lr(s,n.conv_5,[2,2]),l=Lr(u,n.conv_6,[1,1]),c=Lr(l,n.conv_7,[2,2]),f=aa(t,n.box_predictor_0),d=aa(e,n.box_predictor_1),p=aa(o,n.box_predictor_2),h=aa(a,n.box_predictor_3),m=aa(u,n.box_predictor_4),g=aa(c,n.box_predictor_5),v=Dt([f.boxPredictionEncoding,d.boxPredictionEncoding,p.boxPredictionEncoding,h.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),y=Dt([f.classPrediction,d.classPrediction,p.classPrediction,h.classPrediction,m.classPrediction,g.classPrediction],1);return{boxPredictions:v,classPredictions:y}})}var Dd=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),t_=function(e){Oe(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return ue(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=Mt(dn(o,ae(.007843137718737125)),ae(1)),a=Sj(i,r.mobilenetv1),s=Pj(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,l=s.classPredictions;return Rj(u,l,r.output_layer)})},t.prototype.forward=function(n){return xe(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Vt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),xe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,f,d,p,h,m,g,v,y,b,x,w,S,E,C;return we(this,function(k){switch(k.label){case 0:return o=new Dd(r),i=o.maxResults,a=o.minConfidence,[4,Vt(n)];case 1:for(s=k.sent(),u=this.forwardInput(s),l=u.boxes,c=u.scores,f=l[0],d=c[0],p=1;p<l.length;p++)l[p].dispose(),c[p].dispose();return g=(m=Array).from,[4,d.data()];case 2:return h=g.apply(m,[k.sent()]),v=.5,y=Cj(f,h,i,v,a),b=s.getReshapedInputDimensions(0),x=s.inputSize,w=x/b.width,S=x/b.height,E=f.arraySync(),C=y.map(function(_){var T=[Math.max(0,E[_][0]),Math.min(1,E[_][2])].map(function($){return $*S}),D=T[0],U=T[1],j=[Math.max(0,E[_][1]),Math.min(1,E[_][3])].map(function($){return $*w}),A=j[0],M=j[1];return new Nr(h[_],new Zg(A,D,M-A,U-D),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),f.dispose(),d.dispose(),[2,C]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return yj(n)},t.prototype.extractParams=function(n){return mj(n)},t}(Co);(function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(t_);var Ij=.4,Oj=[new Ge(.738768,.874946),new Ge(2.42204,2.65704),new Ge(4.30971,7.04493),new Ge(10.246,4.59428),new Ge(12.6868,11.8741)],Tj=[new Ge(1.603231,2.094468),new Ge(6.041143,7.080126),new Ge(2.882459,3.518061),new Ge(4.266906,5.178857),new Ge(9.041765,10.66308)],Dj=[117.001,114.697,97.404],Nj="tiny_yolov2_model",Aj="tiny_yolov2_separable_conv_model",Fl=function(e){return typeof e=="number"};function Mj(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!Fl(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return Fl(t.x)&&Fl(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(Fl)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function ly(e){return ue(function(){var t=dn(e,ae(.10000000149011612));return Fe(ft(Mt(e,t)),t)})}function Io(e,t){return ue(function(){var n=Qi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=dr(n,t.conv.filters,[1,1],"valid"),n=Mt(n,t.bn.sub),n=dn(n,t.bn.truediv),n=Fe(n,t.conv.bias),ly(n)})}function Oo(e,t){return ue(function(){var n=Qi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=$g(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Fe(n,t.bias),ly(n)})}function Fj(e,t){var n=Od(e,t);function r(a,s){var u=_t(e(a)),l=_t(e(a));return t.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:l}}function o(a,s,u){var l=n(a,s,3,u+"/conv"),c=r(s,u+"/bn");return{conv:l,bn:c}}var i=ay(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function Lj(e,t,n,r){var o=_o(e),i=o.extractWeights,a=o.getRemainingWeights,s=[],u=Fj(i,s),l=u.extractConvParams,c=u.extractConvWithBatchNormParams,f=u.extractSeparableConvParams,d;if(t.withSeparableConvs){var p=r[0],h=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],x=r[7],w=r[8],S=t.isFirstLayerConv2d?l(p,h,3,"conv0"):f(p,h,"conv0"),E=f(h,m,"conv1"),C=f(m,g,"conv2"),k=f(g,v,"conv3"),_=f(v,y,"conv4"),T=f(y,b,"conv5"),D=x?f(b,x,"conv6"):void 0,U=w?f(x,w,"conv7"):void 0,j=l(w||x||b,5*n,1,"conv8");d={conv0:S,conv1:E,conv2:C,conv3:k,conv4:_,conv5:T,conv6:D,conv7:U,conv8:j}}else{var p=r[0],h=r[1],m=r[2],g=r[3],v=r[4],y=r[5],b=r[6],x=r[7],w=r[8],S=c(p,h,"conv0"),E=c(h,m,"conv1"),C=c(m,g,"conv2"),k=c(g,v,"conv3"),_=c(v,y,"conv4"),T=c(y,b,"conv5"),D=c(b,x,"conv6"),U=c(x,w,"conv7"),j=l(w,5*n,1,"conv8");d={conv0:S,conv1:E,conv2:C,conv3:k,conv4:_,conv5:T,conv6:D,conv7:U,conv8:j}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:d,paramMappings:s}}function Bj(e,t){var n=vi(e,t);function r(s){var u=n(s+"/sub",1),l=n(s+"/truediv",1);return{sub:u,truediv:l}}function o(s){var u=n(s+"/filters",4),l=n(s+"/bias",1);return{filters:u,bias:l}}function i(s){var u=o(s+"/conv"),l=r(s+"/bn");return{conv:u,bn:l}}var a=sy(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function jj(e,t){var n=[],r=Bj(e,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return Eo(e,n),{params:s,paramMappings:n}}var jb;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(jb||(jb={}));var cy=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),n_=function(e){Oe(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return Mj(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var o=Io(n,r.conv0);return o=Lt(o,[2,2],[2,2],"same"),o=Io(o,r.conv1),o=Lt(o,[2,2],[2,2],"same"),o=Io(o,r.conv2),o=Lt(o,[2,2],[2,2],"same"),o=Io(o,r.conv3),o=Lt(o,[2,2],[2,2],"same"),o=Io(o,r.conv4),o=Lt(o,[2,2],[2,2],"same"),o=Io(o,r.conv5),o=Lt(o,[2,2],[1,1],"same"),o=Io(o,r.conv6),o=Io(o,r.conv7),Rr(o,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?ly(Rr(n,r.conv0,"valid",!1)):Oo(n,r.conv0);return o=Lt(o,[2,2],[2,2],"same"),o=Oo(o,r.conv1),o=Lt(o,[2,2],[2,2],"same"),o=Oo(o,r.conv2),o=Lt(o,[2,2],[2,2],"same"),o=Oo(o,r.conv3),o=Lt(o,[2,2],[2,2],"same"),o=Oo(o,r.conv4),o=Lt(o,[2,2],[2,2],"same"),o=Oo(o,r.conv5),o=Lt(o,[2,2],[1,1],"same"),o=r.conv6?Oo(o,r.conv6):o,o=r.conv7?Oo(o,r.conv7):o,Rr(o,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return ue(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?Ju(a,o.config.meanRgb):a,a=a.div(ae(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},t.prototype.forward=function(n,r){return xe(this,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Vt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),xe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,f,d,p,h,m,g,v,y=this;return we(this,function(b){switch(b.label){case 0:return o=new cy(r),i=o.inputSize,a=o.scoreThreshold,[4,Vt(n)];case 1:return s=b.sent(),[4,this.forwardInput(s,i)];case 2:return u=b.sent(),l=ue(function(){return Nt(u)[0].expandDims()}),c={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(l,s.getReshapedInputDimensions(0),a)];case 3:return f=b.sent(),u.dispose(),l.dispose(),d=f.map(function(x){return x.box}),p=f.map(function(x){return x.score}),h=f.map(function(x){return x.classScore}),m=f.map(function(x){return y.config.classes[x.label]}),g=Ou(d.map(function(x){return x.rescale(i)}),p,this.config.iouThreshold,!0),v=g.map(function(x){return new RE(p[x],h[x],m[x],d[x],c)}),[2,v]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return jj(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return Lj(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,o){return xe(this,void 0,void 0,function(){var i,a,s,u,l,c,f,d,p,h,m,g,v,y,b,x,w,S,E,C,k,_,T,D,U,j,A,M,$,O=this;return we(this,function(L){switch(L.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,l=s/a,c=n.shape[1],f=this.config.anchors.length,d=ue(function(){var B=n.reshape([c,c,f,O.boxEncodingSize]),G=B.slice([0,0,0,0],[c,c,f,4]),q=B.slice([0,0,0,4],[c,c,f,1]),J=O.withClassScores?wo(B.slice([0,0,0,5],[c,c,f,O.config.classes.length]),3):ae(0);return[G,q,J]}),p=d[0],h=d[1],m=d[2],g=[],[4,h.array()];case 1:return v=L.sent(),[4,p.array()];case 2:y=L.sent(),b=0,L.label=3;case 3:if(!(b<c))return[3,12];x=0,L.label=4;case 4:if(!(x<c))return[3,11];w=0,L.label=5;case 5:return w<f?(S=Qp(v[b][x][w][0]),!o||S>o?(E=(x+Qp(y[b][x][w][0]))/c*u,C=(b+Qp(y[b][x][w][1]))/c*l,k=Math.exp(y[b][x][w][2])*this.config.anchors[w].x/c*u,_=Math.exp(y[b][x][w][3])*this.config.anchors[w].y/c*l,T=E-k/2,D=C-_/2,U={row:b,col:x,anchor:w},this.withClassScores?[4,this.extractPredictedClass(m,U)]:[3,7]):[3,9]):[3,10];case 6:return $=L.sent(),[3,8];case 7:$={classScore:1,label:0},L.label=8;case 8:j=$,A=j.classScore,M=j.label,g.push(ln({box:new Pd(T,D,T+k,D+_),score:S,classScore:S*A,label:M},U)),L.label=9;case 9:return w++,[3,5];case 10:return x++,[3,4];case 11:return b++,[3,3];case 12:return p.dispose(),h.dispose(),m.dispose(),[2,g]}})})},t.prototype.extractPredictedClass=function(n,r){return xe(this,void 0,void 0,function(){var o,i,a,s;return we(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,c){return s[o][i][a][c]}).map(function(l,c){return{classScore:l,label:c}}).reduce(function(l,c){return l.classScore>c.classScore?l:c})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Co),$j=function(e){Oe(t,e);function t(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:Ij,classes:["face"]},n?{anchors:Tj,meanRgb:Dj}:{anchors:Oj,withClassScores:!0});return r=e.call(this,o)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return xe(this,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Nr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?Aj:Nj},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(n_),r_=function(e){Oe(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(cy),Zu=function(){function e(){}return e.prototype.then=function(t){return xe(this,void 0,void 0,function(){var n;return we(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return xe(this,void 0,void 0,function(){return we(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Nd(e,t,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),xe(this,void 0,void 0,function(){var i,a,s,u,l;return we(this,function(c){switch(c.label){case 0:return i=e.map(function(f){return HE(f)?o(f):f.detection}),s=r,s?[3,5]:t instanceof ct?[4,oy(t,i)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,ry(t,i)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return a=s,[4,n(a)];case 6:return l=c.sent(),a.forEach(function(f){return f instanceof ct&&f.dispose()}),[2,l]}})})}function fy(e,t,n,r,o){return xe(this,void 0,void 0,function(){var i=this;return we(this,function(a){return[2,Nd([e],t,function(s){return xe(i,void 0,void 0,function(){return we(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function Vj(e){return ue(function(){return Kn(Nt(e,3).reverse(),3)})}var Ll=2,df=12;function Wj(e,t){var n=Od(e,t),r=iy(e,t);function o(l,c){var f=_t(e(l));return t.push({paramPath:c}),f}function i(l,c,f){f===void 0&&(f=!1);var d=n(l[0],l[1],3,c+"/conv1"),p=o(l[1],c+"/prelu1_alpha"),h=n(l[1],l[2],3,c+"/conv2"),m=o(l[2],c+"/prelu2_alpha"),g=n(l[2],l[3],f?2:3,c+"/conv3"),v=o(l[3],c+"/prelu3_alpha");return{conv1:d,prelu1_alpha:p,conv2:h,prelu2_alpha:m,conv3:g,prelu3_alpha:v}}function a(){var l=i([3,10,16,32],"pnet"),c=n(32,2,1,"pnet/conv4_1"),f=n(32,4,1,"pnet/conv4_2");return ln(ln({},l),{conv4_1:c,conv4_2:f})}function s(){var l=i([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),f=o(128,"rnet/prelu4_alpha"),d=r(128,2,"rnet/fc2_1"),p=r(128,4,"rnet/fc2_2");return ln(ln({},l),{fc1:c,prelu4_alpha:f,fc2_1:d,fc2_2:p})}function u(){var l=i([3,32,64,64],"onet"),c=n(64,128,2,"onet/conv4"),f=o(128,"onet/prelu4_alpha"),d=r(1152,256,"onet/fc1"),p=o(256,"onet/prelu5_alpha"),h=r(256,2,"onet/fc2_1"),m=r(256,4,"onet/fc2_2"),g=r(256,10,"onet/fc2_3");return ln(ln({},l),{conv4:c,prelu4_alpha:f,fc1:d,prelu5_alpha:p,fc2_1:h,fc2_2:m,fc2_3:g})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function Uj(e){var t=_o(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=Wj(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,l=a(),c=s(),f=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:f},paramMappings:o}}function zj(e,t){var n=vi(e,t);function r(c){var f=n(c+"/weights",4,c+"/filters"),d=n(c+"/bias",1);return{filters:f,bias:d}}function o(c){var f=n(c+"/weights",2),d=n(c+"/bias",1);return{weights:f,bias:d}}function i(c){return n(c,1)}function a(c){var f=r(c+"/conv1"),d=i(c+"/prelu1_alpha"),p=r(c+"/conv2"),h=i(c+"/prelu2_alpha"),m=r(c+"/conv3"),g=i(c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:d,conv2:p,prelu2_alpha:h,conv3:m,prelu3_alpha:g}}function s(){var c=a("pnet"),f=r("pnet/conv4_1"),d=r("pnet/conv4_2");return ln(ln({},c),{conv4_1:f,conv4_2:d})}function u(){var c=a("rnet"),f=o("rnet/fc1"),d=i("rnet/prelu4_alpha"),p=o("rnet/fc2_1"),h=o("rnet/fc2_2");return ln(ln({},c),{fc1:f,prelu4_alpha:d,fc2_1:p,fc2_2:h})}function l(){var c=a("onet"),f=r("onet/conv4"),d=i("onet/prelu4_alpha"),p=o("onet/fc1"),h=i("onet/prelu5_alpha"),m=o("onet/fc2_1"),g=o("onet/fc2_2"),v=o("onet/fc2_3");return ln(ln({},c),{conv4:f,prelu4_alpha:d,fc1:p,prelu5_alpha:h,fc2_1:m,fc2_2:g,fc2_3:v})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:l}}function Hj(e){var t=[],n=zj(e,t),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return Eo(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function Gv(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function Gj(e,t,n){for(var r=n[0],o=n[1],i=df/e,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(t,u)),s=s*t,u+=1;return a}var dy=function(e){Oe(t,e);function t(n,r,o,i){return e.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return t}(li);function o_(e){return ue(function(){return dn(Mt(e,ae(127.5)),ae(.0078125))})}function Ua(e,t){return ue(function(){return Fe(ft(e),dn(t,af(ft(af(e)))))})}function py(e,t,n){return n===void 0&&(n=!1),ue(function(){var r=Rr(e,t.conv1,"valid");return r=Ua(r,t.prelu1_alpha),r=Lt(r,n?[2,2]:[3,3],[2,2],"same"),r=Rr(r,t.conv2,"valid"),r=Ua(r,t.prelu2_alpha),r=n?r:Lt(r,[3,3],[2,2],"valid"),r=Rr(r,t.conv3,"valid"),r=Ua(r,t.prelu3_alpha),r})}function qj(e,t){return ue(function(){var n=py(e,t,!0),r=Rr(n,t.conv4_1,"valid"),o=rr(Ed(r,3),3),i=wo(Mt(r,o),3),a=Rr(n,t.conv4_2,"valid");return{prob:i,regions:a}})}function Kj(e,t){return ue(function(){var n=Gv(t,e.shape.slice(1)),r=n.height,o=n.width,i=Hg.resizeBilinear(e,[r,o]),a=o_(i);return ui(a,[0,2,1,3])})}function Xj(e,t,n,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new Ge(s,a));var u=o.map(function(l){var c=new Pd(Math.round((l.y*Ll+1)/n),Math.round((l.x*Ll+1)/n),Math.round((l.y*Ll+df)/n),Math.round((l.x*Ll+df)/n)),f=i[l.y][l.x],d=t.arraySync(),p=new dy(d[l.y][l.x][0],d[l.y][l.x][1],d[l.y][l.x][2],d[l.y][l.x][3]);return{cell:c,score:f,region:p}});return u}function Yj(e,t,n,r,o){o.stage1=[];var i=t.map(function(d){return ue(function(){var p={scale:d},h=Kj(e,d),m=Date.now(),g=qj(h,r),v=g.prob,y=g.regions;p.pnet=Date.now()-m;var b=Nt(Nt(v,3)[1])[0],x=Nt(y)[0];return{scoresTensor:b,regionsTensor:x,scale:d,statsForScale:p}})}),a=i.map(function(d){var p=d.scoresTensor,h=d.regionsTensor,m=d.scale,g=d.statsForScale,v=Xj(p,h,m,n);if(p.dispose(),h.dispose(),!v.length)return o.stage1.push(g),[];var y=Date.now(),b=Ou(v.map(function(x){return x.cell}),v.map(function(x){return x.score}),.5);return g.nms=Date.now()-y,g.numBoxes=b.length,o.stage1.push(g),b.map(function(x){return v[x]})}),s=a.reduce(function(d,p){return d.concat(p)},[]),u=[],l=[];if(s.length>0){var c=Date.now(),f=Ou(s.map(function(d){return d.cell}),s.map(function(d){return d.score}),.7);o.stage1_nms=Date.now()-c,l=f.map(function(d){return s[d].score}),u=f.map(function(d){return s[d]}).map(function(d){var p=d.cell,h=d.region;return new Pd(p.left+h.left*p.width,p.top+h.top*p.height,p.right+h.right*p.width,p.bottom+h.bottom*p.height).toSquare().round()})}return{boxes:u,scores:l}}function i_(e,t,n){var r=n.width,o=n.height;return xe(this,void 0,void 0,function(){var i,a,s,u=this;return we(this,function(l){switch(l.label){case 0:return i=Hi(e),[4,Promise.all(t.map(function(c){return xe(u,void 0,void 0,function(){var f,d,p,h,m,g,v,y;return we(this,function(b){return f=c.padAtBorders(e.height,e.width),d=f.y,p=f.ey,h=f.x,m=f.ex,g=h-1,v=d-1,y=i.getImageData(g,v,m-g,p-v),[2,vn.isNodejs()?ny(y):createImageBitmap(y)]})})}))];case 1:return a=l.sent(),s=[],a.forEach(function(c){var f=Id({width:r,height:o}),d=Hi(f);d.drawImage(c,0,0,r,o);for(var p=d.getImageData(0,0,r,o).data,h=[],m=0;m<p.length;m+=4)h.push(p[m+2]),h.push(p[m+1]),h.push(p[m]);s.push(h)}),[2,s.map(function(c){var f=ue(function(){var d=ui(Cn(c,[1,r,o,3]),[0,2,1,3]).toFloat();return o_(d)});return f})]}})})}function Qj(e,t){return ue(function(){var n=py(e,t),r=Cr(n,[n.shape[0],t.fc1.weights.shape[0]]),o=zr(r,t.fc1),i=Ua(o,t.prelu4_alpha),a=zr(i,t.fc2_1),s=rr(Ed(a,1),1),u=wo(Mt(a,s),1),l=zr(i,t.fc2_2),c=Nt(u,1)[1];return{scores:c,regions:l}})}function Jj(e,t,n,r,o){return xe(this,void 0,void 0,function(){var i,a,s,u,l,c,f,d,p,h,m,g,v,y;return we(this,function(b){switch(b.label){case 0:return i=Date.now(),[4,i_(e,t,{width:24,height:24})];case 1:return a=b.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(x){var w=Qj(x,r);return x.dispose(),w}),o.stage2_rnet=Date.now()-i,u=s.length>1?Dt(s.map(function(x){return x.scores})):s[0].scores,f=(c=Array).from,[4,u.data()];case 2:return l=f.apply(c,[b.sent()]),u.dispose(),d=l.map(function(x,w){return{score:x,idx:w}}).filter(function(x){return x.score>n}).map(function(x){var w=x.idx;return w}),p=d.map(function(x){return t[x]}),h=d.map(function(x){return l[x]}),m=[],g=[],p.length>0&&(i=Date.now(),v=Ou(p,h,.7),o.stage2_nms=Date.now()-i,y=v.map(function(x){var w=s[d[x]].regions.arraySync();return new dy(w[0][0],w[0][1],w[0][2],w[0][3])}),g=v.map(function(x){return h[x]}),m=v.map(function(x,w){return p[x].calibrate(y[w])})),s.forEach(function(x){x.regions.dispose(),x.scores.dispose()}),[2,{boxes:m,scores:g}]}})})}function Zj(e,t){return ue(function(){var n=py(e,t);n=Lt(n,[2,2],[2,2],"same"),n=Rr(n,t.conv4,"valid"),n=Ua(n,t.prelu4_alpha);var r=Cr(n,[n.shape[0],t.fc1.weights.shape[0]]),o=zr(r,t.fc1),i=Ua(o,t.prelu5_alpha),a=zr(i,t.fc2_1),s=rr(Ed(a,1),1),u=wo(Mt(a,s),1),l=zr(i,t.fc2_2),c=zr(i,t.fc2_3),f=Nt(u,1)[1];return{scores:f,regions:l,points:c}})}function e$(e,t,n,r,o){return xe(this,void 0,void 0,function(){var i,a,s,u,l,c,f,d,p,h,m,g,v,y,b;return we(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,i_(e,t,{width:48,height:48})];case 1:return a=x.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(w){var S=Zj(w,r);return w.dispose(),S}),o.stage3_onet=Date.now()-i,u=s.length>1?Dt(s.map(function(w){return w.scores})):s[0].scores,f=(c=Array).from,[4,u.data()];case 2:return l=f.apply(c,[x.sent()]),u.dispose(),d=l.map(function(w,S){return{score:w,idx:S}}).filter(function(w){return w.score>n}).map(function(w){var S=w.idx;return S}),p=d.map(function(w){var S=s[w].regions.arraySync();return new dy(S[0][0],S[0][1],S[0][2],S[0][3])}),h=d.map(function(w,S){return t[w].calibrate(p[S])}),m=d.map(function(w){return l[w]}),g=[],v=[],y=[],h.length>0&&(i=Date.now(),b=Ou(h,m,.7,!1),o.stage3_nms=Date.now()-i,g=b.map(function(w){return h[w]}),v=b.map(function(w){return m[w]}),y=b.map(function(w,S){return Array(5).fill(0).map(function(E,C){var k=s[w].points.arraySync();return new Ge(k[0][C]*(g[S].width+1)+g[S].left,k[0][C+5]*(g[S].height+1)+g[S].top)})})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose(),w.points.dispose()}),[2,{boxes:g,scores:v,points:y}]}})})}var t$=function(e){Oe(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return xe(this,void 0,void 0,function(){return we(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return xe(this,void 0,void 0,function(){return we(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),xe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,f,d,p,h,m,g,v,y,b,x,w,S,E,C;return we(this,function(k){switch(k.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=ue(function(){return Vj(rr(Qg.fromPixels(i)).toFloat())}),l=function(_){return u.dispose(),a.total=Date.now()-s,_},c=u.shape.slice(1),f=c[0],d=c[1],p=new e_(r),h=p.minFaceSize,m=p.scaleFactor,g=p.maxNumScales,v=p.scoreThresholds,y=p.scaleSteps,b=(y||Gj(h,m,[f,d])).filter(function(_){var T=Gv(_,[f,d]);return Math.min(T.width,T.height)>df}).slice(0,g),a.scales=b,a.pyramid=b.map(function(_){return Gv(_,[f,d])}),x=Date.now(),[4,Yj(u,b,v[0],o.pnet,a)];case 1:return w=k.sent(),a.total_stage1=Date.now()-x,w.boxes.length?(a.stage2_numInputBoxes=w.boxes.length,x=Date.now(),[4,Jj(i,w.boxes,v[1],o.rnet,a)]):[2,l({results:[],stats:a})];case 2:return S=k.sent(),a.total_stage2=Date.now()-x,S.boxes.length?(a.stage3_numInputBoxes=S.boxes.length,x=Date.now(),[4,e$(i,S.boxes,v[2],o.onet,a)]):[2,l({results:[],stats:a})];case 3:return E=k.sent(),a.total_stage3=Date.now()-x,C=E.boxes.map(function(_,T){return Td(Du({},new Nr(E.scores[T],new Zg(_.left/d,_.top/f,_.width/d,_.height/f),{height:f,width:d})),new DB(E.points[T].map(function(D){return D.sub(new Ge(_.left,_.top)).div(new Ge(_.width,_.height))}),{width:_.width,height:_.height}))}),[2,l({results:C,stats:a})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),xe(this,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Vt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),xe(this,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Vt(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return Hj(n)},t.prototype.extractParams=function(n){return Uj(n)},t}(Co),n$=.4,r$=[new Ge(1.603231,2.094468),new Ge(6.041143,7.080126),new Ge(2.882459,3.518061),new Ge(4.266906,5.178857),new Ge(9.041765,10.66308)],o$=[117.001,114.697,97.404],i$=function(e){Oe(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:n$,classes:["face"],anchors:r$,meanRgb:o$,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return xe(this,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Nr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(n_),Qt={ssdMobilenetv1:new t_,tinyFaceDetector:new i$,tinyYolov2:new $j,mtcnn:new t$,faceLandmark68Net:new KE,faceLandmark68TinyNet:new sj,faceRecognitionNet:new hj,faceExpressionNet:new KB,ageGenderNet:new rj},a_=function(e){Oe(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(Zu),hy=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r,o=this;return we(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Nd(n,this.input,function(a){return xe(o,void 0,void 0,function(){return we(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Qt.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return zE(a,r[s])})]}})})},t.prototype.withAgeAndGender=function(){return new yy(this,this.input)},t}(a_),vy=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r;return we(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,fy(n,this.input,function(i){return Qt.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,zE(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new by(this,this.input)},t}(a_),my=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new xy(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Sy(this,this.input)},t}(hy),gy=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new wy(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Cy(this,this.input)},t}(vy),s_=function(e){Oe(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(Zu),yy=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r,o=this;return we(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Nd(n,this.input,function(a){return xe(o,void 0,void 0,function(){return we(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Qt.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var u=r[s],l=u.age,c=u.gender,f=u.genderProbability;return JE(ZE(a,c,f),l)})]}})})},t.prototype.withFaceExpressions=function(){return new hy(this,this.input)},t}(s_),by=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r,o,i,a;return we(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,fy(n,this.input,function(u){return Qt.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,JE(ZE(n,i,a),o)]}})})},t.prototype.withFaceExpressions=function(){return new vy(this,this.input)},t}(s_),xy=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new my(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Sy(this,this.input)},t}(yy),wy=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new gy(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Cy(this,this.input)},t}(by),u_=function(e){Oe(t,e);function t(n,r){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o}return t}(Zu),Sy=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r;return we(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,Nd(n,this.input,function(i){return Promise.all(i.map(function(a){return Qt.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return QE(n[a],i)})]}})})},t.prototype.withFaceExpressions=function(){return new my(this,this.input)},t.prototype.withAgeAndGender=function(){return new xy(this,this.input)},t}(u_),Cy=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r;return we(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,fy(n,this.input,function(i){return Qt.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,QE(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new gy(this,this.input)},t.prototype.withAgeAndGender=function(){return new wy(this,this.input)},t}(u_),l_=function(e){Oe(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Qt.faceLandmark68TinyNet:Qt.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Zu),a$=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return we(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(l){return l.detection}),this.input instanceof ct?[4,oy(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,ry(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(l){return s.landmarkNet.detectLandmarks(l)}))];case 6:return a=u.sent(),o.forEach(function(l){return l instanceof ct&&l.dispose()}),[2,n.map(function(l,c){return Td(l,a[c])})]}})})},t.prototype.withFaceExpressions=function(){return new my(this,this.input)},t.prototype.withAgeAndGender=function(){return new xy(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Sy(this,this.input)},t}(l_),s$=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r,o,i,a;return we(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof ct?[4,oy(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,ry(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof ct&&u.dispose()}),[2,Td(n,a)]}})})},t.prototype.withFaceExpressions=function(){return new gy(this,this.input)},t.prototype.withAgeAndGender=function(){return new wy(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Cy(this,this.input)},t}(l_),c_=function(e){Oe(t,e);function t(n,r){r===void 0&&(r=new Dd);var o=e.call(this)||this;return o.input=n,o.options=r,o}return t}(Zu),f_=function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r,o,i;return we(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof e_?[4,Qt.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof r_?function(s){return Qt.tinyFaceDetector.locateFaces(s,o)}:o instanceof Dd?function(s){return Qt.ssdMobilenetv1.locateFaces(s,o)}:o instanceof cy?function(s){return Qt.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return xe(n,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return Du({},a)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new a$(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new hy(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new yy(this.runAndExtendWithFaceDetections(),this.input)},t}(c_);(function(e){Oe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return xe(this,void 0,void 0,function(){var n,r;return we(this,function(o){switch(o.label){case 0:return[4,new f_(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return xe(n,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?Du({},o):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new s$(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new vy(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new by(this.runAndExtendWithFaceDetection(),this.input)},t})(c_);function u$(e,t){return t===void 0&&(t=new Dd),new f_(e,t)}function l$(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof Nl)return a;if(a instanceof Float32Array)return new Nl(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new Nl(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return l$(r,t)}).reduce(function(r,o){return r+o},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new Ab(i,n.computeMeanDistance(t,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new Ab("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return Nl.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();function d_(e,t){var n=new Ni(t.width,t.height),r=n.width,o=n.height;if(r<=0||o<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:o}));if(Array.isArray(e))return e.map(function(s){return d_(s,{width:r,height:o})});if(HE(e)){var i=e.detection.forSize(r,o),a=e.unshiftedLandmarks.forSize(i.box.width,i.box.height);return Td(Du(e,i),a)}return PE(e)?Du(e,e.detection.forSize(r,o)):e instanceof Tu||e instanceof Nr?e.forSize(r,o):e}const c$=()=>{const{videoPlaying:e,videoRef:t,updateDetections:n}=GS(),r=N.useRef(null);N.useEffect(()=>{(async()=>{await Promise.all([Qt.tinyFaceDetector.loadFromUri("./models"),Qt.faceLandmark68Net.loadFromUri("./models"),Qt.faceRecognitionNet.loadFromUri("./models"),Qt.faceExpressionNet.loadFromUri("./models"),Qt.ageGenderNet.loadFromUri("./models")])})()},[]);const o=N.useCallback(async()=>{try{const i=await navigator.mediaDevices.getUserMedia({video:!0});t.current&&(t.current.srcObject=i)}catch(i){console.error("Error accessing webcam:",i)}},[t]);return N.useEffect(()=>{e?o():t.current&&t.current.srcObject&&t.current.srcObject.getTracks().forEach(i=>i.stop())},[e,o]),N.useEffect(()=>{const i=setInterval(async()=>{if(t.current&&r.current){const a=t.current,s=r.current,u={width:a.videoWidth,height:a.videoHeight};WB(s,u);const l=await u$(a,new r_).withFaceLandmarks().withFaceExpressions().withAgeAndGender(),c=d_(l,u);s.getContext("2d").clearRect(0,0,s.width,s.height),n(c)}},100);return()=>clearInterval(i)},[e,n]),P.jsxs("div",{className:"bod",children:[P.jsx("video",{ref:t,width:100,height:50,autoPlay:!0,muted:!0,style:{display:e?"block":"none"}}),P.jsx("canvas",{className:"can",ref:r,style:{display:e?"block":"none"}})]})},f$=({onRecognitionStop:e})=>{const{videoPlaying:t,startVideo:n,stopVideo:r,results:o}=GS();return N.useEffect(()=>{!t&&o.length>0&&e(o)},[t,o,e]),P.jsxs("div",{style:{textAlign:"center",marginTop:"20px",color:"white"},children:[t?P.jsx("button",{onClick:()=>{r(),e(o)},children:"Stop"}):P.jsx("button",{onClick:n,children:"Start"}),o.length>0&&P.jsx("hr",{})]})},d$={male:"top_rated",female:"popular"},p$=({sendDetectionF:e})=>{const[t,n]=N.useState("movie"),[r,o]=N.useState("popular"),{data:i,loading:a}=Ir(`/${t}/${r}`),[s,u]=N.useState([]),[l,c]=N.useState("female"),f=p=>{if(u(p),s.length>0){const h=s.reduce((g,v)=>g.confidence>v.confidence?g:v);c(`${h.gender}`);const m=d$[l];o(`${m}`),e(h)}},d=p=>{n(p==="Movies"?"movie":"tv")};return P.jsxs("div",{className:"carouselSection",children:[P.jsxs(hn,{children:[P.jsx("span",{className:"carouselTitle",children:"For You"}),P.jsx(UN,{children:P.jsxs("div",{children:[P.jsx(c$,{}),P.jsx(f$,{onRecognitionStop:f})]})}),P.jsx(md,{data:["Movies","TV Shows"],onTabChange:d})]}),P.jsx(hs,{data:i==null?void 0:i.results,loading:a,endpoint:t})]})},h$=({sendDetection:e})=>{const[t,n]=N.useState([]),r=o=>{n(o),e(t)};return P.jsxs("div",{className:"homePage",children:[P.jsx(IN,{}),P.jsx(p$,{sendDetectionF:r}),P.jsx($N,{}),P.jsx(VN,{}),P.jsx(WN,{})]})},p_=()=>P.jsxs("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"80px",height:"80px",viewBox:"0 0 213.7 213.7",enableBackground:"new 0 0 213.7 213.7",xmlSpace:"preserve",children:[P.jsx("polygon",{className:"triangle",fill:"none",strokeWidth:"7",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"73.5,62.5 148.5,105.8 73.5,149.1 "}),P.jsx("circle",{className:"circle",fill:"none",strokeWidth:"7",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",cx:"106.8",cy:"106.8",r:"103.3"})]}),v$="modulepreload",m$=function(e){return"/devmood/"+e},$b={},g$=function(t,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.all(n.map(s=>{if(s=m$(s),s in $b)return;$b[s]=!0;const u=s.endsWith(".css"),l=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${l}`))return;const c=document.createElement("link");if(c.rel=u?"stylesheet":v$,u||(c.as="script",c.crossOrigin=""),c.href=s,a&&c.setAttribute("nonce",a),document.head.appendChild(c),u)return new Promise((f,d)=>{c.addEventListener("load",f),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})}))}return o.then(()=>t()).catch(i=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i})};var y$=function(t){return b$(t)&&!x$(t)};function b$(e){return!!e&&typeof e=="object"}function x$(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||C$(e)}var w$=typeof Symbol=="function"&&Symbol.for,S$=w$?Symbol.for("react.element"):60103;function C$(e){return e.$$typeof===S$}function E$(e){return Array.isArray(e)?[]:{}}function Nu(e,t){return t.clone!==!1&&t.isMergeableObject(e)?is(E$(e),e,t):e}function _$(e,t,n){return e.concat(t).map(function(r){return Nu(r,n)})}function k$(e,t){if(!t.customMerge)return is;var n=t.customMerge(e);return typeof n=="function"?n:is}function R$(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function Vb(e){return Object.keys(e).concat(R$(e))}function h_(e,t){try{return t in e}catch{return!1}}function P$(e,t){return h_(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function I$(e,t,n){var r={};return n.isMergeableObject(e)&&Vb(e).forEach(function(o){r[o]=Nu(e[o],n)}),Vb(t).forEach(function(o){P$(e,o)||(h_(e,o)&&n.isMergeableObject(t[o])?r[o]=k$(o,n)(e[o],t[o],n):r[o]=Nu(t[o],n))}),r}function is(e,t,n){n=n||{},n.arrayMerge=n.arrayMerge||_$,n.isMergeableObject=n.isMergeableObject||y$,n.cloneUnlessOtherwiseSpecified=Nu;var r=Array.isArray(t),o=Array.isArray(e),i=r===o;return i?r?n.arrayMerge(e,t,n):I$(e,t,n):Nu(t,n)}is.all=function(t,n){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(r,o){return is(r,o,n)},{})};var O$=is,v_=O$,Wb=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function T$(e,t){return!!(e===t||Wb(e)&&Wb(t))}function D$(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!T$(e[n],t[n]))return!1;return!0}function N$(e,t){t===void 0&&(t=D$);var n,r=[],o,i=!1;function a(){for(var s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];return i&&n===this&&t(s,r)||(o=e.apply(this,s),i=!0,n=this,r=s),o}return a}const A$=Object.freeze(Object.defineProperty({__proto__:null,default:N$},Symbol.toStringTag,{value:"Module"})),M$=Wk(A$);var F$=typeof Element<"u",L$=typeof Map=="function",B$=typeof Set=="function",j$=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function ac(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,o;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!ac(e[r],t[r]))return!1;return!0}var i;if(L$&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;for(i=e.entries();!(r=i.next()).done;)if(!ac(r.value[1],t.get(r.value[0])))return!1;return!0}if(B$&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(j$&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[r]))return!1;if(F$&&e instanceof Element)return!1;for(r=n;r--!==0;)if(!((o[r]==="_owner"||o[r]==="__v"||o[r]==="__o")&&e.$$typeof)&&!ac(e[o[r]],t[o[r]]))return!1;return!0}return e!==e&&t!==t}var m_=function(t,n){try{return ac(t,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},g_={exports:{}},$$="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",V$=$$,W$=V$;function y_(){}function b_(){}b_.resetWarningCache=y_;var U$=function(){function e(r,o,i,a,s,u){if(u!==W$){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:b_,resetWarningCache:y_};return n.PropTypes=n,n};g_.exports=U$();var z$=g_.exports,H$=Object.create,Ad=Object.defineProperty,G$=Object.getOwnPropertyDescriptor,q$=Object.getOwnPropertyNames,K$=Object.getPrototypeOf,X$=Object.prototype.hasOwnProperty,Y$=(e,t)=>{for(var n in t)Ad(e,n,{get:t[n],enumerable:!0})},x_=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of q$(t))!X$.call(e,o)&&o!==n&&Ad(e,o,{get:()=>t[o],enumerable:!(r=G$(t,o))||r.enumerable});return e},Q$=(e,t,n)=>(n=e!=null?H$(K$(e)):{},x_(!e||!e.__esModule?Ad(n,"default",{value:e,enumerable:!0}):n,e)),J$=e=>x_(Ad({},"__esModule",{value:!0}),e),w_={};Y$(w_,{defaultProps:()=>t5,propTypes:()=>e5});var S_=J$(w_),Z$=Q$(z$);const{string:zt,bool:gn,number:sa,array:eh,oneOfType:Ds,shape:jn,object:rn,func:Rt,node:Ub}=Z$.default,e5={url:Ds([zt,eh,rn]),playing:gn,loop:gn,controls:gn,volume:sa,muted:gn,playbackRate:sa,width:Ds([zt,sa]),height:Ds([zt,sa]),style:rn,progressInterval:sa,playsinline:gn,pip:gn,stopOnUnmount:gn,light:Ds([gn,zt,rn]),playIcon:Ub,previewTabIndex:sa,previewAriaLabel:zt,fallback:Ub,oEmbedUrl:zt,wrapper:Ds([zt,Rt,jn({render:Rt.isRequired})]),config:jn({soundcloud:jn({options:rn}),youtube:jn({playerVars:rn,embedOptions:rn,onUnstarted:Rt}),facebook:jn({appId:zt,version:zt,playerId:zt,attributes:rn}),dailymotion:jn({params:rn}),vimeo:jn({playerOptions:rn,title:zt}),mux:jn({attributes:rn,version:zt}),file:jn({attributes:rn,tracks:eh,forceVideo:gn,forceAudio:gn,forceHLS:gn,forceSafariHLS:gn,forceDisableHls:gn,forceDASH:gn,forceFLV:gn,hlsOptions:rn,hlsVersion:zt,dashVersion:zt,flvVersion:zt}),wistia:jn({options:rn,playerId:zt,customControls:eh}),mixcloud:jn({options:rn}),twitch:jn({options:rn,playerId:zt}),vidyard:jn({options:rn})}),onReady:Rt,onStart:Rt,onPlay:Rt,onPause:Rt,onBuffer:Rt,onBufferEnd:Rt,onEnded:Rt,onError:Rt,onDuration:Rt,onSeek:Rt,onPlaybackRateChange:Rt,onPlaybackQualityChange:Rt,onProgress:Rt,onClickPreview:Rt,onEnablePIP:Rt,onDisablePIP:Rt},Ht=()=>{},t5={playing:!1,loop:!1,controls:!1,volume:null,muted:!1,playbackRate:1,width:"640px",height:"360px",style:{},progressInterval:1e3,playsinline:!1,pip:!1,stopOnUnmount:!0,light:!1,fallback:null,wrapper:"div",previewTabIndex:0,previewAriaLabel:"",oEmbedUrl:"https://noembed.com/embed?url={url}",config:{soundcloud:{options:{visual:!0,buying:!1,liking:!1,download:!1,sharing:!1,show_comments:!1,show_playcount:!1}},youtube:{playerVars:{playsinline:1,showinfo:0,rel:0,iv_load_policy:3,modestbranding:1},embedOptions:{},onUnstarted:Ht},facebook:{appId:"1309697205772819",version:"v3.3",playerId:null,attributes:{}},dailymotion:{params:{api:1,"endscreen-enable":!1}},vimeo:{playerOptions:{autopause:!1,byline:!1,portrait:!1,title:!1},title:null},mux:{attributes:{},version:"2"},file:{attributes:{},tracks:[],forceVideo:!1,forceAudio:!1,forceHLS:!1,forceDASH:!1,forceFLV:!1,hlsOptions:{},hlsVersion:"1.1.4",dashVersion:"3.1.3",flvVersion:"1.5.0",forceDisableHls:!1},wistia:{options:{},playerId:null,customControls:null},mixcloud:{options:{hide_cover:1}},twitch:{options:{},playerId:null},vidyard:{options:{}}},onReady:Ht,onStart:Ht,onPlay:Ht,onPause:Ht,onBuffer:Ht,onBufferEnd:Ht,onEnded:Ht,onError:Ht,onDuration:Ht,onSeek:Ht,onPlaybackRateChange:Ht,onPlaybackQualityChange:Ht,onProgress:Ht,onClickPreview:Ht,onEnablePIP:Ht,onDisablePIP:Ht};var n5=function(t,n,r){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("script");typeof n=="function"&&(r=n,n={}),n=n||{},r=r||function(){},i.type=n.type||"text/javascript",i.charset=n.charset||"utf8",i.async="async"in n?!!n.async:!0,i.src=t,n.attrs&&r5(i,n.attrs),n.text&&(i.text=""+n.text);var a="onload"in i?zb:o5;a(i,r),i.onload||zb(i,r),o.appendChild(i)};function r5(e,t){for(var n in t)e.setAttribute(n,t[n])}function zb(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function o5(e,t){e.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,t(null,e))}}var i5=Object.create,Md=Object.defineProperty,a5=Object.getOwnPropertyDescriptor,s5=Object.getOwnPropertyNames,u5=Object.getPrototypeOf,l5=Object.prototype.hasOwnProperty,c5=(e,t)=>{for(var n in t)Md(e,n,{get:t[n],enumerable:!0})},C_=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of s5(t))!l5.call(e,o)&&o!==n&&Md(e,o,{get:()=>t[o],enumerable:!(r=a5(t,o))||r.enumerable});return e},Ey=(e,t,n)=>(n=e!=null?i5(u5(e)):{},C_(!e||!e.__esModule?Md(n,"default",{value:e,enumerable:!0}):n,e)),f5=e=>C_(Md({},"__esModule",{value:!0}),e),E_={};c5(E_,{callPlayer:()=>R5,getConfig:()=>_5,getSDK:()=>E5,isBlobUrl:()=>I5,isMediaStream:()=>P5,lazy:()=>v5,omit:()=>k5,parseEndTime:()=>w5,parseStartTime:()=>x5,queryString:()=>C5,randomString:()=>S5,supportsWebKitPresentationMode:()=>O5});var Fd=f5(E_),d5=Ey(N),p5=Ey(n5),h5=Ey(v_);const v5=e=>d5.default.lazy(async()=>{const t=await e();return typeof t.default=="function"?t:t.default}),m5=/[?&#](?:start|t)=([0-9hms]+)/,g5=/[?&#]end=([0-9hms]+)/,qv=/(\d+)(h|m|s)/g,y5=/^\d+$/;function __(e,t){if(e instanceof Array)return;const n=e.match(t);if(n){const r=n[1];if(r.match(qv))return b5(r);if(y5.test(r))return parseInt(r)}}function b5(e){let t=0,n=qv.exec(e);for(;n!==null;){const[,r,o]=n;o==="h"&&(t+=parseInt(r,10)*60*60),o==="m"&&(t+=parseInt(r,10)*60),o==="s"&&(t+=parseInt(r,10)),n=qv.exec(e)}return t}function x5(e){return __(e,m5)}function w5(e){return __(e,g5)}function S5(){return Math.random().toString(36).substr(2,5)}function C5(e){return Object.keys(e).map(t=>`${t}=${e[t]}`).join("&")}function th(e){return window[e]?window[e]:window.exports&&window.exports[e]?window.exports[e]:window.module&&window.module.exports&&window.module.exports[e]?window.module.exports[e]:null}const ua={},E5=function(t,n,r=null,o=()=>!0,i=p5.default){const a=th(n);return a&&o(a)?Promise.resolve(a):new Promise((s,u)=>{if(ua[t]){ua[t].push({resolve:s,reject:u});return}ua[t]=[{resolve:s,reject:u}];const l=c=>{ua[t].forEach(f=>f.resolve(c))};if(r){const c=window[r];window[r]=function(){c&&c(),l(th(n))}}i(t,c=>{c?(ua[t].forEach(f=>f.reject(c)),ua[t]=null):r||l(th(n))})})};function _5(e,t){return(0,h5.default)(t.config,e.config)}function k5(e,...t){const n=[].concat(...t),r={},o=Object.keys(e);for(const i of o)n.indexOf(i)===-1&&(r[i]=e[i]);return r}function R5(e,...t){if(!this.player||!this.player[e]){let n=`ReactPlayer: ${this.constructor.displayName} player could not call %c${e}%c – `;return this.player?this.player[e]||(n+="The method was not available"):n+="The player was not available",console.warn(n,"font-weight: bold",""),null}return this.player[e](...t)}function P5(e){return typeof window<"u"&&typeof window.MediaStream<"u"&&e instanceof window.MediaStream}function I5(e){return/^blob:/.test(e)}function O5(e=document.createElement("video")){const t=/iPhone|iPod/.test(navigator.userAgent)===!1;return e.webkitSupportsPresentationMode&&typeof e.webkitSetPresentationMode=="function"&&t}var T5=Object.create,el=Object.defineProperty,D5=Object.getOwnPropertyDescriptor,N5=Object.getOwnPropertyNames,A5=Object.getPrototypeOf,M5=Object.prototype.hasOwnProperty,F5=(e,t,n)=>t in e?el(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,L5=(e,t)=>{for(var n in t)el(e,n,{get:t[n],enumerable:!0})},k_=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of N5(t))!M5.call(e,o)&&o!==n&&el(e,o,{get:()=>t[o],enumerable:!(r=D5(t,o))||r.enumerable});return e},R_=(e,t,n)=>(n=e!=null?T5(A5(e)):{},k_(!e||!e.__esModule?el(n,"default",{value:e,enumerable:!0}):n,e)),B5=e=>k_(el({},"__esModule",{value:!0}),e),bt=(e,t,n)=>(F5(e,typeof t!="symbol"?t+"":t,n),n),P_={};L5(P_,{default:()=>Ld});var j5=B5(P_),Hb=R_(N),$5=R_(m_),I_=S_,V5=Fd;const W5=5e3;let Ld=class extends Hb.Component{constructor(){super(...arguments),bt(this,"mounted",!1),bt(this,"isReady",!1),bt(this,"isPlaying",!1),bt(this,"isLoading",!0),bt(this,"loadOnReady",null),bt(this,"startOnPlay",!0),bt(this,"seekOnPlay",null),bt(this,"onDurationCalled",!1),bt(this,"handlePlayerMount",t=>{if(this.player){this.progress();return}this.player=t,this.player.load(this.props.url),this.progress()}),bt(this,"getInternalPlayer",t=>this.player?this.player[t]:null),bt(this,"progress",()=>{if(this.props.url&&this.player&&this.isReady){const t=this.getCurrentTime()||0,n=this.getSecondsLoaded(),r=this.getDuration();if(r){const o={playedSeconds:t,played:t/r};n!==null&&(o.loadedSeconds=n,o.loaded=n/r),(o.playedSeconds!==this.prevPlayed||o.loadedSeconds!==this.prevLoaded)&&this.props.onProgress(o),this.prevPlayed=o.playedSeconds,this.prevLoaded=o.loadedSeconds}}this.progressTimeout=setTimeout(this.progress,this.props.progressFrequency||this.props.progressInterval)}),bt(this,"handleReady",()=>{if(!this.mounted)return;this.isReady=!0,this.isLoading=!1;const{onReady:t,playing:n,volume:r,muted:o}=this.props;t(),!o&&r!==null&&this.player.setVolume(r),this.loadOnReady?(this.player.load(this.loadOnReady,!0),this.loadOnReady=null):n&&this.player.play(),this.handleDurationCheck()}),bt(this,"handlePlay",()=>{this.isPlaying=!0,this.isLoading=!1;const{onStart:t,onPlay:n,playbackRate:r}=this.props;this.startOnPlay&&(this.player.setPlaybackRate&&r!==1&&this.player.setPlaybackRate(r),t(),this.startOnPlay=!1),n(),this.seekOnPlay&&(this.seekTo(this.seekOnPlay),this.seekOnPlay=null),this.handleDurationCheck()}),bt(this,"handlePause",t=>{this.isPlaying=!1,this.isLoading||this.props.onPause(t)}),bt(this,"handleEnded",()=>{const{activePlayer:t,loop:n,onEnded:r}=this.props;t.loopOnEnded&&n&&this.seekTo(0),n||(this.isPlaying=!1,r())}),bt(this,"handleError",(...t)=>{this.isLoading=!1,this.props.onError(...t)}),bt(this,"handleDurationCheck",()=>{clearTimeout(this.durationCheckTimeout);const t=this.getDuration();t?this.onDurationCalled||(this.props.onDuration(t),this.onDurationCalled=!0):this.durationCheckTimeout=setTimeout(this.handleDurationCheck,100)}),bt(this,"handleLoaded",()=>{this.isLoading=!1})}componentDidMount(){this.mounted=!0}componentWillUnmount(){clearTimeout(this.progressTimeout),clearTimeout(this.durationCheckTimeout),this.isReady&&this.props.stopOnUnmount&&(this.player.stop(),this.player.disablePIP&&this.player.disablePIP()),this.mounted=!1}componentDidUpdate(t){if(!this.player)return;const{url:n,playing:r,volume:o,muted:i,playbackRate:a,pip:s,loop:u,activePlayer:l,disableDeferredLoading:c}=this.props;if(!(0,$5.default)(t.url,n)){if(this.isLoading&&!l.forceLoad&&!c&&!(0,V5.isMediaStream)(n)){console.warn(`ReactPlayer: the attempt to load ${n} is being deferred until the player has loaded`),this.loadOnReady=n;return}this.isLoading=!0,this.startOnPlay=!0,this.onDurationCalled=!1,this.player.load(n,this.isReady)}!t.playing&&r&&!this.isPlaying&&this.player.play(),t.playing&&!r&&this.isPlaying&&this.player.pause(),!t.pip&&s&&this.player.enablePIP&&this.player.enablePIP(),t.pip&&!s&&this.player.disablePIP&&this.player.disablePIP(),t.volume!==o&&o!==null&&this.player.setVolume(o),t.muted!==i&&(i?this.player.mute():(this.player.unmute(),o!==null&&setTimeout(()=>this.player.setVolume(o)))),t.playbackRate!==a&&this.player.setPlaybackRate&&this.player.setPlaybackRate(a),t.loop!==u&&this.player.setLoop&&this.player.setLoop(u)}getDuration(){return this.isReady?this.player.getDuration():null}getCurrentTime(){return this.isReady?this.player.getCurrentTime():null}getSecondsLoaded(){return this.isReady?this.player.getSecondsLoaded():null}seekTo(t,n,r){if(!this.isReady){t!==0&&(this.seekOnPlay=t,setTimeout(()=>{this.seekOnPlay=null},W5));return}if(n?n==="fraction":t>0&&t<1){const i=this.player.getDuration();if(!i){console.warn("ReactPlayer: could not seek using fraction – duration not yet available");return}this.player.seekTo(i*t,r);return}this.player.seekTo(t,r)}render(){const t=this.props.activePlayer;return t?Hb.default.createElement(t,{...this.props,onMount:this.handlePlayerMount,onReady:this.handleReady,onPlay:this.handlePlay,onPause:this.handlePause,onEnded:this.handleEnded,onLoaded:this.handleLoaded,onError:this.handleError}):null}};bt(Ld,"displayName","Player");bt(Ld,"propTypes",I_.propTypes);bt(Ld,"defaultProps",I_.defaultProps);var U5=Object.create,tl=Object.defineProperty,z5=Object.getOwnPropertyDescriptor,H5=Object.getOwnPropertyNames,G5=Object.getPrototypeOf,q5=Object.prototype.hasOwnProperty,K5=(e,t,n)=>t in e?tl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,X5=(e,t)=>{for(var n in t)tl(e,n,{get:t[n],enumerable:!0})},O_=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of H5(t))!q5.call(e,o)&&o!==n&&tl(e,o,{get:()=>t[o],enumerable:!(r=z5(t,o))||r.enumerable});return e},nl=(e,t,n)=>(n=e!=null?U5(G5(e)):{},O_(!e||!e.__esModule?tl(n,"default",{value:e,enumerable:!0}):n,e)),Y5=e=>O_(tl({},"__esModule",{value:!0}),e),yt=(e,t,n)=>(K5(e,typeof t!="symbol"?t+"":t,n),n),T_={};X5(T_,{createReactPlayer:()=>iV});var Q5=Y5(T_),ma=nl(N),J5=nl(v_),nh=nl(M$),Gb=nl(m_),Ws=S_,D_=Fd,Z5=nl(j5);const eV=(0,D_.lazy)(()=>g$(()=>import("./Preview-CRhXfh2n.js").then(e=>e.P),[])),tV=typeof window<"u"&&window.document&&typeof document<"u",nV=typeof zl<"u"&&zl.window&&zl.window.document,rV=Object.keys(Ws.propTypes),oV=tV||nV?ma.Suspense:()=>null,Ns=[],iV=(e,t)=>{var n;return n=class extends ma.Component{constructor(){super(...arguments),yt(this,"state",{showPreview:!!this.props.light}),yt(this,"references",{wrapper:r=>{this.wrapper=r},player:r=>{this.player=r}}),yt(this,"handleClickPreview",r=>{this.setState({showPreview:!1}),this.props.onClickPreview(r)}),yt(this,"showPreview",()=>{this.setState({showPreview:!0})}),yt(this,"getDuration",()=>this.player?this.player.getDuration():null),yt(this,"getCurrentTime",()=>this.player?this.player.getCurrentTime():null),yt(this,"getSecondsLoaded",()=>this.player?this.player.getSecondsLoaded():null),yt(this,"getInternalPlayer",(r="player")=>this.player?this.player.getInternalPlayer(r):null),yt(this,"seekTo",(r,o,i)=>{if(!this.player)return null;this.player.seekTo(r,o,i)}),yt(this,"handleReady",()=>{this.props.onReady(this)}),yt(this,"getActivePlayer",(0,nh.default)(r=>{for(const o of[...Ns,...e])if(o.canPlay(r))return o;return t||null})),yt(this,"getConfig",(0,nh.default)((r,o)=>{const{config:i}=this.props;return J5.default.all([Ws.defaultProps.config,Ws.defaultProps.config[o]||{},i,i[o]||{}])})),yt(this,"getAttributes",(0,nh.default)(r=>(0,D_.omit)(this.props,rV))),yt(this,"renderActivePlayer",r=>{if(!r)return null;const o=this.getActivePlayer(r);if(!o)return null;const i=this.getConfig(r,o.key);return ma.default.createElement(Z5.default,{...this.props,key:o.key,ref:this.references.player,config:i,activePlayer:o.lazyPlayer||o,onReady:this.handleReady})})}shouldComponentUpdate(r,o){return!(0,Gb.default)(this.props,r)||!(0,Gb.default)(this.state,o)}componentDidUpdate(r){const{light:o}=this.props;!r.light&&o&&this.setState({showPreview:!0}),r.light&&!o&&this.setState({showPreview:!1})}renderPreview(r){if(!r)return null;const{light:o,playIcon:i,previewTabIndex:a,oEmbedUrl:s,previewAriaLabel:u}=this.props;return ma.default.createElement(eV,{url:r,light:o,playIcon:i,previewTabIndex:a,previewAriaLabel:u,oEmbedUrl:s,onClick:this.handleClickPreview})}render(){const{url:r,style:o,width:i,height:a,fallback:s,wrapper:u}=this.props,{showPreview:l}=this.state,c=this.getAttributes(r),f=typeof u=="string"?this.references.wrapper:void 0;return ma.default.createElement(u,{ref:f,style:{...o,width:i,height:a},...c},ma.default.createElement(oV,{fallback:s},l?this.renderPreview(r):this.renderActivePlayer(r)))}},yt(n,"displayName","ReactPlayer"),yt(n,"propTypes",Ws.propTypes),yt(n,"defaultProps",Ws.defaultProps),yt(n,"addCustomPlayer",r=>{Ns.push(r)}),yt(n,"removeCustomPlayers",()=>{Ns.length=0}),yt(n,"canPlay",r=>{for(const o of[...Ns,...e])if(o.canPlay(r))return!0;return!1}),yt(n,"canEnablePIP",r=>{for(const o of[...Ns,...e])if(o.canEnablePIP&&o.canEnablePIP(r))return!0;return!1}),n};var _y=Object.defineProperty,aV=Object.getOwnPropertyDescriptor,sV=Object.getOwnPropertyNames,uV=Object.prototype.hasOwnProperty,lV=(e,t)=>{for(var n in t)_y(e,n,{get:t[n],enumerable:!0})},cV=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of sV(t))!uV.call(e,o)&&o!==n&&_y(e,o,{get:()=>t[o],enumerable:!(r=aV(t,o))||r.enumerable});return e},fV=e=>cV(_y({},"__esModule",{value:!0}),e),N_={};lV(N_,{AUDIO_EXTENSIONS:()=>ky,DASH_EXTENSIONS:()=>q_,FLV_EXTENSIONS:()=>K_,HLS_EXTENSIONS:()=>Py,MATCH_URL_DAILYMOTION:()=>U_,MATCH_URL_FACEBOOK:()=>L_,MATCH_URL_FACEBOOK_WATCH:()=>B_,MATCH_URL_KALTURA:()=>G_,MATCH_URL_MIXCLOUD:()=>z_,MATCH_URL_MUX:()=>F_,MATCH_URL_SOUNDCLOUD:()=>A_,MATCH_URL_STREAMABLE:()=>j_,MATCH_URL_TWITCH_CHANNEL:()=>W_,MATCH_URL_TWITCH_VIDEO:()=>V_,MATCH_URL_VIDYARD:()=>H_,MATCH_URL_VIMEO:()=>M_,MATCH_URL_WISTIA:()=>$_,MATCH_URL_YOUTUBE:()=>Kv,VIDEO_EXTENSIONS:()=>Ry,canPlay:()=>pV});var dV=fV(N_),qb=Fd;const Kv=/(?:youtu\.be\/|youtube(?:-nocookie|education)?\.com\/(?:embed\/|v\/|watch\/|watch\?v=|watch\?.+&v=|shorts\/|live\/))((\w|-){11})|youtube\.com\/playlist\?list=|youtube\.com\/user\//,A_=/(?:soundcloud\.com|snd\.sc)\/[^.]+$/,M_=/vimeo\.com\/(?!progressive_redirect).+/,F_=/stream\.mux\.com\/(?!\w+\.m3u8)(\w+)/,L_=/^https?:\/\/(www\.)?facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/,B_=/^https?:\/\/fb\.watch\/.+$/,j_=/streamable\.com\/([a-z0-9]+)$/,$_=/(?:wistia\.(?:com|net)|wi\.st)\/(?:medias|embed)\/(?:iframe\/)?([^?]+)/,V_=/(?:www\.|go\.)?twitch\.tv\/videos\/(\d+)($|\?)/,W_=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+)($|\?)/,U_=/^(?:(?:https?):)?(?:\/\/)?(?:www\.)?(?:(?:dailymotion\.com(?:\/embed)?\/video)|dai\.ly)\/([a-zA-Z0-9]+)(?:_[\w_-]+)?(?:[\w.#_-]+)?/,z_=/mixcloud\.com\/([^/]+\/[^/]+)/,H_=/vidyard.com\/(?:watch\/)?([a-zA-Z0-9-_]+)/,G_=/^https?:\/\/[a-zA-Z]+\.kaltura.(com|org)\/p\/([0-9]+)\/sp\/([0-9]+)00\/embedIframeJs\/uiconf_id\/([0-9]+)\/partner_id\/([0-9]+)(.*)entry_id.([a-zA-Z0-9-_].*)$/,ky=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,Ry=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,Py=/\.(m3u8)($|\?)/i,q_=/\.(mpd)($|\?)/i,K_=/\.(flv)($|\?)/i,Xv=e=>{if(e instanceof Array){for(const t of e)if(typeof t=="string"&&Xv(t)||Xv(t.src))return!0;return!1}return(0,qb.isMediaStream)(e)||(0,qb.isBlobUrl)(e)?!0:ky.test(e)||Ry.test(e)||Py.test(e)||q_.test(e)||K_.test(e)},pV={youtube:e=>e instanceof Array?e.every(t=>Kv.test(t)):Kv.test(e),soundcloud:e=>A_.test(e)&&!ky.test(e),vimeo:e=>M_.test(e)&&!Ry.test(e)&&!Py.test(e),mux:e=>F_.test(e),facebook:e=>L_.test(e)||B_.test(e),streamable:e=>j_.test(e),wistia:e=>$_.test(e),twitch:e=>V_.test(e)||W_.test(e),dailymotion:e=>U_.test(e),mixcloud:e=>z_.test(e),vidyard:e=>H_.test(e),kaltura:e=>G_.test(e),file:Xv};var hV=Object.create,rl=Object.defineProperty,vV=Object.getOwnPropertyDescriptor,mV=Object.getOwnPropertyNames,gV=Object.getPrototypeOf,yV=Object.prototype.hasOwnProperty,bV=(e,t,n)=>t in e?rl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xV=(e,t)=>{for(var n in t)rl(e,n,{get:t[n],enumerable:!0})},X_=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of mV(t))!yV.call(e,o)&&o!==n&&rl(e,o,{get:()=>t[o],enumerable:!(r=vV(t,o))||r.enumerable});return e},wV=(e,t,n)=>(n=e!=null?hV(gV(e)):{},X_(!e||!e.__esModule?rl(n,"default",{value:e,enumerable:!0}):n,e)),SV=e=>X_(rl({},"__esModule",{value:!0}),e),Ao=(e,t,n)=>(bV(e,typeof t!="symbol"?t+"":t,n),n),Y_={};xV(Y_,{default:()=>Iy});var CV=SV(Y_),rh=wV(N),la=Fd,Q_=dV;const EV="https://www.youtube.com/iframe_api",Kb="YT",_V="onYouTubeIframeAPIReady",Bl=/[?&](?:list|channel)=([a-zA-Z0-9_-]+)/,oh=/user\/([a-zA-Z0-9_-]+)\/?/,kV=/youtube-nocookie\.com/,RV="https://www.youtube-nocookie.com";class Iy extends rh.Component{constructor(){super(...arguments),Ao(this,"callPlayer",la.callPlayer),Ao(this,"parsePlaylist",t=>{if(t instanceof Array)return{listType:"playlist",playlist:t.map(this.getID).join(",")};if(Bl.test(t)){const[,n]=t.match(Bl);return{listType:"playlist",list:n.replace(/^UC/,"UU")}}if(oh.test(t)){const[,n]=t.match(oh);return{listType:"user_uploads",list:n}}return{}}),Ao(this,"onStateChange",t=>{const{data:n}=t,{onPlay:r,onPause:o,onBuffer:i,onBufferEnd:a,onEnded:s,onReady:u,loop:l,config:{playerVars:c,onUnstarted:f}}=this.props,{UNSTARTED:d,PLAYING:p,PAUSED:h,BUFFERING:m,ENDED:g,CUED:v}=window[Kb].PlayerState;if(n===d&&f(),n===p&&(r(),a()),n===h&&o(),n===m&&i(),n===g){const y=!!this.callPlayer("getPlaylist");l&&!y&&(c.start?this.seekTo(c.start):this.play()),s()}n===v&&u()}),Ao(this,"mute",()=>{this.callPlayer("mute")}),Ao(this,"unmute",()=>{this.callPlayer("unMute")}),Ao(this,"ref",t=>{this.container=t})}componentDidMount(){this.props.onMount&&this.props.onMount(this)}getID(t){return!t||t instanceof Array||Bl.test(t)?null:t.match(Q_.MATCH_URL_YOUTUBE)[1]}load(t,n){const{playing:r,muted:o,playsinline:i,controls:a,loop:s,config:u,onError:l}=this.props,{playerVars:c,embedOptions:f}=u,d=this.getID(t);if(n){if(Bl.test(t)||oh.test(t)||t instanceof Array){this.player.loadPlaylist(this.parsePlaylist(t));return}this.player.cueVideoById({videoId:d,startSeconds:(0,la.parseStartTime)(t)||c.start,endSeconds:(0,la.parseEndTime)(t)||c.end});return}(0,la.getSDK)(EV,Kb,_V,p=>p.loaded).then(p=>{this.container&&(this.player=new p.Player(this.container,{width:"100%",height:"100%",videoId:d,playerVars:{autoplay:r?1:0,mute:o?1:0,controls:a?1:0,start:(0,la.parseStartTime)(t),end:(0,la.parseEndTime)(t),origin:window.location.origin,playsinline:i?1:0,...this.parsePlaylist(t),...c},events:{onReady:()=>{s&&this.player.setLoop(!0),this.props.onReady()},onPlaybackRateChange:h=>this.props.onPlaybackRateChange(h.data),onPlaybackQualityChange:h=>this.props.onPlaybackQualityChange(h),onStateChange:this.onStateChange,onError:h=>l(h.data)},host:kV.test(t)?RV:void 0,...f}))},l),f.events&&console.warn("Using `embedOptions.events` will likely break things. Use ReactPlayer’s callback props instead, eg onReady, onPlay, onPause")}play(){this.callPlayer("playVideo")}pause(){this.callPlayer("pauseVideo")}stop(){document.body.contains(this.callPlayer("getIframe"))&&this.callPlayer("stopVideo")}seekTo(t,n=!1){this.callPlayer("seekTo",t),!n&&!this.props.playing&&this.pause()}setVolume(t){this.callPlayer("setVolume",t*100)}setPlaybackRate(t){this.callPlayer("setPlaybackRate",t)}setLoop(t){this.callPlayer("setLoop",t)}getDuration(){return this.callPlayer("getDuration")}getCurrentTime(){return this.callPlayer("getCurrentTime")}getSecondsLoaded(){return this.callPlayer("getVideoLoadedFraction")*this.getDuration()}render(){const{display:t}=this.props,n={width:"100%",height:"100%",display:t};return rh.default.createElement("div",{style:n},rh.default.createElement("div",{ref:this.ref}))}}Ao(Iy,"displayName","YouTube");Ao(Iy,"canPlay",Q_.canPlay.youtube);var PV=Q5.createReactPlayer,Xb=CV.default,IV=PV([{key:"youtube",canPlay:Xb.canPlay,lazyPlayer:Xb}]);const OV=om(IV),J_=({show:e,setShow:t,videoId:n,setVideoId:r})=>{const o=()=>{t(!1),r(null)};return P.jsxs("div",{className:`videoPopup ${e?"visible":""}`,children:[P.jsx("div",{className:"opacityLayer",onClick:o}),P.jsxs("div",{className:"videoPlayer",children:[P.jsx("span",{className:"closeBtn",onClick:o,children:"Close"}),P.jsx(OV,{url:`https://www.youtube.com/watch?v=${n}`,controls:!0,width:"100%",height:"100%"})]})]})},TV=({video:e,crew:t})=>{var m,g,v;const[n,r]=N.useState(!1),[o,i]=N.useState(null),{mediaType:a,id:s}=Uf(),{data:u,loading:l}=Ir(`/${a}/${s}`),{url:c}=Xi(y=>y.home),f=(m=u==null?void 0:u.genres)==null?void 0:m.map(y=>y.id),d=t==null?void 0:t.filter(y=>y.job==="Director"),p=t==null?void 0:t.filter(y=>y.job==="Screenplay"||y.job==="Story"||y.job==="Writer"),h=y=>{const b=Math.floor(y/60),x=y%60;return`${b}h${x>0?` ${x}m`:""}`};return P.jsx("div",{className:"detailsBanner",children:l?P.jsx("div",{className:"detailsBannerSkeleton",children:P.jsxs(hn,{children:[P.jsx("div",{className:"left skeleton"}),P.jsxs("div",{className:"right",children:[P.jsx("div",{className:"row skeleton"}),P.jsx("div",{className:"row skeleton"}),P.jsx("div",{className:"row skeleton"}),P.jsx("div",{className:"row skeleton"}),P.jsx("div",{className:"row skeleton"}),P.jsx("div",{className:"row skeleton"}),P.jsx("div",{className:"row skeleton"})]})]})}):P.jsx(P.Fragment,{children:!!u&&P.jsxs(_n.Fragment,{children:[P.jsx("div",{className:"backdrop-img",children:P.jsx(ei,{src:c.backdrop+u.backdrop_path})}),P.jsx("div",{className:"opacity-layer"}),P.jsxs(hn,{children:[P.jsxs("div",{className:"content",children:[P.jsx("div",{className:"left",children:u.poster_path?P.jsx(ei,{className:"posterImg",src:c.backdrop+u.poster_path}):P.jsx(ei,{className:"posterImg",src:bg})}),P.jsxs("div",{className:"right",children:[P.jsx("div",{className:"title",children:`${u.name||u.title} (${Uc(u==null?void 0:u.release_date).format("YYYY")})`}),P.jsx("div",{className:"subtitle",children:u.tagline}),P.jsx(wg,{data:f}),P.jsxs("div",{className:"row",children:[P.jsx(xg,{rating:u.vote_average.toFixed(1)}),P.jsxs("div",{className:"playbtn",onClick:()=>{r(!0),i(e.key)},children:[P.jsx(p_,{}),P.jsx("span",{className:"text",children:"Watch Trailer"})]})]}),P.jsxs("div",{className:"overview",children:[P.jsx("div",{className:"heading",children:"Overview"}),P.jsx("div",{className:"description",children:u.overview})]}),P.jsxs("div",{className:"info",children:[u.status&&P.jsxs("div",{className:"infoItem",children:[P.jsxs("span",{className:"text bold",children:["Status:"," "]}),P.jsx("span",{className:"text",children:u.status})]}),u.release_date&&P.jsxs("div",{className:"infoItem",children:[P.jsxs("span",{className:"text bold",children:["Release Date:"," "]}),P.jsx("span",{className:"text",children:Uc(u.release_date).format("MMM D, YYYY")})]}),u.runtime&&P.jsxs("div",{className:"infoItem",children:[P.jsxs("span",{className:"text bold",children:["Runtime:"," "]}),P.jsx("span",{className:"text",children:h(u.runtime)})]})]}),(d==null?void 0:d.length)>0&&P.jsxs("div",{className:"info",children:[P.jsxs("span",{className:"text bold",children:["Director:"," "]}),P.jsx("span",{className:"text",children:d==null?void 0:d.map((y,b)=>P.jsxs("span",{children:[y.name,d.length-1!==b&&", "]},b))})]}),(p==null?void 0:p.length)>0&&P.jsxs("div",{className:"info",children:[P.jsxs("span",{className:"text bold",children:["Writer:"," "]}),P.jsx("span",{className:"text",children:p==null?void 0:p.map((y,b)=>P.jsxs("span",{children:[y.name,p.length-1!==b&&", "]},b))})]}),((g=u==null?void 0:u.created_by)==null?void 0:g.length)>0&&P.jsxs("div",{className:"info",children:[P.jsxs("span",{className:"text bold",children:["Creator:"," "]}),P.jsx("span",{className:"text",children:(v=u==null?void 0:u.created_by)==null?void 0:v.map((y,b)=>P.jsxs("span",{children:[y.name,(u==null?void 0:u.created_by.length)-1!==b&&", "]},b))})]})]})]}),P.jsx(J_,{show:n,setShow:r,videoId:o,setVideoId:i})]})]})})})},DV="/devmood/assets/avatar-CTec_ic7.png",NV=({data:e,loading:t})=>{const{url:n}=Xi(o=>o.home),r=()=>P.jsxs("div",{className:"skItem",children:[P.jsx("div",{className:"circle skeleton"}),P.jsx("div",{className:"row skeleton"}),P.jsx("div",{className:"row2 skeleton"})]});return P.jsx("div",{className:"castSection",children:P.jsxs(hn,{children:[P.jsx("div",{className:"sectionHeading",children:"Top Cast"}),t?P.jsxs("div",{className:"castSkeleton",children:[r(),r(),r(),r(),r(),r()]}):P.jsx("div",{className:"listItems",children:e==null?void 0:e.map(o=>{let i=o.profile_path?n.profile+o.profile_path:DV;return P.jsxs("div",{className:"listItem",children:[P.jsx("div",{className:"profileImg",children:P.jsx(ei,{src:i})}),P.jsx("div",{className:"name",children:o.name}),P.jsx("div",{className:"character",children:o.character})]},o.id)})})]})})},AV=({data:e,loading:t})=>{var s;const[n,r]=N.useState(!1),[o,i]=N.useState(null),a=()=>P.jsxs("div",{className:"skItem",children:[P.jsx("div",{className:"thumb skeleton"}),P.jsx("div",{className:"row skeleton"}),P.jsx("div",{className:"row2 skeleton"})]});return P.jsxs("div",{className:"videosSection",children:[P.jsxs(hn,{children:[P.jsx("div",{className:"sectionHeading",children:"Official Videos"}),t?P.jsxs("div",{className:"videoSkeleton",children:[a(),a(),a(),a()]}):P.jsx("div",{className:"videos",children:(s=e==null?void 0:e.results)==null?void 0:s.map(u=>P.jsxs("div",{className:"videoItem",onClick:()=>{i(u.key),r(!0)},children:[P.jsxs("div",{className:"videoThumbnail",children:[P.jsx(ei,{src:`https://img.youtube.com/vi/${u.key}/mqdefault.jpg`}),P.jsx(p_,{})]}),P.jsx("div",{className:"videoTitle",children:u.name})]},u.id))})]}),P.jsx(J_,{show:n,setShow:r,videoId:o,setVideoId:i})]})},MV=({mediaType:e,id:t})=>{const{data:n,loading:r,error:o}=Ir(`/${e}/${t}/similar`),i=e==="tv"?"Similar TV Shows":"Similar Movies";return P.jsx(hs,{title:i,data:n==null?void 0:n.results,loading:r,endpoint:e})},FV=({mediaType:e,id:t})=>{const{data:n,loading:r,error:o}=Ir(`/${e}/${t}/recommendations`);return P.jsx(hs,{title:"Recommendations",data:n==null?void 0:n.results,loading:r,endpoint:e})},LV=()=>{var a;const{mediaType:e,id:t}=Uf(),{data:n,loading:r}=Ir(`/${e}/${t}/videos`),{data:o,loading:i}=Ir(`/${e}/${t}/credits`);return P.jsxs("div",{children:[P.jsx(TV,{video:(a=n==null?void 0:n.results)==null?void 0:a[0],crew:o==null?void 0:o.crew}),P.jsx(NV,{data:o==null?void 0:o.cast,loading:i}),P.jsx(AV,{data:n,loading:r}),P.jsx(MV,{mediaType:e,id:t}),P.jsx(FV,{mediaType:e,id:t})]})};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Yv=function(e,t){return Yv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},Yv(e,t)};function BV(e,t){Yv(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var tu=function(){return tu=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},tu.apply(this,arguments)};function jV(e,t,n,r){var o,i=!1,a=0;function s(){o&&clearTimeout(o)}function u(){s(),i=!0}typeof t!="boolean"&&(r=n,n=t,t=void 0);function l(){var c=this,f=Date.now()-a,d=arguments;if(i)return;function p(){a=Date.now(),n.apply(c,d)}function h(){o=void 0}r&&!o&&p(),s(),r===void 0&&f>e?p():t!==!0&&(o=setTimeout(r?h:p,r===void 0?e-f:e))}return l.cancel=u,l}var za={Pixel:"Pixel",Percent:"Percent"},Yb={unit:za.Percent,value:.8};function Qb(e){return typeof e=="number"?{unit:za.Percent,value:e*100}:typeof e=="string"?e.match(/^(\d*(\.\d+)?)px$/)?{unit:za.Pixel,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:za.Percent,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),Yb):(console.warn("scrollThreshold should be string or number"),Yb)}var Z_=function(e){BV(t,e);function t(n){var r=e.call(this,n)||this;return r.lastScrollTop=0,r.actionTriggered=!1,r.startY=0,r.currentY=0,r.dragging=!1,r.maxPullDownDistance=0,r.getScrollableTarget=function(){return r.props.scrollableTarget instanceof HTMLElement?r.props.scrollableTarget:typeof r.props.scrollableTarget=="string"?document.getElementById(r.props.scrollableTarget):(r.props.scrollableTarget===null&&console.warn(`You are trying to pass scrollableTarget but it is null. This might
        happen because the element may not have been added to DOM yet.
        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.
      `),null)},r.onStart=function(o){r.lastScrollTop||(r.dragging=!0,o instanceof MouseEvent?r.startY=o.pageY:o instanceof TouchEvent&&(r.startY=o.touches[0].pageY),r.currentY=r.startY,r._infScroll&&(r._infScroll.style.willChange="transform",r._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},r.onMove=function(o){r.dragging&&(o instanceof MouseEvent?r.currentY=o.pageY:o instanceof TouchEvent&&(r.currentY=o.touches[0].pageY),!(r.currentY<r.startY)&&(r.currentY-r.startY>=Number(r.props.pullDownToRefreshThreshold)&&r.setState({pullToRefreshThresholdBreached:!0}),!(r.currentY-r.startY>r.maxPullDownDistance*1.5)&&r._infScroll&&(r._infScroll.style.overflow="visible",r._infScroll.style.transform="translate3d(0px, "+(r.currentY-r.startY)+"px, 0px)")))},r.onEnd=function(){r.startY=0,r.currentY=0,r.dragging=!1,r.state.pullToRefreshThresholdBreached&&(r.props.refreshFunction&&r.props.refreshFunction(),r.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){r._infScroll&&(r._infScroll.style.overflow="auto",r._infScroll.style.transform="none",r._infScroll.style.willChange="unset")})},r.onScrollListener=function(o){typeof r.props.onScroll=="function"&&setTimeout(function(){return r.props.onScroll&&r.props.onScroll(o)},0);var i=r.props.height||r._scrollableNode?o.target:document.documentElement.scrollTop?document.documentElement:document.body;if(!r.actionTriggered){var a=r.props.inverse?r.isElementAtTop(i,r.props.scrollThreshold):r.isElementAtBottom(i,r.props.scrollThreshold);a&&r.props.hasMore&&(r.actionTriggered=!0,r.setState({showLoader:!0}),r.props.next&&r.props.next()),r.lastScrollTop=i.scrollTop}},r.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:n.dataLength},r.throttledOnScrollListener=jV(150,r.onScrollListener).bind(r),r.onStart=r.onStart.bind(r),r.onMove=r.onMove.bind(r),r.onEnd=r.onEnd.bind(r),r}return t.prototype.componentDidMount=function(){if(typeof this.props.dataLength>"u")throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),typeof this.props.initialScrollY=="number"&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),typeof this.props.refreshFunction!="function"))throw new Error(`Mandatory prop "refreshFunction" missing.
          Pull Down To Refresh functionality will not work
          as expected. Check README.md for usage'`)},t.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.componentDidUpdate=function(n){this.props.dataLength!==n.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},t.getDerivedStateFromProps=function(n,r){var o=n.dataLength!==r.prevDataLength;return o?tu(tu({},r),{prevDataLength:n.dataLength}):null},t.prototype.isElementAtTop=function(n,r){r===void 0&&(r=.8);var o=n===document.body||n===document.documentElement?window.screen.availHeight:n.clientHeight,i=Qb(r);return i.unit===za.Pixel?n.scrollTop<=i.value+o-n.scrollHeight+1:n.scrollTop<=i.value/100+o-n.scrollHeight+1},t.prototype.isElementAtBottom=function(n,r){r===void 0&&(r=.8);var o=n===document.body||n===document.documentElement?window.screen.availHeight:n.clientHeight,i=Qb(r);return i.unit===za.Pixel?n.scrollTop+o>=n.scrollHeight-i.value:n.scrollTop+o>=i.value/100*n.scrollHeight},t.prototype.render=function(){var n=this,r=tu({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),o=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),i=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return _n.createElement("div",{style:i,className:"infinite-scroll-component__outerdiv"},_n.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(a){return n._infScroll=a},style:r},this.props.pullDownToRefresh&&_n.createElement("div",{style:{position:"relative"},ref:function(a){return n._pullDown=a}},_n.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!o&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(N.Component);const ek=({data:e,fromSearch:t,mediaType:n})=>{const{url:r}=Xi(a=>a.home),o=Wf(),i=e.poster_path?r.poster+e.poster_path:bg;return P.jsxs("div",{className:"movieCard",onClick:()=>o(`/${e.media_type||n}/${e.id}`),children:[P.jsxs("div",{className:"posterBlock",children:[P.jsx(ei,{className:"posterImg",src:i}),!t&&P.jsxs(_n.Fragment,{children:[P.jsx(xg,{rating:e.vote_average.toFixed(1)}),P.jsx(wg,{data:e.genre_ids.slice(0,2)})]})]}),P.jsxs("div",{className:"textBlock",children:[P.jsx("span",{className:"title",children:e.title||e.name}),P.jsx("span",{className:"date",children:Uc(e.release_date||e.first_air_date).format("MMM D, YYYY")})]})]})},pf=({initial:e})=>P.jsx("div",{className:`loadingSpinner ${e?"initial":""}`,children:P.jsx("svg",{className:"spinner",viewBox:"0 0 50 50",children:P.jsx("circle",{className:"path",cx:"25",cy:"25",r:"20",fill:"none",strokeWidth:"5"})})}),$V=()=>{var l,c;const[e,t]=N.useState(null),[n,r]=N.useState(1),[o,i]=N.useState(!1),{query:a}=Uf(),s=()=>{i(!0),Vi(`/search/multi?query=${a}&page=${n}`).then(f=>{t(f),r(d=>d+1),i(!1)})},u=()=>{Vi(`/search/multi?query=${a}&page=${n}`).then(f=>{e!=null&&e.results?t({...e,results:[...e==null?void 0:e.results,...f.results]}):t(f),r(d=>d+1)})};return N.useEffect(()=>{r(1),s()},[a]),P.jsxs("div",{className:"searchResultsPage",children:[o&&P.jsx(pf,{initial:!0}),!o&&P.jsx(hn,{children:((l=e==null?void 0:e.results)==null?void 0:l.length)>0?P.jsxs(P.Fragment,{children:[P.jsx("div",{className:"pageTitle",children:`Search ${(e==null?void 0:e.total_results)>1?"results":"result"} of '${a}'`}),P.jsx(Z_,{className:"content",dataLength:((c=e==null?void 0:e.results)==null?void 0:c.length)||[],next:u,hasMore:n<=(e==null?void 0:e.total_pages),loader:P.jsx(pf,{}),children:e==null?void 0:e.results.map((f,d)=>{if(f.media_type!=="person")return P.jsx(ek,{data:f,fromSearch:!0},d)})})]}):P.jsx("span",{className:"resultNotFound",children:"Sorry, Results not found!"})})]})};function VV(e){if(Array.isArray(e))return e}function WV(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,o,i,a,s=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(c){l=!0,o=c}finally{try{if(!u&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}function Qv(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tk(e,t){if(e){if(typeof e=="string")return Qv(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qv(e,t):void 0}}function UV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function co(e,t){return VV(e)||WV(e,t)||tk(e,t)||UV()}function ko(e,t){if(e==null)return{};var n,r,o=uD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var zV=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function HV(e){var t=e.defaultInputValue,n=t===void 0?"":t,r=e.defaultMenuIsOpen,o=r===void 0?!1:r,i=e.defaultValue,a=i===void 0?null:i,s=e.inputValue,u=e.menuIsOpen,l=e.onChange,c=e.onInputChange,f=e.onMenuClose,d=e.onMenuOpen,p=e.value,h=ko(e,zV),m=N.useState(s!==void 0?s:n),g=co(m,2),v=g[0],y=g[1],b=N.useState(u!==void 0?u:o),x=co(b,2),w=x[0],S=x[1],E=N.useState(p!==void 0?p:a),C=co(E,2),k=C[0],_=C[1],T=N.useCallback(function(O,L){typeof l=="function"&&l(O,L),_(O)},[l]),D=N.useCallback(function(O,L){var B;typeof c=="function"&&(B=c(O,L)),y(B!==void 0?B:O)},[c]),U=N.useCallback(function(){typeof d=="function"&&d(),S(!0)},[d]),j=N.useCallback(function(){typeof f=="function"&&f(),S(!1)},[f]),A=s!==void 0?s:v,M=u!==void 0?u:w,$=p!==void 0?p:k;return Se(Se({},h),{},{inputValue:A,menuIsOpen:M,onChange:T,onInputChange:D,onMenuClose:j,onMenuOpen:U,value:$})}function GV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,MS(r.key),r)}}function qV(e,t,n){return t&&Jb(e.prototype,t),n&&Jb(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jv(e,t){return Jv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Jv(e,t)}function KV(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jv(e,t)}function hf(e){return hf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hf(e)}function nk(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nk=function(){return!!e})()}function XV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YV(e,t){if(t&&(Ui(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XV(e)}function QV(e){var t=nk();return function(){var n,r=hf(e);if(t){var o=hf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return YV(this,n)}}function JV(e){if(Array.isArray(e))return Qv(e)}function ZV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function e6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oy(e){return JV(e)||ZV(e)||tk(e)||e6()}function t6(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function n6(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var r6=function(){function e(n){var r=this;this._insertTag=function(o){var i;r.tags.length===0?r.insertionPoint?i=r.insertionPoint.nextSibling:r.prepend?i=r.container.firstChild:i=r.before:i=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(o,i),r.tags.push(o)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(n6(this));var o=this.tags[this.tags.length-1];if(this.isSpeedy){var i=t6(o);try{i.insertRule(r,i.cssRules.length)}catch{}}else o.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},e}(),on="-ms-",vf="-moz-",ze="-webkit-",rk="comm",Ty="rule",Dy="decl",o6="@import",ok="@keyframes",i6="@layer",a6=Math.abs,Bd=String.fromCharCode,s6=Object.assign;function u6(e,t){return Yt(e,0)^45?(((t<<2^Yt(e,0))<<2^Yt(e,1))<<2^Yt(e,2))<<2^Yt(e,3):0}function ik(e){return e.trim()}function l6(e,t){return(e=t.exec(e))?e[0]:e}function He(e,t,n){return e.replace(t,n)}function Zv(e,t){return e.indexOf(t)}function Yt(e,t){return e.charCodeAt(t)|0}function Au(e,t,n){return e.slice(t,n)}function jr(e){return e.length}function Ny(e){return e.length}function jl(e,t){return t.push(e),e}function c6(e,t){return e.map(t).join("")}var jd=1,as=1,ak=0,An=0,Ct=0,gs="";function $d(e,t,n,r,o,i,a){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:jd,column:as,length:a,return:""}}function As(e,t){return s6($d("",null,null,"",null,null,0),e,{length:-e.length},t)}function f6(){return Ct}function d6(){return Ct=An>0?Yt(gs,--An):0,as--,Ct===10&&(as=1,jd--),Ct}function Xn(){return Ct=An<ak?Yt(gs,An++):0,as++,Ct===10&&(as=1,jd++),Ct}function Qr(){return Yt(gs,An)}function sc(){return An}function ol(e,t){return Au(gs,e,t)}function Mu(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function sk(e){return jd=as=1,ak=jr(gs=e),An=0,[]}function uk(e){return gs="",e}function uc(e){return ik(ol(An-1,em(e===91?e+2:e===40?e+1:e)))}function p6(e){for(;(Ct=Qr())&&Ct<33;)Xn();return Mu(e)>2||Mu(Ct)>3?"":" "}function h6(e,t){for(;--t&&Xn()&&!(Ct<48||Ct>102||Ct>57&&Ct<65||Ct>70&&Ct<97););return ol(e,sc()+(t<6&&Qr()==32&&Xn()==32))}function em(e){for(;Xn();)switch(Ct){case e:return An;case 34:case 39:e!==34&&e!==39&&em(Ct);break;case 40:e===41&&em(e);break;case 92:Xn();break}return An}function v6(e,t){for(;Xn()&&e+Ct!==57;)if(e+Ct===84&&Qr()===47)break;return"/*"+ol(t,An-1)+"*"+Bd(e===47?e:Xn())}function m6(e){for(;!Mu(Qr());)Xn();return ol(e,An)}function g6(e){return uk(lc("",null,null,null,[""],e=sk(e),0,[0],e))}function lc(e,t,n,r,o,i,a,s,u){for(var l=0,c=0,f=a,d=0,p=0,h=0,m=1,g=1,v=1,y=0,b="",x=o,w=i,S=r,E=b;g;)switch(h=y,y=Xn()){case 40:if(h!=108&&Yt(E,f-1)==58){Zv(E+=He(uc(y),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:E+=uc(y);break;case 9:case 10:case 13:case 32:E+=p6(h);break;case 92:E+=h6(sc()-1,7);continue;case 47:switch(Qr()){case 42:case 47:jl(y6(v6(Xn(),sc()),t,n),u);break;default:E+="/"}break;case 123*m:s[l++]=jr(E)*v;case 125*m:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+c:v==-1&&(E=He(E,/\f/g,"")),p>0&&jr(E)-f&&jl(p>32?ex(E+";",r,n,f-1):ex(He(E," ","")+";",r,n,f-2),u);break;case 59:E+=";";default:if(jl(S=Zb(E,t,n,l,c,o,s,b,x=[],w=[],f),i),y===123)if(c===0)lc(E,t,S,S,x,i,f,s,w);else switch(d===99&&Yt(E,3)===110?100:d){case 100:case 108:case 109:case 115:lc(e,S,S,r&&jl(Zb(e,S,S,0,0,o,s,b,o,x=[],f),w),o,w,f,s,r?x:w);break;default:lc(E,S,S,S,[""],w,0,s,w)}}l=c=p=0,m=v=1,b=E="",f=a;break;case 58:f=1+jr(E),p=h;default:if(m<1){if(y==123)--m;else if(y==125&&m++==0&&d6()==125)continue}switch(E+=Bd(y),y*m){case 38:v=c>0?1:(E+="\f",-1);break;case 44:s[l++]=(jr(E)-1)*v,v=1;break;case 64:Qr()===45&&(E+=uc(Xn())),d=Qr(),c=f=jr(b=E+=m6(sc())),y++;break;case 45:h===45&&jr(E)==2&&(m=0)}}return i}function Zb(e,t,n,r,o,i,a,s,u,l,c){for(var f=o-1,d=o===0?i:[""],p=Ny(d),h=0,m=0,g=0;h<r;++h)for(var v=0,y=Au(e,f+1,f=a6(m=a[h])),b=e;v<p;++v)(b=ik(m>0?d[v]+" "+y:He(y,/&\f/g,d[v])))&&(u[g++]=b);return $d(e,t,n,o===0?Ty:s,u,l,c)}function y6(e,t,n){return $d(e,t,n,rk,Bd(f6()),Au(e,2,-2),0)}function ex(e,t,n,r){return $d(e,t,n,Dy,Au(e,0,r),Au(e,r+1,-1),r)}function Ha(e,t){for(var n="",r=Ny(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function b6(e,t,n,r){switch(e.type){case i6:if(e.children.length)break;case o6:case Dy:return e.return=e.return||e.value;case rk:return"";case ok:return e.return=e.value+"{"+Ha(e.children,r)+"}";case Ty:e.value=e.props.join(",")}return jr(n=Ha(e.children,r))?e.return=e.value+"{"+n+"}":""}function x6(e){var t=Ny(e);return function(n,r,o,i){for(var a="",s=0;s<t;s++)a+=e[s](n,r,o,i)||"";return a}}function w6(e){return function(t){t.root||(t=t.return)&&e(t)}}function S6(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var C6=function(t,n,r){for(var o=0,i=0;o=i,i=Qr(),o===38&&i===12&&(n[r]=1),!Mu(i);)Xn();return ol(t,An)},E6=function(t,n){var r=-1,o=44;do switch(Mu(o)){case 0:o===38&&Qr()===12&&(n[r]=1),t[r]+=C6(An-1,n,r);break;case 2:t[r]+=uc(o);break;case 4:if(o===44){t[++r]=Qr()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=Bd(o)}while(o=Xn());return t},_6=function(t,n){return uk(E6(sk(t),n))},tx=new WeakMap,k6=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,r=t.parent,o=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!tx.get(r))&&!o){tx.set(t,!0);for(var i=[],a=_6(n,i),s=r.props,u=0,l=0;u<a.length;u++)for(var c=0;c<s.length;c++,l++)t.props[l]=i[u]?a[u].replace(/&\f/g,s[c]):s[c]+" "+a[u]}}},R6=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function lk(e,t){switch(u6(e,t)){case 5103:return ze+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ze+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return ze+e+vf+e+on+e+e;case 6828:case 4268:return ze+e+on+e+e;case 6165:return ze+e+on+"flex-"+e+e;case 5187:return ze+e+He(e,/(\w+).+(:[^]+)/,ze+"box-$1$2"+on+"flex-$1$2")+e;case 5443:return ze+e+on+"flex-item-"+He(e,/flex-|-self/,"")+e;case 4675:return ze+e+on+"flex-line-pack"+He(e,/align-content|flex-|-self/,"")+e;case 5548:return ze+e+on+He(e,"shrink","negative")+e;case 5292:return ze+e+on+He(e,"basis","preferred-size")+e;case 6060:return ze+"box-"+He(e,"-grow","")+ze+e+on+He(e,"grow","positive")+e;case 4554:return ze+He(e,/([^-])(transform)/g,"$1"+ze+"$2")+e;case 6187:return He(He(He(e,/(zoom-|grab)/,ze+"$1"),/(image-set)/,ze+"$1"),e,"")+e;case 5495:case 3959:return He(e,/(image-set\([^]*)/,ze+"$1$`$1");case 4968:return He(He(e,/(.+:)(flex-)?(.*)/,ze+"box-pack:$3"+on+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ze+e+e;case 4095:case 3583:case 4068:case 2532:return He(e,/(.+)-inline(.+)/,ze+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(jr(e)-1-t>6)switch(Yt(e,t+1)){case 109:if(Yt(e,t+4)!==45)break;case 102:return He(e,/(.+:)(.+)-([^]+)/,"$1"+ze+"$2-$3$1"+vf+(Yt(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Zv(e,"stretch")?lk(He(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Yt(e,t+1)!==115)break;case 6444:switch(Yt(e,jr(e)-3-(~Zv(e,"!important")&&10))){case 107:return He(e,":",":"+ze)+e;case 101:return He(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ze+(Yt(e,14)===45?"inline-":"")+"box$3$1"+ze+"$2$3$1"+on+"$2box$3")+e}break;case 5936:switch(Yt(e,t+11)){case 114:return ze+e+on+He(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return ze+e+on+He(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return ze+e+on+He(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return ze+e+on+e+e}return e}var P6=function(t,n,r,o){if(t.length>-1&&!t.return)switch(t.type){case Dy:t.return=lk(t.value,t.length);break;case ok:return Ha([As(t,{value:He(t.value,"@","@"+ze)})],o);case Ty:if(t.length)return c6(t.props,function(i){switch(l6(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ha([As(t,{props:[He(i,/:(read-\w+)/,":"+vf+"$1")]})],o);case"::placeholder":return Ha([As(t,{props:[He(i,/:(plac\w+)/,":"+ze+"input-$1")]}),As(t,{props:[He(i,/:(plac\w+)/,":"+vf+"$1")]}),As(t,{props:[He(i,/:(plac\w+)/,on+"input-$1")]})],o)}return""})}},I6=[P6],O6=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(m){var g=m.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var o=t.stylisPlugins||I6,i={},a,s=[];a=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(m){for(var g=m.getAttribute("data-emotion").split(" "),v=1;v<g.length;v++)i[g[v]]=!0;s.push(m)});var u,l=[k6,R6];{var c,f=[b6,w6(function(m){c.insert(m)})],d=x6(l.concat(o,f)),p=function(g){return Ha(g6(g),d)};u=function(g,v,y,b){c=y,p(g?g+"{"+v.styles+"}":v.styles),b&&(h.inserted[v.name]=!0)}}var h={key:n,sheet:new r6({key:n,container:a,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:i,registered:{},insert:u};return h.sheet.hydrate(s),h},T6=!0;function D6(e,t,n){var r="";return n.split(" ").forEach(function(o){e[o]!==void 0?t.push(e[o]+";"):r+=o+" "}),r}var ck=function(t,n,r){var o=t.key+"-"+n.name;(r===!1||T6===!1)&&t.registered[o]===void 0&&(t.registered[o]=n.styles)},N6=function(t,n,r){ck(t,n,r);var o=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var i=n;do t.insert(n===i?"."+o:"",i,t.sheet,!0),i=i.next;while(i!==void 0)}};function A6(e){for(var t=0,n,r=0,o=e.length;o>=4;++r,o-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(o){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var M6={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},F6=/[A-Z]|^ms/g,L6=/_EMO_([^_]+?)_([^]*?)_EMO_/g,fk=function(t){return t.charCodeAt(1)===45},nx=function(t){return t!=null&&typeof t!="boolean"},ih=S6(function(e){return fk(e)?e:e.replace(F6,"-$&").toLowerCase()}),rx=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(L6,function(r,o,i){return $r={name:o,styles:i,next:$r},o})}return M6[t]!==1&&!fk(t)&&typeof n=="number"&&n!==0?n+"px":n};function Fu(e,t,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return $r={name:n.name,styles:n.styles,next:$r},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)$r={name:r.name,styles:r.styles,next:$r},r=r.next;var o=n.styles+";";return o}return B6(e,t,n)}case"function":{if(e!==void 0){var i=$r,a=n(e);return $r=i,Fu(e,t,a)}break}}return n}function B6(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=Fu(e,t,n[o])+";";else for(var i in n){var a=n[i];if(typeof a!="object")nx(a)&&(r+=ih(i)+":"+rx(i,a)+";");else if(Array.isArray(a)&&typeof a[0]=="string"&&t==null)for(var s=0;s<a.length;s++)nx(a[s])&&(r+=ih(i)+":"+rx(i,a[s])+";");else{var u=Fu(e,t,a);switch(i){case"animation":case"animationName":{r+=ih(i)+":"+u+";";break}default:r+=i+"{"+u+"}"}}}return r}var ox=/label:\s*([^\s;\n{]+)\s*(;|$)/g,$r,dk=function(t,n,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var o=!0,i="";$r=void 0;var a=t[0];a==null||a.raw===void 0?(o=!1,i+=Fu(r,n,a)):i+=a[0];for(var s=1;s<t.length;s++)i+=Fu(r,n,t[s]),o&&(i+=a[s]);ox.lastIndex=0;for(var u="",l;(l=ox.exec(i))!==null;)u+="-"+l[1];var c=A6(i)+u;return{name:c,styles:i,next:$r}},j6=function(t){return t()},$6=dh.useInsertionEffect?dh.useInsertionEffect:!1,V6=$6||j6,Ay={}.hasOwnProperty,pk=N.createContext(typeof HTMLElement<"u"?O6({key:"css"}):null);pk.Provider;var W6=function(t){return N.forwardRef(function(n,r){var o=N.useContext(pk);return t(n,o,r)})},U6=N.createContext({}),tm="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",z6=function(t,n){var r={};for(var o in n)Ay.call(n,o)&&(r[o]=n[o]);return r[tm]=t,r},H6=function(t){var n=t.cache,r=t.serialized,o=t.isStringTag;return ck(n,r,o),V6(function(){return N6(n,r,o)}),null},G6=W6(function(e,t,n){var r=e.css;typeof r=="string"&&t.registered[r]!==void 0&&(r=t.registered[r]);var o=e[tm],i=[r],a="";typeof e.className=="string"?a=D6(t.registered,i,e.className):e.className!=null&&(a=e.className+" ");var s=dk(i,void 0,N.useContext(U6));a+=t.key+"-"+s.name;var u={};for(var l in e)Ay.call(e,l)&&l!=="css"&&l!==tm&&(u[l]=e[l]);return u.ref=n,u.className=a,N.createElement(N.Fragment,null,N.createElement(H6,{cache:t,serialized:s,isStringTag:typeof o=="string"}),N.createElement(o,u))}),q6=G6,Ce=function(t,n){var r=arguments;if(n==null||!Ay.call(n,"css"))return N.createElement.apply(void 0,r);var o=r.length,i=new Array(o);i[0]=q6,i[1]=z6(t,n);for(var a=2;a<o;a++)i[a]=r[a];return N.createElement.apply(null,i)};function My(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return dk(t)}var K6=function(){var t=My.apply(void 0,arguments),n="animation-"+t.name;return{name:n,styles:"@keyframes "+n+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function X6(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const Y6=Math.min,Q6=Math.max,mf=Math.round,$l=Math.floor,gf=e=>({x:e,y:e});function J6(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function hk(e){return mk(e)?(e.nodeName||"").toLowerCase():"#document"}function go(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function vk(e){var t;return(t=(mk(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function mk(e){return e instanceof Node||e instanceof go(e).Node}function Z6(e){return e instanceof Element||e instanceof go(e).Element}function Fy(e){return e instanceof HTMLElement||e instanceof go(e).HTMLElement}function ix(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof go(e).ShadowRoot}function gk(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=Ly(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function eW(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function tW(e){return["html","body","#document"].includes(hk(e))}function Ly(e){return go(e).getComputedStyle(e)}function nW(e){if(hk(e)==="html")return e;const t=e.assignedSlot||e.parentNode||ix(e)&&e.host||vk(e);return ix(t)?t.host:t}function yk(e){const t=nW(e);return tW(t)?e.ownerDocument?e.ownerDocument.body:e.body:Fy(t)&&gk(t)?t:yk(t)}function yf(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=yk(e),i=o===((r=e.ownerDocument)==null?void 0:r.body),a=go(o);return i?t.concat(a,a.visualViewport||[],gk(o)?o:[],a.frameElement&&n?yf(a.frameElement):[]):t.concat(o,yf(o,[],n))}function rW(e){const t=Ly(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=Fy(e),i=o?e.offsetWidth:n,a=o?e.offsetHeight:r,s=mf(n)!==i||mf(r)!==a;return s&&(n=i,r=a),{width:n,height:r,$:s}}function By(e){return Z6(e)?e:e.contextElement}function ax(e){const t=By(e);if(!Fy(t))return gf(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:i}=rW(t);let a=(i?mf(n.width):n.width)/r,s=(i?mf(n.height):n.height)/o;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const oW=gf(0);function iW(e){const t=go(e);return!eW()||!t.visualViewport?oW:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function aW(e,t,n){return!1}function sx(e,t,n,r){t===void 0&&(t=!1);const o=e.getBoundingClientRect(),i=By(e);let a=gf(1);t&&(a=ax(e));const s=aW()?iW(i):gf(0);let u=(o.left+s.x)/a.x,l=(o.top+s.y)/a.y,c=o.width/a.x,f=o.height/a.y;if(i){const d=go(i),p=r;let h=d,m=h.frameElement;for(;m&&r&&p!==h;){const g=ax(m),v=m.getBoundingClientRect(),y=Ly(m),b=v.left+(m.clientLeft+parseFloat(y.paddingLeft))*g.x,x=v.top+(m.clientTop+parseFloat(y.paddingTop))*g.y;u*=g.x,l*=g.y,c*=g.x,f*=g.y,u+=b,l+=x,h=go(m),m=h.frameElement}}return J6({width:c,height:f,x:u,y:l})}function sW(e,t){let n=null,r;const o=vk(e);function i(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function a(s,u){s===void 0&&(s=!1),u===void 0&&(u=1),i();const{left:l,top:c,width:f,height:d}=e.getBoundingClientRect();if(s||t(),!f||!d)return;const p=$l(c),h=$l(o.clientWidth-(l+f)),m=$l(o.clientHeight-(c+d)),g=$l(l),y={rootMargin:-p+"px "+-h+"px "+-m+"px "+-g+"px",threshold:Q6(0,Y6(1,u))||1};let b=!0;function x(w){const S=w[0].intersectionRatio;if(S!==u){if(!b)return a();S?a(!1,S):r=setTimeout(()=>{a(!1,1e-7)},1e3)}b=!1}try{n=new IntersectionObserver(x,{...y,root:o.ownerDocument})}catch{n=new IntersectionObserver(x,y)}n.observe(e)}return a(!0),i}function uW(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,l=By(e),c=o||i?[...l?yf(l):[],...yf(t)]:[];c.forEach(v=>{o&&v.addEventListener("scroll",n,{passive:!0}),i&&v.addEventListener("resize",n)});const f=l&&s?sW(l,n):null;let d=-1,p=null;a&&(p=new ResizeObserver(v=>{let[y]=v;y&&y.target===l&&p&&(p.unobserve(t),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var b;(b=p)==null||b.observe(t)})),n()}),l&&!u&&p.observe(l),p.observe(t));let h,m=u?sx(e):null;u&&g();function g(){const v=sx(e);m&&(v.x!==m.x||v.y!==m.y||v.width!==m.width||v.height!==m.height)&&n(),m=v,h=requestAnimationFrame(g)}return n(),()=>{var v;c.forEach(y=>{o&&y.removeEventListener("scroll",n),i&&y.removeEventListener("resize",n)}),f==null||f(),(v=p)==null||v.disconnect(),p=null,u&&cancelAnimationFrame(h)}}var nm=N.useLayoutEffect,lW=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],bf=function(){};function cW(e,t){return t?t[0]==="-"?e+t:e+"__"+t:e}function fW(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i=[].concat(r);if(t&&e)for(var a in t)t.hasOwnProperty(a)&&t[a]&&i.push("".concat(cW(e,a)));return i.filter(function(s){return s}).map(function(s){return String(s).trim()}).join(" ")}var ux=function(t){return xW(t)?t.filter(Boolean):Ui(t)==="object"&&t!==null?[t]:[]},bk=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getClassNames,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var n=ko(t,lW);return Se({},n)},gt=function(t,n,r){var o=t.cx,i=t.getStyles,a=t.getClassNames,s=t.className;return{css:i(n,t),className:o(r??{},a(n,t),s)}};function Vd(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function dW(e){return Vd(e)?window.innerHeight:e.clientHeight}function xk(e){return Vd(e)?window.pageYOffset:e.scrollTop}function xf(e,t){if(Vd(e)){window.scrollTo(0,t);return}e.scrollTop=t}function pW(e){var t=getComputedStyle(e),n=t.position==="absolute",r=/(auto|scroll)/;if(t.position==="fixed")return document.documentElement;for(var o=e;o=o.parentElement;)if(t=getComputedStyle(o),!(n&&t.position==="static")&&r.test(t.overflow+t.overflowY+t.overflowX))return o;return document.documentElement}function hW(e,t,n,r){return n*((e=e/r-1)*e*e+1)+t}function Vl(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:bf,o=xk(e),i=t-o,a=10,s=0;function u(){s+=a;var l=hW(s,o,i,n);xf(e,l),s<n?window.requestAnimationFrame(u):r(e)}u()}function lx(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),o=t.offsetHeight/3;r.bottom+o>n.bottom?xf(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+o,e.scrollHeight)):r.top-o<n.top&&xf(e,Math.max(t.offsetTop-o,0))}function vW(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}function cx(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function mW(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var wk=!1,gW={get passive(){return wk=!0}},Wl=typeof window<"u"?window:{};Wl.addEventListener&&Wl.removeEventListener&&(Wl.addEventListener("p",bf,gW),Wl.removeEventListener("p",bf,!1));var yW=wk;function bW(e){return e!=null}function xW(e){return Array.isArray(e)}function Ul(e,t,n){return e?t:n}var wW=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=Object.entries(t).filter(function(a){var s=co(a,1),u=s[0];return!r.includes(u)});return i.reduce(function(a,s){var u=co(s,2),l=u[0],c=u[1];return a[l]=c,a},{})},SW=["children","innerProps"],CW=["children","innerProps"];function EW(e){var t=e.maxHeight,n=e.menuEl,r=e.minHeight,o=e.placement,i=e.shouldScroll,a=e.isFixedPosition,s=e.controlHeight,u=pW(n),l={placement:"bottom",maxHeight:t};if(!n||!n.offsetParent)return l;var c=u.getBoundingClientRect(),f=c.height,d=n.getBoundingClientRect(),p=d.bottom,h=d.height,m=d.top,g=n.offsetParent.getBoundingClientRect(),v=g.top,y=a?window.innerHeight:dW(u),b=xk(u),x=parseInt(getComputedStyle(n).marginBottom,10),w=parseInt(getComputedStyle(n).marginTop,10),S=v-w,E=y-m,C=S+b,k=f-b-m,_=p-y+b+x,T=b+m-w,D=160;switch(o){case"auto":case"bottom":if(E>=h)return{placement:"bottom",maxHeight:t};if(k>=h&&!a)return i&&Vl(u,_,D),{placement:"bottom",maxHeight:t};if(!a&&k>=r||a&&E>=r){i&&Vl(u,_,D);var U=a?E-x:k-x;return{placement:"bottom",maxHeight:U}}if(o==="auto"||a){var j=t,A=a?S:C;return A>=r&&(j=Math.min(A-x-s,t)),{placement:"top",maxHeight:j}}if(o==="bottom")return i&&xf(u,_),{placement:"bottom",maxHeight:t};break;case"top":if(S>=h)return{placement:"top",maxHeight:t};if(C>=h&&!a)return i&&Vl(u,T,D),{placement:"top",maxHeight:t};if(!a&&C>=r||a&&S>=r){var M=t;return(!a&&C>=r||a&&S>=r)&&(M=a?S-w:C-w),i&&Vl(u,T,D),{placement:"top",maxHeight:M}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(o,'".'))}return l}function _W(e){var t={bottom:"top",top:"bottom"};return e?t[e]:"bottom"}var Sk=function(t){return t==="auto"?"bottom":t},kW=function(t,n){var r,o=t.placement,i=t.theme,a=i.borderRadius,s=i.spacing,u=i.colors;return Se((r={label:"menu"},Vs(r,_W(o),"100%"),Vs(r,"position","absolute"),Vs(r,"width","100%"),Vs(r,"zIndex",1),r),n?{}:{backgroundColor:u.neutral0,borderRadius:a,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:s.menuGutter,marginTop:s.menuGutter})},Ck=N.createContext(null),RW=function(t){var n=t.children,r=t.minMenuHeight,o=t.maxMenuHeight,i=t.menuPlacement,a=t.menuPosition,s=t.menuShouldScrollIntoView,u=t.theme,l=N.useContext(Ck)||{},c=l.setPortalPlacement,f=N.useRef(null),d=N.useState(o),p=co(d,2),h=p[0],m=p[1],g=N.useState(null),v=co(g,2),y=v[0],b=v[1],x=u.spacing.controlHeight;return nm(function(){var w=f.current;if(w){var S=a==="fixed",E=s&&!S,C=EW({maxHeight:o,menuEl:w,minHeight:r,placement:i,shouldScroll:E,isFixedPosition:S,controlHeight:x});m(C.maxHeight),b(C.placement),c==null||c(C.placement)}},[o,i,a,s,r,c,x]),n({ref:f,placerProps:Se(Se({},t),{},{placement:y||Sk(i),maxHeight:h})})},PW=function(t){var n=t.children,r=t.innerRef,o=t.innerProps;return Ce("div",Re({},gt(t,"menu",{menu:!0}),{ref:r},o),n)},IW=PW,OW=function(t,n){var r=t.maxHeight,o=t.theme.spacing.baseUnit;return Se({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},n?{}:{paddingBottom:o,paddingTop:o})},TW=function(t){var n=t.children,r=t.innerProps,o=t.innerRef,i=t.isMulti;return Ce("div",Re({},gt(t,"menuList",{"menu-list":!0,"menu-list--is-multi":i}),{ref:o},r),n)},Ek=function(t,n){var r=t.theme,o=r.spacing.baseUnit,i=r.colors;return Se({textAlign:"center"},n?{}:{color:i.neutral40,padding:"".concat(o*2,"px ").concat(o*3,"px")})},DW=Ek,NW=Ek,AW=function(t){var n=t.children,r=n===void 0?"No options":n,o=t.innerProps,i=ko(t,SW);return Ce("div",Re({},gt(Se(Se({},i),{},{children:r,innerProps:o}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),o),r)},MW=function(t){var n=t.children,r=n===void 0?"Loading...":n,o=t.innerProps,i=ko(t,CW);return Ce("div",Re({},gt(Se(Se({},i),{},{children:r,innerProps:o}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),o),r)},FW=function(t){var n=t.rect,r=t.offset,o=t.position;return{left:n.left,position:o,top:r,width:n.width,zIndex:1}},LW=function(t){var n=t.appendTo,r=t.children,o=t.controlElement,i=t.innerProps,a=t.menuPlacement,s=t.menuPosition,u=N.useRef(null),l=N.useRef(null),c=N.useState(Sk(a)),f=co(c,2),d=f[0],p=f[1],h=N.useMemo(function(){return{setPortalPlacement:p}},[]),m=N.useState(null),g=co(m,2),v=g[0],y=g[1],b=N.useCallback(function(){if(o){var E=vW(o),C=s==="fixed"?0:window.pageYOffset,k=E[d]+C;(k!==(v==null?void 0:v.offset)||E.left!==(v==null?void 0:v.rect.left)||E.width!==(v==null?void 0:v.rect.width))&&y({offset:k,rect:E})}},[o,s,d,v==null?void 0:v.offset,v==null?void 0:v.rect.left,v==null?void 0:v.rect.width]);nm(function(){b()},[b]);var x=N.useCallback(function(){typeof l.current=="function"&&(l.current(),l.current=null),o&&u.current&&(l.current=uW(o,u.current,b,{elementResize:"ResizeObserver"in window}))},[o,b]);nm(function(){x()},[x]);var w=N.useCallback(function(E){u.current=E,x()},[x]);if(!n&&s!=="fixed"||!v)return null;var S=Ce("div",Re({ref:w},gt(Se(Se({},t),{},{offset:v.offset,position:s,rect:v.rect}),"menuPortal",{"menu-portal":!0}),i),r);return Ce(Ck.Provider,{value:h},n?Bf.createPortal(S,n):S)},BW=function(t){var n=t.isDisabled,r=t.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:n?"none":void 0,position:"relative"}},jW=function(t){var n=t.children,r=t.innerProps,o=t.isDisabled,i=t.isRtl;return Ce("div",Re({},gt(t,"container",{"--is-disabled":o,"--is-rtl":i}),r),n)},$W=function(t,n){var r=t.theme.spacing,o=t.isMulti,i=t.hasValue,a=t.selectProps.controlShouldRenderValue;return Se({alignItems:"center",display:o&&i&&a?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},n?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},VW=function(t){var n=t.children,r=t.innerProps,o=t.isMulti,i=t.hasValue;return Ce("div",Re({},gt(t,"valueContainer",{"value-container":!0,"value-container--is-multi":o,"value-container--has-value":i}),r),n)},WW=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},UW=function(t){var n=t.children,r=t.innerProps;return Ce("div",Re({},gt(t,"indicatorsContainer",{indicators:!0}),r),n)},fx,zW=["size"],HW=["innerProps","isRtl","size"],GW={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},_k=function(t){var n=t.size,r=ko(t,zW);return Ce("svg",Re({height:n,width:n,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:GW},r))},jy=function(t){return Ce(_k,Re({size:20},t),Ce("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},kk=function(t){return Ce(_k,Re({size:20},t),Ce("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},Rk=function(t,n){var r=t.isFocused,o=t.theme,i=o.spacing.baseUnit,a=o.colors;return Se({label:"indicatorContainer",display:"flex",transition:"color 150ms"},n?{}:{color:r?a.neutral60:a.neutral20,padding:i*2,":hover":{color:r?a.neutral80:a.neutral40}})},qW=Rk,KW=function(t){var n=t.children,r=t.innerProps;return Ce("div",Re({},gt(t,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),n||Ce(kk,null))},XW=Rk,YW=function(t){var n=t.children,r=t.innerProps;return Ce("div",Re({},gt(t,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),n||Ce(jy,null))},QW=function(t,n){var r=t.isDisabled,o=t.theme,i=o.spacing.baseUnit,a=o.colors;return Se({label:"indicatorSeparator",alignSelf:"stretch",width:1},n?{}:{backgroundColor:r?a.neutral10:a.neutral20,marginBottom:i*2,marginTop:i*2})},JW=function(t){var n=t.innerProps;return Ce("span",Re({},n,gt(t,"indicatorSeparator",{"indicator-separator":!0})))},ZW=K6(fx||(fx=X6([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),eU=function(t,n){var r=t.isFocused,o=t.size,i=t.theme,a=i.colors,s=i.spacing.baseUnit;return Se({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:o,lineHeight:1,marginRight:o,textAlign:"center",verticalAlign:"middle"},n?{}:{color:r?a.neutral60:a.neutral20,padding:s*2})},ah=function(t){var n=t.delay,r=t.offset;return Ce("span",{css:My({animation:"".concat(ZW," 1s ease-in-out ").concat(n,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},tU=function(t){var n=t.innerProps,r=t.isRtl,o=t.size,i=o===void 0?4:o,a=ko(t,HW);return Ce("div",Re({},gt(Se(Se({},a),{},{innerProps:n,isRtl:r,size:i}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),n),Ce(ah,{delay:0,offset:r}),Ce(ah,{delay:160,offset:!0}),Ce(ah,{delay:320,offset:!r}))},nU=function(t,n){var r=t.isDisabled,o=t.isFocused,i=t.theme,a=i.colors,s=i.borderRadius,u=i.spacing;return Se({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:u.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},n?{}:{backgroundColor:r?a.neutral5:a.neutral0,borderColor:r?a.neutral10:o?a.primary:a.neutral20,borderRadius:s,borderStyle:"solid",borderWidth:1,boxShadow:o?"0 0 0 1px ".concat(a.primary):void 0,"&:hover":{borderColor:o?a.primary:a.neutral30}})},rU=function(t){var n=t.children,r=t.isDisabled,o=t.isFocused,i=t.innerRef,a=t.innerProps,s=t.menuIsOpen;return Ce("div",Re({ref:i},gt(t,"control",{control:!0,"control--is-disabled":r,"control--is-focused":o,"control--menu-is-open":s}),a,{"aria-disabled":r||void 0}),n)},oU=rU,iU=["data"],aU=function(t,n){var r=t.theme.spacing;return n?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},sU=function(t){var n=t.children,r=t.cx,o=t.getStyles,i=t.getClassNames,a=t.Heading,s=t.headingProps,u=t.innerProps,l=t.label,c=t.theme,f=t.selectProps;return Ce("div",Re({},gt(t,"group",{group:!0}),u),Ce(a,Re({},s,{selectProps:f,theme:c,getStyles:o,getClassNames:i,cx:r}),l),Ce("div",null,n))},uU=function(t,n){var r=t.theme,o=r.colors,i=r.spacing;return Se({label:"group",cursor:"default",display:"block"},n?{}:{color:o.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:i.baseUnit*3,paddingRight:i.baseUnit*3,textTransform:"uppercase"})},lU=function(t){var n=bk(t);n.data;var r=ko(n,iU);return Ce("div",Re({},gt(t,"groupHeading",{"group-heading":!0}),r))},cU=sU,fU=["innerRef","isDisabled","isHidden","inputClassName"],dU=function(t,n){var r=t.isDisabled,o=t.value,i=t.theme,a=i.spacing,s=i.colors;return Se(Se({visibility:r?"hidden":"visible",transform:o?"translateZ(0)":""},pU),n?{}:{margin:a.baseUnit/2,paddingBottom:a.baseUnit/2,paddingTop:a.baseUnit/2,color:s.neutral80})},Pk={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},pU={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Se({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Pk)},hU=function(t){return Se({label:"input",color:"inherit",background:0,opacity:t?0:1,width:"100%"},Pk)},vU=function(t){var n=t.cx,r=t.value,o=bk(t),i=o.innerRef,a=o.isDisabled,s=o.isHidden,u=o.inputClassName,l=ko(o,fU);return Ce("div",Re({},gt(t,"input",{"input-container":!0}),{"data-value":r||""}),Ce("input",Re({className:n({input:!0},u),ref:i,style:hU(s),disabled:a},l)))},mU=vU,gU=function(t,n){var r=t.theme,o=r.spacing,i=r.borderRadius,a=r.colors;return Se({label:"multiValue",display:"flex",minWidth:0},n?{}:{backgroundColor:a.neutral10,borderRadius:i/2,margin:o.baseUnit/2})},yU=function(t,n){var r=t.theme,o=r.borderRadius,i=r.colors,a=t.cropWithEllipsis;return Se({overflow:"hidden",textOverflow:a||a===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},n?{}:{borderRadius:o/2,color:i.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},bU=function(t,n){var r=t.theme,o=r.spacing,i=r.borderRadius,a=r.colors,s=t.isFocused;return Se({alignItems:"center",display:"flex"},n?{}:{borderRadius:i/2,backgroundColor:s?a.dangerLight:void 0,paddingLeft:o.baseUnit,paddingRight:o.baseUnit,":hover":{backgroundColor:a.dangerLight,color:a.danger}})},Ik=function(t){var n=t.children,r=t.innerProps;return Ce("div",r,n)},xU=Ik,wU=Ik;function SU(e){var t=e.children,n=e.innerProps;return Ce("div",Re({role:"button"},n),t||Ce(jy,{size:14}))}var CU=function(t){var n=t.children,r=t.components,o=t.data,i=t.innerProps,a=t.isDisabled,s=t.removeProps,u=t.selectProps,l=r.Container,c=r.Label,f=r.Remove;return Ce(l,{data:o,innerProps:Se(Se({},gt(t,"multiValue",{"multi-value":!0,"multi-value--is-disabled":a})),i),selectProps:u},Ce(c,{data:o,innerProps:Se({},gt(t,"multiValueLabel",{"multi-value__label":!0})),selectProps:u},n),Ce(f,{data:o,innerProps:Se(Se({},gt(t,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(n||"option")},s),selectProps:u}))},EU=CU,_U=function(t,n){var r=t.isDisabled,o=t.isFocused,i=t.isSelected,a=t.theme,s=a.spacing,u=a.colors;return Se({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},n?{}:{backgroundColor:i?u.primary:o?u.primary25:"transparent",color:r?u.neutral20:i?u.neutral0:"inherit",padding:"".concat(s.baseUnit*2,"px ").concat(s.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:i?u.primary:u.primary50}})},kU=function(t){var n=t.children,r=t.isDisabled,o=t.isFocused,i=t.isSelected,a=t.innerRef,s=t.innerProps;return Ce("div",Re({},gt(t,"option",{option:!0,"option--is-disabled":r,"option--is-focused":o,"option--is-selected":i}),{ref:a,"aria-disabled":r},s),n)},RU=kU,PU=function(t,n){var r=t.theme,o=r.spacing,i=r.colors;return Se({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},n?{}:{color:i.neutral50,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},IU=function(t){var n=t.children,r=t.innerProps;return Ce("div",Re({},gt(t,"placeholder",{placeholder:!0}),r),n)},OU=IU,TU=function(t,n){var r=t.isDisabled,o=t.theme,i=o.spacing,a=o.colors;return Se({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n?{}:{color:r?a.neutral40:a.neutral80,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},DU=function(t){var n=t.children,r=t.isDisabled,o=t.innerProps;return Ce("div",Re({},gt(t,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),o),n)},NU=DU,AU={ClearIndicator:YW,Control:oU,DropdownIndicator:KW,DownChevron:kk,CrossIcon:jy,Group:cU,GroupHeading:lU,IndicatorsContainer:UW,IndicatorSeparator:JW,Input:mU,LoadingIndicator:tU,Menu:IW,MenuList:TW,MenuPortal:LW,LoadingMessage:MW,NoOptionsMessage:AW,MultiValue:EU,MultiValueContainer:xU,MultiValueLabel:wU,MultiValueRemove:SU,Option:RU,Placeholder:OU,SelectContainer:jW,SingleValue:NU,ValueContainer:VW},MU=function(t){return Se(Se({},AU),t.components)},dx=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function FU(e,t){return!!(e===t||dx(e)&&dx(t))}function LU(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!FU(e[n],t[n]))return!1;return!0}function BU(e,t){t===void 0&&(t=LU);var n=null;function r(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];if(n&&n.lastThis===this&&t(o,n.lastArgs))return n.lastResult;var a=e.apply(this,o);return n={lastResult:a,lastArgs:o,lastThis:this},a}return r.clear=function(){n=null},r}var jU={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},$U=function(t){return Ce("span",Re({css:jU},t))},px=$U,VU={guidance:function(t){var n=t.isSearchable,r=t.isMulti,o=t.tabSelectsValue,i=t.context,a=t.isInitialFocus;switch(i){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(o?", press Tab to select the option and exit the menu":"",".");case"input":return a?"".concat(t["aria-label"]||"Select"," is focused ").concat(n?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var n=t.action,r=t.label,o=r===void 0?"":r,i=t.labels,a=t.isDisabled;switch(n){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(o,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(i.length>1?"s":""," ").concat(i.join(","),", selected.");case"select-option":return a?"option ".concat(o," is disabled. Select another option."):"option ".concat(o,", selected.");default:return""}},onFocus:function(t){var n=t.context,r=t.focused,o=t.options,i=t.label,a=i===void 0?"":i,s=t.selectValue,u=t.isDisabled,l=t.isSelected,c=t.isAppleDevice,f=function(m,g){return m&&m.length?"".concat(m.indexOf(g)+1," of ").concat(m.length):""};if(n==="value"&&s)return"value ".concat(a," focused, ").concat(f(s,r),".");if(n==="menu"&&c){var d=u?" disabled":"",p="".concat(l?" selected":"").concat(d);return"".concat(a).concat(p,", ").concat(f(o,r),".")}return""},onFilter:function(t){var n=t.inputValue,r=t.resultsMessage;return"".concat(r).concat(n?" for search term "+n:"",".")}},WU=function(t){var n=t.ariaSelection,r=t.focusedOption,o=t.focusedValue,i=t.focusableOptions,a=t.isFocused,s=t.selectValue,u=t.selectProps,l=t.id,c=t.isAppleDevice,f=u.ariaLiveMessages,d=u.getOptionLabel,p=u.inputValue,h=u.isMulti,m=u.isOptionDisabled,g=u.isSearchable,v=u.menuIsOpen,y=u.options,b=u.screenReaderStatus,x=u.tabSelectsValue,w=u.isLoading,S=u["aria-label"],E=u["aria-live"],C=N.useMemo(function(){return Se(Se({},VU),f||{})},[f]),k=N.useMemo(function(){var A="";if(n&&C.onChange){var M=n.option,$=n.options,O=n.removedValue,L=n.removedValues,B=n.value,G=function(he){return Array.isArray(he)?null:he},q=O||M||G(B),J=q?d(q):"",ne=$||L||void 0,ie=ne?ne.map(d):[],se=Se({isDisabled:q&&m(q,s),label:J,labels:ie},n);A=C.onChange(se)}return A},[n,C,m,s,d]),_=N.useMemo(function(){var A="",M=r||o,$=!!(r&&s&&s.includes(r));if(M&&C.onFocus){var O={focused:M,label:d(M),isDisabled:m(M,s),isSelected:$,options:i,context:M===r?"menu":"value",selectValue:s,isAppleDevice:c};A=C.onFocus(O)}return A},[r,o,d,m,C,i,s,c]),T=N.useMemo(function(){var A="";if(v&&y.length&&!w&&C.onFilter){var M=b({count:i.length});A=C.onFilter({inputValue:p,resultsMessage:M})}return A},[i,p,v,C,y,b,w]),D=(n==null?void 0:n.action)==="initial-input-focus",U=N.useMemo(function(){var A="";if(C.guidance){var M=o?"value":v?"menu":"input";A=C.guidance({"aria-label":S,context:M,isDisabled:r&&m(r,s),isMulti:h,isSearchable:g,tabSelectsValue:x,isInitialFocus:D})}return A},[S,r,o,h,m,g,v,C,s,x,D]),j=Ce(N.Fragment,null,Ce("span",{id:"aria-selection"},k),Ce("span",{id:"aria-focused"},_),Ce("span",{id:"aria-results"},T),Ce("span",{id:"aria-guidance"},U));return Ce(N.Fragment,null,Ce(px,{id:l},D&&j),Ce(px,{"aria-live":E,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},a&&!D&&j))},UU=WU,rm=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],zU=new RegExp("["+rm.map(function(e){return e.letters}).join("")+"]","g"),Ok={};for(var sh=0;sh<rm.length;sh++)for(var uh=rm[sh],lh=0;lh<uh.letters.length;lh++)Ok[uh.letters[lh]]=uh.base;var Tk=function(t){return t.replace(zU,function(n){return Ok[n]})},HU=BU(Tk),hx=function(t){return t.replace(/^\s+|\s+$/g,"")},GU=function(t){return"".concat(t.label," ").concat(t.value)},qU=function(t){return function(n,r){if(n.data.__isNew__)return!0;var o=Se({ignoreCase:!0,ignoreAccents:!0,stringify:GU,trim:!0,matchFrom:"any"},t),i=o.ignoreCase,a=o.ignoreAccents,s=o.stringify,u=o.trim,l=o.matchFrom,c=u?hx(r):r,f=u?hx(s(n)):s(n);return i&&(c=c.toLowerCase(),f=f.toLowerCase()),a&&(c=HU(c),f=Tk(f)),l==="start"?f.substr(0,c.length)===c:f.indexOf(c)>-1}},KU=["innerRef"];function XU(e){var t=e.innerRef,n=ko(e,KU),r=wW(n,"onExited","in","enter","exit","appear");return Ce("input",Re({ref:t},r,{css:My({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var YU=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()};function QU(e){var t=e.isEnabled,n=e.onBottomArrive,r=e.onBottomLeave,o=e.onTopArrive,i=e.onTopLeave,a=N.useRef(!1),s=N.useRef(!1),u=N.useRef(0),l=N.useRef(null),c=N.useCallback(function(g,v){if(l.current!==null){var y=l.current,b=y.scrollTop,x=y.scrollHeight,w=y.clientHeight,S=l.current,E=v>0,C=x-w-b,k=!1;C>v&&a.current&&(r&&r(g),a.current=!1),E&&s.current&&(i&&i(g),s.current=!1),E&&v>C?(n&&!a.current&&n(g),S.scrollTop=x,k=!0,a.current=!0):!E&&-v>b&&(o&&!s.current&&o(g),S.scrollTop=0,k=!0,s.current=!0),k&&YU(g)}},[n,r,o,i]),f=N.useCallback(function(g){c(g,g.deltaY)},[c]),d=N.useCallback(function(g){u.current=g.changedTouches[0].clientY},[]),p=N.useCallback(function(g){var v=u.current-g.changedTouches[0].clientY;c(g,v)},[c]),h=N.useCallback(function(g){if(g){var v=yW?{passive:!1}:!1;g.addEventListener("wheel",f,v),g.addEventListener("touchstart",d,v),g.addEventListener("touchmove",p,v)}},[p,d,f]),m=N.useCallback(function(g){g&&(g.removeEventListener("wheel",f,!1),g.removeEventListener("touchstart",d,!1),g.removeEventListener("touchmove",p,!1))},[p,d,f]);return N.useEffect(function(){if(t){var g=l.current;return h(g),function(){m(g)}}},[t,h,m]),function(g){l.current=g}}var vx=["boxSizing","height","overflow","paddingRight","position"],mx={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function gx(e){e.preventDefault()}function yx(e){e.stopPropagation()}function bx(){var e=this.scrollTop,t=this.scrollHeight,n=e+this.offsetHeight;e===0?this.scrollTop=1:n===t&&(this.scrollTop=e-1)}function xx(){return"ontouchstart"in window||navigator.maxTouchPoints}var wx=!!(typeof window<"u"&&window.document&&window.document.createElement),Ms=0,ca={capture:!1,passive:!1};function JU(e){var t=e.isEnabled,n=e.accountForScrollbars,r=n===void 0?!0:n,o=N.useRef({}),i=N.useRef(null),a=N.useCallback(function(u){if(wx){var l=document.body,c=l&&l.style;if(r&&vx.forEach(function(h){var m=c&&c[h];o.current[h]=m}),r&&Ms<1){var f=parseInt(o.current.paddingRight,10)||0,d=document.body?document.body.clientWidth:0,p=window.innerWidth-d+f||0;Object.keys(mx).forEach(function(h){var m=mx[h];c&&(c[h]=m)}),c&&(c.paddingRight="".concat(p,"px"))}l&&xx()&&(l.addEventListener("touchmove",gx,ca),u&&(u.addEventListener("touchstart",bx,ca),u.addEventListener("touchmove",yx,ca))),Ms+=1}},[r]),s=N.useCallback(function(u){if(wx){var l=document.body,c=l&&l.style;Ms=Math.max(Ms-1,0),r&&Ms<1&&vx.forEach(function(f){var d=o.current[f];c&&(c[f]=d)}),l&&xx()&&(l.removeEventListener("touchmove",gx,ca),u&&(u.removeEventListener("touchstart",bx,ca),u.removeEventListener("touchmove",yx,ca)))}},[r]);return N.useEffect(function(){if(t){var u=i.current;return a(u),function(){s(u)}}},[t,a,s]),function(u){i.current=u}}var ZU=function(t){var n=t.target;return n.ownerDocument.activeElement&&n.ownerDocument.activeElement.blur()},ez={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function tz(e){var t=e.children,n=e.lockEnabled,r=e.captureEnabled,o=r===void 0?!0:r,i=e.onBottomArrive,a=e.onBottomLeave,s=e.onTopArrive,u=e.onTopLeave,l=QU({isEnabled:o,onBottomArrive:i,onBottomLeave:a,onTopArrive:s,onTopLeave:u}),c=JU({isEnabled:n}),f=function(p){l(p),c(p)};return Ce(N.Fragment,null,n&&Ce("div",{onClick:ZU,css:ez}),t(f))}var nz={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},rz=function(t){var n=t.name,r=t.onFocus;return Ce("input",{required:!0,name:n,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:nz,value:"",onChange:function(){}})},oz=rz;function $y(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function iz(){return $y(/^iPhone/i)}function Dk(){return $y(/^Mac/i)}function az(){return $y(/^iPad/i)||Dk()&&navigator.maxTouchPoints>1}function sz(){return iz()||az()}function uz(){return Dk()||sz()}var lz=function(t){return t.label},cz=function(t){return t.label},fz=function(t){return t.value},dz=function(t){return!!t.isDisabled},pz={clearIndicator:XW,container:BW,control:nU,dropdownIndicator:qW,group:aU,groupHeading:uU,indicatorsContainer:WW,indicatorSeparator:QW,input:dU,loadingIndicator:eU,loadingMessage:NW,menu:kW,menuList:OW,menuPortal:FW,multiValue:gU,multiValueLabel:yU,multiValueRemove:bU,noOptionsMessage:DW,option:_U,placeholder:PU,singleValue:TU,valueContainer:$W},hz={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},vz=4,Nk=4,mz=38,gz=Nk*2,yz={baseUnit:Nk,controlHeight:mz,menuGutter:gz},ch={borderRadius:vz,colors:hz,spacing:yz},bz={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:cx(),captureMenuScroll:!cx(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:qU(),formatGroupLabel:lz,getOptionLabel:cz,getOptionValue:fz,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:dz,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!mW(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var n=t.count;return"".concat(n," result").concat(n!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function Sx(e,t,n,r){var o=Fk(e,t,n),i=Lk(e,t,n),a=Mk(e,t),s=wf(e,t);return{type:"option",data:t,isDisabled:o,isSelected:i,label:a,value:s,index:r}}function cc(e,t){return e.options.map(function(n,r){if("options"in n){var o=n.options.map(function(a,s){return Sx(e,a,t,s)}).filter(function(a){return Ex(e,a)});return o.length>0?{type:"group",data:n,options:o,index:r}:void 0}var i=Sx(e,n,t,r);return Ex(e,i)?i:void 0}).filter(bW)}function Ak(e){return e.reduce(function(t,n){return n.type==="group"?t.push.apply(t,Oy(n.options.map(function(r){return r.data}))):t.push(n.data),t},[])}function Cx(e,t){return e.reduce(function(n,r){return r.type==="group"?n.push.apply(n,Oy(r.options.map(function(o){return{data:o.data,id:"".concat(t,"-").concat(r.index,"-").concat(o.index)}}))):n.push({data:r.data,id:"".concat(t,"-").concat(r.index)}),n},[])}function xz(e,t){return Ak(cc(e,t))}function Ex(e,t){var n=e.inputValue,r=n===void 0?"":n,o=t.data,i=t.isSelected,a=t.label,s=t.value;return(!jk(e)||!i)&&Bk(e,{label:a,value:s,data:o},r)}function wz(e,t){var n=e.focusedValue,r=e.selectValue,o=r.indexOf(n);if(o>-1){var i=t.indexOf(n);if(i>-1)return n;if(o<t.length)return t[o]}return null}function Sz(e,t){var n=e.focusedOption;return n&&t.indexOf(n)>-1?n:t[0]}var fh=function(t,n){var r,o=(r=t.find(function(i){return i.data===n}))===null||r===void 0?void 0:r.id;return o||null},Mk=function(t,n){return t.getOptionLabel(n)},wf=function(t,n){return t.getOptionValue(n)};function Fk(e,t,n){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(t,n):!1}function Lk(e,t,n){if(n.indexOf(t)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(t,n);var r=wf(e,t);return n.some(function(o){return wf(e,o)===r})}function Bk(e,t,n){return e.filterOption?e.filterOption(t,n):!0}var jk=function(t){var n=t.hideSelectedOptions,r=t.isMulti;return n===void 0?r:n},Cz=1,$k=function(e){KV(n,e);var t=QV(n);function n(r){var o;if(GV(this,n),o=t.call(this,r),o.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},o.blockOptionHover=!1,o.isComposing=!1,o.commonProps=void 0,o.initialTouchX=0,o.initialTouchY=0,o.openAfterFocus=!1,o.scrollToFocusedOptionOnUpdate=!1,o.userIsDragging=void 0,o.isAppleDevice=uz(),o.controlRef=null,o.getControlRef=function(u){o.controlRef=u},o.focusedOptionRef=null,o.getFocusedOptionRef=function(u){o.focusedOptionRef=u},o.menuListRef=null,o.getMenuListRef=function(u){o.menuListRef=u},o.inputRef=null,o.getInputRef=function(u){o.inputRef=u},o.focus=o.focusInput,o.blur=o.blurInput,o.onChange=function(u,l){var c=o.props,f=c.onChange,d=c.name;l.name=d,o.ariaOnChange(u,l),f(u,l)},o.setValue=function(u,l,c){var f=o.props,d=f.closeMenuOnSelect,p=f.isMulti,h=f.inputValue;o.onInputChange("",{action:"set-value",prevInputValue:h}),d&&(o.setState({inputIsHiddenAfterUpdate:!p}),o.onMenuClose()),o.setState({clearFocusValueOnUpdate:!0}),o.onChange(u,{action:l,option:c})},o.selectOption=function(u){var l=o.props,c=l.blurInputOnSelect,f=l.isMulti,d=l.name,p=o.state.selectValue,h=f&&o.isOptionSelected(u,p),m=o.isOptionDisabled(u,p);if(h){var g=o.getOptionValue(u);o.setValue(p.filter(function(v){return o.getOptionValue(v)!==g}),"deselect-option",u)}else if(!m)f?o.setValue([].concat(Oy(p),[u]),"select-option",u):o.setValue(u,"select-option");else{o.ariaOnChange(u,{action:"select-option",option:u,name:d});return}c&&o.blurInput()},o.removeValue=function(u){var l=o.props.isMulti,c=o.state.selectValue,f=o.getOptionValue(u),d=c.filter(function(h){return o.getOptionValue(h)!==f}),p=Ul(l,d,d[0]||null);o.onChange(p,{action:"remove-value",removedValue:u}),o.focusInput()},o.clearValue=function(){var u=o.state.selectValue;o.onChange(Ul(o.props.isMulti,[],null),{action:"clear",removedValues:u})},o.popValue=function(){var u=o.props.isMulti,l=o.state.selectValue,c=l[l.length-1],f=l.slice(0,l.length-1),d=Ul(u,f,f[0]||null);o.onChange(d,{action:"pop-value",removedValue:c})},o.getFocusedOptionId=function(u){return fh(o.state.focusableOptionsWithIds,u)},o.getFocusableOptionsWithIds=function(){return Cx(cc(o.props,o.state.selectValue),o.getElementId("option"))},o.getValue=function(){return o.state.selectValue},o.cx=function(){for(var u=arguments.length,l=new Array(u),c=0;c<u;c++)l[c]=arguments[c];return fW.apply(void 0,[o.props.classNamePrefix].concat(l))},o.getOptionLabel=function(u){return Mk(o.props,u)},o.getOptionValue=function(u){return wf(o.props,u)},o.getStyles=function(u,l){var c=o.props.unstyled,f=pz[u](l,c);f.boxSizing="border-box";var d=o.props.styles[u];return d?d(f,l):f},o.getClassNames=function(u,l){var c,f;return(c=(f=o.props.classNames)[u])===null||c===void 0?void 0:c.call(f,l)},o.getElementId=function(u){return"".concat(o.state.instancePrefix,"-").concat(u)},o.getComponents=function(){return MU(o.props)},o.buildCategorizedOptions=function(){return cc(o.props,o.state.selectValue)},o.getCategorizedOptions=function(){return o.props.menuIsOpen?o.buildCategorizedOptions():[]},o.buildFocusableOptions=function(){return Ak(o.buildCategorizedOptions())},o.getFocusableOptions=function(){return o.props.menuIsOpen?o.buildFocusableOptions():[]},o.ariaOnChange=function(u,l){o.setState({ariaSelection:Se({value:u},l)})},o.onMenuMouseDown=function(u){u.button===0&&(u.stopPropagation(),u.preventDefault(),o.focusInput())},o.onMenuMouseMove=function(u){o.blockOptionHover=!1},o.onControlMouseDown=function(u){if(!u.defaultPrevented){var l=o.props.openMenuOnClick;o.state.isFocused?o.props.menuIsOpen?u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&o.onMenuClose():l&&o.openMenu("first"):(l&&(o.openAfterFocus=!0),o.focusInput()),u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&u.preventDefault()}},o.onDropdownIndicatorMouseDown=function(u){if(!(u&&u.type==="mousedown"&&u.button!==0)&&!o.props.isDisabled){var l=o.props,c=l.isMulti,f=l.menuIsOpen;o.focusInput(),f?(o.setState({inputIsHiddenAfterUpdate:!c}),o.onMenuClose()):o.openMenu("first"),u.preventDefault()}},o.onClearIndicatorMouseDown=function(u){u&&u.type==="mousedown"&&u.button!==0||(o.clearValue(),u.preventDefault(),o.openAfterFocus=!1,u.type==="touchend"?o.focusInput():setTimeout(function(){return o.focusInput()}))},o.onScroll=function(u){typeof o.props.closeMenuOnScroll=="boolean"?u.target instanceof HTMLElement&&Vd(u.target)&&o.props.onMenuClose():typeof o.props.closeMenuOnScroll=="function"&&o.props.closeMenuOnScroll(u)&&o.props.onMenuClose()},o.onCompositionStart=function(){o.isComposing=!0},o.onCompositionEnd=function(){o.isComposing=!1},o.onTouchStart=function(u){var l=u.touches,c=l&&l.item(0);c&&(o.initialTouchX=c.clientX,o.initialTouchY=c.clientY,o.userIsDragging=!1)},o.onTouchMove=function(u){var l=u.touches,c=l&&l.item(0);if(c){var f=Math.abs(c.clientX-o.initialTouchX),d=Math.abs(c.clientY-o.initialTouchY),p=5;o.userIsDragging=f>p||d>p}},o.onTouchEnd=function(u){o.userIsDragging||(o.controlRef&&!o.controlRef.contains(u.target)&&o.menuListRef&&!o.menuListRef.contains(u.target)&&o.blurInput(),o.initialTouchX=0,o.initialTouchY=0)},o.onControlTouchEnd=function(u){o.userIsDragging||o.onControlMouseDown(u)},o.onClearIndicatorTouchEnd=function(u){o.userIsDragging||o.onClearIndicatorMouseDown(u)},o.onDropdownIndicatorTouchEnd=function(u){o.userIsDragging||o.onDropdownIndicatorMouseDown(u)},o.handleInputChange=function(u){var l=o.props.inputValue,c=u.currentTarget.value;o.setState({inputIsHiddenAfterUpdate:!1}),o.onInputChange(c,{action:"input-change",prevInputValue:l}),o.props.menuIsOpen||o.onMenuOpen()},o.onInputFocus=function(u){o.props.onFocus&&o.props.onFocus(u),o.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(o.openAfterFocus||o.props.openMenuOnFocus)&&o.openMenu("first"),o.openAfterFocus=!1},o.onInputBlur=function(u){var l=o.props.inputValue;if(o.menuListRef&&o.menuListRef.contains(document.activeElement)){o.inputRef.focus();return}o.props.onBlur&&o.props.onBlur(u),o.onInputChange("",{action:"input-blur",prevInputValue:l}),o.onMenuClose(),o.setState({focusedValue:null,isFocused:!1})},o.onOptionHover=function(u){if(!(o.blockOptionHover||o.state.focusedOption===u)){var l=o.getFocusableOptions(),c=l.indexOf(u);o.setState({focusedOption:u,focusedOptionId:c>-1?o.getFocusedOptionId(u):null})}},o.shouldHideSelectedOptions=function(){return jk(o.props)},o.onValueInputFocus=function(u){u.preventDefault(),u.stopPropagation(),o.focus()},o.onKeyDown=function(u){var l=o.props,c=l.isMulti,f=l.backspaceRemovesValue,d=l.escapeClearsValue,p=l.inputValue,h=l.isClearable,m=l.isDisabled,g=l.menuIsOpen,v=l.onKeyDown,y=l.tabSelectsValue,b=l.openMenuOnFocus,x=o.state,w=x.focusedOption,S=x.focusedValue,E=x.selectValue;if(!m&&!(typeof v=="function"&&(v(u),u.defaultPrevented))){switch(o.blockOptionHover=!0,u.key){case"ArrowLeft":if(!c||p)return;o.focusValue("previous");break;case"ArrowRight":if(!c||p)return;o.focusValue("next");break;case"Delete":case"Backspace":if(p)return;if(S)o.removeValue(S);else{if(!f)return;c?o.popValue():h&&o.clearValue()}break;case"Tab":if(o.isComposing||u.shiftKey||!g||!y||!w||b&&o.isOptionSelected(w,E))return;o.selectOption(w);break;case"Enter":if(u.keyCode===229)break;if(g){if(!w||o.isComposing)return;o.selectOption(w);break}return;case"Escape":g?(o.setState({inputIsHiddenAfterUpdate:!1}),o.onInputChange("",{action:"menu-close",prevInputValue:p}),o.onMenuClose()):h&&d&&o.clearValue();break;case" ":if(p)return;if(!g){o.openMenu("first");break}if(!w)return;o.selectOption(w);break;case"ArrowUp":g?o.focusOption("up"):o.openMenu("last");break;case"ArrowDown":g?o.focusOption("down"):o.openMenu("first");break;case"PageUp":if(!g)return;o.focusOption("pageup");break;case"PageDown":if(!g)return;o.focusOption("pagedown");break;case"Home":if(!g)return;o.focusOption("first");break;case"End":if(!g)return;o.focusOption("last");break;default:return}u.preventDefault()}},o.state.instancePrefix="react-select-"+(o.props.instanceId||++Cz),o.state.selectValue=ux(r.value),r.menuIsOpen&&o.state.selectValue.length){var i=o.getFocusableOptionsWithIds(),a=o.buildFocusableOptions(),s=a.indexOf(o.state.selectValue[0]);o.state.focusableOptionsWithIds=i,o.state.focusedOption=a[s],o.state.focusedOptionId=fh(i,a[s])}return o}return qV(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&lx(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(o){var i=this.props,a=i.isDisabled,s=i.menuIsOpen,u=this.state.isFocused;(u&&!a&&o.isDisabled||u&&s&&!o.menuIsOpen)&&this.focusInput(),u&&a&&!o.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!u&&!a&&o.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(lx(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(o,i){this.props.onInputChange(o,i)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(o){var i=this,a=this.state,s=a.selectValue,u=a.isFocused,l=this.buildFocusableOptions(),c=o==="first"?0:l.length-1;if(!this.props.isMulti){var f=l.indexOf(s[0]);f>-1&&(c=f)}this.scrollToFocusedOptionOnUpdate=!(u&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:l[c],focusedOptionId:this.getFocusedOptionId(l[c])},function(){return i.onMenuOpen()})}},{key:"focusValue",value:function(o){var i=this.state,a=i.selectValue,s=i.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var u=a.indexOf(s);s||(u=-1);var l=a.length-1,c=-1;if(a.length){switch(o){case"previous":u===0?c=0:u===-1?c=l:c=u-1;break;case"next":u>-1&&u<l&&(c=u+1);break}this.setState({inputIsHidden:c!==-1,focusedValue:a[c]})}}}},{key:"focusOption",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",i=this.props.pageSize,a=this.state.focusedOption,s=this.getFocusableOptions();if(s.length){var u=0,l=s.indexOf(a);a||(l=-1),o==="up"?u=l>0?l-1:s.length-1:o==="down"?u=(l+1)%s.length:o==="pageup"?(u=l-i,u<0&&(u=0)):o==="pagedown"?(u=l+i,u>s.length-1&&(u=s.length-1)):o==="last"&&(u=s.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:s[u],focusedValue:null,focusedOptionId:this.getFocusedOptionId(s[u])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(ch):Se(Se({},ch),this.props.theme):ch}},{key:"getCommonProps",value:function(){var o=this.clearValue,i=this.cx,a=this.getStyles,s=this.getClassNames,u=this.getValue,l=this.selectOption,c=this.setValue,f=this.props,d=f.isMulti,p=f.isRtl,h=f.options,m=this.hasValue();return{clearValue:o,cx:i,getStyles:a,getClassNames:s,getValue:u,hasValue:m,isMulti:d,isRtl:p,options:h,selectOption:l,selectProps:f,setValue:c,theme:this.getTheme()}}},{key:"hasValue",value:function(){var o=this.state.selectValue;return o.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var o=this.props,i=o.isClearable,a=o.isMulti;return i===void 0?a:i}},{key:"isOptionDisabled",value:function(o,i){return Fk(this.props,o,i)}},{key:"isOptionSelected",value:function(o,i){return Lk(this.props,o,i)}},{key:"filterOption",value:function(o,i){return Bk(this.props,o,i)}},{key:"formatOptionLabel",value:function(o,i){if(typeof this.props.formatOptionLabel=="function"){var a=this.props.inputValue,s=this.state.selectValue;return this.props.formatOptionLabel(o,{context:i,inputValue:a,selectValue:s})}else return this.getOptionLabel(o)}},{key:"formatGroupLabel",value:function(o){return this.props.formatGroupLabel(o)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var o=this.props,i=o.isDisabled,a=o.isSearchable,s=o.inputId,u=o.inputValue,l=o.tabIndex,c=o.form,f=o.menuIsOpen,d=o.required,p=this.getComponents(),h=p.Input,m=this.state,g=m.inputIsHidden,v=m.ariaSelection,y=this.commonProps,b=s||this.getElementId("input"),x=Se(Se(Se({"aria-autocomplete":"list","aria-expanded":f,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":d,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},f&&{"aria-controls":this.getElementId("listbox")}),!a&&{"aria-readonly":!0}),this.hasValue()?(v==null?void 0:v.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return a?N.createElement(h,Re({},y,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:b,innerRef:this.getInputRef,isDisabled:i,isHidden:g,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:l,form:c,type:"text",value:u},x)):N.createElement(XU,Re({id:b,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:bf,onFocus:this.onInputFocus,disabled:i,tabIndex:l,inputMode:"none",form:c,value:""},x))}},{key:"renderPlaceholderOrValue",value:function(){var o=this,i=this.getComponents(),a=i.MultiValue,s=i.MultiValueContainer,u=i.MultiValueLabel,l=i.MultiValueRemove,c=i.SingleValue,f=i.Placeholder,d=this.commonProps,p=this.props,h=p.controlShouldRenderValue,m=p.isDisabled,g=p.isMulti,v=p.inputValue,y=p.placeholder,b=this.state,x=b.selectValue,w=b.focusedValue,S=b.isFocused;if(!this.hasValue()||!h)return v?null:N.createElement(f,Re({},d,{key:"placeholder",isDisabled:m,isFocused:S,innerProps:{id:this.getElementId("placeholder")}}),y);if(g)return x.map(function(C,k){var _=C===w,T="".concat(o.getOptionLabel(C),"-").concat(o.getOptionValue(C));return N.createElement(a,Re({},d,{components:{Container:s,Label:u,Remove:l},isFocused:_,isDisabled:m,key:T,index:k,removeProps:{onClick:function(){return o.removeValue(C)},onTouchEnd:function(){return o.removeValue(C)},onMouseDown:function(U){U.preventDefault()}},data:C}),o.formatOptionLabel(C,"value"))});if(v)return null;var E=x[0];return N.createElement(c,Re({},d,{data:E,isDisabled:m}),this.formatOptionLabel(E,"value"))}},{key:"renderClearIndicator",value:function(){var o=this.getComponents(),i=o.ClearIndicator,a=this.commonProps,s=this.props,u=s.isDisabled,l=s.isLoading,c=this.state.isFocused;if(!this.isClearable()||!i||u||!this.hasValue()||l)return null;var f={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return N.createElement(i,Re({},a,{innerProps:f,isFocused:c}))}},{key:"renderLoadingIndicator",value:function(){var o=this.getComponents(),i=o.LoadingIndicator,a=this.commonProps,s=this.props,u=s.isDisabled,l=s.isLoading,c=this.state.isFocused;if(!i||!l)return null;var f={"aria-hidden":"true"};return N.createElement(i,Re({},a,{innerProps:f,isDisabled:u,isFocused:c}))}},{key:"renderIndicatorSeparator",value:function(){var o=this.getComponents(),i=o.DropdownIndicator,a=o.IndicatorSeparator;if(!i||!a)return null;var s=this.commonProps,u=this.props.isDisabled,l=this.state.isFocused;return N.createElement(a,Re({},s,{isDisabled:u,isFocused:l}))}},{key:"renderDropdownIndicator",value:function(){var o=this.getComponents(),i=o.DropdownIndicator;if(!i)return null;var a=this.commonProps,s=this.props.isDisabled,u=this.state.isFocused,l={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return N.createElement(i,Re({},a,{innerProps:l,isDisabled:s,isFocused:u}))}},{key:"renderMenu",value:function(){var o=this,i=this.getComponents(),a=i.Group,s=i.GroupHeading,u=i.Menu,l=i.MenuList,c=i.MenuPortal,f=i.LoadingMessage,d=i.NoOptionsMessage,p=i.Option,h=this.commonProps,m=this.state.focusedOption,g=this.props,v=g.captureMenuScroll,y=g.inputValue,b=g.isLoading,x=g.loadingMessage,w=g.minMenuHeight,S=g.maxMenuHeight,E=g.menuIsOpen,C=g.menuPlacement,k=g.menuPosition,_=g.menuPortalTarget,T=g.menuShouldBlockScroll,D=g.menuShouldScrollIntoView,U=g.noOptionsMessage,j=g.onMenuScrollToTop,A=g.onMenuScrollToBottom;if(!E)return null;var M=function(J,ne){var ie=J.type,se=J.data,me=J.isDisabled,he=J.isSelected,Ee=J.label,Ie=J.value,ce=m===se,_e=me?void 0:function(){return o.onOptionHover(se)},ke=me?void 0:function(){return o.selectOption(se)},Ye="".concat(o.getElementId("option"),"-").concat(ne),Ue={id:Ye,onClick:ke,onMouseMove:_e,onMouseOver:_e,tabIndex:-1,role:"option","aria-selected":o.isAppleDevice?void 0:he};return N.createElement(p,Re({},h,{innerProps:Ue,data:se,isDisabled:me,isSelected:he,key:Ye,label:Ee,type:ie,value:Ie,isFocused:ce,innerRef:ce?o.getFocusedOptionRef:void 0}),o.formatOptionLabel(J.data,"menu"))},$;if(this.hasOptions())$=this.getCategorizedOptions().map(function(q){if(q.type==="group"){var J=q.data,ne=q.options,ie=q.index,se="".concat(o.getElementId("group"),"-").concat(ie),me="".concat(se,"-heading");return N.createElement(a,Re({},h,{key:se,data:J,options:ne,Heading:s,headingProps:{id:me,data:q.data},label:o.formatGroupLabel(q.data)}),q.options.map(function(he){return M(he,"".concat(ie,"-").concat(he.index))}))}else if(q.type==="option")return M(q,"".concat(q.index))});else if(b){var O=x({inputValue:y});if(O===null)return null;$=N.createElement(f,h,O)}else{var L=U({inputValue:y});if(L===null)return null;$=N.createElement(d,h,L)}var B={minMenuHeight:w,maxMenuHeight:S,menuPlacement:C,menuPosition:k,menuShouldScrollIntoView:D},G=N.createElement(RW,Re({},h,B),function(q){var J=q.ref,ne=q.placerProps,ie=ne.placement,se=ne.maxHeight;return N.createElement(u,Re({},h,B,{innerRef:J,innerProps:{onMouseDown:o.onMenuMouseDown,onMouseMove:o.onMenuMouseMove},isLoading:b,placement:ie}),N.createElement(tz,{captureEnabled:v,onTopArrive:j,onBottomArrive:A,lockEnabled:T},function(me){return N.createElement(l,Re({},h,{innerRef:function(Ee){o.getMenuListRef(Ee),me(Ee)},innerProps:{role:"listbox","aria-multiselectable":h.isMulti,id:o.getElementId("listbox")},isLoading:b,maxHeight:se,focusedOption:m}),$)}))});return _||k==="fixed"?N.createElement(c,Re({},h,{appendTo:_,controlElement:this.controlRef,menuPlacement:C,menuPosition:k}),G):G}},{key:"renderFormField",value:function(){var o=this,i=this.props,a=i.delimiter,s=i.isDisabled,u=i.isMulti,l=i.name,c=i.required,f=this.state.selectValue;if(c&&!this.hasValue()&&!s)return N.createElement(oz,{name:l,onFocus:this.onValueInputFocus});if(!(!l||s))if(u)if(a){var d=f.map(function(m){return o.getOptionValue(m)}).join(a);return N.createElement("input",{name:l,type:"hidden",value:d})}else{var p=f.length>0?f.map(function(m,g){return N.createElement("input",{key:"i-".concat(g),name:l,type:"hidden",value:o.getOptionValue(m)})}):N.createElement("input",{name:l,type:"hidden",value:""});return N.createElement("div",null,p)}else{var h=f[0]?this.getOptionValue(f[0]):"";return N.createElement("input",{name:l,type:"hidden",value:h})}}},{key:"renderLiveRegion",value:function(){var o=this.commonProps,i=this.state,a=i.ariaSelection,s=i.focusedOption,u=i.focusedValue,l=i.isFocused,c=i.selectValue,f=this.getFocusableOptions();return N.createElement(UU,Re({},o,{id:this.getElementId("live-region"),ariaSelection:a,focusedOption:s,focusedValue:u,isFocused:l,selectValue:c,focusableOptions:f,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var o=this.getComponents(),i=o.Control,a=o.IndicatorsContainer,s=o.SelectContainer,u=o.ValueContainer,l=this.props,c=l.className,f=l.id,d=l.isDisabled,p=l.menuIsOpen,h=this.state.isFocused,m=this.commonProps=this.getCommonProps();return N.createElement(s,Re({},m,{className:c,innerProps:{id:f,onKeyDown:this.onKeyDown},isDisabled:d,isFocused:h}),this.renderLiveRegion(),N.createElement(i,Re({},m,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:d,isFocused:h,menuIsOpen:p}),N.createElement(u,Re({},m,{isDisabled:d}),this.renderPlaceholderOrValue(),this.renderInput()),N.createElement(a,Re({},m,{isDisabled:d}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(o,i){var a=i.prevProps,s=i.clearFocusValueOnUpdate,u=i.inputIsHiddenAfterUpdate,l=i.ariaSelection,c=i.isFocused,f=i.prevWasFocused,d=i.instancePrefix,p=o.options,h=o.value,m=o.menuIsOpen,g=o.inputValue,v=o.isMulti,y=ux(h),b={};if(a&&(h!==a.value||p!==a.options||m!==a.menuIsOpen||g!==a.inputValue)){var x=m?xz(o,y):[],w=m?Cx(cc(o,y),"".concat(d,"-option")):[],S=s?wz(i,y):null,E=Sz(i,x),C=fh(w,E);b={selectValue:y,focusedOption:E,focusedOptionId:C,focusableOptionsWithIds:w,focusedValue:S,clearFocusValueOnUpdate:!1}}var k=u!=null&&o!==a?{inputIsHidden:u,inputIsHiddenAfterUpdate:void 0}:{},_=l,T=c&&f;return c&&!T&&(_={value:Ul(v,y,y[0]||null),options:y,action:"initial-input-focus"},T=!f),(l==null?void 0:l.action)==="initial-input-focus"&&(_=null),Se(Se(Se({},b),k),{},{prevProps:o,ariaSelection:_,prevWasFocused:T})}}]),n}(N.Component);$k.defaultProps=bz;var Ez=N.forwardRef(function(e,t){var n=HV(e);return N.createElement($k,Re({ref:t},n))}),_x=Ez;const _z={happy:"Action",sad:"Drama",angry:"Comedy",surprised:"Horror",neutral:"Thriller"},kz={male:"Documentary",female:"Romance"},Rz={underAge:"Animation",adult:"Science Fiction",senior:"History"};let To={};const Pz=[{value:"popularity.desc",label:"Popularity Descending"},{value:"popularity.asc",label:"Popularity Ascending"},{value:"vote_average.desc",label:"Rating Descending"},{value:"vote_average.asc",label:"Rating Ascending"},{value:"primary_release_date.desc",label:"Release Date Descending"},{value:"primary_release_date.asc",label:"Release Date Ascending"},{value:"original_title.asc",label:"Title (A-Z)"}],Iz=({pasDet:e})=>{var b,x,w;const[t,n]=N.useState(null),[r,o]=N.useState(1),[i,a]=N.useState(!1),[s,u]=N.useState(null),[l,c]=N.useState(null),{mediaType:f}=Uf(),[d,p]=N.useState([]),{data:h}=Ir(`/genre/${f}/list`),m=()=>{a(!0),Vi(`/discover/${f}`,To).then(S=>{n(S),o(E=>E+1),a(!1)})},g=()=>{Vi(`/discover/${f}?page=${r}`,To).then(S=>{t!=null&&t.results?n({...t,results:[...t==null?void 0:t.results,...S.results]}):n(S),o(E=>E+1)})};N.useEffect(()=>{p(e),To={},n(null),o(1),c(null),u(null),m()},[f,e]);const v=(S,E)=>{if(E.name==="sortby"&&(c(S),E.action!=="clear"?To.sort_by=S.value:delete To.sort_by),E.name==="genres")if(u(S),E.action!=="clear"){let C=S.map(k=>k.id);C=JSON.stringify(C).slice(1,-1),To.with_genres=C}else delete To.with_genres;o(1),m()},y=()=>{const S=Object.entries(d.expressions).reduce((D,U)=>D[1]>U[1]?D:U)[0],E=Math.round(d.age),C=E>18?E<40?"adult":"senior":"underAge",k=d.gender;console.log(`${S}, ${C}, ${k}`);const _=h==null?void 0:h.genres.filter(D=>[_z[S],kz[k],Rz[C]].includes(D.name));u(_);let T=_.map(D=>D.id);T=JSON.stringify(T).slice(1,-1),To.with_genres=T,o(1),m()};return P.jsx("div",{className:"explorePage",children:P.jsxs(hn,{children:[P.jsxs("div",{className:"pageHeader",children:[P.jsx("div",{className:"pageTitle",children:f==="tv"?"Explore TV Shows":"Explore Movies"}),P.jsx("div",{className:"autoSel",children:P.jsx("button",{className:"autoSelBtn",onClick:y,children:"Auto Filter"})}),P.jsxs("div",{className:"filters",children:[P.jsx(_x,{isMulti:!0,name:"genres",value:s,closeMenuOnSelect:!1,options:h==null?void 0:h.genres,getOptionLabel:S=>S.name,getOptionValue:S=>S.id,onChange:v,placeholder:"Select genres",className:"react-select-container genresDD",classNamePrefix:"react-select"}),P.jsx(_x,{name:"sortby",value:l,options:Pz,onChange:v,isClearable:!0,placeholder:"Sort by",className:"react-select-container sortbyDD",classNamePrefix:"react-select"})]})]}),i&&P.jsx(pf,{initial:!0}),!i&&P.jsx(P.Fragment,{children:((b=t==null?void 0:t.results)==null?void 0:b.length)>0?P.jsx(Z_,{className:"content",dataLength:((x=t==null?void 0:t.results)==null?void 0:x.length)||[],next:g,hasMore:r<=(t==null?void 0:t.total_pages),loader:P.jsx(pf,{}),children:(w=t==null?void 0:t.results)==null?void 0:w.map((S,E)=>{if(S.media_type!=="person")return P.jsx(ek,{data:S,mediaType:f},E)})}):P.jsx("span",{className:"resultNotFound",children:"Sorry, Results not found!"})})]})})},Oz=()=>P.jsx("div",{className:"pageNotFound",children:P.jsxs(hn,{children:[P.jsx("span",{className:"bigText",children:"404"}),P.jsx("span",{className:"smallText",children:"Page not found!"})]})});function Tz(){const e=kD(),{url:t}=Xi(s=>s.home);console.log(t),N.useEffect(()=>{n(),r()},[]);const n=()=>{Vi("/configuration").then(s=>{console.log(s);const u={backdrop:s.images.secure_base_url+"original",poster:s.images.secure_base_url+"original",profile:s.images.secure_base_url+"original"};e(vN(u))})},r=async()=>{let s=[],u=["tv","movie"],l={};u.forEach(f=>{s.push(Vi(`/genre/${f}/list`))});const c=await Promise.all(s);console.log(c),c.map(({genres:f})=>f.map(d=>l[d.id]=d)),e(mN(l))},[o,i]=N.useState([]),a=s=>{i(s)};return P.jsxs(iO,{children:[P.jsx(SN,{}),P.jsxs(nO,{children:[P.jsx(fa,{path:"/devmood/",element:P.jsx(h$,{sendDetection:a})}),P.jsx(fa,{path:"/:mediaType/:id",element:P.jsx(LV,{})}),P.jsx(fa,{path:"/search/:query",element:P.jsx($V,{})}),P.jsx(fa,{path:"/explore/:mediaType",element:P.jsx(Iz,{pasDet:o})}),P.jsx(fa,{path:"*",element:P.jsx(Oz,{})})]}),P.jsx(RN,{})]})}const Dz=oN({reducer:{home:gN}});ph.createRoot(document.getElementById("root")).render(P.jsx(CD,{store:Dz,children:P.jsx(Tz,{})}));export{om as g,N as r};
